{"type":"queue-operation","operation":"dequeue","timestamp":"2026-01-21T15:14:31.495Z","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961"}
{"type":"file-history-snapshot","messageId":"453b4242-d5d6-4211-918d-9da567a475f0","snapshot":{"messageId":"453b4242-d5d6-4211-918d-9da567a475f0","trackedFileBackups":{},"timestamp":"2026-01-21T15:14:31.596Z"},"isSnapshotUpdate":false}
{"parentUuid":null,"isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","type":"user","message":{"role":"user","content":[{"type":"text","text":"<ide_opened_file>The user opened the file c:\\laragon\\www\\psicoalianza-2\\resources\\views\\vacantes\\paginas\\index.blade.php in the IDE. This may or may not be related to the current task.</ide_opened_file>"},{"type":"text","text":"hola naliza este archivo"}]},"uuid":"453b4242-d5d6-4211-918d-9da567a475f0","timestamp":"2026-01-21T15:14:31.591Z"}
{"parentUuid":"453b4242-d5d6-4211-918d-9da567a475f0","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","message":{"model":"claude-opus-4-5-20251101","id":"msg_01M9AF9acsQX1vcHcnpPoHow","type":"message","role":"assistant","content":[{"type":"text","text":"Hola. Voy a leer el archivo que tienes abierto para analizarlo."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":25091,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":25091,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXLjyJUc5mkT3SSuQyTkp","type":"assistant","uuid":"470e6df7-b5da-4662-8bf5-634a5ef9a226","timestamp":"2026-01-21T15:14:35.041Z"}
{"parentUuid":"470e6df7-b5da-4662-8bf5-634a5ef9a226","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","message":{"model":"claude-opus-4-5-20251101","id":"msg_01M9AF9acsQX1vcHcnpPoHow","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_013eGKT5QTazr1EJhbhKsP8A","name":"Read","input":{"file_path":"c:\\laragon\\www\\psicoalianza-2\\resources\\views\\vacantes\\paginas\\index.blade.php"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":25091,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":25091,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXLjyJUc5mkT3SSuQyTkp","type":"assistant","uuid":"77f582d3-0963-482e-bfea-fc2c263464e2","timestamp":"2026-01-21T15:14:35.578Z"}
{"parentUuid":"77f582d3-0963-482e-bfea-fc2c263464e2","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_013eGKT5QTazr1EJhbhKsP8A","type":"tool_result","content":"     1→@extends('layouts.app')\n     2→\n     3→@section('titulo', 'Vacantes')\n     4→\n     5→@section('estilos')\n     6→    <link href=\"{{ asset('css/ofertas-laborales/ofertas-laborales.css') }}\" rel=\"stylesheet\">\n     7→@endsection\n     8→\n     9→@section('contenido')\n    10→    ${contenedorPrincipal({\n    11→        cabecera: `<div class=\"col-auto text-headline-2 text-gray-30 fw-bold\">Producto selección dd</div>`,\n    12→        contenido: `\n    13→            <div class=\"card shadow-none\">\n    14→                <div id=\"cabecera-pagina-sin-archivar\">\n    15→                    @include('componentes.menu-superior', ['rutas' => $rutas_menu->where('slug', 'productos-servicios')->first()?->rutas, 'activo' => 'vacantes'])\n    16→                </div>\n    17→                <div id=\"cabecera-pagina-con-archivar\" class=\"d-none\">\n    18→                    <div class=\"col-auto text-headline-4 text-gray-30 fw-semibold pt-4 px-5\">Vacantes archivadas</div>\n    19→                </div>\n    20→                <div class=\"card-body\">\n    21→                    <div class=\"d-none\" id=\"tabla-sin-contenido\">\n    22→                        <div class=\"w-100 text-center p-10\">\n    23→                            <p class=\"\"><i class=\"bi bi-briefcase text-gray-60\" style=\"font-size: 118px;\"></i></p>\n    24→                            <p class=\"pb-4 text-headline-5 fw-bold text-gray-30\">No tienes vacantes por ahora, publica la primera para comenzar.</p>\n    25→                            <p class=\"pb-4 \">\n    26→                                ${crearBoton({\n    27→                                    clases: 'btn-primary',\n    28→                                    url: '/vacantes/create',\n    29→                                    texto: '<i class=\"bi bi-plus-lg me-2\"></i> Crear vacante'\n    30→                                })}\n    31→                            </p>\n    32→                        </div>\n    33→                    </div>\n    34→                    <div id=\"tabla-contenido\">\n    35→                        ${crearTabla({\n    36→                            id: 'tabla-vacantes',\n    37→                            class: 'table-cards table-borderless',\n    38→                            class_tabla: 'table-cards',\n    39→                            registros_paginas: true,\n    40→                            buscador: {\n    41→                                icono: '<i class=\"bi bi-search input-icono1\"></i>',\n    42→                            },\n    43→                            chips: `\n    44→                                <div class=\"col-12\">\n    45→                                    <div class=\"row align-items-center w-100 mx-0 contenedor-chips my-2\" id=\"contenedor-chips-filtro_vacantes\"></div>\n    46→                                </div>\n    47→                            `,\n    48→                            buscador_datatable: true,\n    49→                            filtro: crearFiltroDropdown({\n    50→                                id: 'filtro_vacantes',\n    51→                                name: 'filtro_vacantes',\n    52→                                type: 'text',\n    53→                                value: '',\n    54→                                class: 'filtro-chips',\n    55→                                input_container_class: 'mb-0',\n    56→                                placeholder: 'Buscar',\n    57→                                buscador_datatable: true,\n    58→                                tabla_id: 'tabla-vacantes',\n    59→                                icono: '<i class=\"bi bi-search input-icono1\"></i>',\n    60→                                icono3: '<i class=\"bi bi-filter input-icono3 pointer icono-filtro-avanzado\" data-bs-toggle=\"dropdown\" aria-expanded=\"false\" data-bs-auto-close=\"outside\"></i>',\n    61→                                dropdown: {\n    62→                                    titulo: 'Filtros avanzados',\n    63→                                    contenido: `\n    64→                                        <div class=\"row mt-4\">\n    65→                                            <div class=\"col-5 pt-2\">Estados</div>\n    66→                                            <div class=\"col-7\">\n    67→                                                ${crearSelect2({\n    68→                                                    opciones: [\n    69→                                                        { nombre: 'Todo', id: '' },\n    70→                                                        @foreach($estados as $item)\n    71→                                                            { nombre: `{{ $item->nombre }}`, id: '{{ $item->id }}' },\n    72→                                                        @endforeach\n    73→                                                    ],\n    74→                                                    opcion_vacia: false,\n    75→                                                    id: 'estados_filtro',\n    76→                                                    class: 'select2-filtro-buscador filtro',\n    77→                                                    input_container_class: 'mb-0',\n    78→                                                    data: [\n    79→                                                        { texto: 'filtro', value: 'Estados'}\n    80→                                                    ]\n    81→                                                })}\n    82→                                            </div>\n    83→                                        </div>\n    84→                                        <div class=\"row mt-4\">\n    85→                                            <div class=\"col-5 pt-2\">Creador</div>\n    86→                                            <div class=\"col-7\">\n    87→                                                ${crearSelect2({\n    88→                                                    opciones: [\n    89→                                                        { nombre: 'Todo', id: '' },\n    90→                                                        @foreach($usuarios as $item)\n    91→                                                            { nombre: `{{ $item->nombres . ' ' . $item->apellidos }}`, id: '{{ $item->id }}' },\n    92→                                                        @endforeach\n    93→                                                    ],\n    94→                                                    opcion_vacia: false,\n    95→                                                    id: 'creador_filtro',\n    96→                                                    class: 'select2-filtro-buscador filtro',\n    97→                                                    input_container_class: 'mb-0',\n    98→                                                    data: [\n    99→                                                        { texto: 'filtro', value: 'Creador'}\n   100→                                                    ]\n   101→                                                })}\n   102→                                            </div>\n   103→                                        </div>\n   104→                                        <div class=\"row mt-5\">\n   105→                                            <div class=\"col-5 pt-2\">Fecha de creación</div>\n   106→                                            <div class=\"col-7\">\n   107→                                                ${crearDatePicker({\n   108→                                                    id: 'fecha_creacion_filtro',\n   109→                                                    class: 'flatpickr-range filtro',\n   110→                                                    input_container_class: 'mb-1',\n   111→                                                    placeholder: 'Desde - hasta',\n   112→                                                    icono: '<i class=\"bi bi-calendar4 input-icono2 text-gray-30 pointer\"></i>',\n   113→                                                    data: [\n   114→                                                        { texto: 'filtro', value: 'Fecha de creación'}\n   115→                                                    ]\n   116→                                                })}\n   117→                                            </div>\n   118→                                        </div>\n   119→                                        <div id=\"fecha_archivado\" class=\"row mt-5\">\n   120→                                            <div class=\"col-5 pt-2\">Fecha de archivado</div>\n   121→                                            <div class=\"col-7\">\n   122→                                                ${crearDatePicker({\n   123→                                                    id: 'fecha_archivado_filtro',\n   124→                                                    class: 'flatpickr-range filtro',\n   125→                                                    input_container_class: 'mb-1',\n   126→                                                    placeholder: 'Desde - hasta',\n   127→                                                    icono: '<i class=\"bi bi-calendar4 input-icono2 text-gray-30 pointer\"></i>',\n   128→                                                    data: [\n   129→                                                        { texto: 'filtro', value: 'Fecha de archivado'}\n   130→                                                    ]\n   131→                                                })}\n   132→                                            </div>\n   133→                                        </div>\n   134→                                        <div class=\"row mt-5\">\n   135→                                            <div class=\"col-5 pt-2\">Aplicante</div>\n   136→                                            <div class=\"col-7\">\n   137→                                                ${crearInput({\n   138→                                                    id: 'aplicante_filtro',\n   139→                                                    class: 'filtro',\n   140→                                                    input_container_class: 'mb-1',\n   141→                                                    placeholder: 'Nombre o cedula',\n   142→                                                    data: [\n   143→                                                        { texto: 'filtro', value: 'Aplicante'}\n   144→                                                    ]\n   145→                                                })}\n   146→                                            </div>\n   147→                                        </div>\n   148→                                        <div class=\"row mt-4\">\n   149→                                            <div class=\"col-5 pt-2\">Etapas</div>\n   150→                                            <div class=\"col-7\">\n   151→                                                ${crearSelect2({\n   152→                                                    opciones: [\n   153→                                                        { nombre: 'Todo', id: '' },\n   154→                                                        @foreach($etapas as $etapa)\n   155→                                                            { nombre: `{{ $etapa->nombre }}`, id: '{{ $etapa->nombre }}' },\n   156→                                                        @endforeach\n   157→                                                    ],\n   158→                                                    opcion_vacia: false,\n   159→                                                    id: 'etapa_filtro',\n   160→                                                    class: 'select2-filtro-buscador filtro',\n   161→                                                    input_container_class: 'mb-0',\n   162→                                                    data: [\n   163→                                                        { texto: 'filtro', value: 'Etapa'}\n   164→                                                    ]\n   165→                                                })}\n   166→                                            </div>\n   167→                                        </div>\n   168→                                    `\n   169→                                }\n   170→                            }),\n   171→                            botones: `\n   172→                            <div class=\"col-12 col-md\">\n   173→                                <div class=\"row justify-content-end\">\n   174→                                    <div class=\"col-12 px-1 col-md-3 my-auto\">\n   175→                                        ${crearSelect2({\n   176→                                            input_container_class: 'my-auto',\n   177→                                            opciones: [\n   178→                                                {id: 'created_at-DESC', nombre: 'Más recientes'},\n   179→                                                {id: 'created_at-ASC', nombre: 'Más antiguos'},\n   180→                                                {id: 'nombre_vacante-ASC', nombre: 'De la  A a la Z'},\n   181→                                                {id: 'nombre_vacante-DESC', nombre: 'De la  Z a la A'},\n   182→                                            ],\n   183→                                            opcion_vacia:false,\n   184→                                            id: 'filtro_mas_recientes',\n   185→                                            disabled: false,\n   186→                                            required: true,\n   187→                                            buscador: true\n   188→                                        })}\n   189→                                    </div>\n   190→                                    <div class=\"col-12 col-md my-auto\">\n   191→                                        <div class=\"row justify-content-end\">\n   192→                                            <div class=\"col-auto px-1 ms-auto\">\n   193→                                                ${crearBoton({\n   194→                                                    id     : 'boton-descargar-tabla-vacantes',\n   195→                                                    clases : 'btn-green-excel clase-desabilitada',\n   196→                                                    tooltip: `${crearTooltip({ placement: `bottom`, content: 'En contrucción', toggle: `popover`,})}`,\n   197→                                                    texto  : '<img class=\"me-3\" src=\"{{ asset('/iconos/excel_icon.svg') }}\"> Exportar todo',\n   198→                                                })}\n   199→                                            </div>\n   200→                                            <div class=\"col-auto\">\n   201→                                                ${crearBoton({\n   202→                                                    id: 'btn-archivo-vacantes',\n   203→                                                    clases: 'btn-tonal-primary',\n   204→                                                    texto: `<i class=\"bi bi-archive me-2\"></i> Archivo de vacantes`\n   205→                                                })}\n   206→                                                <input type=\"hidden\" id=\"vacantes_archivadas\" value=\"1\">\n   207→                                            </div>\n   208→                                            <div class=\"col-auto px-1 pe-3\">\n   209→                                                ${crearBoton({\n   210→                                                    id: 'btn-crear-vacante',\n   211→                                                    clases: 'btn-primary',\n   212→                                                    url: '/vacantes/create',\n   213→                                                    texto: '<i class=\"bi bi-plus-lg me-2\"></i> Crear vacante'\n   214→                                                })}\n   215→                                            </div>\n   216→                                        </div>\n   217→                                    </div>\n   218→                                </div>\n   219→                            </div>\n   220→                            `,\n   221→                        })}\n   222→                    </div>\n   223→                </div>\n   224→            </div>\n   225→        `\n   226→    })}\n   227→\n   228→    @include('vacantes.paginas.modales.modal-agregar-candidatos')\n   229→    @include('vacantes.paginas.modales.modal-cargar-archivo')\n   230→    @include('vacantes.paginas.modales.modal-solicitar-mas-creditos-ia')\n   231→    @include('vacantes.paginas.modales.modal-consumo-creditos-ia')\n   232→@endsection\n   233→\n   234→@section('scripts')\n   235→    <script type=\"text/javascript\">\n   236→        let activas = {{ $activas }};\n   237→        var empresa_id = {{ $empresa_id }};\n   238→        const EMPRESA_ID = @json(\\Auth::user()->empresa->id);\n   239→    </script>\n   240→\n   241→    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js\"></script>\n   242→    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js\"></script>\n   243→\n   244→    <script src=\"{{ asset('js/vacantes/vacantes-funciones.js') }}\" type=\"text/javascript\"></script>\n   245→    <script src=\"{{ asset('js/vacantes/general-vacantes.js') }}\" type=\"text/javascript\"></script>\n   246→    <script src=\"{{ asset('js/vacantes/vacantes.js') }}\" type=\"text/javascript\"></script>\n   247→@endsection\n   248→\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"76378517-ea8f-409d-aa5e-edcd6c509363","timestamp":"2026-01-21T15:14:38.450Z","toolUseResult":{"type":"text","file":{"filePath":"c:\\laragon\\www\\psicoalianza-2\\resources\\views\\vacantes\\paginas\\index.blade.php","content":"@extends('layouts.app')\n\n@section('titulo', 'Vacantes')\n\n@section('estilos')\n    <link href=\"{{ asset('css/ofertas-laborales/ofertas-laborales.css') }}\" rel=\"stylesheet\">\n@endsection\n\n@section('contenido')\n    ${contenedorPrincipal({\n        cabecera: `<div class=\"col-auto text-headline-2 text-gray-30 fw-bold\">Producto selección dd</div>`,\n        contenido: `\n            <div class=\"card shadow-none\">\n                <div id=\"cabecera-pagina-sin-archivar\">\n                    @include('componentes.menu-superior', ['rutas' => $rutas_menu->where('slug', 'productos-servicios')->first()?->rutas, 'activo' => 'vacantes'])\n                </div>\n                <div id=\"cabecera-pagina-con-archivar\" class=\"d-none\">\n                    <div class=\"col-auto text-headline-4 text-gray-30 fw-semibold pt-4 px-5\">Vacantes archivadas</div>\n                </div>\n                <div class=\"card-body\">\n                    <div class=\"d-none\" id=\"tabla-sin-contenido\">\n                        <div class=\"w-100 text-center p-10\">\n                            <p class=\"\"><i class=\"bi bi-briefcase text-gray-60\" style=\"font-size: 118px;\"></i></p>\n                            <p class=\"pb-4 text-headline-5 fw-bold text-gray-30\">No tienes vacantes por ahora, publica la primera para comenzar.</p>\n                            <p class=\"pb-4 \">\n                                ${crearBoton({\n                                    clases: 'btn-primary',\n                                    url: '/vacantes/create',\n                                    texto: '<i class=\"bi bi-plus-lg me-2\"></i> Crear vacante'\n                                })}\n                            </p>\n                        </div>\n                    </div>\n                    <div id=\"tabla-contenido\">\n                        ${crearTabla({\n                            id: 'tabla-vacantes',\n                            class: 'table-cards table-borderless',\n                            class_tabla: 'table-cards',\n                            registros_paginas: true,\n                            buscador: {\n                                icono: '<i class=\"bi bi-search input-icono1\"></i>',\n                            },\n                            chips: `\n                                <div class=\"col-12\">\n                                    <div class=\"row align-items-center w-100 mx-0 contenedor-chips my-2\" id=\"contenedor-chips-filtro_vacantes\"></div>\n                                </div>\n                            `,\n                            buscador_datatable: true,\n                            filtro: crearFiltroDropdown({\n                                id: 'filtro_vacantes',\n                                name: 'filtro_vacantes',\n                                type: 'text',\n                                value: '',\n                                class: 'filtro-chips',\n                                input_container_class: 'mb-0',\n                                placeholder: 'Buscar',\n                                buscador_datatable: true,\n                                tabla_id: 'tabla-vacantes',\n                                icono: '<i class=\"bi bi-search input-icono1\"></i>',\n                                icono3: '<i class=\"bi bi-filter input-icono3 pointer icono-filtro-avanzado\" data-bs-toggle=\"dropdown\" aria-expanded=\"false\" data-bs-auto-close=\"outside\"></i>',\n                                dropdown: {\n                                    titulo: 'Filtros avanzados',\n                                    contenido: `\n                                        <div class=\"row mt-4\">\n                                            <div class=\"col-5 pt-2\">Estados</div>\n                                            <div class=\"col-7\">\n                                                ${crearSelect2({\n                                                    opciones: [\n                                                        { nombre: 'Todo', id: '' },\n                                                        @foreach($estados as $item)\n                                                            { nombre: `{{ $item->nombre }}`, id: '{{ $item->id }}' },\n                                                        @endforeach\n                                                    ],\n                                                    opcion_vacia: false,\n                                                    id: 'estados_filtro',\n                                                    class: 'select2-filtro-buscador filtro',\n                                                    input_container_class: 'mb-0',\n                                                    data: [\n                                                        { texto: 'filtro', value: 'Estados'}\n                                                    ]\n                                                })}\n                                            </div>\n                                        </div>\n                                        <div class=\"row mt-4\">\n                                            <div class=\"col-5 pt-2\">Creador</div>\n                                            <div class=\"col-7\">\n                                                ${crearSelect2({\n                                                    opciones: [\n                                                        { nombre: 'Todo', id: '' },\n                                                        @foreach($usuarios as $item)\n                                                            { nombre: `{{ $item->nombres . ' ' . $item->apellidos }}`, id: '{{ $item->id }}' },\n                                                        @endforeach\n                                                    ],\n                                                    opcion_vacia: false,\n                                                    id: 'creador_filtro',\n                                                    class: 'select2-filtro-buscador filtro',\n                                                    input_container_class: 'mb-0',\n                                                    data: [\n                                                        { texto: 'filtro', value: 'Creador'}\n                                                    ]\n                                                })}\n                                            </div>\n                                        </div>\n                                        <div class=\"row mt-5\">\n                                            <div class=\"col-5 pt-2\">Fecha de creación</div>\n                                            <div class=\"col-7\">\n                                                ${crearDatePicker({\n                                                    id: 'fecha_creacion_filtro',\n                                                    class: 'flatpickr-range filtro',\n                                                    input_container_class: 'mb-1',\n                                                    placeholder: 'Desde - hasta',\n                                                    icono: '<i class=\"bi bi-calendar4 input-icono2 text-gray-30 pointer\"></i>',\n                                                    data: [\n                                                        { texto: 'filtro', value: 'Fecha de creación'}\n                                                    ]\n                                                })}\n                                            </div>\n                                        </div>\n                                        <div id=\"fecha_archivado\" class=\"row mt-5\">\n                                            <div class=\"col-5 pt-2\">Fecha de archivado</div>\n                                            <div class=\"col-7\">\n                                                ${crearDatePicker({\n                                                    id: 'fecha_archivado_filtro',\n                                                    class: 'flatpickr-range filtro',\n                                                    input_container_class: 'mb-1',\n                                                    placeholder: 'Desde - hasta',\n                                                    icono: '<i class=\"bi bi-calendar4 input-icono2 text-gray-30 pointer\"></i>',\n                                                    data: [\n                                                        { texto: 'filtro', value: 'Fecha de archivado'}\n                                                    ]\n                                                })}\n                                            </div>\n                                        </div>\n                                        <div class=\"row mt-5\">\n                                            <div class=\"col-5 pt-2\">Aplicante</div>\n                                            <div class=\"col-7\">\n                                                ${crearInput({\n                                                    id: 'aplicante_filtro',\n                                                    class: 'filtro',\n                                                    input_container_class: 'mb-1',\n                                                    placeholder: 'Nombre o cedula',\n                                                    data: [\n                                                        { texto: 'filtro', value: 'Aplicante'}\n                                                    ]\n                                                })}\n                                            </div>\n                                        </div>\n                                        <div class=\"row mt-4\">\n                                            <div class=\"col-5 pt-2\">Etapas</div>\n                                            <div class=\"col-7\">\n                                                ${crearSelect2({\n                                                    opciones: [\n                                                        { nombre: 'Todo', id: '' },\n                                                        @foreach($etapas as $etapa)\n                                                            { nombre: `{{ $etapa->nombre }}`, id: '{{ $etapa->nombre }}' },\n                                                        @endforeach\n                                                    ],\n                                                    opcion_vacia: false,\n                                                    id: 'etapa_filtro',\n                                                    class: 'select2-filtro-buscador filtro',\n                                                    input_container_class: 'mb-0',\n                                                    data: [\n                                                        { texto: 'filtro', value: 'Etapa'}\n                                                    ]\n                                                })}\n                                            </div>\n                                        </div>\n                                    `\n                                }\n                            }),\n                            botones: `\n                            <div class=\"col-12 col-md\">\n                                <div class=\"row justify-content-end\">\n                                    <div class=\"col-12 px-1 col-md-3 my-auto\">\n                                        ${crearSelect2({\n                                            input_container_class: 'my-auto',\n                                            opciones: [\n                                                {id: 'created_at-DESC', nombre: 'Más recientes'},\n                                                {id: 'created_at-ASC', nombre: 'Más antiguos'},\n                                                {id: 'nombre_vacante-ASC', nombre: 'De la  A a la Z'},\n                                                {id: 'nombre_vacante-DESC', nombre: 'De la  Z a la A'},\n                                            ],\n                                            opcion_vacia:false,\n                                            id: 'filtro_mas_recientes',\n                                            disabled: false,\n                                            required: true,\n                                            buscador: true\n                                        })}\n                                    </div>\n                                    <div class=\"col-12 col-md my-auto\">\n                                        <div class=\"row justify-content-end\">\n                                            <div class=\"col-auto px-1 ms-auto\">\n                                                ${crearBoton({\n                                                    id     : 'boton-descargar-tabla-vacantes',\n                                                    clases : 'btn-green-excel clase-desabilitada',\n                                                    tooltip: `${crearTooltip({ placement: `bottom`, content: 'En contrucción', toggle: `popover`,})}`,\n                                                    texto  : '<img class=\"me-3\" src=\"{{ asset('/iconos/excel_icon.svg') }}\"> Exportar todo',\n                                                })}\n                                            </div>\n                                            <div class=\"col-auto\">\n                                                ${crearBoton({\n                                                    id: 'btn-archivo-vacantes',\n                                                    clases: 'btn-tonal-primary',\n                                                    texto: `<i class=\"bi bi-archive me-2\"></i> Archivo de vacantes`\n                                                })}\n                                                <input type=\"hidden\" id=\"vacantes_archivadas\" value=\"1\">\n                                            </div>\n                                            <div class=\"col-auto px-1 pe-3\">\n                                                ${crearBoton({\n                                                    id: 'btn-crear-vacante',\n                                                    clases: 'btn-primary',\n                                                    url: '/vacantes/create',\n                                                    texto: '<i class=\"bi bi-plus-lg me-2\"></i> Crear vacante'\n                                                })}\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                            `,\n                        })}\n                    </div>\n                </div>\n            </div>\n        `\n    })}\n\n    @include('vacantes.paginas.modales.modal-agregar-candidatos')\n    @include('vacantes.paginas.modales.modal-cargar-archivo')\n    @include('vacantes.paginas.modales.modal-solicitar-mas-creditos-ia')\n    @include('vacantes.paginas.modales.modal-consumo-creditos-ia')\n@endsection\n\n@section('scripts')\n    <script type=\"text/javascript\">\n        let activas = {{ $activas }};\n        var empresa_id = {{ $empresa_id }};\n        const EMPRESA_ID = @json(\\Auth::user()->empresa->id);\n    </script>\n\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js\"></script>\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js\"></script>\n\n    <script src=\"{{ asset('js/vacantes/vacantes-funciones.js') }}\" type=\"text/javascript\"></script>\n    <script src=\"{{ asset('js/vacantes/general-vacantes.js') }}\" type=\"text/javascript\"></script>\n    <script src=\"{{ asset('js/vacantes/vacantes.js') }}\" type=\"text/javascript\"></script>\n@endsection\n","numLines":248,"startLine":1,"totalLines":248}},"sourceToolAssistantUUID":"77f582d3-0963-482e-bfea-fc2c263464e2"}
{"parentUuid":"76378517-ea8f-409d-aa5e-edcd6c509363","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01H72fHcBigBKJbBcHJB4tBq","type":"message","role":"assistant","content":[{"type":"text","text":"## Análisis del archivo `index.blade.php`\n\nEste es un archivo de vista Blade para el **módulo de Vacantes** del sistema PsicoAlianza. Aquí está el análisis:\n\n### Estructura General\n- **Extiende**: `layouts.app` (layout principal)\n- **Título**: \"Vacantes\"\n- **Estilos**: Carga CSS específico de ofertas laborales\n\n### Componentes UI Utilizados\nEl archivo usa correctamente el sistema de componentes documentado:\n\n| Componente | Uso |\n|------------|-----|\n| `contenedorPrincipal()` | Contenedor principal de la página |\n| `crearTabla()` | Tabla DataTable para listar vacantes |\n| `crearBoton()` | Botones de acción (crear, exportar, archivo) |\n| `crearSelect2()` | Selectores de filtros (estados, creador, etapas, ordenamiento) |\n| `crearDatePicker()` | Filtros de fecha (creación, archivado) |\n| `crearInput()` | Input para filtrar por aplicante |\n| `crearFiltroDropdown()` | Dropdown de filtros avanzados |\n| `crearTooltip()` | Tooltip en botón de exportar |\n\n### Funcionalidades\n1. **Listado de vacantes** con DataTable\n2. **Estado vacío** cuando no hay vacantes (con botón para crear)\n3. **Filtros avanzados**:\n   - Por estado\n   - Por creador (usuario)\n   - Por fecha de creación\n   - Por fecha de archivado\n   - Por aplicante (nombre o cédula)\n   - Por etapa\n4. **Ordenamiento**: Más recientes, más antiguos, A-Z, Z-A\n5. **Acciones**: Crear vacante, exportar a Excel, ver archivo de vacantes\n\n### Modales Incluidos\n- `modal-agregar-candidatos`\n- `modal-cargar-archivo`\n- `modal-solicitar-mas-creditos-ia`\n- `modal-consumo-creditos-ia`\n\n### Scripts Cargados\n- Variables PHP pasadas a JS: `activas`, `empresa_id`, `EMPRESA_ID`\n- Librerías externas: XLSX (Excel), QRCode\n- Scripts propios: `vacantes-funciones.js`, `general-vacantes.js`, `vacantes.js`\n\n### Observación\nEn la línea 11 hay un texto \"dd\" que parece ser un residuo de debug:\n```blade\ncabecera: `<div class=\"...\">Producto selección dd</div>`\n```\n\n¿Quieres que corrija ese detalle u otra cosa del archivo?"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":4401,"cache_read_input_tokens":25091,"cache_creation":{"ephemeral_5m_input_tokens":4401,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard"}},"requestId":"req_011CXLjyoikpka8FF1XDFe42","type":"assistant","uuid":"14e110fd-05c6-4b75-8364-94fee67424a8","timestamp":"2026-01-21T15:14:52.082Z"}
{"type":"queue-operation","operation":"dequeue","timestamp":"2026-01-21T15:21:25.368Z","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961"}
{"type":"file-history-snapshot","messageId":"a659b8a4-3f5b-48d4-8a1b-95c476624016","snapshot":{"messageId":"a659b8a4-3f5b-48d4-8a1b-95c476624016","trackedFileBackups":{},"timestamp":"2026-01-21T15:21:26.439Z"},"isSnapshotUpdate":false}
{"parentUuid":"77f582d3-0963-482e-bfea-fc2c263464e2","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Read","command":"callback"},"toolUseID":"toolu_013eGKT5QTazr1EJhbhKsP8A","parentToolUseID":"toolu_013eGKT5QTazr1EJhbhKsP8A","uuid":"ba551ac7-c1f4-4b95-b832-036a81e095d4","timestamp":"2026-01-21T15:14:36.769Z"}
{"parentUuid":"14e110fd-05c6-4b75-8364-94fee67424a8","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"type":"text","text":"<ide_selection>The user selected the lines 11 to 11 from c:\\laragon\\www\\psicoalianza-2\\resources\\views\\vacantes\\paginas\\index.blade.php:\nProducto selección dd\n\nThis may or may not be related to the current task.</ide_selection>"},{"type":"text","text":"listo ala alturad el titiulo Producto selección quiero coplocar un tag con tag tonal azul utilizando los componetes este <div class=\"col-auto pe-0\">\n                ${crearTag({\n                    texto: 'Tag',\n                    icono: `<i class=\"bi bi-person\"></i>`,\n                    class: 'tag-tonal-blue',\n                })}\n            </div> que diga Créditos disponibles: 1.800"}]},"uuid":"a659b8a4-3f5b-48d4-8a1b-95c476624016","timestamp":"2026-01-21T15:21:26.436Z"}
{"parentUuid":"a659b8a4-3f5b-48d4-8a1b-95c476624016","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_016ekZP2hYSxCLvuYCwcUNWi","type":"message","role":"assistant","content":[{"type":"text","text":"Entendido. Voy a agregar el tag tonal azul junto al título \"Producto selección\"."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":30360,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":30360,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXLkVujzSNgRtHPXtii8E","type":"assistant","uuid":"1e553c65-6a4d-4ab4-a8b2-32a1046c10c3","timestamp":"2026-01-21T15:21:29.857Z"}
{"parentUuid":"1e553c65-6a4d-4ab4-a8b2-32a1046c10c3","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_016ekZP2hYSxCLvuYCwcUNWi","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_0117eHkHaxubo1dKFi9bzVvy","name":"Edit","input":{"replace_all":false,"file_path":"c:\\laragon\\www\\psicoalianza-2\\resources\\views\\vacantes\\paginas\\index.blade.php","old_string":"        cabecera: `<div class=\"col-auto text-headline-2 text-gray-30 fw-bold\">Producto selección dd</div>`,","new_string":"        cabecera: `\n            <div class=\"col-auto text-headline-2 text-gray-30 fw-bold\">Producto selección</div>\n            <div class=\"col-auto pe-0\">\n                ${crearTag({\n                    texto: 'Créditos disponibles: 1.800',\n                    icono: '<i class=\"bi bi-person\"></i>',\n                    class: 'tag-tonal-blue',\n                })}\n            </div>\n        `,"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":30360,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":30360,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXLkVujzSNgRtHPXtii8E","type":"assistant","uuid":"ec61595b-6dda-4c7c-a0e7-f59641502957","timestamp":"2026-01-21T15:21:32.365Z"}
{"type":"file-history-snapshot","messageId":"ec61595b-6dda-4c7c-a0e7-f59641502957","snapshot":{"messageId":"a659b8a4-3f5b-48d4-8a1b-95c476624016","trackedFileBackups":{"resources\\views\\vacantes\\paginas\\index.blade.php":{"backupFileName":"1ae59264a32091d1@v1","version":1,"backupTime":"2026-01-21T15:21:37.667Z"}},"timestamp":"2026-01-21T15:21:26.439Z"},"isSnapshotUpdate":true}
{"parentUuid":"ec61595b-6dda-4c7c-a0e7-f59641502957","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_0117eHkHaxubo1dKFi9bzVvy","type":"tool_result","content":"The file c:\\laragon\\www\\psicoalianza-2\\resources\\views\\vacantes\\paginas\\index.blade.php has been updated. Here's the result of running `cat -n` on a snippet of the edited file:\n     7→@endsection\n     8→\n     9→@section('contenido')\n    10→    ${contenedorPrincipal({\n    11→        cabecera: `\n    12→            <div class=\"col-auto text-headline-2 text-gray-30 fw-bold\">Producto selección</div>\n    13→            <div class=\"col-auto pe-0\">\n    14→                ${crearTag({\n    15→                    texto: 'Créditos disponibles: 1.800',\n    16→                    icono: '<i class=\"bi bi-person\"></i>',\n    17→                    class: 'tag-tonal-blue',\n    18→                })}\n    19→            </div>\n    20→        `,\n    21→        contenido: `\n    22→            <div class=\"card shadow-none\">\n    23→                <div id=\"cabecera-pagina-sin-archivar\">\n    24→                    @include('componentes.menu-superior', ['rutas' => $rutas_menu->where('slug', 'productos-servicios')->first()?->rutas, 'activo' => 'vacantes'])"}]},"uuid":"74bea072-5dc1-4f13-b0f3-28e53491d061","timestamp":"2026-01-21T15:21:37.711Z","toolUseResult":{"filePath":"c:\\laragon\\www\\psicoalianza-2\\resources\\views\\vacantes\\paginas\\index.blade.php","oldString":"        cabecera: `<div class=\"col-auto text-headline-2 text-gray-30 fw-bold\">Producto selección dd</div>`,","newString":"        cabecera: `\n            <div class=\"col-auto text-headline-2 text-gray-30 fw-bold\">Producto selección</div>\n            <div class=\"col-auto pe-0\">\n                ${crearTag({\n                    texto: 'Créditos disponibles: 1.800',\n                    icono: '<i class=\"bi bi-person\"></i>',\n                    class: 'tag-tonal-blue',\n                })}\n            </div>\n        `,","originalFile":"@extends('layouts.app')\n\n@section('titulo', 'Vacantes')\n\n@section('estilos')\n    <link href=\"{{ asset('css/ofertas-laborales/ofertas-laborales.css') }}\" rel=\"stylesheet\">\n@endsection\n\n@section('contenido')\n    ${contenedorPrincipal({\n        cabecera: `<div class=\"col-auto text-headline-2 text-gray-30 fw-bold\">Producto selección dd</div>`,\n        contenido: `\n            <div class=\"card shadow-none\">\n                <div id=\"cabecera-pagina-sin-archivar\">\n                    @include('componentes.menu-superior', ['rutas' => $rutas_menu->where('slug', 'productos-servicios')->first()?->rutas, 'activo' => 'vacantes'])\n                </div>\n                <div id=\"cabecera-pagina-con-archivar\" class=\"d-none\">\n                    <div class=\"col-auto text-headline-4 text-gray-30 fw-semibold pt-4 px-5\">Vacantes archivadas</div>\n                </div>\n                <div class=\"card-body\">\n                    <div class=\"d-none\" id=\"tabla-sin-contenido\">\n                        <div class=\"w-100 text-center p-10\">\n                            <p class=\"\"><i class=\"bi bi-briefcase text-gray-60\" style=\"font-size: 118px;\"></i></p>\n                            <p class=\"pb-4 text-headline-5 fw-bold text-gray-30\">No tienes vacantes por ahora, publica la primera para comenzar.</p>\n                            <p class=\"pb-4 \">\n                                ${crearBoton({\n                                    clases: 'btn-primary',\n                                    url: '/vacantes/create',\n                                    texto: '<i class=\"bi bi-plus-lg me-2\"></i> Crear vacante'\n                                })}\n                            </p>\n                        </div>\n                    </div>\n                    <div id=\"tabla-contenido\">\n                        ${crearTabla({\n                            id: 'tabla-vacantes',\n                            class: 'table-cards table-borderless',\n                            class_tabla: 'table-cards',\n                            registros_paginas: true,\n                            buscador: {\n                                icono: '<i class=\"bi bi-search input-icono1\"></i>',\n                            },\n                            chips: `\n                                <div class=\"col-12\">\n                                    <div class=\"row align-items-center w-100 mx-0 contenedor-chips my-2\" id=\"contenedor-chips-filtro_vacantes\"></div>\n                                </div>\n                            `,\n                            buscador_datatable: true,\n                            filtro: crearFiltroDropdown({\n                                id: 'filtro_vacantes',\n                                name: 'filtro_vacantes',\n                                type: 'text',\n                                value: '',\n                                class: 'filtro-chips',\n                                input_container_class: 'mb-0',\n                                placeholder: 'Buscar',\n                                buscador_datatable: true,\n                                tabla_id: 'tabla-vacantes',\n                                icono: '<i class=\"bi bi-search input-icono1\"></i>',\n                                icono3: '<i class=\"bi bi-filter input-icono3 pointer icono-filtro-avanzado\" data-bs-toggle=\"dropdown\" aria-expanded=\"false\" data-bs-auto-close=\"outside\"></i>',\n                                dropdown: {\n                                    titulo: 'Filtros avanzados',\n                                    contenido: `\n                                        <div class=\"row mt-4\">\n                                            <div class=\"col-5 pt-2\">Estados</div>\n                                            <div class=\"col-7\">\n                                                ${crearSelect2({\n                                                    opciones: [\n                                                        { nombre: 'Todo', id: '' },\n                                                        @foreach($estados as $item)\n                                                            { nombre: `{{ $item->nombre }}`, id: '{{ $item->id }}' },\n                                                        @endforeach\n                                                    ],\n                                                    opcion_vacia: false,\n                                                    id: 'estados_filtro',\n                                                    class: 'select2-filtro-buscador filtro',\n                                                    input_container_class: 'mb-0',\n                                                    data: [\n                                                        { texto: 'filtro', value: 'Estados'}\n                                                    ]\n                                                })}\n                                            </div>\n                                        </div>\n                                        <div class=\"row mt-4\">\n                                            <div class=\"col-5 pt-2\">Creador</div>\n                                            <div class=\"col-7\">\n                                                ${crearSelect2({\n                                                    opciones: [\n                                                        { nombre: 'Todo', id: '' },\n                                                        @foreach($usuarios as $item)\n                                                            { nombre: `{{ $item->nombres . ' ' . $item->apellidos }}`, id: '{{ $item->id }}' },\n                                                        @endforeach\n                                                    ],\n                                                    opcion_vacia: false,\n                                                    id: 'creador_filtro',\n                                                    class: 'select2-filtro-buscador filtro',\n                                                    input_container_class: 'mb-0',\n                                                    data: [\n                                                        { texto: 'filtro', value: 'Creador'}\n                                                    ]\n                                                })}\n                                            </div>\n                                        </div>\n                                        <div class=\"row mt-5\">\n                                            <div class=\"col-5 pt-2\">Fecha de creación</div>\n                                            <div class=\"col-7\">\n                                                ${crearDatePicker({\n                                                    id: 'fecha_creacion_filtro',\n                                                    class: 'flatpickr-range filtro',\n                                                    input_container_class: 'mb-1',\n                                                    placeholder: 'Desde - hasta',\n                                                    icono: '<i class=\"bi bi-calendar4 input-icono2 text-gray-30 pointer\"></i>',\n                                                    data: [\n                                                        { texto: 'filtro', value: 'Fecha de creación'}\n                                                    ]\n                                                })}\n                                            </div>\n                                        </div>\n                                        <div id=\"fecha_archivado\" class=\"row mt-5\">\n                                            <div class=\"col-5 pt-2\">Fecha de archivado</div>\n                                            <div class=\"col-7\">\n                                                ${crearDatePicker({\n                                                    id: 'fecha_archivado_filtro',\n                                                    class: 'flatpickr-range filtro',\n                                                    input_container_class: 'mb-1',\n                                                    placeholder: 'Desde - hasta',\n                                                    icono: '<i class=\"bi bi-calendar4 input-icono2 text-gray-30 pointer\"></i>',\n                                                    data: [\n                                                        { texto: 'filtro', value: 'Fecha de archivado'}\n                                                    ]\n                                                })}\n                                            </div>\n                                        </div>\n                                        <div class=\"row mt-5\">\n                                            <div class=\"col-5 pt-2\">Aplicante</div>\n                                            <div class=\"col-7\">\n                                                ${crearInput({\n                                                    id: 'aplicante_filtro',\n                                                    class: 'filtro',\n                                                    input_container_class: 'mb-1',\n                                                    placeholder: 'Nombre o cedula',\n                                                    data: [\n                                                        { texto: 'filtro', value: 'Aplicante'}\n                                                    ]\n                                                })}\n                                            </div>\n                                        </div>\n                                        <div class=\"row mt-4\">\n                                            <div class=\"col-5 pt-2\">Etapas</div>\n                                            <div class=\"col-7\">\n                                                ${crearSelect2({\n                                                    opciones: [\n                                                        { nombre: 'Todo', id: '' },\n                                                        @foreach($etapas as $etapa)\n                                                            { nombre: `{{ $etapa->nombre }}`, id: '{{ $etapa->nombre }}' },\n                                                        @endforeach\n                                                    ],\n                                                    opcion_vacia: false,\n                                                    id: 'etapa_filtro',\n                                                    class: 'select2-filtro-buscador filtro',\n                                                    input_container_class: 'mb-0',\n                                                    data: [\n                                                        { texto: 'filtro', value: 'Etapa'}\n                                                    ]\n                                                })}\n                                            </div>\n                                        </div>\n                                    `\n                                }\n                            }),\n                            botones: `\n                            <div class=\"col-12 col-md\">\n                                <div class=\"row justify-content-end\">\n                                    <div class=\"col-12 px-1 col-md-3 my-auto\">\n                                        ${crearSelect2({\n                                            input_container_class: 'my-auto',\n                                            opciones: [\n                                                {id: 'created_at-DESC', nombre: 'Más recientes'},\n                                                {id: 'created_at-ASC', nombre: 'Más antiguos'},\n                                                {id: 'nombre_vacante-ASC', nombre: 'De la  A a la Z'},\n                                                {id: 'nombre_vacante-DESC', nombre: 'De la  Z a la A'},\n                                            ],\n                                            opcion_vacia:false,\n                                            id: 'filtro_mas_recientes',\n                                            disabled: false,\n                                            required: true,\n                                            buscador: true\n                                        })}\n                                    </div>\n                                    <div class=\"col-12 col-md my-auto\">\n                                        <div class=\"row justify-content-end\">\n                                            <div class=\"col-auto px-1 ms-auto\">\n                                                ${crearBoton({\n                                                    id     : 'boton-descargar-tabla-vacantes',\n                                                    clases : 'btn-green-excel clase-desabilitada',\n                                                    tooltip: `${crearTooltip({ placement: `bottom`, content: 'En contrucción', toggle: `popover`,})}`,\n                                                    texto  : '<img class=\"me-3\" src=\"{{ asset('/iconos/excel_icon.svg') }}\"> Exportar todo',\n                                                })}\n                                            </div>\n                                            <div class=\"col-auto\">\n                                                ${crearBoton({\n                                                    id: 'btn-archivo-vacantes',\n                                                    clases: 'btn-tonal-primary',\n                                                    texto: `<i class=\"bi bi-archive me-2\"></i> Archivo de vacantes`\n                                                })}\n                                                <input type=\"hidden\" id=\"vacantes_archivadas\" value=\"1\">\n                                            </div>\n                                            <div class=\"col-auto px-1 pe-3\">\n                                                ${crearBoton({\n                                                    id: 'btn-crear-vacante',\n                                                    clases: 'btn-primary',\n                                                    url: '/vacantes/create',\n                                                    texto: '<i class=\"bi bi-plus-lg me-2\"></i> Crear vacante'\n                                                })}\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                            `,\n                        })}\n                    </div>\n                </div>\n            </div>\n        `\n    })}\n\n    @include('vacantes.paginas.modales.modal-agregar-candidatos')\n    @include('vacantes.paginas.modales.modal-cargar-archivo')\n    @include('vacantes.paginas.modales.modal-solicitar-mas-creditos-ia')\n    @include('vacantes.paginas.modales.modal-consumo-creditos-ia')\n@endsection\n\n@section('scripts')\n    <script type=\"text/javascript\">\n        let activas = {{ $activas }};\n        var empresa_id = {{ $empresa_id }};\n        const EMPRESA_ID = @json(\\Auth::user()->empresa->id);\n    </script>\n\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js\"></script>\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js\"></script>\n\n    <script src=\"{{ asset('js/vacantes/vacantes-funciones.js') }}\" type=\"text/javascript\"></script>\n    <script src=\"{{ asset('js/vacantes/general-vacantes.js') }}\" type=\"text/javascript\"></script>\n    <script src=\"{{ asset('js/vacantes/vacantes.js') }}\" type=\"text/javascript\"></script>\n@endsection\n","structuredPatch":[{"oldStart":8,"oldLines":7,"newStart":8,"newLines":16,"lines":[" "," @section('contenido')","     ${contenedorPrincipal({","-        cabecera: `<div class=\"col-auto text-headline-2 text-gray-30 fw-bold\">Producto selección dd</div>`,","+        cabecera: `","+            <div class=\"col-auto text-headline-2 text-gray-30 fw-bold\">Producto selección</div>","+            <div class=\"col-auto pe-0\">","+                ${crearTag({","+                    texto: 'Créditos disponibles: 1.800',","+                    icono: '<i class=\"bi bi-person\"></i>',","+                    class: 'tag-tonal-blue',","+                })}","+            </div>","+        `,","         contenido: `","             <div class=\"card shadow-none\">","                 <div id=\"cabecera-pagina-sin-archivar\">"]}],"userModified":false,"replaceAll":false},"sourceToolAssistantUUID":"ec61595b-6dda-4c7c-a0e7-f59641502957"}
{"parentUuid":"74bea072-5dc1-4f13-b0f3-28e53491d061","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01NthYm5iELYwhGgREis7Zwk","type":"message","role":"assistant","content":[{"type":"text","text":"Listo. He agregado el tag tonal azul con el texto \"Créditos disponibles: 1.800\" a la derecha del título \"Producto selección\" y también eliminé el \"dd\" que sobraba."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":683,"cache_read_input_tokens":30360,"cache_creation":{"ephemeral_5m_input_tokens":683,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXLkWqv5LQy9ZTVjpd13F","type":"assistant","uuid":"08151091-0e42-4f3f-b060-2554a3eaebb0","timestamp":"2026-01-21T15:21:42.832Z"}
{"type":"queue-operation","operation":"dequeue","timestamp":"2026-01-21T15:22:53.161Z","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961"}
{"type":"file-history-snapshot","messageId":"ebd8adfb-c602-4320-98a4-a83363863784","snapshot":{"messageId":"ebd8adfb-c602-4320-98a4-a83363863784","trackedFileBackups":{"resources\\views\\vacantes\\paginas\\index.blade.php":{"backupFileName":"1ae59264a32091d1@v2","version":2,"backupTime":"2026-01-21T15:22:54.118Z"}},"timestamp":"2026-01-21T15:22:54.107Z"},"isSnapshotUpdate":false}
{"parentUuid":"ec61595b-6dda-4c7c-a0e7-f59641502957","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Edit","command":"callback"},"toolUseID":"toolu_0117eHkHaxubo1dKFi9bzVvy","parentToolUseID":"toolu_0117eHkHaxubo1dKFi9bzVvy","uuid":"179c8460-a8bf-4488-85ce-ec29b70e38d7","timestamp":"2026-01-21T15:21:32.510Z"}
{"parentUuid":"179c8460-a8bf-4488-85ce-ec29b70e38d7","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Edit","command":"callback"},"toolUseID":"toolu_0117eHkHaxubo1dKFi9bzVvy","parentToolUseID":"toolu_0117eHkHaxubo1dKFi9bzVvy","uuid":"dec25544-442b-4ad0-a98b-cedd01a03fba","timestamp":"2026-01-21T15:21:32.510Z"}
{"parentUuid":"74bea072-5dc1-4f13-b0f3-28e53491d061","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"callback"},"parentToolUseID":"toolu_0117eHkHaxubo1dKFi9bzVvy","toolUseID":"toolu_0117eHkHaxubo1dKFi9bzVvy","timestamp":"2026-01-21T15:21:37.712Z","uuid":"5e937002-046f-441d-9b3a-77c23ec349c9"}
{"parentUuid":"08151091-0e42-4f3f-b060-2554a3eaebb0","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"type":"text","text":"<ide_opened_file>The user opened the file c:\\laragon\\www\\psicoalianza-2\\resources\\views\\vacantes\\paginas\\index.blade.php in the IDE. This may or may not be related to the current task.</ide_opened_file>"},{"type":"text","text":"listo hice un pequeño ajuste entonces quiero que se tag quede centrado ala altura del texto o cea que busque el centroe del texto y quy¿uede cebtrado"}]},"uuid":"ebd8adfb-c602-4320-98a4-a83363863784","timestamp":"2026-01-21T15:22:54.105Z"}
{"parentUuid":"ebd8adfb-c602-4320-98a4-a83363863784","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_014efbKmDFC7LH8whZGVEN3C","type":"message","role":"assistant","content":[{"type":"text","text":"Entendido. Voy a agregar la clase `my-auto` al div del tag para que quede centrado verticalmente respecto al título."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":914,"cache_read_input_tokens":31043,"cache_creation":{"ephemeral_5m_input_tokens":914,"ephemeral_1h_input_tokens":0},"output_tokens":8,"service_tier":"standard"}},"requestId":"req_011CXLkcLkobKDVuQTmvK2E6","type":"assistant","uuid":"1f283ed9-0f68-4ebe-aa5c-1bc1a9a9e03c","timestamp":"2026-01-21T15:22:57.472Z"}
{"parentUuid":"1f283ed9-0f68-4ebe-aa5c-1bc1a9a9e03c","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_014efbKmDFC7LH8whZGVEN3C","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01UWZENHALzwYipoP9si2AU7","name":"Read","input":{"file_path":"c:\\laragon\\www\\psicoalianza-2\\resources\\views\\vacantes\\paginas\\index.blade.php","limit":25}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":914,"cache_read_input_tokens":31043,"cache_creation":{"ephemeral_5m_input_tokens":914,"ephemeral_1h_input_tokens":0},"output_tokens":8,"service_tier":"standard"}},"requestId":"req_011CXLkcLkobKDVuQTmvK2E6","type":"assistant","uuid":"591fd28a-7278-435e-95df-c138f6ffca6f","timestamp":"2026-01-21T15:22:58.130Z"}
{"parentUuid":"591fd28a-7278-435e-95df-c138f6ffca6f","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01UWZENHALzwYipoP9si2AU7","type":"tool_result","content":"     1→@extends('layouts.app')\n     2→\n     3→@section('titulo', 'Vacantes')\n     4→\n     5→@section('estilos')\n     6→    <link href=\"{{ asset('css/ofertas-laborales/ofertas-laborales.css') }}\" rel=\"stylesheet\">\n     7→@endsection\n     8→\n     9→@section('contenido')\n    10→    ${contenedorPrincipal({\n    11→        cabecera: `\n    12→            <div class=\"col-auto text-headline-2 text-gray-30 fw-bold\">Producto selección</div>\n    13→            <div class=\"col-auto pe-0\">\n    14→                ${crearTag({\n    15→                    texto: 'Créditos disponibles: 1.800',\n    16→                    class: 'tag-tonal-blue',\n    17→                })}\n    18→            </div>\n    19→        `,\n    20→        contenido: `\n    21→            <div class=\"card shadow-none\">\n    22→                <div id=\"cabecera-pagina-sin-archivar\">\n    23→                    @include('componentes.menu-superior', ['rutas' => $rutas_menu->where('slug', 'productos-servicios')->first()?->rutas, 'activo' => 'vacantes'])\n    24→                </div>\n    25→                <div id=\"cabecera-pagina-con-archivar\" class=\"d-none\">\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"7eb4132a-d986-4acb-8c92-44481027188a","timestamp":"2026-01-21T15:22:59.359Z","toolUseResult":{"type":"text","file":{"filePath":"c:\\laragon\\www\\psicoalianza-2\\resources\\views\\vacantes\\paginas\\index.blade.php","content":"@extends('layouts.app')\n\n@section('titulo', 'Vacantes')\n\n@section('estilos')\n    <link href=\"{{ asset('css/ofertas-laborales/ofertas-laborales.css') }}\" rel=\"stylesheet\">\n@endsection\n\n@section('contenido')\n    ${contenedorPrincipal({\n        cabecera: `\n            <div class=\"col-auto text-headline-2 text-gray-30 fw-bold\">Producto selección</div>\n            <div class=\"col-auto pe-0\">\n                ${crearTag({\n                    texto: 'Créditos disponibles: 1.800',\n                    class: 'tag-tonal-blue',\n                })}\n            </div>\n        `,\n        contenido: `\n            <div class=\"card shadow-none\">\n                <div id=\"cabecera-pagina-sin-archivar\">\n                    @include('componentes.menu-superior', ['rutas' => $rutas_menu->where('slug', 'productos-servicios')->first()?->rutas, 'activo' => 'vacantes'])\n                </div>\n                <div id=\"cabecera-pagina-con-archivar\" class=\"d-none\">","numLines":25,"startLine":1,"totalLines":256}},"sourceToolAssistantUUID":"591fd28a-7278-435e-95df-c138f6ffca6f"}
{"parentUuid":"7eb4132a-d986-4acb-8c92-44481027188a","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01CdKJFS6EhUXLQfXewHVjY9","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01J1EyX48wwCs7NhquFsLizQ","name":"Edit","input":{"replace_all":false,"file_path":"c:\\laragon\\www\\psicoalianza-2\\resources\\views\\vacantes\\paginas\\index.blade.php","old_string":"            <div class=\"col-auto pe-0\">\n                ${crearTag({\n                    texto: 'Créditos disponibles: 1.800',\n                    class: 'tag-tonal-blue',\n                })}\n            </div>","new_string":"            <div class=\"col-auto pe-0 my-auto\">\n                ${crearTag({\n                    texto: 'Créditos disponibles: 1.800',\n                    class: 'tag-tonal-blue',\n                })}\n            </div>"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":611,"cache_read_input_tokens":31957,"cache_creation":{"ephemeral_5m_input_tokens":611,"ephemeral_1h_input_tokens":0},"output_tokens":25,"service_tier":"standard"}},"requestId":"req_011CXLkcjEugafRN9NnMdHeM","type":"assistant","uuid":"8f5e46b8-df98-4df2-bb79-cbe02c5ec763","timestamp":"2026-01-21T15:23:03.790Z"}
{"parentUuid":"8f5e46b8-df98-4df2-bb79-cbe02c5ec763","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01J1EyX48wwCs7NhquFsLizQ","type":"tool_result","content":"The file c:\\laragon\\www\\psicoalianza-2\\resources\\views\\vacantes\\paginas\\index.blade.php has been updated. Here's the result of running `cat -n` on a snippet of the edited file:\n     9→@section('contenido')\n    10→    ${contenedorPrincipal({\n    11→        cabecera: `\n    12→            <div class=\"col-auto text-headline-2 text-gray-30 fw-bold\">Producto selección</div>\n    13→            <div class=\"col-auto pe-0 my-auto\">\n    14→                ${crearTag({\n    15→                    texto: 'Créditos disponibles: 1.800',\n    16→                    class: 'tag-tonal-blue',\n    17→                })}\n    18→            </div>\n    19→        `,\n    20→        contenido: `\n    21→            <div class=\"card shadow-none\">\n    22→                <div id=\"cabecera-pagina-sin-archivar\">"}]},"uuid":"cb8cff3b-39cd-4b7b-b500-128e2e638c8e","timestamp":"2026-01-21T15:23:07.652Z","toolUseResult":{"filePath":"c:\\laragon\\www\\psicoalianza-2\\resources\\views\\vacantes\\paginas\\index.blade.php","oldString":"            <div class=\"col-auto pe-0\">\n                ${crearTag({\n                    texto: 'Créditos disponibles: 1.800',\n                    class: 'tag-tonal-blue',\n                })}\n            </div>","newString":"            <div class=\"col-auto pe-0 my-auto\">\n                ${crearTag({\n                    texto: 'Créditos disponibles: 1.800',\n                    class: 'tag-tonal-blue',\n                })}\n            </div>","originalFile":"@extends('layouts.app')\n\n@section('titulo', 'Vacantes')\n\n@section('estilos')\n    <link href=\"{{ asset('css/ofertas-laborales/ofertas-laborales.css') }}\" rel=\"stylesheet\">\n@endsection\n\n@section('contenido')\n    ${contenedorPrincipal({\n        cabecera: `\n            <div class=\"col-auto text-headline-2 text-gray-30 fw-bold\">Producto selección</div>\n            <div class=\"col-auto pe-0\">\n                ${crearTag({\n                    texto: 'Créditos disponibles: 1.800',\n                    class: 'tag-tonal-blue',\n                })}\n            </div>\n        `,\n        contenido: `\n            <div class=\"card shadow-none\">\n                <div id=\"cabecera-pagina-sin-archivar\">\n                    @include('componentes.menu-superior', ['rutas' => $rutas_menu->where('slug', 'productos-servicios')->first()?->rutas, 'activo' => 'vacantes'])\n                </div>\n                <div id=\"cabecera-pagina-con-archivar\" class=\"d-none\">\n                    <div class=\"col-auto text-headline-4 text-gray-30 fw-semibold pt-4 px-5\">Vacantes archivadas</div>\n                </div>\n                <div class=\"card-body\">\n                    <div class=\"d-none\" id=\"tabla-sin-contenido\">\n                        <div class=\"w-100 text-center p-10\">\n                            <p class=\"\"><i class=\"bi bi-briefcase text-gray-60\" style=\"font-size: 118px;\"></i></p>\n                            <p class=\"pb-4 text-headline-5 fw-bold text-gray-30\">No tienes vacantes por ahora, publica la primera para comenzar.</p>\n                            <p class=\"pb-4 \">\n                                ${crearBoton({\n                                    clases: 'btn-primary',\n                                    url: '/vacantes/create',\n                                    texto: '<i class=\"bi bi-plus-lg me-2\"></i> Crear vacante'\n                                })}\n                            </p>\n                        </div>\n                    </div>\n                    <div id=\"tabla-contenido\">\n                        ${crearTabla({\n                            id: 'tabla-vacantes',\n                            class: 'table-cards table-borderless',\n                            class_tabla: 'table-cards',\n                            registros_paginas: true,\n                            buscador: {\n                                icono: '<i class=\"bi bi-search input-icono1\"></i>',\n                            },\n                            chips: `\n                                <div class=\"col-12\">\n                                    <div class=\"row align-items-center w-100 mx-0 contenedor-chips my-2\" id=\"contenedor-chips-filtro_vacantes\"></div>\n                                </div>\n                            `,\n                            buscador_datatable: true,\n                            filtro: crearFiltroDropdown({\n                                id: 'filtro_vacantes',\n                                name: 'filtro_vacantes',\n                                type: 'text',\n                                value: '',\n                                class: 'filtro-chips',\n                                input_container_class: 'mb-0',\n                                placeholder: 'Buscar',\n                                buscador_datatable: true,\n                                tabla_id: 'tabla-vacantes',\n                                icono: '<i class=\"bi bi-search input-icono1\"></i>',\n                                icono3: '<i class=\"bi bi-filter input-icono3 pointer icono-filtro-avanzado\" data-bs-toggle=\"dropdown\" aria-expanded=\"false\" data-bs-auto-close=\"outside\"></i>',\n                                dropdown: {\n                                    titulo: 'Filtros avanzados',\n                                    contenido: `\n                                        <div class=\"row mt-4\">\n                                            <div class=\"col-5 pt-2\">Estados</div>\n                                            <div class=\"col-7\">\n                                                ${crearSelect2({\n                                                    opciones: [\n                                                        { nombre: 'Todo', id: '' },\n                                                        @foreach($estados as $item)\n                                                            { nombre: `{{ $item->nombre }}`, id: '{{ $item->id }}' },\n                                                        @endforeach\n                                                    ],\n                                                    opcion_vacia: false,\n                                                    id: 'estados_filtro',\n                                                    class: 'select2-filtro-buscador filtro',\n                                                    input_container_class: 'mb-0',\n                                                    data: [\n                                                        { texto: 'filtro', value: 'Estados'}\n                                                    ]\n                                                })}\n                                            </div>\n                                        </div>\n                                        <div class=\"row mt-4\">\n                                            <div class=\"col-5 pt-2\">Creador</div>\n                                            <div class=\"col-7\">\n                                                ${crearSelect2({\n                                                    opciones: [\n                                                        { nombre: 'Todo', id: '' },\n                                                        @foreach($usuarios as $item)\n                                                            { nombre: `{{ $item->nombres . ' ' . $item->apellidos }}`, id: '{{ $item->id }}' },\n                                                        @endforeach\n                                                    ],\n                                                    opcion_vacia: false,\n                                                    id: 'creador_filtro',\n                                                    class: 'select2-filtro-buscador filtro',\n                                                    input_container_class: 'mb-0',\n                                                    data: [\n                                                        { texto: 'filtro', value: 'Creador'}\n                                                    ]\n                                                })}\n                                            </div>\n                                        </div>\n                                        <div class=\"row mt-5\">\n                                            <div class=\"col-5 pt-2\">Fecha de creación</div>\n                                            <div class=\"col-7\">\n                                                ${crearDatePicker({\n                                                    id: 'fecha_creacion_filtro',\n                                                    class: 'flatpickr-range filtro',\n                                                    input_container_class: 'mb-1',\n                                                    placeholder: 'Desde - hasta',\n                                                    icono: '<i class=\"bi bi-calendar4 input-icono2 text-gray-30 pointer\"></i>',\n                                                    data: [\n                                                        { texto: 'filtro', value: 'Fecha de creación'}\n                                                    ]\n                                                })}\n                                            </div>\n                                        </div>\n                                        <div id=\"fecha_archivado\" class=\"row mt-5\">\n                                            <div class=\"col-5 pt-2\">Fecha de archivado</div>\n                                            <div class=\"col-7\">\n                                                ${crearDatePicker({\n                                                    id: 'fecha_archivado_filtro',\n                                                    class: 'flatpickr-range filtro',\n                                                    input_container_class: 'mb-1',\n                                                    placeholder: 'Desde - hasta',\n                                                    icono: '<i class=\"bi bi-calendar4 input-icono2 text-gray-30 pointer\"></i>',\n                                                    data: [\n                                                        { texto: 'filtro', value: 'Fecha de archivado'}\n                                                    ]\n                                                })}\n                                            </div>\n                                        </div>\n                                        <div class=\"row mt-5\">\n                                            <div class=\"col-5 pt-2\">Aplicante</div>\n                                            <div class=\"col-7\">\n                                                ${crearInput({\n                                                    id: 'aplicante_filtro',\n                                                    class: 'filtro',\n                                                    input_container_class: 'mb-1',\n                                                    placeholder: 'Nombre o cedula',\n                                                    data: [\n                                                        { texto: 'filtro', value: 'Aplicante'}\n                                                    ]\n                                                })}\n                                            </div>\n                                        </div>\n                                        <div class=\"row mt-4\">\n                                            <div class=\"col-5 pt-2\">Etapas</div>\n                                            <div class=\"col-7\">\n                                                ${crearSelect2({\n                                                    opciones: [\n                                                        { nombre: 'Todo', id: '' },\n                                                        @foreach($etapas as $etapa)\n                                                            { nombre: `{{ $etapa->nombre }}`, id: '{{ $etapa->nombre }}' },\n                                                        @endforeach\n                                                    ],\n                                                    opcion_vacia: false,\n                                                    id: 'etapa_filtro',\n                                                    class: 'select2-filtro-buscador filtro',\n                                                    input_container_class: 'mb-0',\n                                                    data: [\n                                                        { texto: 'filtro', value: 'Etapa'}\n                                                    ]\n                                                })}\n                                            </div>\n                                        </div>\n                                    `\n                                }\n                            }),\n                            botones: `\n                            <div class=\"col-12 col-md\">\n                                <div class=\"row justify-content-end\">\n                                    <div class=\"col-12 px-1 col-md-3 my-auto\">\n                                        ${crearSelect2({\n                                            input_container_class: 'my-auto',\n                                            opciones: [\n                                                {id: 'created_at-DESC', nombre: 'Más recientes'},\n                                                {id: 'created_at-ASC', nombre: 'Más antiguos'},\n                                                {id: 'nombre_vacante-ASC', nombre: 'De la  A a la Z'},\n                                                {id: 'nombre_vacante-DESC', nombre: 'De la  Z a la A'},\n                                            ],\n                                            opcion_vacia:false,\n                                            id: 'filtro_mas_recientes',\n                                            disabled: false,\n                                            required: true,\n                                            buscador: true\n                                        })}\n                                    </div>\n                                    <div class=\"col-12 col-md my-auto\">\n                                        <div class=\"row justify-content-end\">\n                                            <div class=\"col-auto px-1 ms-auto\">\n                                                ${crearBoton({\n                                                    id     : 'boton-descargar-tabla-vacantes',\n                                                    clases : 'btn-green-excel clase-desabilitada',\n                                                    tooltip: `${crearTooltip({ placement: `bottom`, content: 'En contrucción', toggle: `popover`,})}`,\n                                                    texto  : '<img class=\"me-3\" src=\"{{ asset('/iconos/excel_icon.svg') }}\"> Exportar todo',\n                                                })}\n                                            </div>\n                                            <div class=\"col-auto\">\n                                                ${crearBoton({\n                                                    id: 'btn-archivo-vacantes',\n                                                    clases: 'btn-tonal-primary',\n                                                    texto: `<i class=\"bi bi-archive me-2\"></i> Archivo de vacantes`\n                                                })}\n                                                <input type=\"hidden\" id=\"vacantes_archivadas\" value=\"1\">\n                                            </div>\n                                            <div class=\"col-auto px-1 pe-3\">\n                                                ${crearBoton({\n                                                    id: 'btn-crear-vacante',\n                                                    clases: 'btn-primary',\n                                                    url: '/vacantes/create',\n                                                    texto: '<i class=\"bi bi-plus-lg me-2\"></i> Crear vacante'\n                                                })}\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                            `,\n                        })}\n                    </div>\n                </div>\n            </div>\n        `\n    })}\n\n    @include('vacantes.paginas.modales.modal-agregar-candidatos')\n    @include('vacantes.paginas.modales.modal-cargar-archivo')\n    @include('vacantes.paginas.modales.modal-solicitar-mas-creditos-ia')\n    @include('vacantes.paginas.modales.modal-consumo-creditos-ia')\n@endsection\n\n@section('scripts')\n    <script type=\"text/javascript\">\n        let activas = {{ $activas }};\n        var empresa_id = {{ $empresa_id }};\n        const EMPRESA_ID = @json(\\Auth::user()->empresa->id);\n    </script>\n\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js\"></script>\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js\"></script>\n\n    <script src=\"{{ asset('js/vacantes/vacantes-funciones.js') }}\" type=\"text/javascript\"></script>\n    <script src=\"{{ asset('js/vacantes/general-vacantes.js') }}\" type=\"text/javascript\"></script>\n    <script src=\"{{ asset('js/vacantes/vacantes.js') }}\" type=\"text/javascript\"></script>\n@endsection\n","structuredPatch":[{"oldStart":10,"oldLines":7,"newStart":10,"newLines":7,"lines":["     ${contenedorPrincipal({","         cabecera: `","             <div class=\"col-auto text-headline-2 text-gray-30 fw-bold\">Producto selección</div>","-            <div class=\"col-auto pe-0\">","+            <div class=\"col-auto pe-0 my-auto\">","                 ${crearTag({","                     texto: 'Créditos disponibles: 1.800',","                     class: 'tag-tonal-blue',"]}],"userModified":false,"replaceAll":false},"sourceToolAssistantUUID":"8f5e46b8-df98-4df2-bb79-cbe02c5ec763"}
{"parentUuid":"cb8cff3b-39cd-4b7b-b500-128e2e638c8e","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01KoitoLeS2ubci64avWHTgm","type":"message","role":"assistant","content":[{"type":"text","text":"Listo. Agregué la clase `my-auto` al div del tag para que quede centrado verticalmente respecto al título \"Producto selección\"."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":532,"cache_read_input_tokens":32568,"cache_creation":{"ephemeral_5m_input_tokens":532,"ephemeral_1h_input_tokens":0},"output_tokens":5,"service_tier":"standard"}},"requestId":"req_011CXLkdTpVQwSwoSk5setF3","type":"assistant","uuid":"52c17c46-ebe6-4917-82a1-f01cb54f03b7","timestamp":"2026-01-21T15:23:11.983Z"}
{"type":"queue-operation","operation":"dequeue","timestamp":"2026-01-21T15:23:38.281Z","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961"}
{"type":"file-history-snapshot","messageId":"83f225d8-c627-4520-8114-29de145691dc","snapshot":{"messageId":"83f225d8-c627-4520-8114-29de145691dc","trackedFileBackups":{"resources\\views\\vacantes\\paginas\\index.blade.php":{"backupFileName":"1ae59264a32091d1@v3","version":3,"backupTime":"2026-01-21T15:23:38.501Z"}},"timestamp":"2026-01-21T15:23:38.488Z"},"isSnapshotUpdate":false}
{"parentUuid":"591fd28a-7278-435e-95df-c138f6ffca6f","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Read","command":"callback"},"toolUseID":"toolu_01UWZENHALzwYipoP9si2AU7","parentToolUseID":"toolu_01UWZENHALzwYipoP9si2AU7","uuid":"2170a8cf-4b02-4dea-afdd-023c2b18ee00","timestamp":"2026-01-21T15:22:58.283Z"}
{"parentUuid":"8f5e46b8-df98-4df2-bb79-cbe02c5ec763","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Edit","command":"callback"},"toolUseID":"toolu_01J1EyX48wwCs7NhquFsLizQ","parentToolUseID":"toolu_01J1EyX48wwCs7NhquFsLizQ","uuid":"c65f5102-208f-4310-b5d4-8e1541cd47f8","timestamp":"2026-01-21T15:23:03.936Z"}
{"parentUuid":"c65f5102-208f-4310-b5d4-8e1541cd47f8","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Edit","command":"callback"},"toolUseID":"toolu_01J1EyX48wwCs7NhquFsLizQ","parentToolUseID":"toolu_01J1EyX48wwCs7NhquFsLizQ","uuid":"462f5a74-94ba-4a9b-9806-8d7dc834c1be","timestamp":"2026-01-21T15:23:03.936Z"}
{"parentUuid":"cb8cff3b-39cd-4b7b-b500-128e2e638c8e","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"callback"},"parentToolUseID":"toolu_01J1EyX48wwCs7NhquFsLizQ","toolUseID":"toolu_01J1EyX48wwCs7NhquFsLizQ","timestamp":"2026-01-21T15:23:07.653Z","uuid":"2351a900-d9d7-4cb7-8115-b6da7b50ac03"}
{"parentUuid":"52c17c46-ebe6-4917-82a1-f01cb54f03b7","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"type":"text","text":"listo quiro que el espacio que hay entre el tecto y el tag sea un poco mendor"}]},"uuid":"83f225d8-c627-4520-8114-29de145691dc","timestamp":"2026-01-21T15:23:38.487Z"}
{"parentUuid":"83f225d8-c627-4520-8114-29de145691dc","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_012DXyW2YGwkzE2J7aEQwLg2","type":"message","role":"assistant","content":[{"type":"text","text":"Voy a agregar la clase `ps-2` al div del tag para reducir el espacio entre el título y el tag."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":917,"cache_read_input_tokens":33100,"cache_creation":{"ephemeral_5m_input_tokens":917,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXLkfcXv732A9NkpwQzyR","type":"assistant","uuid":"dd8b12e4-cda1-46c0-8b2a-f83affebce15","timestamp":"2026-01-21T15:23:41.361Z"}
{"parentUuid":"dd8b12e4-cda1-46c0-8b2a-f83affebce15","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_012DXyW2YGwkzE2J7aEQwLg2","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_012LbzNqa17GYY2n6htJwoa2","name":"Edit","input":{"replace_all":false,"file_path":"c:\\laragon\\www\\psicoalianza-2\\resources\\views\\vacantes\\paginas\\index.blade.php","old_string":"<div class=\"col-auto pe-0 my-auto\">","new_string":"<div class=\"col-auto ps-2 pe-0 my-auto\">"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":917,"cache_read_input_tokens":33100,"cache_creation":{"ephemeral_5m_input_tokens":917,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXLkfcXv732A9NkpwQzyR","type":"assistant","uuid":"fa400950-5048-430e-8643-2a937c870630","timestamp":"2026-01-21T15:23:42.415Z"}
{"parentUuid":"fa400950-5048-430e-8643-2a937c870630","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_012LbzNqa17GYY2n6htJwoa2","type":"tool_result","content":"The file c:\\laragon\\www\\psicoalianza-2\\resources\\views\\vacantes\\paginas\\index.blade.php has been updated. Here's the result of running `cat -n` on a snippet of the edited file:\n     9→@section('contenido')\n    10→    ${contenedorPrincipal({\n    11→        cabecera: `\n    12→            <div class=\"col-auto text-headline-2 text-gray-30 fw-bold\">Producto selección</div>\n    13→            <div class=\"col-auto ps-2 pe-0 my-auto\">\n    14→                ${crearTag({\n    15→                    texto: 'Créditos disponibles: 1.800',\n    16→                    class: 'tag-tonal-blue',\n    17→                })}"}]},"uuid":"085bf073-5267-4f9e-95a8-a0fcde175ed4","timestamp":"2026-01-21T15:23:46.540Z","toolUseResult":{"filePath":"c:\\laragon\\www\\psicoalianza-2\\resources\\views\\vacantes\\paginas\\index.blade.php","oldString":"<div class=\"col-auto pe-0 my-auto\">","newString":"<div class=\"col-auto ps-2 pe-0 my-auto\">","originalFile":"@extends('layouts.app')\n\n@section('titulo', 'Vacantes')\n\n@section('estilos')\n    <link href=\"{{ asset('css/ofertas-laborales/ofertas-laborales.css') }}\" rel=\"stylesheet\">\n@endsection\n\n@section('contenido')\n    ${contenedorPrincipal({\n        cabecera: `\n            <div class=\"col-auto text-headline-2 text-gray-30 fw-bold\">Producto selección</div>\n            <div class=\"col-auto pe-0 my-auto\">\n                ${crearTag({\n                    texto: 'Créditos disponibles: 1.800',\n                    class: 'tag-tonal-blue',\n                })}\n            </div>\n        `,\n        contenido: `\n            <div class=\"card shadow-none\">\n                <div id=\"cabecera-pagina-sin-archivar\">\n                    @include('componentes.menu-superior', ['rutas' => $rutas_menu->where('slug', 'productos-servicios')->first()?->rutas, 'activo' => 'vacantes'])\n                </div>\n                <div id=\"cabecera-pagina-con-archivar\" class=\"d-none\">\n                    <div class=\"col-auto text-headline-4 text-gray-30 fw-semibold pt-4 px-5\">Vacantes archivadas</div>\n                </div>\n                <div class=\"card-body\">\n                    <div class=\"d-none\" id=\"tabla-sin-contenido\">\n                        <div class=\"w-100 text-center p-10\">\n                            <p class=\"\"><i class=\"bi bi-briefcase text-gray-60\" style=\"font-size: 118px;\"></i></p>\n                            <p class=\"pb-4 text-headline-5 fw-bold text-gray-30\">No tienes vacantes por ahora, publica la primera para comenzar.</p>\n                            <p class=\"pb-4 \">\n                                ${crearBoton({\n                                    clases: 'btn-primary',\n                                    url: '/vacantes/create',\n                                    texto: '<i class=\"bi bi-plus-lg me-2\"></i> Crear vacante'\n                                })}\n                            </p>\n                        </div>\n                    </div>\n                    <div id=\"tabla-contenido\">\n                        ${crearTabla({\n                            id: 'tabla-vacantes',\n                            class: 'table-cards table-borderless',\n                            class_tabla: 'table-cards',\n                            registros_paginas: true,\n                            buscador: {\n                                icono: '<i class=\"bi bi-search input-icono1\"></i>',\n                            },\n                            chips: `\n                                <div class=\"col-12\">\n                                    <div class=\"row align-items-center w-100 mx-0 contenedor-chips my-2\" id=\"contenedor-chips-filtro_vacantes\"></div>\n                                </div>\n                            `,\n                            buscador_datatable: true,\n                            filtro: crearFiltroDropdown({\n                                id: 'filtro_vacantes',\n                                name: 'filtro_vacantes',\n                                type: 'text',\n                                value: '',\n                                class: 'filtro-chips',\n                                input_container_class: 'mb-0',\n                                placeholder: 'Buscar',\n                                buscador_datatable: true,\n                                tabla_id: 'tabla-vacantes',\n                                icono: '<i class=\"bi bi-search input-icono1\"></i>',\n                                icono3: '<i class=\"bi bi-filter input-icono3 pointer icono-filtro-avanzado\" data-bs-toggle=\"dropdown\" aria-expanded=\"false\" data-bs-auto-close=\"outside\"></i>',\n                                dropdown: {\n                                    titulo: 'Filtros avanzados',\n                                    contenido: `\n                                        <div class=\"row mt-4\">\n                                            <div class=\"col-5 pt-2\">Estados</div>\n                                            <div class=\"col-7\">\n                                                ${crearSelect2({\n                                                    opciones: [\n                                                        { nombre: 'Todo', id: '' },\n                                                        @foreach($estados as $item)\n                                                            { nombre: `{{ $item->nombre }}`, id: '{{ $item->id }}' },\n                                                        @endforeach\n                                                    ],\n                                                    opcion_vacia: false,\n                                                    id: 'estados_filtro',\n                                                    class: 'select2-filtro-buscador filtro',\n                                                    input_container_class: 'mb-0',\n                                                    data: [\n                                                        { texto: 'filtro', value: 'Estados'}\n                                                    ]\n                                                })}\n                                            </div>\n                                        </div>\n                                        <div class=\"row mt-4\">\n                                            <div class=\"col-5 pt-2\">Creador</div>\n                                            <div class=\"col-7\">\n                                                ${crearSelect2({\n                                                    opciones: [\n                                                        { nombre: 'Todo', id: '' },\n                                                        @foreach($usuarios as $item)\n                                                            { nombre: `{{ $item->nombres . ' ' . $item->apellidos }}`, id: '{{ $item->id }}' },\n                                                        @endforeach\n                                                    ],\n                                                    opcion_vacia: false,\n                                                    id: 'creador_filtro',\n                                                    class: 'select2-filtro-buscador filtro',\n                                                    input_container_class: 'mb-0',\n                                                    data: [\n                                                        { texto: 'filtro', value: 'Creador'}\n                                                    ]\n                                                })}\n                                            </div>\n                                        </div>\n                                        <div class=\"row mt-5\">\n                                            <div class=\"col-5 pt-2\">Fecha de creación</div>\n                                            <div class=\"col-7\">\n                                                ${crearDatePicker({\n                                                    id: 'fecha_creacion_filtro',\n                                                    class: 'flatpickr-range filtro',\n                                                    input_container_class: 'mb-1',\n                                                    placeholder: 'Desde - hasta',\n                                                    icono: '<i class=\"bi bi-calendar4 input-icono2 text-gray-30 pointer\"></i>',\n                                                    data: [\n                                                        { texto: 'filtro', value: 'Fecha de creación'}\n                                                    ]\n                                                })}\n                                            </div>\n                                        </div>\n                                        <div id=\"fecha_archivado\" class=\"row mt-5\">\n                                            <div class=\"col-5 pt-2\">Fecha de archivado</div>\n                                            <div class=\"col-7\">\n                                                ${crearDatePicker({\n                                                    id: 'fecha_archivado_filtro',\n                                                    class: 'flatpickr-range filtro',\n                                                    input_container_class: 'mb-1',\n                                                    placeholder: 'Desde - hasta',\n                                                    icono: '<i class=\"bi bi-calendar4 input-icono2 text-gray-30 pointer\"></i>',\n                                                    data: [\n                                                        { texto: 'filtro', value: 'Fecha de archivado'}\n                                                    ]\n                                                })}\n                                            </div>\n                                        </div>\n                                        <div class=\"row mt-5\">\n                                            <div class=\"col-5 pt-2\">Aplicante</div>\n                                            <div class=\"col-7\">\n                                                ${crearInput({\n                                                    id: 'aplicante_filtro',\n                                                    class: 'filtro',\n                                                    input_container_class: 'mb-1',\n                                                    placeholder: 'Nombre o cedula',\n                                                    data: [\n                                                        { texto: 'filtro', value: 'Aplicante'}\n                                                    ]\n                                                })}\n                                            </div>\n                                        </div>\n                                        <div class=\"row mt-4\">\n                                            <div class=\"col-5 pt-2\">Etapas</div>\n                                            <div class=\"col-7\">\n                                                ${crearSelect2({\n                                                    opciones: [\n                                                        { nombre: 'Todo', id: '' },\n                                                        @foreach($etapas as $etapa)\n                                                            { nombre: `{{ $etapa->nombre }}`, id: '{{ $etapa->nombre }}' },\n                                                        @endforeach\n                                                    ],\n                                                    opcion_vacia: false,\n                                                    id: 'etapa_filtro',\n                                                    class: 'select2-filtro-buscador filtro',\n                                                    input_container_class: 'mb-0',\n                                                    data: [\n                                                        { texto: 'filtro', value: 'Etapa'}\n                                                    ]\n                                                })}\n                                            </div>\n                                        </div>\n                                    `\n                                }\n                            }),\n                            botones: `\n                            <div class=\"col-12 col-md\">\n                                <div class=\"row justify-content-end\">\n                                    <div class=\"col-12 px-1 col-md-3 my-auto\">\n                                        ${crearSelect2({\n                                            input_container_class: 'my-auto',\n                                            opciones: [\n                                                {id: 'created_at-DESC', nombre: 'Más recientes'},\n                                                {id: 'created_at-ASC', nombre: 'Más antiguos'},\n                                                {id: 'nombre_vacante-ASC', nombre: 'De la  A a la Z'},\n                                                {id: 'nombre_vacante-DESC', nombre: 'De la  Z a la A'},\n                                            ],\n                                            opcion_vacia:false,\n                                            id: 'filtro_mas_recientes',\n                                            disabled: false,\n                                            required: true,\n                                            buscador: true\n                                        })}\n                                    </div>\n                                    <div class=\"col-12 col-md my-auto\">\n                                        <div class=\"row justify-content-end\">\n                                            <div class=\"col-auto px-1 ms-auto\">\n                                                ${crearBoton({\n                                                    id     : 'boton-descargar-tabla-vacantes',\n                                                    clases : 'btn-green-excel clase-desabilitada',\n                                                    tooltip: `${crearTooltip({ placement: `bottom`, content: 'En contrucción', toggle: `popover`,})}`,\n                                                    texto  : '<img class=\"me-3\" src=\"{{ asset('/iconos/excel_icon.svg') }}\"> Exportar todo',\n                                                })}\n                                            </div>\n                                            <div class=\"col-auto\">\n                                                ${crearBoton({\n                                                    id: 'btn-archivo-vacantes',\n                                                    clases: 'btn-tonal-primary',\n                                                    texto: `<i class=\"bi bi-archive me-2\"></i> Archivo de vacantes`\n                                                })}\n                                                <input type=\"hidden\" id=\"vacantes_archivadas\" value=\"1\">\n                                            </div>\n                                            <div class=\"col-auto px-1 pe-3\">\n                                                ${crearBoton({\n                                                    id: 'btn-crear-vacante',\n                                                    clases: 'btn-primary',\n                                                    url: '/vacantes/create',\n                                                    texto: '<i class=\"bi bi-plus-lg me-2\"></i> Crear vacante'\n                                                })}\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                            `,\n                        })}\n                    </div>\n                </div>\n            </div>\n        `\n    })}\n\n    @include('vacantes.paginas.modales.modal-agregar-candidatos')\n    @include('vacantes.paginas.modales.modal-cargar-archivo')\n    @include('vacantes.paginas.modales.modal-solicitar-mas-creditos-ia')\n    @include('vacantes.paginas.modales.modal-consumo-creditos-ia')\n@endsection\n\n@section('scripts')\n    <script type=\"text/javascript\">\n        let activas = {{ $activas }};\n        var empresa_id = {{ $empresa_id }};\n        const EMPRESA_ID = @json(\\Auth::user()->empresa->id);\n    </script>\n\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js\"></script>\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js\"></script>\n\n    <script src=\"{{ asset('js/vacantes/vacantes-funciones.js') }}\" type=\"text/javascript\"></script>\n    <script src=\"{{ asset('js/vacantes/general-vacantes.js') }}\" type=\"text/javascript\"></script>\n    <script src=\"{{ asset('js/vacantes/vacantes.js') }}\" type=\"text/javascript\"></script>\n@endsection\n","structuredPatch":[{"oldStart":10,"oldLines":7,"newStart":10,"newLines":7,"lines":["     ${contenedorPrincipal({","         cabecera: `","             <div class=\"col-auto text-headline-2 text-gray-30 fw-bold\">Producto selección</div>","-            <div class=\"col-auto pe-0 my-auto\">","+            <div class=\"col-auto ps-2 pe-0 my-auto\">","                 ${crearTag({","                     texto: 'Créditos disponibles: 1.800',","                     class: 'tag-tonal-blue',"]}],"userModified":false,"replaceAll":false},"sourceToolAssistantUUID":"fa400950-5048-430e-8643-2a937c870630"}
{"parentUuid":"085bf073-5267-4f9e-95a8-a0fcde175ed4","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01MrfURAbRYcBdMX4rNji91L","type":"message","role":"assistant","content":[{"type":"text","text":"Listo. Cambié el padding izquierdo a `ps-2` para que el espacio entre el título y el tag sea menor. Si necesitas que sea aún más pequeño, puedo usar `ps-1`."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":415,"cache_read_input_tokens":34017,"cache_creation":{"ephemeral_5m_input_tokens":415,"ephemeral_1h_input_tokens":0},"output_tokens":6,"service_tier":"standard"}},"requestId":"req_011CXLkgLqNxzj56HetTxusJ","type":"assistant","uuid":"16a96602-a83f-4836-8d6f-d523d0f442ce","timestamp":"2026-01-21T15:23:51.640Z"}
{"type":"queue-operation","operation":"dequeue","timestamp":"2026-01-21T15:51:57.047Z","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961"}
{"type":"file-history-snapshot","messageId":"fa0b47ef-c747-4784-acba-90f74b050cec","snapshot":{"messageId":"fa0b47ef-c747-4784-acba-90f74b050cec","trackedFileBackups":{"resources\\views\\vacantes\\paginas\\index.blade.php":{"backupFileName":"1ae59264a32091d1@v4","version":4,"backupTime":"2026-01-21T15:51:58.466Z"}},"timestamp":"2026-01-21T15:51:58.451Z"},"isSnapshotUpdate":false}
{"parentUuid":"fa400950-5048-430e-8643-2a937c870630","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Edit","command":"callback"},"toolUseID":"toolu_012LbzNqa17GYY2n6htJwoa2","parentToolUseID":"toolu_012LbzNqa17GYY2n6htJwoa2","uuid":"84b47fff-4ef2-4644-add0-2be7a56eaae0","timestamp":"2026-01-21T15:23:43.423Z"}
{"parentUuid":"84b47fff-4ef2-4644-add0-2be7a56eaae0","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Edit","command":"callback"},"toolUseID":"toolu_012LbzNqa17GYY2n6htJwoa2","parentToolUseID":"toolu_012LbzNqa17GYY2n6htJwoa2","uuid":"e5932f96-28b9-48a4-a929-e32818702c3d","timestamp":"2026-01-21T15:23:43.423Z"}
{"parentUuid":"085bf073-5267-4f9e-95a8-a0fcde175ed4","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"callback"},"parentToolUseID":"toolu_012LbzNqa17GYY2n6htJwoa2","toolUseID":"toolu_012LbzNqa17GYY2n6htJwoa2","timestamp":"2026-01-21T15:23:46.541Z","uuid":"3d6f04b8-d7a8-453a-8eeb-a8a6af977105"}
{"parentUuid":"16a96602-a83f-4836-8d6f-d523d0f442ce","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"type":"text","text":"<ide_opened_file>The user opened the file c:\\laragon\\www\\psicoalianza-2\\resources\\views\\vacantes\\paginas\\index.blade.php in the IDE. This may or may not be related to the current task.</ide_opened_file>"},{"type":"text","text":"listo perfecto entonves toca crear una funcion en el js pero de globales js que es para obtener los creditos dsiponibes de la empresa y que s ejecute apenas cargue la pagina y este s el endpoint api/empresas/2/creditos y eso debulbe esto {\n  \"data\": {\n    \"empresa_id\": 2,\n    \"empresa_plan_id\": 2,\n    \"creditos_plan\": 300,\n    \"creditos_disponibles\": 300,\n    \"plan_credito\": {\n      \"id\": 3,\n      \"nombre\": \"Plan 300\",\n      \"creditos\": 300,\n      \"precio\": \"300.00\"\n    }\n  }\n} entonces quiero que el conteo de creditos disponibles sea el campo de creditos_disponibles y que si le queda menos del 20% del total disponible que el tagse amarillo asi ${crearTag({\n                    texto: 'Tag',\n                    icono: `<i class=\"bi bi-person\"></i>`,\n                    class: 'tag-filled-yellow',\n                })} y si no tiene que el tag sea ${crearTag({\n                    texto: 'Tag',\n                    icono: `<i class=\"bi bi-person\"></i>`,\n                    class: 'tag-tonal-gray',\n                })} que diga sin creditos"}]},"uuid":"fa0b47ef-c747-4784-acba-90f74b050cec","timestamp":"2026-01-21T15:51:58.449Z"}
{"parentUuid":"fa0b47ef-c747-4784-acba-90f74b050cec","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01M4tVpePBUoosrMXqJzzQss","type":"message","role":"assistant","content":[{"type":"text","text":"Entendido. Primero voy a revisar el archivo `globales.js` para agregar la función."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":35641,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":35641,"ephemeral_1h_input_tokens":0},"output_tokens":7,"service_tier":"standard"}},"requestId":"req_011CXLnpxL2S8hDCyMwZ1yrR","type":"assistant","uuid":"7f86bda3-622c-489e-85ce-c64cf4a7ee2d","timestamp":"2026-01-21T15:52:02.099Z"}
{"parentUuid":"7f86bda3-622c-489e-85ce-c64cf4a7ee2d","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01M4tVpePBUoosrMXqJzzQss","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01LCXm7yUjgBZpAsVCHhTyzq","name":"Glob","input":{"pattern":"**/globales.js"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":35641,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":35641,"ephemeral_1h_input_tokens":0},"output_tokens":7,"service_tier":"standard"}},"requestId":"req_011CXLnpxL2S8hDCyMwZ1yrR","type":"assistant","uuid":"eb962608-34b7-40ca-92f6-21df87ab3441","timestamp":"2026-01-21T15:52:02.414Z"}
{"parentUuid":"eb962608-34b7-40ca-92f6-21df87ab3441","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01LCXm7yUjgBZpAsVCHhTyzq","type":"tool_result","content":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\ajustes\\general\\globales.js\nc:\\laragon\\www\\psicoalianza-2\\public\\js\\psicoacademy\\globales.js\nc:\\laragon\\www\\psicoalianza-2\\public\\js\\globales.js"}]},"uuid":"23deccaf-0650-4c23-b3ad-a255723299b5","timestamp":"2026-01-21T15:52:06.971Z","toolUseResult":{"filenames":["c:\\laragon\\www\\psicoalianza-2\\public\\js\\ajustes\\general\\globales.js","c:\\laragon\\www\\psicoalianza-2\\public\\js\\psicoacademy\\globales.js","c:\\laragon\\www\\psicoalianza-2\\public\\js\\globales.js"],"durationMs":2929,"numFiles":3,"truncated":false},"sourceToolAssistantUUID":"eb962608-34b7-40ca-92f6-21df87ab3441"}
{"parentUuid":"23deccaf-0650-4c23-b3ad-a255723299b5","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_019UMh8SaKWe2k8dgsQy7G1z","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_015Wf2yuSUTCHmnu1LTFYn2i","name":"Read","input":{"file_path":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\globales.js"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":182,"cache_read_input_tokens":35641,"cache_creation":{"ephemeral_5m_input_tokens":182,"ephemeral_1h_input_tokens":0},"output_tokens":25,"service_tier":"standard"}},"requestId":"req_011CXLnqZZLRsX6hKSLd35PE","type":"assistant","uuid":"894cca4e-b688-41d1-8443-4adde9b64dbc","timestamp":"2026-01-21T15:52:10.416Z"}
{"parentUuid":"894cca4e-b688-41d1-8443-4adde9b64dbc","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_015Wf2yuSUTCHmnu1LTFYn2i","type":"tool_result","content":"     1→// Mensajes en español para el plugin Select2\n     2→const mensajes_select2 = {\n     3→    'noResults'              : () => { return 'No hay resultados para la búsqueda.'; },\n     4→    'searching'              : () => { return 'Buscando...'; },\n     5→    'Loading'                : () => { return 'Cargando...'; },\n     6→    'loadingMore'            : () => { return 'Cargando más resultados...'; },\n     7→    'dropdownFooter'         : (texto) => { return `Mostrando ${texto} resultados`; },\n     8→    'emptyOptions'           : () => { return 'No hay opciones disponibles.'; },\n     9→    'appendItems'            : (items) => { return `Agregando ${items.length} elementos.`; },\n    10→    'maximumSelectionReached': () => { return 'Se ha alcanzado el número máximo de selecciones.'; },\n    11→    'selectOnClose'          : () => { return 'Seleccione una opción al cerrar el menú.'; },\n    12→    'escapeKeyUp'            : () => { return 'Presione \\'Escape\\' para cerrar el menú.'; },\n    13→    'errorLoading'           : () => { return 'Error al cargar datos. Inténtalo de nuevo más tarde.'; },\n    14→    'inputTooShort'          : (elemento) => { return `Ingresa al menos ${elemento.minimum} caracteres para iniciar una búsqueda.`; },\n    15→    'noMatches'              : () => { return 'No se encontraron coincidencias para tu búsqueda.'; },\n    16→    'allowClear'             : () => { return 'Borrar selección'; },\n    17→    'SelectionTooLong'       : (conteo, maximo) => { return `Solo puedes seleccionar ${maximo} opciones.`; },\n    18→    'loadMore'               : () => { return 'Cargando más resultados...'; },\n    19→    'removing'               : (seleccion) => { return 'Eliminando...'; },\n    20→    'matches'                : (coincidencias, total) => {\n    21→        if (coincidencias === 0) {\n    22→            return 'No hay coincidencias.';\n    23→        } else if (coincidencias === 1) {\n    24→            return 'Se encontró 1 coincidencia.';\n    25→        } else {\n    26→            return `Se encontraron ${coincidencias} coincidencias entre ${total}.`;\n    27→        }\n    28→    }\n    29→};\n    30→\n    31→// audios\n    32→var audio_notificacion = new Audio('/audios/notificacion.mp3');\n    33→\n    34→let mostro_modal_creditos_ia = false;\n    35→let funcion_ejecucion_ia = null;\n    36→let modals_abiertos_ia = null;\n    37→\n    38→/**\n    39→ * Mostrar modal de créditos IA\n    40→ * \n    41→ * @return void\n    42→ * @author José Manuel Jiménez\n    43→ */\n    44→function mostrarModalCreditosIA(servicio_ia_id) {\n    45→    $.ajax({\n    46→        url: `/api/empresas/${$('#empresa_sesion_id').val()}/creditos`,\n    47→        method: 'GET',\n    48→        dataType: 'json',\n    49→        success: function(respuesta_empresa) {\n    50→            if (respuesta_empresa?.data?.creditos_disponibles > 0) {\n    51→                $.ajax({\n    52→                    url: `/api/servicios-ia/${servicio_ia_id}/creditos`,\n    53→                    method: 'GET',\n    54→                    dataType: 'json',\n    55→                    success: function(respuesta) {\n    56→                        if (respuesta?.data?.consume_creditos && respuesta?.data?.consume_creditos <= respuesta_empresa.data.creditos_disponibles) {\n    57→                            $('#cantidad-creditos-descontar-modal').text(respuesta.data.consume_creditos);\n    58→                            $('#modal-consumo-creditos-ia').modal('show');\n    59→                            mostro_modal_creditos_ia = true;\n    60→                            modals_abiertos_ia = $('.modal.show').not('#modal-consumo-creditos-ia').not('#modal-generando-ia');\n    61→                            $(modals_abiertos_ia).addClass('d-none');\n    62→                        } else {\n    63→                            mostrarToastSolicitarCreditosIA();\n    64→                        }\n    65→                    }\n    66→                });\n    67→            } else {\n    68→                mostrarToastSolicitarCreditosIA();\n    69→            }\n    70→        }\n    71→    });\n    72→}\n    73→\n    74→/**\n    75→ * Mostrar toast para solicitar créditos IA\n    76→ * \n    77→ * @return void\n    78→ * @author José Manuel Jiménez\n    79→ */\n    80→function mostrarToastSolicitarCreditosIA() {\n    81→    $.ajax({\n    82→        url: `/empresas/${$('#empresa_sesion_id').val()}`,\n    83→        method: 'GET',\n    84→        dataType: 'json',\n    85→        success: function(respuesta) {\n    86→            let adicional_toast = '';\n    87→            if (respuesta?.data?.ejecutivo?.telefono) {\n    88→                adicional_toast = `<a href=\"https://wa.me/${respuesta.data.ejecutivo.telefono.replace(/\\D/g, '')}?text=Hola,%20me%20gustar%C3%ADa%20solicitar%20cr%C3%A9ditos%20adicionales%20para%20mi%20empresa.\" target=\"_blank\">\n    89→                    <p class=\"text-label-1 text-white no-visited text-decoration-none mb-0\">Solicitar</p>\n    90→                </a>`;\n    91→            }\n    92→            setTimeout(() => {\n    93→                $('#modal-generando-ia').modal('hide');\n    94→                $('#modal-cargue-ia').modal('hide');\n    95→                mostrarToast('danger', 'No cuentas con créditos. Solicita créditos adicionales.', '', adicional_toast);\n    96→            }, 300);\n    97→        }\n    98→    });\n    99→}\n   100→\n   101→/**\n   102→ * Continuar ejecución IA luego del modal de créditos\n   103→ * \n   104→ * @return void\n   105→ * @author José Manuel Jiménez\n   106→ */\n   107→function continuarEjecucionIA() {\n   108→    if (funcion_ejecucion_ia) {\n   109→        funcion_ejecucion_ia();\n   110→        funcion_ejecucion_ia = null;\n   111→    }\n   112→    mostro_modal_creditos_ia = false;\n   113→    $('#modal-consumo-creditos-ia').modal('hide');\n   114→}\n   115→\n   116→/**\n   117→ * Solicitar más créditos IA\n   118→ * \n   119→ * @return void\n   120→ * @author José Manuel Jiménez\n   121→ */\n   122→function solicitarMasCreditosIA() {\n   123→    $.ajax({\n   124→        url: `/empresas/${$('#empresa_sesion_id').val()}`,\n   125→        method: 'GET',\n   126→        dataType: 'json',\n   127→        success: function(respuesta) {\n   128→            if (respuesta?.data?.ejecutivo?.telefono) {\n   129→                window.open(`https://wa.me/${respuesta.data.ejecutivo.telefono.replace(/\\D/g, '')}?text=Hola,%20me%20gustar%C3%ADa%20solicitar%20cr%C3%A9ditos%20adicionales%20para%20mi%20empresa.`, '_blank');\n   130→            } else {\n   131→                mostrarToast('danger', 'No se encontró un ejecutivo asignado a la empresa. Por favor, comunícate con soporte para recargar créditos.');\n   132→            }\n   133→            $('#modal-solicitar-mas-creditos-ia').modal('hide');\n   134→        }\n   135→    });\n   136→}\n   137→\n   138→/**\n   139→ * Validar respuesta de créditos IA\n   140→ * \n   141→ * @return void\n   142→ * @author José Manuel Jiménez\n   143→ */\n   144→function validarRespuestaCreditosIA(error_ia) {\n   145→    if (error_ia == 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.') {\n   146→        mostrarToastSolicitarCreditosIA();\n   147→        return true;\n   148→    }\n   149→    return false;\n   150→}\n   151→\n   152→/**\n   153→ * Ajustar el ancho de los elementos select2 asincrono multiple.\n   154→ *\n   155→ * @returns {void}\n   156→ * @author Andres Morales\n   157→ */\n   158→$(document).ready(function () {\n   159→    cargarNotificiacionesHeader();\n   160→    if (window.configuracion_reverbg && window.configuracion_reverbg.activar_websocket) {\n   161→        configurarWebSocketNotificaciones();\n   162→    }\n   163→    setTimeout(() => {\n   164→        $(\".input-container\").each(function () {\n   165→            let $container = $(this);\n   166→            let $select = $container.find(\"select[multiple]\");\n   167→            let $icon = $container.find(\".input-icono1\");\n   168→            if ($select.length && $icon.length) {\n   169→                $(this).find('.select2-selection--multiple').addClass('ps-5')\n   170→            }\n   171→        });\n   172→    }, 1000);\n   173→    $('#modal-consumo-creditos-ia').on('hidden.bs.modal', function () {\n   174→        if (mostro_modal_creditos_ia) {\n   175→            $(modals_abiertos_ia).removeClass('d-none');\n   176→        }\n   177→        mostro_modal_creditos_ia = false;\n   178→    });\n   179→});\n   180→\n   181→/**\n   182→ * Formatear fecha a formato dd/mm/yyyy - hh:mm AM/PM.  Ejemplo: 01/Feb/2022 - 12:00 PM\n   183→ *\n   184→ * @param {string} fecha_entrada fecha en formato ISO\n   185→ * @returns {string} fecha y hora formateada\n   186→ * @author Andres Morales\n   187→ */\n   188→function formatearFecha(fecha_entrada) {\n   189→    var fecha = new Date(fecha_entrada);\n   190→    var dia = fecha.getDate();\n   191→    var mes = fecha.toLocaleString('es-ES', { month: 'short' });\n   192→    var anio = fecha.getFullYear();\n   193→    let hora = fecha.getHours();\n   194→    let minuto = fecha.getMinutes();\n   195→    let ampm = hora >= 12 ? 'PM' : 'AM';\n   196→    hora = hora % 12 || 12;\n   197→    minuto = minuto.toString().padStart(2, '0');\n   198→    return `${dia}/${mes}/${anio} - ${hora}:${minuto} ${ampm}`;\n   199→}\n   200→\n   201→function formatearFecha2(fecha_entrada) {\n   202→    let partes = fecha_entrada.split(' ');\n   203→    let fecha = partes[0].split('-');\n   204→    let hora = partes[1];\n   205→    let fechaISO = `${fecha[2]}-${fecha[1]}-${fecha[0]}T${hora}`;\n   206→\n   207→    let date = new Date(fechaISO);\n   208→\n   209→    if (isNaN(date.getTime())) {\n   210→        return 'Fecha inválida';\n   211→    }\n   212→\n   213→    let dia = date.getDate();\n   214→    let mes = date.toLocaleString('eu-EU', { month: 'short' });\n   215→    let anio = date.getFullYear();\n   216→    return `${dia}/${mes}/${anio}`;\n   217→}\n   218→\n   219→/**\n   220→ * Opción para contraer o agrandar el menú principal\n   221→ *\n   222→ * @returns {void}\n   223→ * @author José Manuel Jiménez\n   224→ * @author Andres Morales\n   225→ */\n   226→function contraerMenu() {\n   227→    if ($('.sidebar-menu').hasClass('close')) {\n   228→        $('.sidebar-menu').removeClass('d-none');\n   229→        localStorage.setItem('opcion_menu_storage', 'abierto');\n   230→        $('#btn-collapse').attr('data-bs-original-title', 'Contraer');\n   231→        $('#btn-collapse').attr('data-bs-title', 'Contraer');\n   232→        $(\".menu-bar\").each(function() {\n   233→            $(this).removeClass(\"px-2\").addClass(\"px-5\");\n   234→        });\n   235→        $('[data-bs-toggle=\"tooltip\"]').each(function () { new bootstrap.Tooltip(this); });\n   236→        $('.lista-primary[data-bs-toggle=\"tooltip\"]').each(function () {\n   237→            var tooltip_instancia = bootstrap.Tooltip.getInstance(this);\n   238→            if (tooltip_instancia) {\n   239→                tooltip_instancia.dispose();\n   240→            }\n   241→        });\n   242→    } else {\n   243→        $('.sidebar-menu').addClass('d-none');\n   244→        localStorage.setItem('opcion_menu_storage', 'cerrado');\n   245→        $('#btn-collapse').attr('data-bs-original-title', 'Expandir');\n   246→        $('#btn-collapse').attr('data-bs-title', 'Expandir');\n   247→        $(\".menu-bar\").each(function() {\n   248→            $(this).removeClass(\"px-5\").addClass(\"px-2\");\n   249→        });\n   250→        $('[data-bs-toggle=\"tooltip\"]').each(function () { new bootstrap.Tooltip(this); });\n   251→    }\n   252→    $('.tooltip.bs-tooltip-auto').remove();\n   253→    $('.sidebar-menu').toggleClass('close');\n   254→    $('.contenedor-vista').toggleClass('close');\n   255→    $('#btn-collapse').toggleClass('close');\n   256→    $('.nombre-usuario-empresa').toggle();\n   257→    $('.menu-bar .text-menu').toggle();\n   258→}\n   259→\n   260→/**\n   261→ * Opción para abrir o cerrar el menu segun la elección guardada\n   262→ *\n   263→ * @returns {void}\n   264→ * @author José Manuel Jiménez\n   265→ * @author Andres Morales\n   266→ */\n   267→function mostrarMenuStorage() {\n   268→    $(document).ready(function() {\n   269→        $('.lista-primary[data-bs-toggle=\"tooltip\"]').each(function () {\n   270→            var tooltip_instancia = bootstrap.Tooltip.getInstance(this);\n   271→            if (tooltip_instancia) {\n   272→                tooltip_instancia.dispose();\n   273→            }\n   274→        });\n   275→\n   276→        if (window.innerWidth < 768) {\n   277→            localStorage.setItem('opcion_menu_storage', 'cerrado');\n   278→        }\n   279→\n   280→        if (localStorage.getItem('opcion_menu_storage') === 'cerrado') {\n   281→            contraerMenu();\n   282→        }\n   283→        let $active = $('.menu-bar .active');\n   284→\n   285→        if ($active.length) {\n   286→            $('.menu-bar').scrollTop($active.position().top);\n   287→        }\n   288→    });\n   289→}\n   290→mostrarMenuStorage();\n   291→\n   292→/**\n   293→ * Funcion para hacer el slug de un texto desde jquery.\n   294→ *\n   295→ * @returns {void}\n   296→ * @author Andres Morales\n   297→ */\n   298→function slugify(text) {\n   299→    return $.trim(text)\n   300→        .toLowerCase()\n   301→        .normalize(\"NFD\")\n   302→        .replace(/[\\u0300-\\u036f]/g, \"\")\n   303→        .replace(/[^a-z0-9 -]/g, \"\")\n   304→        .replace(/\\s+/g, \"-\")\n   305→        .replace(/-+/g, \"-\");\n   306→}\n   307→\n   308→/**\n   309→ * Función generica para mostrar mensajes de respuesta\n   310→ *\n   311→ * @param {string} tipo_alerta define el color de la alerta segun alerts de botstrap.\n   312→ * @param {string} texto_1 Texto que mostrara la alerta.\n   313→ * @param {string} texto_2 Texto secundario en la alerta.\n   314→ * @param {string} accion Acción adicional(por definir).\n   315→ * @returns {void}\n   316→ * @author José Manuel Jiménez\n   317→ * @author Andres Gonzalez\n   318→ */\n   319→function mostrarToast(tipo_alerta, texto_1, texto_2 = '', accion = '', icono2 = '') {\n   320→    let icono = '';\n   321→    let texto_color = 'text-white';\n   322→    if (accion != '') {\n   323→        accion = `<div class=\"col-auto p-0 text-label-1\">${accion}</div>`;\n   324→    }\n   325→\n   326→    if (tipo_alerta == 'success') {\n   327→        icono = 'bi bi-check-circle';\n   328→    }\n   329→\n   330→    if (tipo_alerta == 'neutral') {\n   331→        icono = 'bi bi-info-circle';\n   332→    }\n   333→\n   334→    if (tipo_alerta == 'warning') {\n   335→        icono = 'bi bi-info-circle';\n   336→        texto_color = \"text-red-letras\";\n   337→    }\n   338→\n   339→    if (tipo_alerta == 'danger') {\n   340→        icono = 'bi bi-x-circle';\n   341→    }\n   342→\n   343→    if (icono2 != '') {\n   344→        icono = icono2;\n   345→    }\n   346→\n   347→    if (texto_2 != '') {\n   348→        texto_2 = `<div class=\"col-12 p-0 text-label-1 ${texto_color}\">${texto_2}</div>`;\n   349→    }\n   350→\n   351→    let alert_toast = $(`\n   352→        <div class=\"alert toast-${tipo_alerta} alert-dismissible fade show d-flex align-items-center pe-3 py-3 me-3\" role=\"alert\" style=\"display:none\">\n   353→            <div class=\"col-auto\">\n   354→                <span class=\"${icono} ${texto_color}\"></span>\n   355→            </div>\n   356→            <div class=\"col px-3\">\n   357→                <div class=\"row m-0 ${texto_color}\">\n   358→                    <div class=\"col-12 p-0 text-label-1 ${texto_color}\">\n   359→                        ${texto_1}\n   360→                    </div>\n   361→                    ${texto_2}\n   362→                </div>\n   363→            </div>\n   364→            ${accion}\n   365→            <div class=\"col-auto ms-3 pointer\" data-bs-dismiss=\"alert\">\n   366→                <span class=\"bi bi-x ${texto_color}\"></span>\n   367→            </div>\n   368→        </div>\n   369→    `);\n   370→    $('#contenedor-alert-toast').append(alert_toast);\n   371→    alert_toast.fadeIn();\n   372→    setTimeout(function() {\n   373→        alert_toast.fadeOut();\n   374→        alert_toast.alert('close');\n   375→    }, 5000);\n   376→}\n   377→\n   378→/**\n   379→ * Formatear número.\n   380→ *\n   381→ * @param {number} numero número a formatear\n   382→ * @author Andres Morales\n   383→ */\n   384→function formatearNumero(numero) {\n   385→    return parseInt(numero).toLocaleString('es-ES');\n   386→}\n   387→\n   388→/**\n   389→ * Formatear fecha.\n   390→ *\n   391→ * @param {*} fecha Fecha a formatear.\n   392→ * @param {boolean} incluir_segundos Indica si se debe incluir los segundos en la hora.\n   393→ * @param {string} formato Formato en el que se retornará la fecha.\n   394→ * @param {string} separador Símbolo que se usará para separar días, meses y años.\n   395→ * @returns {Object} Objeto con la fecha y hora formateada.\n   396→ * @author Daniel Beltrán\n   397→ */\n   398→function formatearFechaConceptual(fecha, incluir_segundos = false, formato = 'Ymd', separador = '-') {\n   399→    const NUEVA_FECHA = new Date(fecha);\n   400→    const ANO         = NUEVA_FECHA.getFullYear();\n   401→    const MES         = String(NUEVA_FECHA.getMonth() + 1).padStart(2, '0');\n   402→    const DIA         = String(NUEVA_FECHA.getDate()).padStart(2, '0');\n   403→    const HORAS       = String(NUEVA_FECHA.getHours()).padStart(2, '0');\n   404→    const MINUTOS     = String(NUEVA_FECHA.getMinutes()).padStart(2, '0');\n   405→    const SEGUNDOS    = String(NUEVA_FECHA.getSeconds()).padStart(2, '0');\n   406→\n   407→    let fecha_formateada = `${ANO}${separador}${MES}${separador}${DIA}`;\n   408→\n   409→    if (formato === 'dmY') {\n   410→        fecha_formateada = `${DIA}${separador}${MES}${separador}${ANO}`;\n   411→    }\n   412→\n   413→    return {\n   414→        fecha: fecha_formateada,\n   415→        hora : incluir_segundos ? `${HORAS}:${MINUTOS}:${SEGUNDOS}` : `${HORAS}:${MINUTOS}`\n   416→    };\n   417→}\n   418→\n   419→/**\n   420→ * Formatear fecha a May. 2023.\n   421→ *\n   422→ * @param {string} fechaISO Fecha a formatear.\n   423→ * @returns {string} Objeto con la fecha y hora formateada.\n   424→ * @author Andres Morales\n   425→ */\n   426→function formatearFechaAnioMes(fechaISO) {\n   427→    const fecha = new Date(fechaISO);\n   428→    const opciones = { month: 'short', year: 'numeric' };\n   429→    let fecha_formateada = fecha.toLocaleDateString('es-ES', opciones);\n   430→\n   431→    fecha_formateada = fecha_formateada.replace(\n   432→        /^([a-zñ]+)(\\s\\d{4})$/,\n   433→        (_, mes, anio) => `${mes.charAt(0).toUpperCase() + mes.slice(1)}. ${anio.trim()}`\n   434→    );\n   435→\n   436→    return fecha_formateada;\n   437→}\n   438→\n   439→/**\n   440→ * Formatear un numero a moneda.\n   441→ *\n   442→ * @param {string} valor Numero.\n   443→ * @returns {string} Numero formateado.\n   444→ * @author Andres Morales\n   445→ */\n   446→function formatearMonedaCOP(valor) {\n   447→    return new Intl.NumberFormat('es-CO', {\n   448→        style: 'currency',\n   449→        currency: 'COP',\n   450→        minimumFractionDigits: 0,\n   451→        maximumFractionDigits: 0\n   452→    }).format(valor);\n   453→}\n   454→\n   455→/**\n   456→ * Formatear fecha a un formato d/m/Y hh:mm:ss entendible para el usuario.\n   457→ *\n   458→ * @param {*} fecha_inicial Fecha a formatear.\n   459→ * @returns {String} String con la fecha y hora formateada.\n   460→ * @author José Manuel Jiménez\n   461→ */\n   462→function fechaMostrar(fecha_inicial) {\n   463→    if (!fecha_inicial) {\n   464→        return \"\";\n   465→    }\n   466→    const fecha = new Date(fecha_inicial);\n   467→    if (isNaN(fecha.getTime())) {\n   468→        return \"\";\n   469→    }\n   470→    const dia = String(fecha.getUTCDate()).padStart(2, '0');\n   471→    const mes = String(fecha.getUTCMonth() + 1).padStart(2, '0');\n   472→    const anio = fecha.getUTCFullYear();\n   473→    if (!fecha_inicial.includes(\" \")) {\n   474→        return `${dia}/${mes}/${anio}`;\n   475→    }\n   476→    const horas = String(fecha.getUTCHours()).padStart(2, '0');\n   477→    const minutos = String(fecha.getUTCMinutes()).padStart(2, '0');\n   478→    const segundos = String(fecha.getUTCSeconds()).padStart(2, '0');\n   479→    return `${dia}/${mes}/${anio} ${horas}:${minutos}:${segundos}`;\n   480→}\n   481→\n   482→/**\n   483→ * Descargar Excel.\n   484→ *\n   485→ * @param {string} ruta Ruta desde donde se descarga el archivo.\n   486→ * @param {string} nombre_archivo Nombre del archivo descargado.\n   487→ * @param {boolean} marca_tiempo Indica si el nombre del archivo debe llevar marca de tiempo.\n   488→ * @param {Object} parametros Parámetros a enviar en la petición.\n   489→ * @returns {void}\n   490→ * @author Daniel Beltrán\n   491→ */\n   492→async function descargarExcel(ruta, nombre_archivo, marca_tiempo = true, parametros = {}) {\n   493→    parametros._token = $('meta[name=\"csrf-token\"]').attr('content');\n   494→\n   495→    await $.ajax({\n   496→        type     : 'POST',\n   497→        url      : `/${ruta}`,\n   498→        data     : parametros,\n   499→        xhrFields: {\n   500→            responseType: 'blob'\n   501→        },\n   502→        success: function (respuesta) {\n   503→            // Crear una URL para el Blob\n   504→            let url = window.URL.createObjectURL(respuesta); // 'respuesta' es el Blob\n   505→            let a   = document.createElement('a'); // Crea un nuevo elemento <a> para iniciar la descarga\n   506→            a.href  = url;\n   507→            const fecha_actual     = new Date();\n   508→            const dia              = fecha_actual.getDate();\n   509→            const mes              = fecha_actual.getMonth() + 1;\n   510→            const ano              = fecha_actual.getFullYear();\n   511→            const hora             = fecha_actual.getHours();\n   512→            const minutos          = fecha_actual.getMinutes();\n   513→            const segundos         = fecha_actual.getSeconds();\n   514→            const fecha_formateada = `${dia}${mes}${ano}${hora}${minutos}${segundos}`;\n   515→\n   516→            a.download = marca_tiempo ? `${nombre_archivo}-${fecha_formateada}.xlsx` : `${nombre_archivo}.xlsx`;\n   517→            document.body.appendChild(a);\n   518→            a.click();\n   519→            window.URL.revokeObjectURL(url);\n   520→            document.body.removeChild(a);\n   521→        }\n   522→    }).then(() => {\n   523→        mostrarToast('success', 'Archivo descargado correctamente.');\n   524→    }).catch((error) => {\n   525→        mostrarToast('danger', 'Ocurrió un error al descargar el archivo.');\n   526→    });\n   527→}\n   528→\n   529→/**\n   530→ * Convierte un string a slug.\n   531→ *\n   532→ * @param {string} str\n   533→ * @returns {string}\n   534→ * @author Fahibram Cárcamo\n   535→ */\n   536→function slug(str) {\n   537→\n   538→    // Quita espacios en blanco\n   539→    str = str.replace(/^\\s+|\\s+$/g, \"\")\n   540→\n   541→    // Convierte el string a minusculas\n   542→    str = str.toLowerCase()\n   543→\n   544→    // Quita los caracteres no alfanuméricos\n   545→    str = str.replace(/[^a-z0-9 -]/g, \"\")\n   546→\n   547→    // Reemplaza los espacio con guiones\n   548→    str = str.replace(/\\s+/g, \"-\")\n   549→\n   550→    // Remueve los guiones consecutivos\n   551→    str = str.replace(/-+/g, \"-\")\n   552→\n   553→    return str\n   554→}\n   555→\n   556→/**\n   557→ * Compara los elementos de dos arreglos y retorna `true` si son iguales y `false` en caso contrario\n   558→ * (Este función está pensada para comparar arreglos unidimensionales).\n   559→ *\n   560→ * @param {array} primer_arreglo\n   561→ * @param {array} segundo_arreglo\n   562→ * @param {boolean} comparar_orden\n   563→ * @return {boolean}\n   564→ * @author Fahibram Cárcamo\n   565→ */\n   566→function sonArreglosIguales(primer_arreglo, segundo_arreglo, comparar_orden = false) {\n   567→\n   568→    if (!comparar_orden) {\n   569→        primer_arreglo.sort()\n   570→        segundo_arreglo.sort()\n   571→    }\n   572→\n   573→    if (primer_arreglo.length !== segundo_arreglo.length) return false\n   574→\n   575→    for (let i = 0; i < primer_arreglo.length; i++) {\n   576→        if (primer_arreglo[i] !== segundo_arreglo[i]) return false\n   577→    }\n   578→\n   579→    return true\n   580→}\n   581→\n   582→/**\n   583→ * Función para cambiar de empresa.\n   584→ *\n   585→ * @param {number} empresa_id ID de la empresa a la que se va a cambiar.\n   586→ * @returns {void}\n   587→ * @author José Manuel Jiménez\n   588→ * @author Daniel Beltrán\n   589→ */\n   590→function cambiarEmpresa(empresa_id) {\n   591→    $.ajax({\n   592→        type: 'POST',\n   593→        url: '/suplantar-rol-admin-general',\n   594→        data: {\n   595→            _token    : $('meta[name=\"csrf-token\"]').attr('content'),\n   596→            empresa_id: empresa_id\n   597→        },\n   598→        success: function (respuesta) {\n   599→            localStorage.setItem('notificacionToast', JSON.stringify({\n   600→                tipo_alerta: 'success',\n   601→                texto_1    : 'Cambio de empresa exitoso'\n   602→            }));\n   603→\n   604→            window.location.reload();\n   605→        },\n   606→        error: function (error) {\n   607→            mostrarToast('danger', 'Ocurrió un error al cambiar de empresa');\n   608→        }\n   609→    });\n   610→}\n   611→\n   612→/**\n   613→ * Enviar la solucitud de suplantación de rol y empresa al Back-end.\n   614→ *\n   615→ * @param {function|null} callback_exito Callback ejecutado en caso de éxito.\n   616→ * @param {string} url URL de suplantación.\n   617→ * @param {string} _token Token CSRF del formulario.\n   618→ * @param {number} empresa_id Id de la empresa a suplantar.\n   619→ * @param {number|null} rol_id Id del rol a suplantar.\n   620→ * @param {function|null} callback_error Callback ejecutado en caso de error.\n   621→ * @returns {void}\n   622→ * @author Fahibram Cárcamo\n   623→ */\n   624→async function enviarOrdenSuplantacionRolEmpresa (callback_exito, url, _token, empresa_id = null, rol_id = null, callback_error = null) {\n   625→\n   626→    let condicion_suplantacion = rol_id === null\n   627→        ? empresa_id === null\n   628→            ? true\n   629→            : parseInt($('#empresa_sesion_id').val()) !== parseInt(empresa_id)\n   630→        : parseInt($('#rol_sesion_id').val()) !== parseInt(rol_id) && parseInt($('#empresa_sesion_id').val()) !== parseInt(empresa_id);\n   631→\n   632→    if (condicion_suplantacion) {\n   633→        let data = { _token };\n   634→        if (empresa_id !== null) data.empresa_id = empresa_id;\n   635→        if (rol_id !== null) data.rol_id = rol_id;\n   636→\n   637→        await $.ajax({ type: 'POST', url, data })\n   638→            .then((respuesta, status, xhr) => {\n   639→                if (xhr.status >= 200 && xhr.status < 300 && callback_exito !== null) callback_exito();\n   640→            })\n   641→            .catch(error => {\n   642→                let swal_titulo, swal_texto;\n   643→\n   644→                if (error.status === 404) {\n   645→                    if (error.responseJSON.mensaje) {\n   646→                        swal_titulo = 'Algo salió mal';\n   647→                        if (error.responseJSON.mensaje === 'no existe rol_suplantar') {\n   648→                            swal_texto = 'El rol no existe.';\n   649→                        } else if (error.responseJSON.mensaje === 'no existe empresa_suplantar') {\n   650→                            swal_texto = 'La empresa no existe.';\n   651→                        } else if (error.responseJSON.mensaje === 'no existe usuario_suplantar') {\n   652→                            swal_texto = 'El usuario no existe.';\n   653→                        } else {\n   654→                            swal_texto = '';\n   655→                        }\n   656→                    } else if (error.responseJSON.empresa && error.responseJSON.rol) {\n   657→                        swal_titulo = 'No fué posible cambiar de empresa';\n   658→                        swal_texto = error.responseJSON.rol === 'Administrador general' || error.responseJSON.rol === 'Propietario'\n   659→                            ? `La empresa ${error.responseJSON.empresa} no tiene ningún usuario con el rol Administrador general o Propietario.`\n   660→                            : `La empresa ${error.responseJSON.empresa} no tiene ningún usuario con el rol ${error.responseJSON.rol}.`;\n   661→                    } else {\n   662→                        swal_titulo = 'Algo salió mal';\n   663→                        swal_texto = error.responseJSON.errors;\n   664→                    }\n   665→                } else {\n   666→                    swal_titulo = 'Algo salió mal';\n   667→                    swal_texto = '';\n   668→                }\n   669→\n   670→                if (callback_error !== null) callback_error();\n   671→\n   672→                Swal.fire({\n   673→                    title: swal_titulo,\n   674→                    text: swal_texto,\n   675→                    icon: \"error\",\n   676→                    confirmButtonText: \"Aceptar\"\n   677→                });\n   678→            });\n   679→    }\n   680→}\n   681→\n   682→/**\n   683→ * Mostrar tooltip según el div que lo contenga.\n   684→ *\n   685→ * @param {div} div Elemento en donde se va a mostrar el tooltip.\n   686→ * @returns {void}\n   687→ * @author Sol Espitia\n   688→ */\n   689→function mostrarTooltip(div) {\n   690→    const TOOLTIP         = div.querySelector('.tooltip-x');\n   691→    TOOLTIP.style.display = 'block';\n   692→}\n   693→\n   694→/**\n   695→ * Ocultar tooltip según el div que lo contenga.\n   696→ *\n   697→ * @param {div} div Elemento en donde se va a mostrar el tooltip.\n   698→ * @returns {void}\n   699→ * @author Sol Espitia\n   700→ */\n   701→function ocultarTooltip(div) {\n   702→    const TOOLTIP         = div.querySelector('.tooltip-x');\n   703→    TOOLTIP.style.display = 'none';\n   704→}\n   705→\n   706→/**\n   707→ * Retornar la diferencia en días de dos fechas dadas.\n   708→ *\n   709→ * @param {string} fecha_inicial Fecha inicial\n   710→ * @param {string} fecha_final Fecha final\n   711→ * @param {bool} valor_absoluto Retorna la diferencia en valor absoluto\n   712→ * @returns {number}\n   713→ * @author Fahibram Cárcamo\n   714→ * @author Andres Morales\n   715→ */\n   716→function diferenciaFechasDias(fecha_inicial, fecha_final, valor_absoluto = false, sumar_dia = true) {\n   717→    let fecha1 = new Date(fecha_inicial);\n   718→    let fecha2 = new Date(fecha_final);\n   719→\n   720→    fecha1.setHours(0, 0, 0, 0);\n   721→    fecha2.setHours(0, 0, 0, 0);\n   722→\n   723→    let diferencia_milisegundos = fecha2.getTime() - fecha1.getTime();\n   724→\n   725→    let diferencia_dias = diferencia_milisegundos / (1000 * 60 * 60 * 24);\n   726→    let resultado = diferencia_dias;\n   727→    if (sumar_dia) {\n   728→        resultado = diferencia_dias + 1;\n   729→    }\n   730→\n   731→    return valor_absoluto ? Math.abs(resultado) : resultado;\n   732→}\n   733→\n   734→/**\n   735→ * Retornar `true` si una fecha dada está dentro de un rango de fechas dadas, `false` en otro caso.\n   736→ *\n   737→ * @param {string} fecha Fecha dada\n   738→ * @param {string} fecha_desde Fecha inicial del rango\n   739→ * @param {string} fecha_hasta Fecha final del rango\n   740→ * @returns {boolean}\n   741→ * @author Fahibram Cárcamo\n   742→ */\n   743→function fechaDentroDelRango(fecha, fecha_desde, fecha_hasta) {\n   744→    fecha = new Date(fecha);\n   745→    fecha_desde = new Date(fecha_desde);\n   746→    fecha_hasta = new Date(fecha_hasta);\n   747→\n   748→    if (isNaN(fecha) || isNaN(fecha_desde) || isNaN(fecha_hasta)) {\n   749→        throw new Error('Una o más fechas no son válidas.');\n   750→    }\n   751→\n   752→    return fecha >= fecha_desde && fecha <= fecha_hasta;\n   753→}\n   754→\n   755→/**\n   756→ * Descuenta el tiempo para las respuestas.\n   757→ *\n   758→ * @param id - ID del elemento HTML donde mostrar el tiempo\n   759→ * @param tiempo - Tiempo inicial en segundos\n   760→ * @author Jair Carvajal\n   761→ */\n   762→var tiempos_usados = {};\n   763→\n   764→function descuentoTiempo(id, tiempo, callback, onTick) {\n   765→    var $elemento = $('#' + id);\n   766→    if ($elemento.length === 0) {\n   767→        console.error('Elemento con id \"' + id + '\" no encontrado.');\n   768→        return;\n   769→    }\n   770→    if (tiempos_usados[id]) {\n   771→        clearInterval(tiempos_usados[id]);\n   772→    }\n   773→    let tiempoTotal = tiempo;\n   774→    tiempos_usados[id] = setInterval(function() {\n   775→        if (tiempo <= 0) {\n   776→            clearInterval(tiempos_usados[id]);\n   777→            delete tiempos_usados[id];\n   778→            $elemento.text('Tiempo finalizado');\n   779→            if (window.tiempoFinalizado()) {\n   780→                tiempoFinalizado();\n   781→            }\n   782→            if (typeof callback === 'function') {\n   783→                callback();\n   784→            }\n   785→            return;\n   786→        }\n   787→\n   788→        var minutos = Math.floor(tiempo / 60);\n   789→        var segundos = tiempo % 60;\n   790→\n   791→        var textoTiempo = minutos + ':' + (segundos < 10 ? '0' : '') + segundos + '<i class=\"bi bi-alarm ms-2\"></i>';\n   792→\n   793→        if (tiempo <= 15) {\n   794→            $elemento.addClass('text-state-red');\n   795→            $elemento.removeClass('text-state-green');\n   796→        } else {\n   797→            $elemento.addClass('text-state-green');\n   798→            $elemento.removeClass('text-state-red');\n   799→        }\n   800→\n   801→        $elemento.html(textoTiempo);\n   802→\n   803→        var tiempoUsado = tiempoTotal - tiempo;\n   804→\n   805→        if (typeof onTick === 'function') {\n   806→            onTick((tiempoUsado % 5));\n   807→        }\n   808→        tiempo--;\n   809→    }, 1000);\n   810→}\n   811→\n   812→/**\n   813→ * Detengo el tiempo para las respuestas.\n   814→ *\n   815→ * @param id - ID del elemento HTML donde mostrar el tiempo\n   816→ * @param tiempo - Tiempo inicial en segundos\n   817→ * @author Jair Carvajal\n   818→ */\n   819→function detenerDescuentoTiempo(id) {\n   820→    if (tiempos_usados[id]) {\n   821→        clearInterval(tiempos_usados[id]);\n   822→        delete tiempos_usados[id];\n   823→    }\n   824→}\n   825→\n   826→/**\n   827→ * Genera un SVG de la imagen de usuario.\n   828→ *\n   829→ * @param id ID del usuario.\n   830→ * @param nombres Nombres del usuario.\n   831→ * @param apellidos Apellidos del usuario.\n   832→ * @return image\n   833→ * @author Andres Morales\n   834→ */\n   835→function crearImagenUsuarioLetras(id, nombres, apellidos) {\n   836→    var tamano = 200;\n   837→    var iniciales = (nombres[0] + apellidos[0]).toUpperCase();\n   838→    var hash = md5(id);\n   839→\n   840→    var r = parseInt(hash.substring(0, 2), 16);\n   841→    var g = parseInt(hash.substring(2, 4), 16);\n   842→    var b = parseInt(hash.substring(4, 6), 16);\n   843→    var colorFondo = `rgb(${r},${g},${b})`;\n   844→\n   845→    var luminancia = 0.299 * r + 0.587 * g + 0.114 * b;\n   846→    var colorTexto = luminancia > 150 ? \"#000000\" : \"#FFFFFF\";\n   847→\n   848→    // SVG como texto\n   849→    var svg = `\n   850→    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${tamano}\" height=\"${tamano}\">\n   851→        <rect width=\"100%\" height=\"100%\" fill=\"${colorFondo}\" />\n   852→        <text x=\"50%\" y=\"50%\" dy=\".35em\"\n   853→            text-anchor=\"middle\"\n   854→            font-family=\"Lato, sans-serif\"\n   855→            font-size=\"${tamano * 0.4}\"\n   856→            fill=\"${colorTexto}\">\n   857→            ${iniciales}\n   858→        </text>\n   859→    </svg>`;\n   860→    var svgEncoded = encodeURIComponent(svg)\n   861→        .replace(/'/g, \"%27\")\n   862→        .replace(/\"/g, \"%22\");\n   863→\n   864→    var dataUri = `data:image/svg+xml,${svgEncoded}`;\n   865→    return dataUri;\n   866→}\n   867→\n   868→/**\n   869→ * Carga las notificaciones\n   870→ *\n   871→ * @return void\n   872→ * @author Andres Morales\n   873→ * @author Andres Gonzalez\n   874→ * @author Esperanza Olivo\n   875→ */\n   876→function cargarNotificiacionesHeader() {\n   877→    $.ajax({\n   878→        url: '/usuario-notificaciones',\n   879→        type: 'GET',\n   880→        dataType: 'json',\n   881→        success: function(respuesta) {\n   882→            let datos = respuesta.data;\n   883→            let notificaciones_noleidas = datos?.unread_notifications?.length ?? 0;\n   884→\n   885→            // Siempre remover el badge existente\n   886→            $('#dropdownNotificaciones #badge-notificaciones').remove();\n   887→\n   888→            // Solo agregar el badge si hay notificaciones no leídas\n   889→            if (notificaciones_noleidas > 0) {\n   890→                $('#dropdownNotificaciones').append(`<span id=\"badge-notificaciones\" class=\"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger border border-white\">${notificaciones_noleidas}</span>`);\n   891→                $('#contador-notificaciones-abierto').append(`<span id=\"badge-notificaciones\" class=\"badge rounded-pill bg-danger border border-white\">${notificaciones_noleidas}</span>`);\n   892→\n   893→                $('#contenedor-boton-marcar-todas').html(`\n   894→                    <button class=\"btn btn-link text-primary w-100 d-flex justify-content-center\" onclick=\"marcarNotificacionesLeidas('all')\">\n   895→                        Marcar todo como leído\n   896→                    </button>\n   897→                `);\n   898→            }\n   899→\n   900→            let no_leidos_ids = Array.isArray(datos?.unread_notifications) ? datos.unread_notifications.map(notificacion => notificacion.id): [];\n   901→\n   902→            if (Array.isArray(datos?.notifications) && datos.notifications.length > 0) {\n   903→                $('#notificacion-sinnotificaciones').hide();\n   904→                $('.notificaciones-listado').remove();\n   905→                datos.notifications.forEach(notificacion => {\n   906→                    const { id, data, updated_at } = notificacion;\n   907→\n   908→                    const NO_LEIDO = no_leidos_ids.includes(id);\n   909→                    const MENSAJE = (data?.mensaje || '').slice(0, 120) + '...';\n   910→                    const HORA = new Date(updated_at).toLocaleTimeString('es-CO', {\n   911→                        hour: '2-digit',\n   912→                        minute: '2-digit',\n   913→                        hour12: false\n   914→                    });\n   915→\n   916→                    const notificaciones = `\n   917→                        <li class=\"${NO_LEIDO ? '' : 'bg-gray-90'} notificaciones-listado py-0\" id=\"notificacion-${id}\">\n   918→                            <a class=\"dropdown-item text-gray-10 text-decoration-none border-top pt-0 pb-1\" href=\"javascript:void(0)\" onclick=\"marcarNotificacionesLeidas('${id}','${data?.ruta}')\">\n   919→                                <div class=\"d-flex justify-content-between\">\n   920→                                    <div class=\"w-auto flex-grow-1 pe-3\">\n   921→                                        <p class=\"mt-1 mb-0 text-headline-6 text-gray-10\">${data?.titulo}</p>\n   922→                                        <p class=\"mb-0 text-body-3 text-gray-30 notificacion-mensaje\">${MENSAJE}</p>\n   923→                                    </div>\n   924→                                    <div class=\"w-auto my-auto ${NO_LEIDO ? 'text-cta-azul' : 'text-gray-10'} text-label-2 flex-shrink-0\">\n   925→                                        ${HORA}${NO_LEIDO ? `<i class=\"bi bi-circle-fill text-cta-azul my-auto texto-notificacion-icono ms-3\"></i>` : ''}\n   926→                                    </div>\n   927→                                </div>\n   928→                            </a>\n   929→                        </li>\n   930→                    `;\n   931→\n   932→                    $(notificaciones).insertBefore('#contenedor-boton-marcar-todas');\n   933→                });\n   934→\n   935→            } else {\n   936→                $('#notificacion-sinnotificaciones').hide();\n   937→                $('.notificaciones-listado').remove();\n   938→            }\n   939→\n   940→        },\n   941→        error: function(xhr, status, error) {\n   942→            console.error('Error al cargar notificaciones:', error);\n   943→        }\n   944→    });\n   945→}\n   946→\n   947→/**\n   948→ * Marcar las notificaciones leídas.\n   949→ *\n   950→ * @param {array} notificaciones_ids ids de las notificaciones\n   951→ * @param {string} ruta_destino ruta donde se va ha actualizar la pagina\n   952→ * @returns {void}\n   953→ * @author Andres Gonzalez\n   954→ * @author Esperanza Olivo\n   955→ */\n   956→function marcarNotificacionesLeidas(notificaciones_ids = null, ruta_destino = null, soporte_id = null) {\n   957→\n   958→    let data = {\n   959→        _token: $('meta[name=\"csrf-token\"]').attr('content')\n   960→    };\n   961→\n   962→    if (notificaciones_ids === 'all') {\n   963→        data.marcar_todo = true;\n   964→    } else if (soporte_id) {\n   965→        data.soporte_id = soporte_id;\n   966→    } else if (notificaciones_ids) {\n   967→        data.notificaciones_ids = Array.isArray(notificaciones_ids)\n   968→            ? notificaciones_ids\n   969→            : [notificaciones_ids];\n   970→    }\n   971→\n   972→    $.ajax({\n   973→        url: '/usuario-marcar-notificaciones-leidas',\n   974→        type: 'POST',\n   975→        data: data,\n   976→        success: function(respuesta) {\n   977→            cargarNotificiacionesHeader();\n   978→\n   979→            if (notificaciones_ids && notificaciones_ids !== 'all' && ruta_destino) {\n   980→                window.location.href = \"/\" + ruta_destino;\n   981→            }\n   982→\n   983→            if (notificaciones_ids === 'all') {\n   984→                $('#badge-notificaciones').remove();\n   985→                $('#contenedor-boton-marcar-todas').empty();\n   986→                $('.notificaciones-listado').addClass('bg-gray-90');\n   987→                $('.bi-circle-fill').remove();\n   988→            }\n   989→        },\n   990→        error: function(xhr, estatus, error) {\n   991→            console.error('Error al cargar notificaciones:', error);\n   992→        }\n   993→    });\n   994→}\n   995→\n   996→/**\n   997→ * Configurar WebSocket para notificaciones en tiempo real\n   998→ *\n   999→ * @return void\n  1000→ * @author Andres Gonzalez\n  1001→ */\n  1002→function configurarWebSocketNotificaciones() {\n  1003→    try {\n  1004→        if (!window.configuracion_reverbg) {\n  1005→            return;\n  1006→        }\n  1007→\n  1008→        const PUSHER = new Pusher(window.configuracion_reverbg.appKey, {\n  1009→            wsHost: window.configuracion_reverbg.host,\n  1010→            wsPort: window.configuracion_reverbg.port,\n  1011→            wssPort: window.configuracion_reverbg.port,\n  1012→            cluster: 'mt1',\n  1013→            forceTLS: false,\n  1014→            enabledTransports: ['ws', 'wss'],\n  1015→            authEndpoint: '/broadcasting-auth',\n  1016→            auth: {\n  1017→                headers: {\n  1018→                    'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\n  1019→                }\n  1020→            }\n  1021→        });\n  1022→\n  1023→        PUSHER.connection.bind('failed', function() {\n  1024→            console.error('❌ Conexión WebSocket falló');\n  1025→        });\n  1026→\n  1027→        PUSHER.connection.bind('error', function(error) {\n  1028→            console.error('❌ Error de WebSocket:', error);\n  1029→        });\n  1030→\n  1031→        let usuario_id = window.configuracion_reverbg.usuario_id;\n  1032→\n  1033→        if (!usuario_id) {\n  1034→            return;\n  1035→        }\n  1036→\n  1037→        const NOMBRE_CANAL = `private-App.Models.Usuarios.User.${usuario_id}`;\n  1038→        const CANAL = PUSHER.subscribe(NOMBRE_CANAL);\n  1039→\n  1040→        CANAL.bind('pusher:subscription_error', function(error) {\n  1041→            console.error('❌ Error al suscribirse al canal:', error);\n  1042→        });\n  1043→\n  1044→        // Escuchar eventos específicos de notificaciones\n  1045→        CANAL.bind('Illuminate\\\\Notifications\\\\Events\\\\BroadcastNotificationCreated', function(data) {\n  1046→            if (data.tipo === 'nueva_notificacion') {\n  1047→                audio_notificacion.play();\n  1048→                cargarNotificiacionesHeader();\n  1049→            }\n  1050→\n  1051→            if (data.tipo === 'nuevo_mensaje') {\n  1052→                if (($('#soporte-guardado-id').val() == data.soporte_id) || ($('#soporte_empresa_id').val() == data.soporte_id)) {\n  1053→                    audio_notificacion.play();\n  1054→                    consultarChat(data.soporte_id);\n  1055→                }\n  1056→            }\n  1057→        });\n  1058→    } catch (error) {\n  1059→        console.error('💥 Error en configurarWebSocketNotificaciones:', error);\n  1060→        console.error('Stack trace:', error.stack);\n  1061→    }\n  1062→}\n  1063→\n  1064→/**\n  1065→ * Retornar el string entrante en formato title case.\n  1066→ *\n  1067→ * @param {string} texto\n  1068→ * @returns {string}\n  1069→ * @author Fahibram Cárcamo\n  1070→ */\n  1071→function titleCase(texto) {\n  1072→    return texto.toLowerCase().replace(/\\b\\w/g, caracter => caracter.toUpperCase());\n  1073→}\n  1074→\n  1075→/**\n  1076→ * Número de horas que durará el almacenamiento de la variable `ulitmas_empresas` en el\n  1077→ * almacenamiento local **LocalStorage**.\n  1078→ *\n  1079→ * @var {number}\n  1080→ * @author Fahibram Cárcamo\n  1081→ */\n  1082→const CANTIDAD_HORAS_VENCIMIENTO_ULTIMAS_EMPRESAS_LOCALSTORAGE = 6;\n  1083→\n  1084→/**\n  1085→ * Validar si ya debe removerse la variable `ultimas_empresas` del alamacenamiento local\n  1086→ * **LocalStorage**, si no es tiempo de eliminarla entonces se reinicia el tiempo de vigencia de la\n  1087→ * variable.\n  1088→ *\n  1089→ * @returns {void}\n  1090→ * @author Fahibram Cárcamo\n  1091→ */\n  1092→function validarYActualizarUltimasEmpresasLocalStorage() {\n  1093→    let fecha_hora_actuales = moment();\n  1094→    let fecha_hora_vencimiento_ultimas_empresas = fecha_hora_actuales.clone().add(CANTIDAD_HORAS_VENCIMIENTO_ULTIMAS_EMPRESAS_LOCALSTORAGE, 'hours');\n  1095→    let fecha_hora_vencimiento_ultimas_empresas_localstorage = localStorage.getItem('vencimiento_ultimas_empresas');\n  1096→    let ultimas_empresas = localStorage.getItem('ultimas_empresas');\n  1097→\n  1098→    if (\n  1099→        ultimas_empresas != null &&\n  1100→        fecha_hora_vencimiento_ultimas_empresas_localstorage != null &&\n  1101→        fecha_hora_actuales.clone().isBefore(moment(fecha_hora_vencimiento_ultimas_empresas_localstorage).clone())\n  1102→    ) {\n  1103→        localStorage.setItem('vencimiento_ultimas_empresas', fecha_hora_vencimiento_ultimas_empresas.format('YYYY-MM-DD HH:mm:ss'));\n  1104→        return;\n  1105→    }\n  1106→\n  1107→    localStorage.removeItem('vencimiento_ultimas_empresas');\n  1108→    localStorage.removeItem('ultimas_empresas');\n  1109→}\n  1110→\n  1111→/**\n  1112→ * Obtener la edad actual de un usuario según su fecha de nacimiento.\n  1113→ *\n  1114→ * @param {string} fecha_nacimiento\n  1115→ * @returns {string}\n  1116→ * @author José Manuel Jiménez\n  1117→ * @author Fahibram Cárcamo\n  1118→ * @author Andres Morales\n  1119→ */\n  1120→function obtenerEdad(fecha_nacimiento) {\n  1121→    if (!fecha_nacimiento) return \"N/A\";\n  1122→    let hoy = new Date();\n  1123→    let nacimiento = new Date(fecha_nacimiento);\n  1124→    let edad = hoy.getFullYear() - nacimiento.getFullYear();\n  1125→    let mes = hoy.getMonth() - nacimiento.getMonth();\n  1126→    if (mes < 0 || (mes === 0 && hoy.getDate() < nacimiento.getDate())) edad--;\n  1127→    return edad + \" años\";\n  1128→}\n  1129→\n  1130→/**\n  1131→ * Restablecer un input de tipo file.\n  1132→ *\n  1133→ * @param {html} elemento_input_html Elemento input html.\n  1134→ * @param {html} label_elemento_input_html Label del elemento input html.\n  1135→ * @param {html} boton_eliminar_elemento_input_html Botón para eliminar archivo del elemento input html.\n  1136→ * @author Fahibram Cárcamo\n  1137→ */\n  1138→function reiniciarCampoArchivo(elemento_input_html, label_elemento_input_html, boton_eliminar_elemento_input_html) {\n  1139→    elemento_input_html.val('');\n  1140→    elemento_input_html.removeAttr('data-base64');\n  1141→    label_elemento_input_html.text('Ningún archivo seleccionado');\n  1142→    boton_eliminar_elemento_input_html.hide();\n  1143→\n  1144→    if (elemento_input_html.data('imagen')) {\n  1145→        $('#' + elemento_input_html.data('imagen')).val('');\n  1146→        $('#' + elemento_input_html.data('imagen') + '_previsualizacion').attr('src', '');\n  1147→        $('#' + elemento_input_html.data('imagen') + '_fondo_previsualizacion').removeClass('d-none');\n  1148→    }\n  1149→}\n  1150→\n  1151→/**\n  1152→ * Definir un campo destinado a recibir un número de teléfono celular.\n  1153→ *\n  1154→ * Esta función debe llamarse en el evento ready del objeto global document:\n  1155→ * `$(document).ready(...)`. Ademas debe incluirse un pequeño fragmento de código en la función\n  1156→ * `validacionAdicional` para que se agregué el código del número de celular al valor de campo\n  1157→ * cuando se envíe el formulario donde se encutra el campo.\n  1158→ *\n  1159→ * ```\n  1160→ * if (\n  1161→ *   $('#input_celular_id').length &&\n  1162→ *   $('#input_celular_id').val() !== '' &&\n  1163→ *   input_celular.getNumber() !== ''\n  1164→ * ) {\n  1165→ *   $('#input_celular_id').val(input_celular.getNumber().slice(1));\n  1166→ * }\n  1167→ * ```\n  1168→ *\n  1169→ * Donde `input_celular` es el objeto retornado por esta función.\n  1170→ *\n  1171→ * @param {string} input_celular_id Id del campo.\n  1172→ * @param {string} nombre_input_celular Nombre del campo.\n  1173→ * @param {string} placeholder_input_celular Placeholder del campo.\n  1174→ * @param {boolean} obligatorio El campo es obligatorio en el formulario.\n  1175→ * @returns {object}\n  1176→ * @author Fahibram Cárcamo\n  1177→ */\n  1178→function definirInputTipoCelular(input_celular_id, nombre_input_celular, placeholder_input_celular, obligatorio = true) {\n  1179→    /**\n  1180→     * 🌎 Campo para ingresar un número de telefono con selectór de código de país con banderas.\n  1181→     * Este componente se creó con la librería International Telephone Input\n  1182→     * (https://intl-tel-input.com).\n  1183→     *\n  1184→     * La linea hiddenInput: () => ({ phone: 'celular_contacto' }) tiene como función establecer el\n  1185→     * nombre del campo, es decir, la llave del par llave-valor que se adjuntará en los datos del\n  1186→     * formulario cuando se envíe, en este caso 'celular_contacto'.\n  1187→     *\n  1188→     * Las lienas autoPlaceholder: 'aggressive' y\n  1189→     * customPlaceholder: (placeholder, country) => 'Celular*' se usan para definir el placeholder\n  1190→     * del campo.\n  1191→     *\n  1192→     * Con $('#celular_contacto').attr('required', true); se establece el campo como requerido\n  1193→     * dentro del formulario, se hace de esta forma porque la librería no admite el atributo\n  1194→     * required directamente en el componente html.\n  1195→     *\n  1196→     * @author Fahibram Cárcamo\n  1197→     */\n  1198→    if (document.querySelector(`#${input_celular_id}`)) {\n  1199→        const dropdown_dinamico = document.createElement('div');\n  1200→        document.body.appendChild(dropdown_dinamico);\n  1201→\n  1202→        let campo_celular = window.intlTelInput(document.querySelector(`#${input_celular_id}`), {\n  1203→            nationalMode: true,\n  1204→            initialCountry: 'co',\n  1205→            separateDialCode: true,\n  1206→            autoInsertDialCode: false,\n  1207→            autoPlaceholder: 'aggressive',\n  1208→            dropdownContainer: dropdown_dinamico,\n  1209→            customPlaceholder: (placeholder, country) => placeholder_input_celular,\n  1210→            loadUtils: () => import('https://cdn.jsdelivr.net/npm/intl-tel-input@25.4.2/build/js/utils.js'),\n  1211→            onlyCountries: [\n  1212→                'CO', // Colombia\n  1213→                'EC', // Ecuador\n  1214→                'AR', // Argentina\n  1215→                'CL', // Chile\n  1216→                'VE', // Venezuela\n  1217→                'PE', // Perú\n  1218→                'BO', // Bolivia\n  1219→                'UY', // Uruguay\n  1220→                'PY', // Paraguay\n  1221→                'PA', // Panamá\n  1222→                'MX', // México\n  1223→                'CR', // Costa Rica\n  1224→                // 'PR', // Puerto Rico\n  1225→                'CU', // Cuba\n  1226→                // 'DO', // República Dominicana\n  1227→                'SV', // El Salvador\n  1228→                'GT', // Guatemala\n  1229→                'HN', // Honduras\n  1230→                'NI', // Nicaragua\n  1231→                'ES', // España\n  1232→                'US', // Estados Unidos\n  1233→                'GQ'  // Guinea Ecuatorial\n  1234→            ]\n  1235→        });\n  1236→\n  1237→        if (obligatorio) $(`#${input_celular_id}`).attr('required', true);\n  1238→\n  1239→        return campo_celular;\n  1240→    }\n  1241→\n  1242→    return null;\n  1243→}\n  1244→\n  1245→/**\n  1246→ * Establece la validación adicional que se aplica a un campo de tipo celular antes de enviar sus\n  1247→ * datos en un formulario.\n  1248→ *\n  1249→ * @param {HTMLInputElement} input Elemento HTML del campo de tipo celular.\n  1250→ * @param {string} input_id Id del elemento HTML del campo de tipo celular.\n  1251→ * @author Fahibram Cárcamo\n  1252→ * @author Jair Carvajal\n  1253→ */\n  1254→function validacionAdicionalInputTipoCelular(input, input_id) {\n  1255→    let numero_completo = input.getNumber();\n  1256→    let indicativo = '+' + input.getSelectedCountryData().dialCode;\n  1257→    let codigo_iso2_pais = input.getSelectedCountryData().iso2;\n  1258→    let numero_sin_indicativo = numero_completo.replace(indicativo, '');\n  1259→    $(`#indicativo_${input_id}`).val(indicativo);\n  1260→    $(`#codigo_iso2_pais_${input_id}`).val(codigo_iso2_pais);\n  1261→    $(`#${input_id}`).val(numero_sin_indicativo);\n  1262→}\n  1263→\n  1264→/**\n  1265→ * Rellenar un input de tipo celular.\n  1266→ *\n  1267→ * @param {string} indicativo_celular Código del país del número de celular.\n  1268→ * @param {string} codigo_pais_iso2 Código ISO2 del país del número de celular.\n  1269→ * @param {string} numero_celular Número de celular sin código de país.\n  1270→ * @param {string} input_celular_id ID del input de tipo celular.\n  1271→ * @param {HTMLInputElement} input_celular Input de tipo celular.\n  1272→ * @returns {void}\n  1273→ * @author Daniel Beltrán\n  1274→ * @author Fahibram Cárcamo\n  1275→ */\n  1276→function rellenarInputCelular(indicativo_celular, codigo_pais_iso2, numero_celular, input_celular_id, input_celular) {\n  1277→    $(`#${input_celular_id}`).val(numero_celular);\n  1278→    if (![null, undefined].includes(codigo_pais_iso2)) input_celular.setCountry(codigo_pais_iso2);\n  1279→}\n  1280→\n  1281→/**\n  1282→ * Convierte imágenes de base64 a Blob.\n  1283→ *\n  1284→ * @param {string} cadena_base_64 Base 64 de la imagen.\n  1285→ * @returns {Promise<Array>}\n  1286→ * @author Andres Gonzalez\n  1287→ */\n  1288→function imagenBase64Blob(cadena_base_64) {\n  1289→    if (!cadena_base_64 || !cadena_base_64.startsWith('data:image')) return null;\n  1290→    let datos_base_64 = cadena_base_64.split(',')[1];\n  1291→    let tipo_mime = cadena_base_64.match(/data:(.*?);base64/)[1];\n  1292→    let caracteres_binarios = atob(datos_base_64);\n  1293→    let arreglo_bytes = new Array(caracteres_binarios.length).fill(0).map((_, i) => caracteres_binarios.charCodeAt(i));\n  1294→    let bytes_uint8 = new Uint8Array(arreglo_bytes);\n  1295→    return new Blob([bytes_uint8], { type: tipo_mime });\n  1296→}\n  1297→\n  1298→\n  1299→/**\n  1300→ * Limpiar estructuras html innecesarias en el check editor.\n  1301→ *\n  1302→ * @param {string} html - Cadena HTML generada por CKEditor a limpiar\n  1303→ * @returns {string} HTML limpio sin elementos específicos de CKEditor\n  1304→ * @author Andres Gonzalez\n  1305→ * @author Jair Carvajal\n  1306→ */\n  1307→function limpiarHTMLCKEditor(html) {\n  1308→    // Remover todos los elementos con clases de CKEditor\n  1309→    html = html.replace(/<div class=\"ck[^\"]*\"[^>]*>.*?<\\/div>/gs, '');\n  1310→    html = html.replace(/<span class=\"[^\"]*ck[^\"]*\"[^>]*>/gi, '<span>');\n  1311→\n  1312→    // Limpiar spans de imagen inline\n  1313→    html = html.replace(/<span class=\"image-inline[^\"]*\"[^>]*>/gi, '');\n  1314→    html = html.replace(/<\\/span>/g, '');\n  1315→\n  1316→    // Remover elementos de upload y widgets\n  1317→    html = html.replace(/<div class=\"ck-image-upload[^\"]*\"[^>]*>.*?<\\/div>/gs, '');\n  1318→    html = html.replace(/<div class=\"ck-fake-selection[^\"]*\"[^>]*>.*?<\\/div>/gs, '');\n  1319→\n  1320→    // Remover atributos innecesarios\n  1321→    html = html.replace(/contenteditable=\"[^\"]*\"/gi, '');\n  1322→    html = html.replace(/data-cke-filler=\"[^\"]*\"/gi, '');\n  1323→\n  1324→    // Limpiar párrafos vacíos con br\n  1325→    html = html.replace(/<p><br[^>]*><\\/p>/gi, '');\n  1326→    html = html.replace(/<br data-cke[^>]*>/gi, '');\n  1327→\n  1328→    // Limpiar espacios múltiples y saltos de línea\n  1329→    html = html.replace(/\\s+/g, ' ');\n  1330→    html = html.replace(/>\\s+</g, '><');\n  1331→\n  1332→    return html.trim();\n  1333→}\n  1334→\n  1335→/**\n  1336→ * Ordena estudios por fecha_inicio más reciente (de más nueva a más antigua).\n  1337→ * Preserva los índices originales para permitir edición y eliminación correcta.\n  1338→ *\n  1339→ * @param {Array} estudios - Array de objetos con estudios\n  1340→ * @returns {Array} Array de estudios ordenados con propiedad indice_original\n  1341→ * @author Jair Carvajal\n  1342→ */\n  1343→function ordenarEstudiosPorFecha(estudios) {\n  1344→    // Mapear con índice original\n  1345→    let estudios_con_indice = estudios.map((estudio, indice_original) => ({\n  1346→        ...estudio,\n  1347→        indice_original: indice_original\n  1348→    }));\n  1349→\n  1350→    // Ordenar estudios por fecha_inicio (más reciente primero)\n  1351→    let estudios_ordenados = estudios_con_indice.sort((a, b) => {\n  1352→        // Si ambos tienen fecha_inicio, ordenar por más reciente\n  1353→        if (a.fecha_inicio && b.fecha_inicio) {\n  1354→            return moment(b.fecha_inicio).diff(moment(a.fecha_inicio));\n  1355→        }\n  1356→        // Si solo uno tiene fecha_inicio, ese va primero\n  1357→        if (a.fecha_inicio && !b.fecha_inicio) return -1;\n  1358→        if (!a.fecha_inicio && b.fecha_inicio) return 1;\n  1359→        // Si ninguno tiene fecha_inicio, mantener orden original\n  1360→        return 0;\n  1361→    });\n  1362→\n  1363→    return estudios_ordenados;\n  1364→}\n  1365→\n  1366→/**\n  1367→ * Ordena experiencias laborales por fecha: primero las que está trabajando actualmente (sin fecha_fin),\n  1368→ * luego por fecha_fin más reciente.\n  1369→ * Preserva los índices originales para permitir edición y eliminación correcta.\n  1370→ *\n  1371→ * @param {Array} experiencias - Array de objetos con experiencias laborales\n  1372→ * @returns {Array} Array de experiencias ordenadas con propiedad indice_original\n  1373→ * @author Jair Carvajal\n  1374→ */\n  1375→function ordenarExperienciasPorFecha(experiencias) {\n  1376→    // Mapear con índice original\n  1377→    let experiencias_con_indice = experiencias.map((experiencia, indice_original) => ({\n  1378→        ...experiencia,\n  1379→        indice_original: indice_original\n  1380→    }));\n  1381→\n  1382→    // Ordenar experiencias\n  1383→    let experiencias_ordenadas = experiencias_con_indice.sort((a, b) => {\n  1384→        // Si 'a' no tiene fecha_fin (trabaja actualmente), va primero\n  1385→        if (!a.fecha_fin && b.fecha_fin) return -1;\n  1386→        // Si 'b' no tiene fecha_fin (trabaja actualmente), va primero\n  1387→        if (a.fecha_fin && !b.fecha_fin) return 1;\n  1388→        // Si ambos están trabajando actualmente (sin fecha_fin), mantener el orden actual\n  1389→        if (!a.fecha_fin && !b.fecha_fin) return 0;\n  1390→        // Si ambos tienen fecha_fin, ordenar por fecha más reciente primero (descendente)\n  1391→        return moment(b.fecha_fin).diff(moment(a.fecha_fin));\n  1392→    });\n  1393→\n  1394→    return experiencias_ordenadas;\n  1395→}\n  1396→\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"215c5896-54b3-48f8-a63a-583b911b4c5f","timestamp":"2026-01-21T15:52:12.597Z","toolUseResult":{"type":"text","file":{"filePath":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\globales.js","content":"// Mensajes en español para el plugin Select2\nconst mensajes_select2 = {\n    'noResults'              : () => { return 'No hay resultados para la búsqueda.'; },\n    'searching'              : () => { return 'Buscando...'; },\n    'Loading'                : () => { return 'Cargando...'; },\n    'loadingMore'            : () => { return 'Cargando más resultados...'; },\n    'dropdownFooter'         : (texto) => { return `Mostrando ${texto} resultados`; },\n    'emptyOptions'           : () => { return 'No hay opciones disponibles.'; },\n    'appendItems'            : (items) => { return `Agregando ${items.length} elementos.`; },\n    'maximumSelectionReached': () => { return 'Se ha alcanzado el número máximo de selecciones.'; },\n    'selectOnClose'          : () => { return 'Seleccione una opción al cerrar el menú.'; },\n    'escapeKeyUp'            : () => { return 'Presione \\'Escape\\' para cerrar el menú.'; },\n    'errorLoading'           : () => { return 'Error al cargar datos. Inténtalo de nuevo más tarde.'; },\n    'inputTooShort'          : (elemento) => { return `Ingresa al menos ${elemento.minimum} caracteres para iniciar una búsqueda.`; },\n    'noMatches'              : () => { return 'No se encontraron coincidencias para tu búsqueda.'; },\n    'allowClear'             : () => { return 'Borrar selección'; },\n    'SelectionTooLong'       : (conteo, maximo) => { return `Solo puedes seleccionar ${maximo} opciones.`; },\n    'loadMore'               : () => { return 'Cargando más resultados...'; },\n    'removing'               : (seleccion) => { return 'Eliminando...'; },\n    'matches'                : (coincidencias, total) => {\n        if (coincidencias === 0) {\n            return 'No hay coincidencias.';\n        } else if (coincidencias === 1) {\n            return 'Se encontró 1 coincidencia.';\n        } else {\n            return `Se encontraron ${coincidencias} coincidencias entre ${total}.`;\n        }\n    }\n};\n\n// audios\nvar audio_notificacion = new Audio('/audios/notificacion.mp3');\n\nlet mostro_modal_creditos_ia = false;\nlet funcion_ejecucion_ia = null;\nlet modals_abiertos_ia = null;\n\n/**\n * Mostrar modal de créditos IA\n * \n * @return void\n * @author José Manuel Jiménez\n */\nfunction mostrarModalCreditosIA(servicio_ia_id) {\n    $.ajax({\n        url: `/api/empresas/${$('#empresa_sesion_id').val()}/creditos`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta_empresa) {\n            if (respuesta_empresa?.data?.creditos_disponibles > 0) {\n                $.ajax({\n                    url: `/api/servicios-ia/${servicio_ia_id}/creditos`,\n                    method: 'GET',\n                    dataType: 'json',\n                    success: function(respuesta) {\n                        if (respuesta?.data?.consume_creditos && respuesta?.data?.consume_creditos <= respuesta_empresa.data.creditos_disponibles) {\n                            $('#cantidad-creditos-descontar-modal').text(respuesta.data.consume_creditos);\n                            $('#modal-consumo-creditos-ia').modal('show');\n                            mostro_modal_creditos_ia = true;\n                            modals_abiertos_ia = $('.modal.show').not('#modal-consumo-creditos-ia').not('#modal-generando-ia');\n                            $(modals_abiertos_ia).addClass('d-none');\n                        } else {\n                            mostrarToastSolicitarCreditosIA();\n                        }\n                    }\n                });\n            } else {\n                mostrarToastSolicitarCreditosIA();\n            }\n        }\n    });\n}\n\n/**\n * Mostrar toast para solicitar créditos IA\n * \n * @return void\n * @author José Manuel Jiménez\n */\nfunction mostrarToastSolicitarCreditosIA() {\n    $.ajax({\n        url: `/empresas/${$('#empresa_sesion_id').val()}`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            let adicional_toast = '';\n            if (respuesta?.data?.ejecutivo?.telefono) {\n                adicional_toast = `<a href=\"https://wa.me/${respuesta.data.ejecutivo.telefono.replace(/\\D/g, '')}?text=Hola,%20me%20gustar%C3%ADa%20solicitar%20cr%C3%A9ditos%20adicionales%20para%20mi%20empresa.\" target=\"_blank\">\n                    <p class=\"text-label-1 text-white no-visited text-decoration-none mb-0\">Solicitar</p>\n                </a>`;\n            }\n            setTimeout(() => {\n                $('#modal-generando-ia').modal('hide');\n                $('#modal-cargue-ia').modal('hide');\n                mostrarToast('danger', 'No cuentas con créditos. Solicita créditos adicionales.', '', adicional_toast);\n            }, 300);\n        }\n    });\n}\n\n/**\n * Continuar ejecución IA luego del modal de créditos\n * \n * @return void\n * @author José Manuel Jiménez\n */\nfunction continuarEjecucionIA() {\n    if (funcion_ejecucion_ia) {\n        funcion_ejecucion_ia();\n        funcion_ejecucion_ia = null;\n    }\n    mostro_modal_creditos_ia = false;\n    $('#modal-consumo-creditos-ia').modal('hide');\n}\n\n/**\n * Solicitar más créditos IA\n * \n * @return void\n * @author José Manuel Jiménez\n */\nfunction solicitarMasCreditosIA() {\n    $.ajax({\n        url: `/empresas/${$('#empresa_sesion_id').val()}`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            if (respuesta?.data?.ejecutivo?.telefono) {\n                window.open(`https://wa.me/${respuesta.data.ejecutivo.telefono.replace(/\\D/g, '')}?text=Hola,%20me%20gustar%C3%ADa%20solicitar%20cr%C3%A9ditos%20adicionales%20para%20mi%20empresa.`, '_blank');\n            } else {\n                mostrarToast('danger', 'No se encontró un ejecutivo asignado a la empresa. Por favor, comunícate con soporte para recargar créditos.');\n            }\n            $('#modal-solicitar-mas-creditos-ia').modal('hide');\n        }\n    });\n}\n\n/**\n * Validar respuesta de créditos IA\n * \n * @return void\n * @author José Manuel Jiménez\n */\nfunction validarRespuestaCreditosIA(error_ia) {\n    if (error_ia == 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.') {\n        mostrarToastSolicitarCreditosIA();\n        return true;\n    }\n    return false;\n}\n\n/**\n * Ajustar el ancho de los elementos select2 asincrono multiple.\n *\n * @returns {void}\n * @author Andres Morales\n */\n$(document).ready(function () {\n    cargarNotificiacionesHeader();\n    if (window.configuracion_reverbg && window.configuracion_reverbg.activar_websocket) {\n        configurarWebSocketNotificaciones();\n    }\n    setTimeout(() => {\n        $(\".input-container\").each(function () {\n            let $container = $(this);\n            let $select = $container.find(\"select[multiple]\");\n            let $icon = $container.find(\".input-icono1\");\n            if ($select.length && $icon.length) {\n                $(this).find('.select2-selection--multiple').addClass('ps-5')\n            }\n        });\n    }, 1000);\n    $('#modal-consumo-creditos-ia').on('hidden.bs.modal', function () {\n        if (mostro_modal_creditos_ia) {\n            $(modals_abiertos_ia).removeClass('d-none');\n        }\n        mostro_modal_creditos_ia = false;\n    });\n});\n\n/**\n * Formatear fecha a formato dd/mm/yyyy - hh:mm AM/PM.  Ejemplo: 01/Feb/2022 - 12:00 PM\n *\n * @param {string} fecha_entrada fecha en formato ISO\n * @returns {string} fecha y hora formateada\n * @author Andres Morales\n */\nfunction formatearFecha(fecha_entrada) {\n    var fecha = new Date(fecha_entrada);\n    var dia = fecha.getDate();\n    var mes = fecha.toLocaleString('es-ES', { month: 'short' });\n    var anio = fecha.getFullYear();\n    let hora = fecha.getHours();\n    let minuto = fecha.getMinutes();\n    let ampm = hora >= 12 ? 'PM' : 'AM';\n    hora = hora % 12 || 12;\n    minuto = minuto.toString().padStart(2, '0');\n    return `${dia}/${mes}/${anio} - ${hora}:${minuto} ${ampm}`;\n}\n\nfunction formatearFecha2(fecha_entrada) {\n    let partes = fecha_entrada.split(' ');\n    let fecha = partes[0].split('-');\n    let hora = partes[1];\n    let fechaISO = `${fecha[2]}-${fecha[1]}-${fecha[0]}T${hora}`;\n\n    let date = new Date(fechaISO);\n\n    if (isNaN(date.getTime())) {\n        return 'Fecha inválida';\n    }\n\n    let dia = date.getDate();\n    let mes = date.toLocaleString('eu-EU', { month: 'short' });\n    let anio = date.getFullYear();\n    return `${dia}/${mes}/${anio}`;\n}\n\n/**\n * Opción para contraer o agrandar el menú principal\n *\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Andres Morales\n */\nfunction contraerMenu() {\n    if ($('.sidebar-menu').hasClass('close')) {\n        $('.sidebar-menu').removeClass('d-none');\n        localStorage.setItem('opcion_menu_storage', 'abierto');\n        $('#btn-collapse').attr('data-bs-original-title', 'Contraer');\n        $('#btn-collapse').attr('data-bs-title', 'Contraer');\n        $(\".menu-bar\").each(function() {\n            $(this).removeClass(\"px-2\").addClass(\"px-5\");\n        });\n        $('[data-bs-toggle=\"tooltip\"]').each(function () { new bootstrap.Tooltip(this); });\n        $('.lista-primary[data-bs-toggle=\"tooltip\"]').each(function () {\n            var tooltip_instancia = bootstrap.Tooltip.getInstance(this);\n            if (tooltip_instancia) {\n                tooltip_instancia.dispose();\n            }\n        });\n    } else {\n        $('.sidebar-menu').addClass('d-none');\n        localStorage.setItem('opcion_menu_storage', 'cerrado');\n        $('#btn-collapse').attr('data-bs-original-title', 'Expandir');\n        $('#btn-collapse').attr('data-bs-title', 'Expandir');\n        $(\".menu-bar\").each(function() {\n            $(this).removeClass(\"px-5\").addClass(\"px-2\");\n        });\n        $('[data-bs-toggle=\"tooltip\"]').each(function () { new bootstrap.Tooltip(this); });\n    }\n    $('.tooltip.bs-tooltip-auto').remove();\n    $('.sidebar-menu').toggleClass('close');\n    $('.contenedor-vista').toggleClass('close');\n    $('#btn-collapse').toggleClass('close');\n    $('.nombre-usuario-empresa').toggle();\n    $('.menu-bar .text-menu').toggle();\n}\n\n/**\n * Opción para abrir o cerrar el menu segun la elección guardada\n *\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Andres Morales\n */\nfunction mostrarMenuStorage() {\n    $(document).ready(function() {\n        $('.lista-primary[data-bs-toggle=\"tooltip\"]').each(function () {\n            var tooltip_instancia = bootstrap.Tooltip.getInstance(this);\n            if (tooltip_instancia) {\n                tooltip_instancia.dispose();\n            }\n        });\n\n        if (window.innerWidth < 768) {\n            localStorage.setItem('opcion_menu_storage', 'cerrado');\n        }\n\n        if (localStorage.getItem('opcion_menu_storage') === 'cerrado') {\n            contraerMenu();\n        }\n        let $active = $('.menu-bar .active');\n\n        if ($active.length) {\n            $('.menu-bar').scrollTop($active.position().top);\n        }\n    });\n}\nmostrarMenuStorage();\n\n/**\n * Funcion para hacer el slug de un texto desde jquery.\n *\n * @returns {void}\n * @author Andres Morales\n */\nfunction slugify(text) {\n    return $.trim(text)\n        .toLowerCase()\n        .normalize(\"NFD\")\n        .replace(/[\\u0300-\\u036f]/g, \"\")\n        .replace(/[^a-z0-9 -]/g, \"\")\n        .replace(/\\s+/g, \"-\")\n        .replace(/-+/g, \"-\");\n}\n\n/**\n * Función generica para mostrar mensajes de respuesta\n *\n * @param {string} tipo_alerta define el color de la alerta segun alerts de botstrap.\n * @param {string} texto_1 Texto que mostrara la alerta.\n * @param {string} texto_2 Texto secundario en la alerta.\n * @param {string} accion Acción adicional(por definir).\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Andres Gonzalez\n */\nfunction mostrarToast(tipo_alerta, texto_1, texto_2 = '', accion = '', icono2 = '') {\n    let icono = '';\n    let texto_color = 'text-white';\n    if (accion != '') {\n        accion = `<div class=\"col-auto p-0 text-label-1\">${accion}</div>`;\n    }\n\n    if (tipo_alerta == 'success') {\n        icono = 'bi bi-check-circle';\n    }\n\n    if (tipo_alerta == 'neutral') {\n        icono = 'bi bi-info-circle';\n    }\n\n    if (tipo_alerta == 'warning') {\n        icono = 'bi bi-info-circle';\n        texto_color = \"text-red-letras\";\n    }\n\n    if (tipo_alerta == 'danger') {\n        icono = 'bi bi-x-circle';\n    }\n\n    if (icono2 != '') {\n        icono = icono2;\n    }\n\n    if (texto_2 != '') {\n        texto_2 = `<div class=\"col-12 p-0 text-label-1 ${texto_color}\">${texto_2}</div>`;\n    }\n\n    let alert_toast = $(`\n        <div class=\"alert toast-${tipo_alerta} alert-dismissible fade show d-flex align-items-center pe-3 py-3 me-3\" role=\"alert\" style=\"display:none\">\n            <div class=\"col-auto\">\n                <span class=\"${icono} ${texto_color}\"></span>\n            </div>\n            <div class=\"col px-3\">\n                <div class=\"row m-0 ${texto_color}\">\n                    <div class=\"col-12 p-0 text-label-1 ${texto_color}\">\n                        ${texto_1}\n                    </div>\n                    ${texto_2}\n                </div>\n            </div>\n            ${accion}\n            <div class=\"col-auto ms-3 pointer\" data-bs-dismiss=\"alert\">\n                <span class=\"bi bi-x ${texto_color}\"></span>\n            </div>\n        </div>\n    `);\n    $('#contenedor-alert-toast').append(alert_toast);\n    alert_toast.fadeIn();\n    setTimeout(function() {\n        alert_toast.fadeOut();\n        alert_toast.alert('close');\n    }, 5000);\n}\n\n/**\n * Formatear número.\n *\n * @param {number} numero número a formatear\n * @author Andres Morales\n */\nfunction formatearNumero(numero) {\n    return parseInt(numero).toLocaleString('es-ES');\n}\n\n/**\n * Formatear fecha.\n *\n * @param {*} fecha Fecha a formatear.\n * @param {boolean} incluir_segundos Indica si se debe incluir los segundos en la hora.\n * @param {string} formato Formato en el que se retornará la fecha.\n * @param {string} separador Símbolo que se usará para separar días, meses y años.\n * @returns {Object} Objeto con la fecha y hora formateada.\n * @author Daniel Beltrán\n */\nfunction formatearFechaConceptual(fecha, incluir_segundos = false, formato = 'Ymd', separador = '-') {\n    const NUEVA_FECHA = new Date(fecha);\n    const ANO         = NUEVA_FECHA.getFullYear();\n    const MES         = String(NUEVA_FECHA.getMonth() + 1).padStart(2, '0');\n    const DIA         = String(NUEVA_FECHA.getDate()).padStart(2, '0');\n    const HORAS       = String(NUEVA_FECHA.getHours()).padStart(2, '0');\n    const MINUTOS     = String(NUEVA_FECHA.getMinutes()).padStart(2, '0');\n    const SEGUNDOS    = String(NUEVA_FECHA.getSeconds()).padStart(2, '0');\n\n    let fecha_formateada = `${ANO}${separador}${MES}${separador}${DIA}`;\n\n    if (formato === 'dmY') {\n        fecha_formateada = `${DIA}${separador}${MES}${separador}${ANO}`;\n    }\n\n    return {\n        fecha: fecha_formateada,\n        hora : incluir_segundos ? `${HORAS}:${MINUTOS}:${SEGUNDOS}` : `${HORAS}:${MINUTOS}`\n    };\n}\n\n/**\n * Formatear fecha a May. 2023.\n *\n * @param {string} fechaISO Fecha a formatear.\n * @returns {string} Objeto con la fecha y hora formateada.\n * @author Andres Morales\n */\nfunction formatearFechaAnioMes(fechaISO) {\n    const fecha = new Date(fechaISO);\n    const opciones = { month: 'short', year: 'numeric' };\n    let fecha_formateada = fecha.toLocaleDateString('es-ES', opciones);\n\n    fecha_formateada = fecha_formateada.replace(\n        /^([a-zñ]+)(\\s\\d{4})$/,\n        (_, mes, anio) => `${mes.charAt(0).toUpperCase() + mes.slice(1)}. ${anio.trim()}`\n    );\n\n    return fecha_formateada;\n}\n\n/**\n * Formatear un numero a moneda.\n *\n * @param {string} valor Numero.\n * @returns {string} Numero formateado.\n * @author Andres Morales\n */\nfunction formatearMonedaCOP(valor) {\n    return new Intl.NumberFormat('es-CO', {\n        style: 'currency',\n        currency: 'COP',\n        minimumFractionDigits: 0,\n        maximumFractionDigits: 0\n    }).format(valor);\n}\n\n/**\n * Formatear fecha a un formato d/m/Y hh:mm:ss entendible para el usuario.\n *\n * @param {*} fecha_inicial Fecha a formatear.\n * @returns {String} String con la fecha y hora formateada.\n * @author José Manuel Jiménez\n */\nfunction fechaMostrar(fecha_inicial) {\n    if (!fecha_inicial) {\n        return \"\";\n    }\n    const fecha = new Date(fecha_inicial);\n    if (isNaN(fecha.getTime())) {\n        return \"\";\n    }\n    const dia = String(fecha.getUTCDate()).padStart(2, '0');\n    const mes = String(fecha.getUTCMonth() + 1).padStart(2, '0');\n    const anio = fecha.getUTCFullYear();\n    if (!fecha_inicial.includes(\" \")) {\n        return `${dia}/${mes}/${anio}`;\n    }\n    const horas = String(fecha.getUTCHours()).padStart(2, '0');\n    const minutos = String(fecha.getUTCMinutes()).padStart(2, '0');\n    const segundos = String(fecha.getUTCSeconds()).padStart(2, '0');\n    return `${dia}/${mes}/${anio} ${horas}:${minutos}:${segundos}`;\n}\n\n/**\n * Descargar Excel.\n *\n * @param {string} ruta Ruta desde donde se descarga el archivo.\n * @param {string} nombre_archivo Nombre del archivo descargado.\n * @param {boolean} marca_tiempo Indica si el nombre del archivo debe llevar marca de tiempo.\n * @param {Object} parametros Parámetros a enviar en la petición.\n * @returns {void}\n * @author Daniel Beltrán\n */\nasync function descargarExcel(ruta, nombre_archivo, marca_tiempo = true, parametros = {}) {\n    parametros._token = $('meta[name=\"csrf-token\"]').attr('content');\n\n    await $.ajax({\n        type     : 'POST',\n        url      : `/${ruta}`,\n        data     : parametros,\n        xhrFields: {\n            responseType: 'blob'\n        },\n        success: function (respuesta) {\n            // Crear una URL para el Blob\n            let url = window.URL.createObjectURL(respuesta); // 'respuesta' es el Blob\n            let a   = document.createElement('a'); // Crea un nuevo elemento <a> para iniciar la descarga\n            a.href  = url;\n            const fecha_actual     = new Date();\n            const dia              = fecha_actual.getDate();\n            const mes              = fecha_actual.getMonth() + 1;\n            const ano              = fecha_actual.getFullYear();\n            const hora             = fecha_actual.getHours();\n            const minutos          = fecha_actual.getMinutes();\n            const segundos         = fecha_actual.getSeconds();\n            const fecha_formateada = `${dia}${mes}${ano}${hora}${minutos}${segundos}`;\n\n            a.download = marca_tiempo ? `${nombre_archivo}-${fecha_formateada}.xlsx` : `${nombre_archivo}.xlsx`;\n            document.body.appendChild(a);\n            a.click();\n            window.URL.revokeObjectURL(url);\n            document.body.removeChild(a);\n        }\n    }).then(() => {\n        mostrarToast('success', 'Archivo descargado correctamente.');\n    }).catch((error) => {\n        mostrarToast('danger', 'Ocurrió un error al descargar el archivo.');\n    });\n}\n\n/**\n * Convierte un string a slug.\n *\n * @param {string} str\n * @returns {string}\n * @author Fahibram Cárcamo\n */\nfunction slug(str) {\n\n    // Quita espacios en blanco\n    str = str.replace(/^\\s+|\\s+$/g, \"\")\n\n    // Convierte el string a minusculas\n    str = str.toLowerCase()\n\n    // Quita los caracteres no alfanuméricos\n    str = str.replace(/[^a-z0-9 -]/g, \"\")\n\n    // Reemplaza los espacio con guiones\n    str = str.replace(/\\s+/g, \"-\")\n\n    // Remueve los guiones consecutivos\n    str = str.replace(/-+/g, \"-\")\n\n    return str\n}\n\n/**\n * Compara los elementos de dos arreglos y retorna `true` si son iguales y `false` en caso contrario\n * (Este función está pensada para comparar arreglos unidimensionales).\n *\n * @param {array} primer_arreglo\n * @param {array} segundo_arreglo\n * @param {boolean} comparar_orden\n * @return {boolean}\n * @author Fahibram Cárcamo\n */\nfunction sonArreglosIguales(primer_arreglo, segundo_arreglo, comparar_orden = false) {\n\n    if (!comparar_orden) {\n        primer_arreglo.sort()\n        segundo_arreglo.sort()\n    }\n\n    if (primer_arreglo.length !== segundo_arreglo.length) return false\n\n    for (let i = 0; i < primer_arreglo.length; i++) {\n        if (primer_arreglo[i] !== segundo_arreglo[i]) return false\n    }\n\n    return true\n}\n\n/**\n * Función para cambiar de empresa.\n *\n * @param {number} empresa_id ID de la empresa a la que se va a cambiar.\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Daniel Beltrán\n */\nfunction cambiarEmpresa(empresa_id) {\n    $.ajax({\n        type: 'POST',\n        url: '/suplantar-rol-admin-general',\n        data: {\n            _token    : $('meta[name=\"csrf-token\"]').attr('content'),\n            empresa_id: empresa_id\n        },\n        success: function (respuesta) {\n            localStorage.setItem('notificacionToast', JSON.stringify({\n                tipo_alerta: 'success',\n                texto_1    : 'Cambio de empresa exitoso'\n            }));\n\n            window.location.reload();\n        },\n        error: function (error) {\n            mostrarToast('danger', 'Ocurrió un error al cambiar de empresa');\n        }\n    });\n}\n\n/**\n * Enviar la solucitud de suplantación de rol y empresa al Back-end.\n *\n * @param {function|null} callback_exito Callback ejecutado en caso de éxito.\n * @param {string} url URL de suplantación.\n * @param {string} _token Token CSRF del formulario.\n * @param {number} empresa_id Id de la empresa a suplantar.\n * @param {number|null} rol_id Id del rol a suplantar.\n * @param {function|null} callback_error Callback ejecutado en caso de error.\n * @returns {void}\n * @author Fahibram Cárcamo\n */\nasync function enviarOrdenSuplantacionRolEmpresa (callback_exito, url, _token, empresa_id = null, rol_id = null, callback_error = null) {\n\n    let condicion_suplantacion = rol_id === null\n        ? empresa_id === null\n            ? true\n            : parseInt($('#empresa_sesion_id').val()) !== parseInt(empresa_id)\n        : parseInt($('#rol_sesion_id').val()) !== parseInt(rol_id) && parseInt($('#empresa_sesion_id').val()) !== parseInt(empresa_id);\n\n    if (condicion_suplantacion) {\n        let data = { _token };\n        if (empresa_id !== null) data.empresa_id = empresa_id;\n        if (rol_id !== null) data.rol_id = rol_id;\n\n        await $.ajax({ type: 'POST', url, data })\n            .then((respuesta, status, xhr) => {\n                if (xhr.status >= 200 && xhr.status < 300 && callback_exito !== null) callback_exito();\n            })\n            .catch(error => {\n                let swal_titulo, swal_texto;\n\n                if (error.status === 404) {\n                    if (error.responseJSON.mensaje) {\n                        swal_titulo = 'Algo salió mal';\n                        if (error.responseJSON.mensaje === 'no existe rol_suplantar') {\n                            swal_texto = 'El rol no existe.';\n                        } else if (error.responseJSON.mensaje === 'no existe empresa_suplantar') {\n                            swal_texto = 'La empresa no existe.';\n                        } else if (error.responseJSON.mensaje === 'no existe usuario_suplantar') {\n                            swal_texto = 'El usuario no existe.';\n                        } else {\n                            swal_texto = '';\n                        }\n                    } else if (error.responseJSON.empresa && error.responseJSON.rol) {\n                        swal_titulo = 'No fué posible cambiar de empresa';\n                        swal_texto = error.responseJSON.rol === 'Administrador general' || error.responseJSON.rol === 'Propietario'\n                            ? `La empresa ${error.responseJSON.empresa} no tiene ningún usuario con el rol Administrador general o Propietario.`\n                            : `La empresa ${error.responseJSON.empresa} no tiene ningún usuario con el rol ${error.responseJSON.rol}.`;\n                    } else {\n                        swal_titulo = 'Algo salió mal';\n                        swal_texto = error.responseJSON.errors;\n                    }\n                } else {\n                    swal_titulo = 'Algo salió mal';\n                    swal_texto = '';\n                }\n\n                if (callback_error !== null) callback_error();\n\n                Swal.fire({\n                    title: swal_titulo,\n                    text: swal_texto,\n                    icon: \"error\",\n                    confirmButtonText: \"Aceptar\"\n                });\n            });\n    }\n}\n\n/**\n * Mostrar tooltip según el div que lo contenga.\n *\n * @param {div} div Elemento en donde se va a mostrar el tooltip.\n * @returns {void}\n * @author Sol Espitia\n */\nfunction mostrarTooltip(div) {\n    const TOOLTIP         = div.querySelector('.tooltip-x');\n    TOOLTIP.style.display = 'block';\n}\n\n/**\n * Ocultar tooltip según el div que lo contenga.\n *\n * @param {div} div Elemento en donde se va a mostrar el tooltip.\n * @returns {void}\n * @author Sol Espitia\n */\nfunction ocultarTooltip(div) {\n    const TOOLTIP         = div.querySelector('.tooltip-x');\n    TOOLTIP.style.display = 'none';\n}\n\n/**\n * Retornar la diferencia en días de dos fechas dadas.\n *\n * @param {string} fecha_inicial Fecha inicial\n * @param {string} fecha_final Fecha final\n * @param {bool} valor_absoluto Retorna la diferencia en valor absoluto\n * @returns {number}\n * @author Fahibram Cárcamo\n * @author Andres Morales\n */\nfunction diferenciaFechasDias(fecha_inicial, fecha_final, valor_absoluto = false, sumar_dia = true) {\n    let fecha1 = new Date(fecha_inicial);\n    let fecha2 = new Date(fecha_final);\n\n    fecha1.setHours(0, 0, 0, 0);\n    fecha2.setHours(0, 0, 0, 0);\n\n    let diferencia_milisegundos = fecha2.getTime() - fecha1.getTime();\n\n    let diferencia_dias = diferencia_milisegundos / (1000 * 60 * 60 * 24);\n    let resultado = diferencia_dias;\n    if (sumar_dia) {\n        resultado = diferencia_dias + 1;\n    }\n\n    return valor_absoluto ? Math.abs(resultado) : resultado;\n}\n\n/**\n * Retornar `true` si una fecha dada está dentro de un rango de fechas dadas, `false` en otro caso.\n *\n * @param {string} fecha Fecha dada\n * @param {string} fecha_desde Fecha inicial del rango\n * @param {string} fecha_hasta Fecha final del rango\n * @returns {boolean}\n * @author Fahibram Cárcamo\n */\nfunction fechaDentroDelRango(fecha, fecha_desde, fecha_hasta) {\n    fecha = new Date(fecha);\n    fecha_desde = new Date(fecha_desde);\n    fecha_hasta = new Date(fecha_hasta);\n\n    if (isNaN(fecha) || isNaN(fecha_desde) || isNaN(fecha_hasta)) {\n        throw new Error('Una o más fechas no son válidas.');\n    }\n\n    return fecha >= fecha_desde && fecha <= fecha_hasta;\n}\n\n/**\n * Descuenta el tiempo para las respuestas.\n *\n * @param id - ID del elemento HTML donde mostrar el tiempo\n * @param tiempo - Tiempo inicial en segundos\n * @author Jair Carvajal\n */\nvar tiempos_usados = {};\n\nfunction descuentoTiempo(id, tiempo, callback, onTick) {\n    var $elemento = $('#' + id);\n    if ($elemento.length === 0) {\n        console.error('Elemento con id \"' + id + '\" no encontrado.');\n        return;\n    }\n    if (tiempos_usados[id]) {\n        clearInterval(tiempos_usados[id]);\n    }\n    let tiempoTotal = tiempo;\n    tiempos_usados[id] = setInterval(function() {\n        if (tiempo <= 0) {\n            clearInterval(tiempos_usados[id]);\n            delete tiempos_usados[id];\n            $elemento.text('Tiempo finalizado');\n            if (window.tiempoFinalizado()) {\n                tiempoFinalizado();\n            }\n            if (typeof callback === 'function') {\n                callback();\n            }\n            return;\n        }\n\n        var minutos = Math.floor(tiempo / 60);\n        var segundos = tiempo % 60;\n\n        var textoTiempo = minutos + ':' + (segundos < 10 ? '0' : '') + segundos + '<i class=\"bi bi-alarm ms-2\"></i>';\n\n        if (tiempo <= 15) {\n            $elemento.addClass('text-state-red');\n            $elemento.removeClass('text-state-green');\n        } else {\n            $elemento.addClass('text-state-green');\n            $elemento.removeClass('text-state-red');\n        }\n\n        $elemento.html(textoTiempo);\n\n        var tiempoUsado = tiempoTotal - tiempo;\n\n        if (typeof onTick === 'function') {\n            onTick((tiempoUsado % 5));\n        }\n        tiempo--;\n    }, 1000);\n}\n\n/**\n * Detengo el tiempo para las respuestas.\n *\n * @param id - ID del elemento HTML donde mostrar el tiempo\n * @param tiempo - Tiempo inicial en segundos\n * @author Jair Carvajal\n */\nfunction detenerDescuentoTiempo(id) {\n    if (tiempos_usados[id]) {\n        clearInterval(tiempos_usados[id]);\n        delete tiempos_usados[id];\n    }\n}\n\n/**\n * Genera un SVG de la imagen de usuario.\n *\n * @param id ID del usuario.\n * @param nombres Nombres del usuario.\n * @param apellidos Apellidos del usuario.\n * @return image\n * @author Andres Morales\n */\nfunction crearImagenUsuarioLetras(id, nombres, apellidos) {\n    var tamano = 200;\n    var iniciales = (nombres[0] + apellidos[0]).toUpperCase();\n    var hash = md5(id);\n\n    var r = parseInt(hash.substring(0, 2), 16);\n    var g = parseInt(hash.substring(2, 4), 16);\n    var b = parseInt(hash.substring(4, 6), 16);\n    var colorFondo = `rgb(${r},${g},${b})`;\n\n    var luminancia = 0.299 * r + 0.587 * g + 0.114 * b;\n    var colorTexto = luminancia > 150 ? \"#000000\" : \"#FFFFFF\";\n\n    // SVG como texto\n    var svg = `\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${tamano}\" height=\"${tamano}\">\n        <rect width=\"100%\" height=\"100%\" fill=\"${colorFondo}\" />\n        <text x=\"50%\" y=\"50%\" dy=\".35em\"\n            text-anchor=\"middle\"\n            font-family=\"Lato, sans-serif\"\n            font-size=\"${tamano * 0.4}\"\n            fill=\"${colorTexto}\">\n            ${iniciales}\n        </text>\n    </svg>`;\n    var svgEncoded = encodeURIComponent(svg)\n        .replace(/'/g, \"%27\")\n        .replace(/\"/g, \"%22\");\n\n    var dataUri = `data:image/svg+xml,${svgEncoded}`;\n    return dataUri;\n}\n\n/**\n * Carga las notificaciones\n *\n * @return void\n * @author Andres Morales\n * @author Andres Gonzalez\n * @author Esperanza Olivo\n */\nfunction cargarNotificiacionesHeader() {\n    $.ajax({\n        url: '/usuario-notificaciones',\n        type: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            let datos = respuesta.data;\n            let notificaciones_noleidas = datos?.unread_notifications?.length ?? 0;\n\n            // Siempre remover el badge existente\n            $('#dropdownNotificaciones #badge-notificaciones').remove();\n\n            // Solo agregar el badge si hay notificaciones no leídas\n            if (notificaciones_noleidas > 0) {\n                $('#dropdownNotificaciones').append(`<span id=\"badge-notificaciones\" class=\"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger border border-white\">${notificaciones_noleidas}</span>`);\n                $('#contador-notificaciones-abierto').append(`<span id=\"badge-notificaciones\" class=\"badge rounded-pill bg-danger border border-white\">${notificaciones_noleidas}</span>`);\n\n                $('#contenedor-boton-marcar-todas').html(`\n                    <button class=\"btn btn-link text-primary w-100 d-flex justify-content-center\" onclick=\"marcarNotificacionesLeidas('all')\">\n                        Marcar todo como leído\n                    </button>\n                `);\n            }\n\n            let no_leidos_ids = Array.isArray(datos?.unread_notifications) ? datos.unread_notifications.map(notificacion => notificacion.id): [];\n\n            if (Array.isArray(datos?.notifications) && datos.notifications.length > 0) {\n                $('#notificacion-sinnotificaciones').hide();\n                $('.notificaciones-listado').remove();\n                datos.notifications.forEach(notificacion => {\n                    const { id, data, updated_at } = notificacion;\n\n                    const NO_LEIDO = no_leidos_ids.includes(id);\n                    const MENSAJE = (data?.mensaje || '').slice(0, 120) + '...';\n                    const HORA = new Date(updated_at).toLocaleTimeString('es-CO', {\n                        hour: '2-digit',\n                        minute: '2-digit',\n                        hour12: false\n                    });\n\n                    const notificaciones = `\n                        <li class=\"${NO_LEIDO ? '' : 'bg-gray-90'} notificaciones-listado py-0\" id=\"notificacion-${id}\">\n                            <a class=\"dropdown-item text-gray-10 text-decoration-none border-top pt-0 pb-1\" href=\"javascript:void(0)\" onclick=\"marcarNotificacionesLeidas('${id}','${data?.ruta}')\">\n                                <div class=\"d-flex justify-content-between\">\n                                    <div class=\"w-auto flex-grow-1 pe-3\">\n                                        <p class=\"mt-1 mb-0 text-headline-6 text-gray-10\">${data?.titulo}</p>\n                                        <p class=\"mb-0 text-body-3 text-gray-30 notificacion-mensaje\">${MENSAJE}</p>\n                                    </div>\n                                    <div class=\"w-auto my-auto ${NO_LEIDO ? 'text-cta-azul' : 'text-gray-10'} text-label-2 flex-shrink-0\">\n                                        ${HORA}${NO_LEIDO ? `<i class=\"bi bi-circle-fill text-cta-azul my-auto texto-notificacion-icono ms-3\"></i>` : ''}\n                                    </div>\n                                </div>\n                            </a>\n                        </li>\n                    `;\n\n                    $(notificaciones).insertBefore('#contenedor-boton-marcar-todas');\n                });\n\n            } else {\n                $('#notificacion-sinnotificaciones').hide();\n                $('.notificaciones-listado').remove();\n            }\n\n        },\n        error: function(xhr, status, error) {\n            console.error('Error al cargar notificaciones:', error);\n        }\n    });\n}\n\n/**\n * Marcar las notificaciones leídas.\n *\n * @param {array} notificaciones_ids ids de las notificaciones\n * @param {string} ruta_destino ruta donde se va ha actualizar la pagina\n * @returns {void}\n * @author Andres Gonzalez\n * @author Esperanza Olivo\n */\nfunction marcarNotificacionesLeidas(notificaciones_ids = null, ruta_destino = null, soporte_id = null) {\n\n    let data = {\n        _token: $('meta[name=\"csrf-token\"]').attr('content')\n    };\n\n    if (notificaciones_ids === 'all') {\n        data.marcar_todo = true;\n    } else if (soporte_id) {\n        data.soporte_id = soporte_id;\n    } else if (notificaciones_ids) {\n        data.notificaciones_ids = Array.isArray(notificaciones_ids)\n            ? notificaciones_ids\n            : [notificaciones_ids];\n    }\n\n    $.ajax({\n        url: '/usuario-marcar-notificaciones-leidas',\n        type: 'POST',\n        data: data,\n        success: function(respuesta) {\n            cargarNotificiacionesHeader();\n\n            if (notificaciones_ids && notificaciones_ids !== 'all' && ruta_destino) {\n                window.location.href = \"/\" + ruta_destino;\n            }\n\n            if (notificaciones_ids === 'all') {\n                $('#badge-notificaciones').remove();\n                $('#contenedor-boton-marcar-todas').empty();\n                $('.notificaciones-listado').addClass('bg-gray-90');\n                $('.bi-circle-fill').remove();\n            }\n        },\n        error: function(xhr, estatus, error) {\n            console.error('Error al cargar notificaciones:', error);\n        }\n    });\n}\n\n/**\n * Configurar WebSocket para notificaciones en tiempo real\n *\n * @return void\n * @author Andres Gonzalez\n */\nfunction configurarWebSocketNotificaciones() {\n    try {\n        if (!window.configuracion_reverbg) {\n            return;\n        }\n\n        const PUSHER = new Pusher(window.configuracion_reverbg.appKey, {\n            wsHost: window.configuracion_reverbg.host,\n            wsPort: window.configuracion_reverbg.port,\n            wssPort: window.configuracion_reverbg.port,\n            cluster: 'mt1',\n            forceTLS: false,\n            enabledTransports: ['ws', 'wss'],\n            authEndpoint: '/broadcasting-auth',\n            auth: {\n                headers: {\n                    'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\n                }\n            }\n        });\n\n        PUSHER.connection.bind('failed', function() {\n            console.error('❌ Conexión WebSocket falló');\n        });\n\n        PUSHER.connection.bind('error', function(error) {\n            console.error('❌ Error de WebSocket:', error);\n        });\n\n        let usuario_id = window.configuracion_reverbg.usuario_id;\n\n        if (!usuario_id) {\n            return;\n        }\n\n        const NOMBRE_CANAL = `private-App.Models.Usuarios.User.${usuario_id}`;\n        const CANAL = PUSHER.subscribe(NOMBRE_CANAL);\n\n        CANAL.bind('pusher:subscription_error', function(error) {\n            console.error('❌ Error al suscribirse al canal:', error);\n        });\n\n        // Escuchar eventos específicos de notificaciones\n        CANAL.bind('Illuminate\\\\Notifications\\\\Events\\\\BroadcastNotificationCreated', function(data) {\n            if (data.tipo === 'nueva_notificacion') {\n                audio_notificacion.play();\n                cargarNotificiacionesHeader();\n            }\n\n            if (data.tipo === 'nuevo_mensaje') {\n                if (($('#soporte-guardado-id').val() == data.soporte_id) || ($('#soporte_empresa_id').val() == data.soporte_id)) {\n                    audio_notificacion.play();\n                    consultarChat(data.soporte_id);\n                }\n            }\n        });\n    } catch (error) {\n        console.error('💥 Error en configurarWebSocketNotificaciones:', error);\n        console.error('Stack trace:', error.stack);\n    }\n}\n\n/**\n * Retornar el string entrante en formato title case.\n *\n * @param {string} texto\n * @returns {string}\n * @author Fahibram Cárcamo\n */\nfunction titleCase(texto) {\n    return texto.toLowerCase().replace(/\\b\\w/g, caracter => caracter.toUpperCase());\n}\n\n/**\n * Número de horas que durará el almacenamiento de la variable `ulitmas_empresas` en el\n * almacenamiento local **LocalStorage**.\n *\n * @var {number}\n * @author Fahibram Cárcamo\n */\nconst CANTIDAD_HORAS_VENCIMIENTO_ULTIMAS_EMPRESAS_LOCALSTORAGE = 6;\n\n/**\n * Validar si ya debe removerse la variable `ultimas_empresas` del alamacenamiento local\n * **LocalStorage**, si no es tiempo de eliminarla entonces se reinicia el tiempo de vigencia de la\n * variable.\n *\n * @returns {void}\n * @author Fahibram Cárcamo\n */\nfunction validarYActualizarUltimasEmpresasLocalStorage() {\n    let fecha_hora_actuales = moment();\n    let fecha_hora_vencimiento_ultimas_empresas = fecha_hora_actuales.clone().add(CANTIDAD_HORAS_VENCIMIENTO_ULTIMAS_EMPRESAS_LOCALSTORAGE, 'hours');\n    let fecha_hora_vencimiento_ultimas_empresas_localstorage = localStorage.getItem('vencimiento_ultimas_empresas');\n    let ultimas_empresas = localStorage.getItem('ultimas_empresas');\n\n    if (\n        ultimas_empresas != null &&\n        fecha_hora_vencimiento_ultimas_empresas_localstorage != null &&\n        fecha_hora_actuales.clone().isBefore(moment(fecha_hora_vencimiento_ultimas_empresas_localstorage).clone())\n    ) {\n        localStorage.setItem('vencimiento_ultimas_empresas', fecha_hora_vencimiento_ultimas_empresas.format('YYYY-MM-DD HH:mm:ss'));\n        return;\n    }\n\n    localStorage.removeItem('vencimiento_ultimas_empresas');\n    localStorage.removeItem('ultimas_empresas');\n}\n\n/**\n * Obtener la edad actual de un usuario según su fecha de nacimiento.\n *\n * @param {string} fecha_nacimiento\n * @returns {string}\n * @author José Manuel Jiménez\n * @author Fahibram Cárcamo\n * @author Andres Morales\n */\nfunction obtenerEdad(fecha_nacimiento) {\n    if (!fecha_nacimiento) return \"N/A\";\n    let hoy = new Date();\n    let nacimiento = new Date(fecha_nacimiento);\n    let edad = hoy.getFullYear() - nacimiento.getFullYear();\n    let mes = hoy.getMonth() - nacimiento.getMonth();\n    if (mes < 0 || (mes === 0 && hoy.getDate() < nacimiento.getDate())) edad--;\n    return edad + \" años\";\n}\n\n/**\n * Restablecer un input de tipo file.\n *\n * @param {html} elemento_input_html Elemento input html.\n * @param {html} label_elemento_input_html Label del elemento input html.\n * @param {html} boton_eliminar_elemento_input_html Botón para eliminar archivo del elemento input html.\n * @author Fahibram Cárcamo\n */\nfunction reiniciarCampoArchivo(elemento_input_html, label_elemento_input_html, boton_eliminar_elemento_input_html) {\n    elemento_input_html.val('');\n    elemento_input_html.removeAttr('data-base64');\n    label_elemento_input_html.text('Ningún archivo seleccionado');\n    boton_eliminar_elemento_input_html.hide();\n\n    if (elemento_input_html.data('imagen')) {\n        $('#' + elemento_input_html.data('imagen')).val('');\n        $('#' + elemento_input_html.data('imagen') + '_previsualizacion').attr('src', '');\n        $('#' + elemento_input_html.data('imagen') + '_fondo_previsualizacion').removeClass('d-none');\n    }\n}\n\n/**\n * Definir un campo destinado a recibir un número de teléfono celular.\n *\n * Esta función debe llamarse en el evento ready del objeto global document:\n * `$(document).ready(...)`. Ademas debe incluirse un pequeño fragmento de código en la función\n * `validacionAdicional` para que se agregué el código del número de celular al valor de campo\n * cuando se envíe el formulario donde se encutra el campo.\n *\n * ```\n * if (\n *   $('#input_celular_id').length &&\n *   $('#input_celular_id').val() !== '' &&\n *   input_celular.getNumber() !== ''\n * ) {\n *   $('#input_celular_id').val(input_celular.getNumber().slice(1));\n * }\n * ```\n *\n * Donde `input_celular` es el objeto retornado por esta función.\n *\n * @param {string} input_celular_id Id del campo.\n * @param {string} nombre_input_celular Nombre del campo.\n * @param {string} placeholder_input_celular Placeholder del campo.\n * @param {boolean} obligatorio El campo es obligatorio en el formulario.\n * @returns {object}\n * @author Fahibram Cárcamo\n */\nfunction definirInputTipoCelular(input_celular_id, nombre_input_celular, placeholder_input_celular, obligatorio = true) {\n    /**\n     * 🌎 Campo para ingresar un número de telefono con selectór de código de país con banderas.\n     * Este componente se creó con la librería International Telephone Input\n     * (https://intl-tel-input.com).\n     *\n     * La linea hiddenInput: () => ({ phone: 'celular_contacto' }) tiene como función establecer el\n     * nombre del campo, es decir, la llave del par llave-valor que se adjuntará en los datos del\n     * formulario cuando se envíe, en este caso 'celular_contacto'.\n     *\n     * Las lienas autoPlaceholder: 'aggressive' y\n     * customPlaceholder: (placeholder, country) => 'Celular*' se usan para definir el placeholder\n     * del campo.\n     *\n     * Con $('#celular_contacto').attr('required', true); se establece el campo como requerido\n     * dentro del formulario, se hace de esta forma porque la librería no admite el atributo\n     * required directamente en el componente html.\n     *\n     * @author Fahibram Cárcamo\n     */\n    if (document.querySelector(`#${input_celular_id}`)) {\n        const dropdown_dinamico = document.createElement('div');\n        document.body.appendChild(dropdown_dinamico);\n\n        let campo_celular = window.intlTelInput(document.querySelector(`#${input_celular_id}`), {\n            nationalMode: true,\n            initialCountry: 'co',\n            separateDialCode: true,\n            autoInsertDialCode: false,\n            autoPlaceholder: 'aggressive',\n            dropdownContainer: dropdown_dinamico,\n            customPlaceholder: (placeholder, country) => placeholder_input_celular,\n            loadUtils: () => import('https://cdn.jsdelivr.net/npm/intl-tel-input@25.4.2/build/js/utils.js'),\n            onlyCountries: [\n                'CO', // Colombia\n                'EC', // Ecuador\n                'AR', // Argentina\n                'CL', // Chile\n                'VE', // Venezuela\n                'PE', // Perú\n                'BO', // Bolivia\n                'UY', // Uruguay\n                'PY', // Paraguay\n                'PA', // Panamá\n                'MX', // México\n                'CR', // Costa Rica\n                // 'PR', // Puerto Rico\n                'CU', // Cuba\n                // 'DO', // República Dominicana\n                'SV', // El Salvador\n                'GT', // Guatemala\n                'HN', // Honduras\n                'NI', // Nicaragua\n                'ES', // España\n                'US', // Estados Unidos\n                'GQ'  // Guinea Ecuatorial\n            ]\n        });\n\n        if (obligatorio) $(`#${input_celular_id}`).attr('required', true);\n\n        return campo_celular;\n    }\n\n    return null;\n}\n\n/**\n * Establece la validación adicional que se aplica a un campo de tipo celular antes de enviar sus\n * datos en un formulario.\n *\n * @param {HTMLInputElement} input Elemento HTML del campo de tipo celular.\n * @param {string} input_id Id del elemento HTML del campo de tipo celular.\n * @author Fahibram Cárcamo\n * @author Jair Carvajal\n */\nfunction validacionAdicionalInputTipoCelular(input, input_id) {\n    let numero_completo = input.getNumber();\n    let indicativo = '+' + input.getSelectedCountryData().dialCode;\n    let codigo_iso2_pais = input.getSelectedCountryData().iso2;\n    let numero_sin_indicativo = numero_completo.replace(indicativo, '');\n    $(`#indicativo_${input_id}`).val(indicativo);\n    $(`#codigo_iso2_pais_${input_id}`).val(codigo_iso2_pais);\n    $(`#${input_id}`).val(numero_sin_indicativo);\n}\n\n/**\n * Rellenar un input de tipo celular.\n *\n * @param {string} indicativo_celular Código del país del número de celular.\n * @param {string} codigo_pais_iso2 Código ISO2 del país del número de celular.\n * @param {string} numero_celular Número de celular sin código de país.\n * @param {string} input_celular_id ID del input de tipo celular.\n * @param {HTMLInputElement} input_celular Input de tipo celular.\n * @returns {void}\n * @author Daniel Beltrán\n * @author Fahibram Cárcamo\n */\nfunction rellenarInputCelular(indicativo_celular, codigo_pais_iso2, numero_celular, input_celular_id, input_celular) {\n    $(`#${input_celular_id}`).val(numero_celular);\n    if (![null, undefined].includes(codigo_pais_iso2)) input_celular.setCountry(codigo_pais_iso2);\n}\n\n/**\n * Convierte imágenes de base64 a Blob.\n *\n * @param {string} cadena_base_64 Base 64 de la imagen.\n * @returns {Promise<Array>}\n * @author Andres Gonzalez\n */\nfunction imagenBase64Blob(cadena_base_64) {\n    if (!cadena_base_64 || !cadena_base_64.startsWith('data:image')) return null;\n    let datos_base_64 = cadena_base_64.split(',')[1];\n    let tipo_mime = cadena_base_64.match(/data:(.*?);base64/)[1];\n    let caracteres_binarios = atob(datos_base_64);\n    let arreglo_bytes = new Array(caracteres_binarios.length).fill(0).map((_, i) => caracteres_binarios.charCodeAt(i));\n    let bytes_uint8 = new Uint8Array(arreglo_bytes);\n    return new Blob([bytes_uint8], { type: tipo_mime });\n}\n\n\n/**\n * Limpiar estructuras html innecesarias en el check editor.\n *\n * @param {string} html - Cadena HTML generada por CKEditor a limpiar\n * @returns {string} HTML limpio sin elementos específicos de CKEditor\n * @author Andres Gonzalez\n * @author Jair Carvajal\n */\nfunction limpiarHTMLCKEditor(html) {\n    // Remover todos los elementos con clases de CKEditor\n    html = html.replace(/<div class=\"ck[^\"]*\"[^>]*>.*?<\\/div>/gs, '');\n    html = html.replace(/<span class=\"[^\"]*ck[^\"]*\"[^>]*>/gi, '<span>');\n\n    // Limpiar spans de imagen inline\n    html = html.replace(/<span class=\"image-inline[^\"]*\"[^>]*>/gi, '');\n    html = html.replace(/<\\/span>/g, '');\n\n    // Remover elementos de upload y widgets\n    html = html.replace(/<div class=\"ck-image-upload[^\"]*\"[^>]*>.*?<\\/div>/gs, '');\n    html = html.replace(/<div class=\"ck-fake-selection[^\"]*\"[^>]*>.*?<\\/div>/gs, '');\n\n    // Remover atributos innecesarios\n    html = html.replace(/contenteditable=\"[^\"]*\"/gi, '');\n    html = html.replace(/data-cke-filler=\"[^\"]*\"/gi, '');\n\n    // Limpiar párrafos vacíos con br\n    html = html.replace(/<p><br[^>]*><\\/p>/gi, '');\n    html = html.replace(/<br data-cke[^>]*>/gi, '');\n\n    // Limpiar espacios múltiples y saltos de línea\n    html = html.replace(/\\s+/g, ' ');\n    html = html.replace(/>\\s+</g, '><');\n\n    return html.trim();\n}\n\n/**\n * Ordena estudios por fecha_inicio más reciente (de más nueva a más antigua).\n * Preserva los índices originales para permitir edición y eliminación correcta.\n *\n * @param {Array} estudios - Array de objetos con estudios\n * @returns {Array} Array de estudios ordenados con propiedad indice_original\n * @author Jair Carvajal\n */\nfunction ordenarEstudiosPorFecha(estudios) {\n    // Mapear con índice original\n    let estudios_con_indice = estudios.map((estudio, indice_original) => ({\n        ...estudio,\n        indice_original: indice_original\n    }));\n\n    // Ordenar estudios por fecha_inicio (más reciente primero)\n    let estudios_ordenados = estudios_con_indice.sort((a, b) => {\n        // Si ambos tienen fecha_inicio, ordenar por más reciente\n        if (a.fecha_inicio && b.fecha_inicio) {\n            return moment(b.fecha_inicio).diff(moment(a.fecha_inicio));\n        }\n        // Si solo uno tiene fecha_inicio, ese va primero\n        if (a.fecha_inicio && !b.fecha_inicio) return -1;\n        if (!a.fecha_inicio && b.fecha_inicio) return 1;\n        // Si ninguno tiene fecha_inicio, mantener orden original\n        return 0;\n    });\n\n    return estudios_ordenados;\n}\n\n/**\n * Ordena experiencias laborales por fecha: primero las que está trabajando actualmente (sin fecha_fin),\n * luego por fecha_fin más reciente.\n * Preserva los índices originales para permitir edición y eliminación correcta.\n *\n * @param {Array} experiencias - Array de objetos con experiencias laborales\n * @returns {Array} Array de experiencias ordenadas con propiedad indice_original\n * @author Jair Carvajal\n */\nfunction ordenarExperienciasPorFecha(experiencias) {\n    // Mapear con índice original\n    let experiencias_con_indice = experiencias.map((experiencia, indice_original) => ({\n        ...experiencia,\n        indice_original: indice_original\n    }));\n\n    // Ordenar experiencias\n    let experiencias_ordenadas = experiencias_con_indice.sort((a, b) => {\n        // Si 'a' no tiene fecha_fin (trabaja actualmente), va primero\n        if (!a.fecha_fin && b.fecha_fin) return -1;\n        // Si 'b' no tiene fecha_fin (trabaja actualmente), va primero\n        if (a.fecha_fin && !b.fecha_fin) return 1;\n        // Si ambos están trabajando actualmente (sin fecha_fin), mantener el orden actual\n        if (!a.fecha_fin && !b.fecha_fin) return 0;\n        // Si ambos tienen fecha_fin, ordenar por fecha más reciente primero (descendente)\n        return moment(b.fecha_fin).diff(moment(a.fecha_fin));\n    });\n\n    return experiencias_ordenadas;\n}\n","numLines":1396,"startLine":1,"totalLines":1396}},"sourceToolAssistantUUID":"894cca4e-b688-41d1-8443-4adde9b64dbc"}
{"parentUuid":"215c5896-54b3-48f8-a63a-583b911b4c5f","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_016tgbCAfv526cZaBbz8MLvk","type":"message","role":"assistant","content":[{"type":"text","text":"Ahora voy a agregar la función para obtener los créditos disponibles de la empresa y actualizar el tag dinámicamente. También necesito agregar un ID al tag en la vista para poder actualizarlo."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":21249,"cache_read_input_tokens":35823,"cache_creation":{"ephemeral_5m_input_tokens":21249,"ephemeral_1h_input_tokens":0},"output_tokens":7,"service_tier":"standard"}},"requestId":"req_011CXLnqz3jxdCiWcnZ6nt63","type":"assistant","uuid":"4d723e6a-16d8-43bc-a031-a42452ab3017","timestamp":"2026-01-21T15:52:17.114Z"}
{"parentUuid":"4d723e6a-16d8-43bc-a031-a42452ab3017","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_016tgbCAfv526cZaBbz8MLvk","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01A8g2kL8uNY4XExzjv7KCgn","name":"Edit","input":{"replace_all":false,"file_path":"c:\\laragon\\www\\psicoalianza-2\\resources\\views\\vacantes\\paginas\\index.blade.php","old_string":"            <div class=\"col-auto ps-2 pe-0 my-auto\">\n                ${crearTag({\n                    texto: 'Créditos disponibles: 1.800',\n                    class: 'tag-tonal-blue',\n                })}\n            </div>","new_string":"            <div class=\"col-auto ps-2 pe-0 my-auto\" id=\"contenedor-tag-creditos\">\n                ${crearTag({\n                    texto: 'Cargando créditos...',\n                    class: 'tag-tonal-blue',\n                })}\n            </div>"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":21249,"cache_read_input_tokens":35823,"cache_creation":{"ephemeral_5m_input_tokens":21249,"ephemeral_1h_input_tokens":0},"output_tokens":7,"service_tier":"standard"}},"requestId":"req_011CXLnqz3jxdCiWcnZ6nt63","type":"assistant","uuid":"3658d915-69ea-4c42-91c4-deb0cfd48b86","timestamp":"2026-01-21T15:52:21.116Z"}
{"parentUuid":"3658d915-69ea-4c42-91c4-deb0cfd48b86","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01A8g2kL8uNY4XExzjv7KCgn","type":"tool_result","content":"The file c:\\laragon\\www\\psicoalianza-2\\resources\\views\\vacantes\\paginas\\index.blade.php has been updated. Here's the result of running `cat -n` on a snippet of the edited file:\n     9→@section('contenido')\n    10→    ${contenedorPrincipal({\n    11→        cabecera: `\n    12→            <div class=\"col-auto text-headline-2 text-gray-30 fw-bold\">Producto selección</div>\n    13→            <div class=\"col-auto ps-2 pe-0 my-auto\" id=\"contenedor-tag-creditos\">\n    14→                ${crearTag({\n    15→                    texto: 'Cargando créditos...',\n    16→                    class: 'tag-tonal-blue',\n    17→                })}\n    18→            </div>\n    19→        `,\n    20→        contenido: `\n    21→            <div class=\"card shadow-none\">\n    22→                <div id=\"cabecera-pagina-sin-archivar\">"}]},"uuid":"91ed1aaf-85ea-4c86-a996-2222558b52e6","timestamp":"2026-01-21T15:53:55.478Z","toolUseResult":{"filePath":"c:\\laragon\\www\\psicoalianza-2\\resources\\views\\vacantes\\paginas\\index.blade.php","oldString":"            <div class=\"col-auto ps-2 pe-0 my-auto\">\n                ${crearTag({\n                    texto: 'Créditos disponibles: 1.800',\n                    class: 'tag-tonal-blue',\n                })}\n            </div>","newString":"            <div class=\"col-auto ps-2 pe-0 my-auto\" id=\"contenedor-tag-creditos\">\n                ${crearTag({\n                    texto: 'Cargando créditos...',\n                    class: 'tag-tonal-blue',\n                })}\n            </div>","originalFile":"@extends('layouts.app')\n\n@section('titulo', 'Vacantes')\n\n@section('estilos')\n    <link href=\"{{ asset('css/ofertas-laborales/ofertas-laborales.css') }}\" rel=\"stylesheet\">\n@endsection\n\n@section('contenido')\n    ${contenedorPrincipal({\n        cabecera: `\n            <div class=\"col-auto text-headline-2 text-gray-30 fw-bold\">Producto selección</div>\n            <div class=\"col-auto ps-2 pe-0 my-auto\">\n                ${crearTag({\n                    texto: 'Créditos disponibles: 1.800',\n                    class: 'tag-tonal-blue',\n                })}\n            </div>\n        `,\n        contenido: `\n            <div class=\"card shadow-none\">\n                <div id=\"cabecera-pagina-sin-archivar\">\n                    @include('componentes.menu-superior', ['rutas' => $rutas_menu->where('slug', 'productos-servicios')->first()?->rutas, 'activo' => 'vacantes'])\n                </div>\n                <div id=\"cabecera-pagina-con-archivar\" class=\"d-none\">\n                    <div class=\"col-auto text-headline-4 text-gray-30 fw-semibold pt-4 px-5\">Vacantes archivadas</div>\n                </div>\n                <div class=\"card-body\">\n                    <div class=\"d-none\" id=\"tabla-sin-contenido\">\n                        <div class=\"w-100 text-center p-10\">\n                            <p class=\"\"><i class=\"bi bi-briefcase text-gray-60\" style=\"font-size: 118px;\"></i></p>\n                            <p class=\"pb-4 text-headline-5 fw-bold text-gray-30\">No tienes vacantes por ahora, publica la primera para comenzar.</p>\n                            <p class=\"pb-4 \">\n                                ${crearBoton({\n                                    clases: 'btn-primary',\n                                    url: '/vacantes/create',\n                                    texto: '<i class=\"bi bi-plus-lg me-2\"></i> Crear vacante'\n                                })}\n                            </p>\n                        </div>\n                    </div>\n                    <div id=\"tabla-contenido\">\n                        ${crearTabla({\n                            id: 'tabla-vacantes',\n                            class: 'table-cards table-borderless',\n                            class_tabla: 'table-cards',\n                            registros_paginas: true,\n                            buscador: {\n                                icono: '<i class=\"bi bi-search input-icono1\"></i>',\n                            },\n                            chips: `\n                                <div class=\"col-12\">\n                                    <div class=\"row align-items-center w-100 mx-0 contenedor-chips my-2\" id=\"contenedor-chips-filtro_vacantes\"></div>\n                                </div>\n                            `,\n                            buscador_datatable: true,\n                            filtro: crearFiltroDropdown({\n                                id: 'filtro_vacantes',\n                                name: 'filtro_vacantes',\n                                type: 'text',\n                                value: '',\n                                class: 'filtro-chips',\n                                input_container_class: 'mb-0',\n                                placeholder: 'Buscar',\n                                buscador_datatable: true,\n                                tabla_id: 'tabla-vacantes',\n                                icono: '<i class=\"bi bi-search input-icono1\"></i>',\n                                icono3: '<i class=\"bi bi-filter input-icono3 pointer icono-filtro-avanzado\" data-bs-toggle=\"dropdown\" aria-expanded=\"false\" data-bs-auto-close=\"outside\"></i>',\n                                dropdown: {\n                                    titulo: 'Filtros avanzados',\n                                    contenido: `\n                                        <div class=\"row mt-4\">\n                                            <div class=\"col-5 pt-2\">Estados</div>\n                                            <div class=\"col-7\">\n                                                ${crearSelect2({\n                                                    opciones: [\n                                                        { nombre: 'Todo', id: '' },\n                                                        @foreach($estados as $item)\n                                                            { nombre: `{{ $item->nombre }}`, id: '{{ $item->id }}' },\n                                                        @endforeach\n                                                    ],\n                                                    opcion_vacia: false,\n                                                    id: 'estados_filtro',\n                                                    class: 'select2-filtro-buscador filtro',\n                                                    input_container_class: 'mb-0',\n                                                    data: [\n                                                        { texto: 'filtro', value: 'Estados'}\n                                                    ]\n                                                })}\n                                            </div>\n                                        </div>\n                                        <div class=\"row mt-4\">\n                                            <div class=\"col-5 pt-2\">Creador</div>\n                                            <div class=\"col-7\">\n                                                ${crearSelect2({\n                                                    opciones: [\n                                                        { nombre: 'Todo', id: '' },\n                                                        @foreach($usuarios as $item)\n                                                            { nombre: `{{ $item->nombres . ' ' . $item->apellidos }}`, id: '{{ $item->id }}' },\n                                                        @endforeach\n                                                    ],\n                                                    opcion_vacia: false,\n                                                    id: 'creador_filtro',\n                                                    class: 'select2-filtro-buscador filtro',\n                                                    input_container_class: 'mb-0',\n                                                    data: [\n                                                        { texto: 'filtro', value: 'Creador'}\n                                                    ]\n                                                })}\n                                            </div>\n                                        </div>\n                                        <div class=\"row mt-5\">\n                                            <div class=\"col-5 pt-2\">Fecha de creación</div>\n                                            <div class=\"col-7\">\n                                                ${crearDatePicker({\n                                                    id: 'fecha_creacion_filtro',\n                                                    class: 'flatpickr-range filtro',\n                                                    input_container_class: 'mb-1',\n                                                    placeholder: 'Desde - hasta',\n                                                    icono: '<i class=\"bi bi-calendar4 input-icono2 text-gray-30 pointer\"></i>',\n                                                    data: [\n                                                        { texto: 'filtro', value: 'Fecha de creación'}\n                                                    ]\n                                                })}\n                                            </div>\n                                        </div>\n                                        <div id=\"fecha_archivado\" class=\"row mt-5\">\n                                            <div class=\"col-5 pt-2\">Fecha de archivado</div>\n                                            <div class=\"col-7\">\n                                                ${crearDatePicker({\n                                                    id: 'fecha_archivado_filtro',\n                                                    class: 'flatpickr-range filtro',\n                                                    input_container_class: 'mb-1',\n                                                    placeholder: 'Desde - hasta',\n                                                    icono: '<i class=\"bi bi-calendar4 input-icono2 text-gray-30 pointer\"></i>',\n                                                    data: [\n                                                        { texto: 'filtro', value: 'Fecha de archivado'}\n                                                    ]\n                                                })}\n                                            </div>\n                                        </div>\n                                        <div class=\"row mt-5\">\n                                            <div class=\"col-5 pt-2\">Aplicante</div>\n                                            <div class=\"col-7\">\n                                                ${crearInput({\n                                                    id: 'aplicante_filtro',\n                                                    class: 'filtro',\n                                                    input_container_class: 'mb-1',\n                                                    placeholder: 'Nombre o cedula',\n                                                    data: [\n                                                        { texto: 'filtro', value: 'Aplicante'}\n                                                    ]\n                                                })}\n                                            </div>\n                                        </div>\n                                        <div class=\"row mt-4\">\n                                            <div class=\"col-5 pt-2\">Etapas</div>\n                                            <div class=\"col-7\">\n                                                ${crearSelect2({\n                                                    opciones: [\n                                                        { nombre: 'Todo', id: '' },\n                                                        @foreach($etapas as $etapa)\n                                                            { nombre: `{{ $etapa->nombre }}`, id: '{{ $etapa->nombre }}' },\n                                                        @endforeach\n                                                    ],\n                                                    opcion_vacia: false,\n                                                    id: 'etapa_filtro',\n                                                    class: 'select2-filtro-buscador filtro',\n                                                    input_container_class: 'mb-0',\n                                                    data: [\n                                                        { texto: 'filtro', value: 'Etapa'}\n                                                    ]\n                                                })}\n                                            </div>\n                                        </div>\n                                    `\n                                }\n                            }),\n                            botones: `\n                            <div class=\"col-12 col-md\">\n                                <div class=\"row justify-content-end\">\n                                    <div class=\"col-12 px-1 col-md-3 my-auto\">\n                                        ${crearSelect2({\n                                            input_container_class: 'my-auto',\n                                            opciones: [\n                                                {id: 'created_at-DESC', nombre: 'Más recientes'},\n                                                {id: 'created_at-ASC', nombre: 'Más antiguos'},\n                                                {id: 'nombre_vacante-ASC', nombre: 'De la  A a la Z'},\n                                                {id: 'nombre_vacante-DESC', nombre: 'De la  Z a la A'},\n                                            ],\n                                            opcion_vacia:false,\n                                            id: 'filtro_mas_recientes',\n                                            disabled: false,\n                                            required: true,\n                                            buscador: true\n                                        })}\n                                    </div>\n                                    <div class=\"col-12 col-md my-auto\">\n                                        <div class=\"row justify-content-end\">\n                                            <div class=\"col-auto px-1 ms-auto\">\n                                                ${crearBoton({\n                                                    id     : 'boton-descargar-tabla-vacantes',\n                                                    clases : 'btn-green-excel clase-desabilitada',\n                                                    tooltip: `${crearTooltip({ placement: `bottom`, content: 'En contrucción', toggle: `popover`,})}`,\n                                                    texto  : '<img class=\"me-3\" src=\"{{ asset('/iconos/excel_icon.svg') }}\"> Exportar todo',\n                                                })}\n                                            </div>\n                                            <div class=\"col-auto\">\n                                                ${crearBoton({\n                                                    id: 'btn-archivo-vacantes',\n                                                    clases: 'btn-tonal-primary',\n                                                    texto: `<i class=\"bi bi-archive me-2\"></i> Archivo de vacantes`\n                                                })}\n                                                <input type=\"hidden\" id=\"vacantes_archivadas\" value=\"1\">\n                                            </div>\n                                            <div class=\"col-auto px-1 pe-3\">\n                                                ${crearBoton({\n                                                    id: 'btn-crear-vacante',\n                                                    clases: 'btn-primary',\n                                                    url: '/vacantes/create',\n                                                    texto: '<i class=\"bi bi-plus-lg me-2\"></i> Crear vacante'\n                                                })}\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                            `,\n                        })}\n                    </div>\n                </div>\n            </div>\n        `\n    })}\n\n    @include('vacantes.paginas.modales.modal-agregar-candidatos')\n    @include('vacantes.paginas.modales.modal-cargar-archivo')\n    @include('vacantes.paginas.modales.modal-solicitar-mas-creditos-ia')\n    @include('vacantes.paginas.modales.modal-consumo-creditos-ia')\n@endsection\n\n@section('scripts')\n    <script type=\"text/javascript\">\n        let activas = {{ $activas }};\n        var empresa_id = {{ $empresa_id }};\n        const EMPRESA_ID = @json(\\Auth::user()->empresa->id);\n    </script>\n\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js\"></script>\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js\"></script>\n\n    <script src=\"{{ asset('js/vacantes/vacantes-funciones.js') }}\" type=\"text/javascript\"></script>\n    <script src=\"{{ asset('js/vacantes/general-vacantes.js') }}\" type=\"text/javascript\"></script>\n    <script src=\"{{ asset('js/vacantes/vacantes.js') }}\" type=\"text/javascript\"></script>\n@endsection\n","structuredPatch":[{"oldStart":10,"oldLines":9,"newStart":10,"newLines":9,"lines":["     ${contenedorPrincipal({","         cabecera: `","             <div class=\"col-auto text-headline-2 text-gray-30 fw-bold\">Producto selección</div>","-            <div class=\"col-auto ps-2 pe-0 my-auto\">","+            <div class=\"col-auto ps-2 pe-0 my-auto\" id=\"contenedor-tag-creditos\">","                 ${crearTag({","-                    texto: 'Créditos disponibles: 1.800',","+                    texto: 'Cargando créditos...',","                     class: 'tag-tonal-blue',","                 })}","             </div>"]}],"userModified":false,"replaceAll":false},"sourceToolAssistantUUID":"3658d915-69ea-4c42-91c4-deb0cfd48b86"}
{"parentUuid":"91ed1aaf-85ea-4c86-a996-2222558b52e6","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_013dzJ8go6pz4ScA9AeGDuMf","type":"message","role":"assistant","content":[{"type":"text","text":"Ahora voy a agregar la función en `globales.js`:"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":612,"cache_read_input_tokens":57072,"cache_creation":{"ephemeral_5m_input_tokens":612,"ephemeral_1h_input_tokens":0},"output_tokens":8,"service_tier":"standard"}},"requestId":"req_011CXLnymyvpjGStf4M4j1qD","type":"assistant","uuid":"06c6a512-9c84-413a-a7f3-c3954afea5c4","timestamp":"2026-01-21T15:54:01.015Z"}
{"parentUuid":"06c6a512-9c84-413a-a7f3-c3954afea5c4","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_013dzJ8go6pz4ScA9AeGDuMf","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01Y8NJPsa2zSHf1CnZwnwUkF","name":"Edit","input":{"replace_all":false,"file_path":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\globales.js","old_string":"function ordenarExperienciasPorFecha(experiencias) {\n    // Mapear con índice original\n    let experiencias_con_indice = experiencias.map((experiencia, indice_original) => ({\n        ...experiencia,\n        indice_original: indice_original\n    }));\n\n    // Ordenar experiencias\n    let experiencias_ordenadas = experiencias_con_indice.sort((a, b) => {\n        // Si 'a' no tiene fecha_fin (trabaja actualmente), va primero\n        if (!a.fecha_fin && b.fecha_fin) return -1;\n        // Si 'b' no tiene fecha_fin (trabaja actualmente), va primero\n        if (a.fecha_fin && !b.fecha_fin) return 1;\n        // Si ambos están trabajando actualmente (sin fecha_fin), mantener el orden actual\n        if (!a.fecha_fin && !b.fecha_fin) return 0;\n        // Si ambos tienen fecha_fin, ordenar por fecha más reciente primero (descendente)\n        return moment(b.fecha_fin).diff(moment(a.fecha_fin));\n    });\n\n    return experiencias_ordenadas;\n}","new_string":"function ordenarExperienciasPorFecha(experiencias) {\n    // Mapear con índice original\n    let experiencias_con_indice = experiencias.map((experiencia, indice_original) => ({\n        ...experiencia,\n        indice_original: indice_original\n    }));\n\n    // Ordenar experiencias\n    let experiencias_ordenadas = experiencias_con_indice.sort((a, b) => {\n        // Si 'a' no tiene fecha_fin (trabaja actualmente), va primero\n        if (!a.fecha_fin && b.fecha_fin) return -1;\n        // Si 'b' no tiene fecha_fin (trabaja actualmente), va primero\n        if (a.fecha_fin && !b.fecha_fin) return 1;\n        // Si ambos están trabajando actualmente (sin fecha_fin), mantener el orden actual\n        if (!a.fecha_fin && !b.fecha_fin) return 0;\n        // Si ambos tienen fecha_fin, ordenar por fecha más reciente primero (descendente)\n        return moment(b.fecha_fin).diff(moment(a.fecha_fin));\n    });\n\n    return experiencias_ordenadas;\n}\n\n/**\n * Obtener créditos disponibles de la empresa y actualizar el tag.\n * - Si tiene créditos >= 20% del plan: tag azul\n * - Si tiene créditos < 20% del plan: tag amarillo\n * - Si no tiene créditos: tag gris \"Sin créditos\"\n *\n * @param {number} empresa_id ID de la empresa\n * @param {string} contenedor_id ID del contenedor donde se mostrará el tag\n * @returns {void}\n * @author Claude Code\n */\nfunction obtenerCreditosDisponiblesEmpresa(empresa_id, contenedor_id = 'contenedor-tag-creditos') {\n    if (!empresa_id || !$(`#${contenedor_id}`).length) {\n        return;\n    }\n\n    $.ajax({\n        url: `/api/empresas/${empresa_id}/creditos`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            let creditos_disponibles = respuesta?.data?.creditos_disponibles ?? 0;\n            let creditos_plan = respuesta?.data?.creditos_plan ?? 0;\n            let porcentaje_disponible = creditos_plan > 0 ? (creditos_disponibles / creditos_plan) * 100 : 0;\n\n            let texto_tag = '';\n            let clase_tag = '';\n\n            if (creditos_disponibles <= 0) {\n                texto_tag = 'Sin créditos';\n                clase_tag = 'tag-tonal-gray';\n            } else if (porcentaje_disponible < 20) {\n                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                clase_tag = 'tag-filled-yellow';\n            } else {\n                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                clase_tag = 'tag-tonal-blue';\n            }\n\n            $(`#${contenedor_id}`).html(crearTag({\n                texto: texto_tag,\n                class: clase_tag,\n            }));\n        },\n        error: function() {\n            $(`#${contenedor_id}`).html(crearTag({\n                texto: 'Error al cargar créditos',\n                class: 'tag-tonal-gray',\n            }));\n        }\n    });\n}"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":612,"cache_read_input_tokens":57072,"cache_creation":{"ephemeral_5m_input_tokens":612,"ephemeral_1h_input_tokens":0},"output_tokens":8,"service_tier":"standard"}},"requestId":"req_011CXLnymyvpjGStf4M4j1qD","type":"assistant","uuid":"14f8b4ab-88a2-44c9-8344-f211a380cb90","timestamp":"2026-01-21T15:54:12.285Z"}
{"parentUuid":"14f8b4ab-88a2-44c9-8344-f211a380cb90","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"type":"tool_result","content":"The user doesn't want to proceed with this tool use. The tool use was rejected (eg. if it was a file edit, the new_string was NOT written to the file). The user provided the following reason for the rejection:  que el autor sea andres gonzalez","is_error":true,"tool_use_id":"toolu_01Y8NJPsa2zSHf1CnZwnwUkF"}]},"uuid":"ca319169-f212-47fd-bbaa-746893d39a09","timestamp":"2026-01-21T15:54:26.004Z","toolUseResult":"Error: The user doesn't want to proceed with this tool use. The tool use was rejected (eg. if it was a file edit, the new_string was NOT written to the file). The user provided the following reason for the rejection:  que el autor sea andres gonzalez","sourceToolAssistantUUID":"14f8b4ab-88a2-44c9-8344-f211a380cb90"}
{"parentUuid":"ca319169-f212-47fd-bbaa-746893d39a09","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01UbjBir3sU96AtAmb9AcP4t","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01QbUJ86cypCjpP9qi1XQit4","name":"Edit","input":{"replace_all":false,"file_path":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\globales.js","old_string":"function ordenarExperienciasPorFecha(experiencias) {\n    // Mapear con índice original\n    let experiencias_con_indice = experiencias.map((experiencia, indice_original) => ({\n        ...experiencia,\n        indice_original: indice_original\n    }));\n\n    // Ordenar experiencias\n    let experiencias_ordenadas = experiencias_con_indice.sort((a, b) => {\n        // Si 'a' no tiene fecha_fin (trabaja actualmente), va primero\n        if (!a.fecha_fin && b.fecha_fin) return -1;\n        // Si 'b' no tiene fecha_fin (trabaja actualmente), va primero\n        if (a.fecha_fin && !b.fecha_fin) return 1;\n        // Si ambos están trabajando actualmente (sin fecha_fin), mantener el orden actual\n        if (!a.fecha_fin && !b.fecha_fin) return 0;\n        // Si ambos tienen fecha_fin, ordenar por fecha más reciente primero (descendente)\n        return moment(b.fecha_fin).diff(moment(a.fecha_fin));\n    });\n\n    return experiencias_ordenadas;\n}","new_string":"function ordenarExperienciasPorFecha(experiencias) {\n    // Mapear con índice original\n    let experiencias_con_indice = experiencias.map((experiencia, indice_original) => ({\n        ...experiencia,\n        indice_original: indice_original\n    }));\n\n    // Ordenar experiencias\n    let experiencias_ordenadas = experiencias_con_indice.sort((a, b) => {\n        // Si 'a' no tiene fecha_fin (trabaja actualmente), va primero\n        if (!a.fecha_fin && b.fecha_fin) return -1;\n        // Si 'b' no tiene fecha_fin (trabaja actualmente), va primero\n        if (a.fecha_fin && !b.fecha_fin) return 1;\n        // Si ambos están trabajando actualmente (sin fecha_fin), mantener el orden actual\n        if (!a.fecha_fin && !b.fecha_fin) return 0;\n        // Si ambos tienen fecha_fin, ordenar por fecha más reciente primero (descendente)\n        return moment(b.fecha_fin).diff(moment(a.fecha_fin));\n    });\n\n    return experiencias_ordenadas;\n}\n\n/**\n * Obtener créditos disponibles de la empresa y actualizar el tag.\n * - Si tiene créditos >= 20% del plan: tag azul\n * - Si tiene créditos < 20% del plan: tag amarillo\n * - Si no tiene créditos: tag gris \"Sin créditos\"\n *\n * @param {number} empresa_id ID de la empresa\n * @param {string} contenedor_id ID del contenedor donde se mostrará el tag\n * @returns {void}\n * @author Andres Gonzalez\n */\nfunction obtenerCreditosDisponiblesEmpresa(empresa_id, contenedor_id = 'contenedor-tag-creditos') {\n    if (!empresa_id || !$(`#${contenedor_id}`).length) {\n        return;\n    }\n\n    $.ajax({\n        url: `/api/empresas/${empresa_id}/creditos`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            let creditos_disponibles = respuesta?.data?.creditos_disponibles ?? 0;\n            let creditos_plan = respuesta?.data?.creditos_plan ?? 0;\n            let porcentaje_disponible = creditos_plan > 0 ? (creditos_disponibles / creditos_plan) * 100 : 0;\n\n            let texto_tag = '';\n            let clase_tag = '';\n\n            if (creditos_disponibles <= 0) {\n                texto_tag = 'Sin créditos';\n                clase_tag = 'tag-tonal-gray';\n            } else if (porcentaje_disponible < 20) {\n                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                clase_tag = 'tag-filled-yellow';\n            } else {\n                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                clase_tag = 'tag-tonal-blue';\n            }\n\n            $(`#${contenedor_id}`).html(crearTag({\n                texto: texto_tag,\n                class: clase_tag,\n            }));\n        },\n        error: function() {\n            $(`#${contenedor_id}`).html(crearTag({\n                texto: 'Error al cargar créditos',\n                class: 'tag-tonal-gray',\n            }));\n        }\n    });\n}"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":1519,"cache_read_input_tokens":57684,"cache_creation":{"ephemeral_5m_input_tokens":1519,"ephemeral_1h_input_tokens":0},"output_tokens":25,"service_tier":"standard"}},"requestId":"req_011CXLo1qGvZdcgB6q7NNr9e","type":"assistant","uuid":"e674d781-b9c5-4b33-87f3-73b062f8b334","timestamp":"2026-01-21T15:54:37.471Z"}
{"type":"file-history-snapshot","messageId":"e674d781-b9c5-4b33-87f3-73b062f8b334","snapshot":{"messageId":"fa0b47ef-c747-4784-acba-90f74b050cec","trackedFileBackups":{"resources\\views\\vacantes\\paginas\\index.blade.php":{"backupFileName":"1ae59264a32091d1@v4","version":4,"backupTime":"2026-01-21T15:51:58.466Z"},"public\\js\\globales.js":{"backupFileName":"704f632e999527e6@v1","version":1,"backupTime":"2026-01-21T15:54:42.827Z"}},"timestamp":"2026-01-21T15:51:58.451Z"},"isSnapshotUpdate":true}
{"parentUuid":"e674d781-b9c5-4b33-87f3-73b062f8b334","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01QbUJ86cypCjpP9qi1XQit4","type":"tool_result","content":"The file c:\\laragon\\www\\psicoalianza-2\\public\\js\\globales.js has been updated. Here's the result of running `cat -n` on a snippet of the edited file:\n  1371→ * @param {Array} experiencias - Array de objetos con experiencias laborales\n  1372→ * @returns {Array} Array de experiencias ordenadas con propiedad indice_original\n  1373→ * @author Jair Carvajal\n  1374→ */\n  1375→function ordenarExperienciasPorFecha(experiencias) {\n  1376→    // Mapear con índice original\n  1377→    let experiencias_con_indice = experiencias.map((experiencia, indice_original) => ({\n  1378→        ...experiencia,\n  1379→        indice_original: indice_original\n  1380→    }));\n  1381→\n  1382→    // Ordenar experiencias\n  1383→    let experiencias_ordenadas = experiencias_con_indice.sort((a, b) => {\n  1384→        // Si 'a' no tiene fecha_fin (trabaja actualmente), va primero\n  1385→        if (!a.fecha_fin && b.fecha_fin) return -1;\n  1386→        // Si 'b' no tiene fecha_fin (trabaja actualmente), va primero\n  1387→        if (a.fecha_fin && !b.fecha_fin) return 1;\n  1388→        // Si ambos están trabajando actualmente (sin fecha_fin), mantener el orden actual\n  1389→        if (!a.fecha_fin && !b.fecha_fin) return 0;\n  1390→        // Si ambos tienen fecha_fin, ordenar por fecha más reciente primero (descendente)\n  1391→        return moment(b.fecha_fin).diff(moment(a.fecha_fin));\n  1392→    });\n  1393→\n  1394→    return experiencias_ordenadas;\n  1395→}\n  1396→\n  1397→/**\n  1398→ * Obtener créditos disponibles de la empresa y actualizar el tag.\n  1399→ * - Si tiene créditos >= 20% del plan: tag azul\n  1400→ * - Si tiene créditos < 20% del plan: tag amarillo\n  1401→ * - Si no tiene créditos: tag gris \"Sin créditos\"\n  1402→ *\n  1403→ * @param {number} empresa_id ID de la empresa\n  1404→ * @param {string} contenedor_id ID del contenedor donde se mostrará el tag\n  1405→ * @returns {void}\n  1406→ * @author Andres Gonzalez\n  1407→ */\n  1408→function obtenerCreditosDisponiblesEmpresa(empresa_id, contenedor_id = 'contenedor-tag-creditos') {\n  1409→    if (!empresa_id || !$(`#${contenedor_id}`).length) {\n  1410→        return;\n  1411→    }\n  1412→\n  1413→    $.ajax({\n  1414→        url: `/api/empresas/${empresa_id}/creditos`,\n  1415→        method: 'GET',\n  1416→        dataType: 'json',\n  1417→        success: function(respuesta) {\n  1418→            let creditos_disponibles = respuesta?.data?.creditos_disponibles ?? 0;\n  1419→            let creditos_plan = respuesta?.data?.creditos_plan ?? 0;\n  1420→            let porcentaje_disponible = creditos_plan > 0 ? (creditos_disponibles / creditos_plan) * 100 : 0;\n  1421→\n  1422→            let texto_tag = '';\n  1423→            let clase_tag = '';\n  1424→\n  1425→            if (creditos_disponibles <= 0) {\n  1426→                texto_tag = 'Sin créditos';\n  1427→                clase_tag = 'tag-tonal-gray';\n  1428→            } else if (porcentaje_disponible < 20) {\n  1429→                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n  1430→                clase_tag = 'tag-filled-yellow';\n  1431→            } else {\n  1432→                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n  1433→                clase_tag = 'tag-tonal-blue';\n  1434→            }\n  1435→\n  1436→            $(`#${contenedor_id}`).html(crearTag({\n  1437→                texto: texto_tag,\n  1438→                class: clase_tag,\n  1439→            }));\n  1440→        },\n  1441→        error: function() {\n  1442→            $(`#${contenedor_id}`).html(crearTag({\n  1443→                texto: 'Error al cargar créditos',\n  1444→                class: 'tag-tonal-gray',\n  1445→            }));\n  1446→        }\n  1447→    });\n  1448→}\n  1449→"}]},"uuid":"c5924423-d3bf-4968-a1b9-beb1a11f3748","timestamp":"2026-01-21T15:54:42.894Z","toolUseResult":{"filePath":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\globales.js","oldString":"function ordenarExperienciasPorFecha(experiencias) {\n    // Mapear con índice original\n    let experiencias_con_indice = experiencias.map((experiencia, indice_original) => ({\n        ...experiencia,\n        indice_original: indice_original\n    }));\n\n    // Ordenar experiencias\n    let experiencias_ordenadas = experiencias_con_indice.sort((a, b) => {\n        // Si 'a' no tiene fecha_fin (trabaja actualmente), va primero\n        if (!a.fecha_fin && b.fecha_fin) return -1;\n        // Si 'b' no tiene fecha_fin (trabaja actualmente), va primero\n        if (a.fecha_fin && !b.fecha_fin) return 1;\n        // Si ambos están trabajando actualmente (sin fecha_fin), mantener el orden actual\n        if (!a.fecha_fin && !b.fecha_fin) return 0;\n        // Si ambos tienen fecha_fin, ordenar por fecha más reciente primero (descendente)\n        return moment(b.fecha_fin).diff(moment(a.fecha_fin));\n    });\n\n    return experiencias_ordenadas;\n}","newString":"function ordenarExperienciasPorFecha(experiencias) {\n    // Mapear con índice original\n    let experiencias_con_indice = experiencias.map((experiencia, indice_original) => ({\n        ...experiencia,\n        indice_original: indice_original\n    }));\n\n    // Ordenar experiencias\n    let experiencias_ordenadas = experiencias_con_indice.sort((a, b) => {\n        // Si 'a' no tiene fecha_fin (trabaja actualmente), va primero\n        if (!a.fecha_fin && b.fecha_fin) return -1;\n        // Si 'b' no tiene fecha_fin (trabaja actualmente), va primero\n        if (a.fecha_fin && !b.fecha_fin) return 1;\n        // Si ambos están trabajando actualmente (sin fecha_fin), mantener el orden actual\n        if (!a.fecha_fin && !b.fecha_fin) return 0;\n        // Si ambos tienen fecha_fin, ordenar por fecha más reciente primero (descendente)\n        return moment(b.fecha_fin).diff(moment(a.fecha_fin));\n    });\n\n    return experiencias_ordenadas;\n}\n\n/**\n * Obtener créditos disponibles de la empresa y actualizar el tag.\n * - Si tiene créditos >= 20% del plan: tag azul\n * - Si tiene créditos < 20% del plan: tag amarillo\n * - Si no tiene créditos: tag gris \"Sin créditos\"\n *\n * @param {number} empresa_id ID de la empresa\n * @param {string} contenedor_id ID del contenedor donde se mostrará el tag\n * @returns {void}\n * @author Andres Gonzalez\n */\nfunction obtenerCreditosDisponiblesEmpresa(empresa_id, contenedor_id = 'contenedor-tag-creditos') {\n    if (!empresa_id || !$(`#${contenedor_id}`).length) {\n        return;\n    }\n\n    $.ajax({\n        url: `/api/empresas/${empresa_id}/creditos`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            let creditos_disponibles = respuesta?.data?.creditos_disponibles ?? 0;\n            let creditos_plan = respuesta?.data?.creditos_plan ?? 0;\n            let porcentaje_disponible = creditos_plan > 0 ? (creditos_disponibles / creditos_plan) * 100 : 0;\n\n            let texto_tag = '';\n            let clase_tag = '';\n\n            if (creditos_disponibles <= 0) {\n                texto_tag = 'Sin créditos';\n                clase_tag = 'tag-tonal-gray';\n            } else if (porcentaje_disponible < 20) {\n                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                clase_tag = 'tag-filled-yellow';\n            } else {\n                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                clase_tag = 'tag-tonal-blue';\n            }\n\n            $(`#${contenedor_id}`).html(crearTag({\n                texto: texto_tag,\n                class: clase_tag,\n            }));\n        },\n        error: function() {\n            $(`#${contenedor_id}`).html(crearTag({\n                texto: 'Error al cargar créditos',\n                class: 'tag-tonal-gray',\n            }));\n        }\n    });\n}","originalFile":"// Mensajes en español para el plugin Select2\nconst mensajes_select2 = {\n    'noResults'              : () => { return 'No hay resultados para la búsqueda.'; },\n    'searching'              : () => { return 'Buscando...'; },\n    'Loading'                : () => { return 'Cargando...'; },\n    'loadingMore'            : () => { return 'Cargando más resultados...'; },\n    'dropdownFooter'         : (texto) => { return `Mostrando ${texto} resultados`; },\n    'emptyOptions'           : () => { return 'No hay opciones disponibles.'; },\n    'appendItems'            : (items) => { return `Agregando ${items.length} elementos.`; },\n    'maximumSelectionReached': () => { return 'Se ha alcanzado el número máximo de selecciones.'; },\n    'selectOnClose'          : () => { return 'Seleccione una opción al cerrar el menú.'; },\n    'escapeKeyUp'            : () => { return 'Presione \\'Escape\\' para cerrar el menú.'; },\n    'errorLoading'           : () => { return 'Error al cargar datos. Inténtalo de nuevo más tarde.'; },\n    'inputTooShort'          : (elemento) => { return `Ingresa al menos ${elemento.minimum} caracteres para iniciar una búsqueda.`; },\n    'noMatches'              : () => { return 'No se encontraron coincidencias para tu búsqueda.'; },\n    'allowClear'             : () => { return 'Borrar selección'; },\n    'SelectionTooLong'       : (conteo, maximo) => { return `Solo puedes seleccionar ${maximo} opciones.`; },\n    'loadMore'               : () => { return 'Cargando más resultados...'; },\n    'removing'               : (seleccion) => { return 'Eliminando...'; },\n    'matches'                : (coincidencias, total) => {\n        if (coincidencias === 0) {\n            return 'No hay coincidencias.';\n        } else if (coincidencias === 1) {\n            return 'Se encontró 1 coincidencia.';\n        } else {\n            return `Se encontraron ${coincidencias} coincidencias entre ${total}.`;\n        }\n    }\n};\n\n// audios\nvar audio_notificacion = new Audio('/audios/notificacion.mp3');\n\nlet mostro_modal_creditos_ia = false;\nlet funcion_ejecucion_ia = null;\nlet modals_abiertos_ia = null;\n\n/**\n * Mostrar modal de créditos IA\n * \n * @return void\n * @author José Manuel Jiménez\n */\nfunction mostrarModalCreditosIA(servicio_ia_id) {\n    $.ajax({\n        url: `/api/empresas/${$('#empresa_sesion_id').val()}/creditos`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta_empresa) {\n            if (respuesta_empresa?.data?.creditos_disponibles > 0) {\n                $.ajax({\n                    url: `/api/servicios-ia/${servicio_ia_id}/creditos`,\n                    method: 'GET',\n                    dataType: 'json',\n                    success: function(respuesta) {\n                        if (respuesta?.data?.consume_creditos && respuesta?.data?.consume_creditos <= respuesta_empresa.data.creditos_disponibles) {\n                            $('#cantidad-creditos-descontar-modal').text(respuesta.data.consume_creditos);\n                            $('#modal-consumo-creditos-ia').modal('show');\n                            mostro_modal_creditos_ia = true;\n                            modals_abiertos_ia = $('.modal.show').not('#modal-consumo-creditos-ia').not('#modal-generando-ia');\n                            $(modals_abiertos_ia).addClass('d-none');\n                        } else {\n                            mostrarToastSolicitarCreditosIA();\n                        }\n                    }\n                });\n            } else {\n                mostrarToastSolicitarCreditosIA();\n            }\n        }\n    });\n}\n\n/**\n * Mostrar toast para solicitar créditos IA\n * \n * @return void\n * @author José Manuel Jiménez\n */\nfunction mostrarToastSolicitarCreditosIA() {\n    $.ajax({\n        url: `/empresas/${$('#empresa_sesion_id').val()}`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            let adicional_toast = '';\n            if (respuesta?.data?.ejecutivo?.telefono) {\n                adicional_toast = `<a href=\"https://wa.me/${respuesta.data.ejecutivo.telefono.replace(/\\D/g, '')}?text=Hola,%20me%20gustar%C3%ADa%20solicitar%20cr%C3%A9ditos%20adicionales%20para%20mi%20empresa.\" target=\"_blank\">\n                    <p class=\"text-label-1 text-white no-visited text-decoration-none mb-0\">Solicitar</p>\n                </a>`;\n            }\n            setTimeout(() => {\n                $('#modal-generando-ia').modal('hide');\n                $('#modal-cargue-ia').modal('hide');\n                mostrarToast('danger', 'No cuentas con créditos. Solicita créditos adicionales.', '', adicional_toast);\n            }, 300);\n        }\n    });\n}\n\n/**\n * Continuar ejecución IA luego del modal de créditos\n * \n * @return void\n * @author José Manuel Jiménez\n */\nfunction continuarEjecucionIA() {\n    if (funcion_ejecucion_ia) {\n        funcion_ejecucion_ia();\n        funcion_ejecucion_ia = null;\n    }\n    mostro_modal_creditos_ia = false;\n    $('#modal-consumo-creditos-ia').modal('hide');\n}\n\n/**\n * Solicitar más créditos IA\n * \n * @return void\n * @author José Manuel Jiménez\n */\nfunction solicitarMasCreditosIA() {\n    $.ajax({\n        url: `/empresas/${$('#empresa_sesion_id').val()}`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            if (respuesta?.data?.ejecutivo?.telefono) {\n                window.open(`https://wa.me/${respuesta.data.ejecutivo.telefono.replace(/\\D/g, '')}?text=Hola,%20me%20gustar%C3%ADa%20solicitar%20cr%C3%A9ditos%20adicionales%20para%20mi%20empresa.`, '_blank');\n            } else {\n                mostrarToast('danger', 'No se encontró un ejecutivo asignado a la empresa. Por favor, comunícate con soporte para recargar créditos.');\n            }\n            $('#modal-solicitar-mas-creditos-ia').modal('hide');\n        }\n    });\n}\n\n/**\n * Validar respuesta de créditos IA\n * \n * @return void\n * @author José Manuel Jiménez\n */\nfunction validarRespuestaCreditosIA(error_ia) {\n    if (error_ia == 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.') {\n        mostrarToastSolicitarCreditosIA();\n        return true;\n    }\n    return false;\n}\n\n/**\n * Ajustar el ancho de los elementos select2 asincrono multiple.\n *\n * @returns {void}\n * @author Andres Morales\n */\n$(document).ready(function () {\n    cargarNotificiacionesHeader();\n    if (window.configuracion_reverbg && window.configuracion_reverbg.activar_websocket) {\n        configurarWebSocketNotificaciones();\n    }\n    setTimeout(() => {\n        $(\".input-container\").each(function () {\n            let $container = $(this);\n            let $select = $container.find(\"select[multiple]\");\n            let $icon = $container.find(\".input-icono1\");\n            if ($select.length && $icon.length) {\n                $(this).find('.select2-selection--multiple').addClass('ps-5')\n            }\n        });\n    }, 1000);\n    $('#modal-consumo-creditos-ia').on('hidden.bs.modal', function () {\n        if (mostro_modal_creditos_ia) {\n            $(modals_abiertos_ia).removeClass('d-none');\n        }\n        mostro_modal_creditos_ia = false;\n    });\n});\n\n/**\n * Formatear fecha a formato dd/mm/yyyy - hh:mm AM/PM.  Ejemplo: 01/Feb/2022 - 12:00 PM\n *\n * @param {string} fecha_entrada fecha en formato ISO\n * @returns {string} fecha y hora formateada\n * @author Andres Morales\n */\nfunction formatearFecha(fecha_entrada) {\n    var fecha = new Date(fecha_entrada);\n    var dia = fecha.getDate();\n    var mes = fecha.toLocaleString('es-ES', { month: 'short' });\n    var anio = fecha.getFullYear();\n    let hora = fecha.getHours();\n    let minuto = fecha.getMinutes();\n    let ampm = hora >= 12 ? 'PM' : 'AM';\n    hora = hora % 12 || 12;\n    minuto = minuto.toString().padStart(2, '0');\n    return `${dia}/${mes}/${anio} - ${hora}:${minuto} ${ampm}`;\n}\n\nfunction formatearFecha2(fecha_entrada) {\n    let partes = fecha_entrada.split(' ');\n    let fecha = partes[0].split('-');\n    let hora = partes[1];\n    let fechaISO = `${fecha[2]}-${fecha[1]}-${fecha[0]}T${hora}`;\n\n    let date = new Date(fechaISO);\n\n    if (isNaN(date.getTime())) {\n        return 'Fecha inválida';\n    }\n\n    let dia = date.getDate();\n    let mes = date.toLocaleString('eu-EU', { month: 'short' });\n    let anio = date.getFullYear();\n    return `${dia}/${mes}/${anio}`;\n}\n\n/**\n * Opción para contraer o agrandar el menú principal\n *\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Andres Morales\n */\nfunction contraerMenu() {\n    if ($('.sidebar-menu').hasClass('close')) {\n        $('.sidebar-menu').removeClass('d-none');\n        localStorage.setItem('opcion_menu_storage', 'abierto');\n        $('#btn-collapse').attr('data-bs-original-title', 'Contraer');\n        $('#btn-collapse').attr('data-bs-title', 'Contraer');\n        $(\".menu-bar\").each(function() {\n            $(this).removeClass(\"px-2\").addClass(\"px-5\");\n        });\n        $('[data-bs-toggle=\"tooltip\"]').each(function () { new bootstrap.Tooltip(this); });\n        $('.lista-primary[data-bs-toggle=\"tooltip\"]').each(function () {\n            var tooltip_instancia = bootstrap.Tooltip.getInstance(this);\n            if (tooltip_instancia) {\n                tooltip_instancia.dispose();\n            }\n        });\n    } else {\n        $('.sidebar-menu').addClass('d-none');\n        localStorage.setItem('opcion_menu_storage', 'cerrado');\n        $('#btn-collapse').attr('data-bs-original-title', 'Expandir');\n        $('#btn-collapse').attr('data-bs-title', 'Expandir');\n        $(\".menu-bar\").each(function() {\n            $(this).removeClass(\"px-5\").addClass(\"px-2\");\n        });\n        $('[data-bs-toggle=\"tooltip\"]').each(function () { new bootstrap.Tooltip(this); });\n    }\n    $('.tooltip.bs-tooltip-auto').remove();\n    $('.sidebar-menu').toggleClass('close');\n    $('.contenedor-vista').toggleClass('close');\n    $('#btn-collapse').toggleClass('close');\n    $('.nombre-usuario-empresa').toggle();\n    $('.menu-bar .text-menu').toggle();\n}\n\n/**\n * Opción para abrir o cerrar el menu segun la elección guardada\n *\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Andres Morales\n */\nfunction mostrarMenuStorage() {\n    $(document).ready(function() {\n        $('.lista-primary[data-bs-toggle=\"tooltip\"]').each(function () {\n            var tooltip_instancia = bootstrap.Tooltip.getInstance(this);\n            if (tooltip_instancia) {\n                tooltip_instancia.dispose();\n            }\n        });\n\n        if (window.innerWidth < 768) {\n            localStorage.setItem('opcion_menu_storage', 'cerrado');\n        }\n\n        if (localStorage.getItem('opcion_menu_storage') === 'cerrado') {\n            contraerMenu();\n        }\n        let $active = $('.menu-bar .active');\n\n        if ($active.length) {\n            $('.menu-bar').scrollTop($active.position().top);\n        }\n    });\n}\nmostrarMenuStorage();\n\n/**\n * Funcion para hacer el slug de un texto desde jquery.\n *\n * @returns {void}\n * @author Andres Morales\n */\nfunction slugify(text) {\n    return $.trim(text)\n        .toLowerCase()\n        .normalize(\"NFD\")\n        .replace(/[\\u0300-\\u036f]/g, \"\")\n        .replace(/[^a-z0-9 -]/g, \"\")\n        .replace(/\\s+/g, \"-\")\n        .replace(/-+/g, \"-\");\n}\n\n/**\n * Función generica para mostrar mensajes de respuesta\n *\n * @param {string} tipo_alerta define el color de la alerta segun alerts de botstrap.\n * @param {string} texto_1 Texto que mostrara la alerta.\n * @param {string} texto_2 Texto secundario en la alerta.\n * @param {string} accion Acción adicional(por definir).\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Andres Gonzalez\n */\nfunction mostrarToast(tipo_alerta, texto_1, texto_2 = '', accion = '', icono2 = '') {\n    let icono = '';\n    let texto_color = 'text-white';\n    if (accion != '') {\n        accion = `<div class=\"col-auto p-0 text-label-1\">${accion}</div>`;\n    }\n\n    if (tipo_alerta == 'success') {\n        icono = 'bi bi-check-circle';\n    }\n\n    if (tipo_alerta == 'neutral') {\n        icono = 'bi bi-info-circle';\n    }\n\n    if (tipo_alerta == 'warning') {\n        icono = 'bi bi-info-circle';\n        texto_color = \"text-red-letras\";\n    }\n\n    if (tipo_alerta == 'danger') {\n        icono = 'bi bi-x-circle';\n    }\n\n    if (icono2 != '') {\n        icono = icono2;\n    }\n\n    if (texto_2 != '') {\n        texto_2 = `<div class=\"col-12 p-0 text-label-1 ${texto_color}\">${texto_2}</div>`;\n    }\n\n    let alert_toast = $(`\n        <div class=\"alert toast-${tipo_alerta} alert-dismissible fade show d-flex align-items-center pe-3 py-3 me-3\" role=\"alert\" style=\"display:none\">\n            <div class=\"col-auto\">\n                <span class=\"${icono} ${texto_color}\"></span>\n            </div>\n            <div class=\"col px-3\">\n                <div class=\"row m-0 ${texto_color}\">\n                    <div class=\"col-12 p-0 text-label-1 ${texto_color}\">\n                        ${texto_1}\n                    </div>\n                    ${texto_2}\n                </div>\n            </div>\n            ${accion}\n            <div class=\"col-auto ms-3 pointer\" data-bs-dismiss=\"alert\">\n                <span class=\"bi bi-x ${texto_color}\"></span>\n            </div>\n        </div>\n    `);\n    $('#contenedor-alert-toast').append(alert_toast);\n    alert_toast.fadeIn();\n    setTimeout(function() {\n        alert_toast.fadeOut();\n        alert_toast.alert('close');\n    }, 5000);\n}\n\n/**\n * Formatear número.\n *\n * @param {number} numero número a formatear\n * @author Andres Morales\n */\nfunction formatearNumero(numero) {\n    return parseInt(numero).toLocaleString('es-ES');\n}\n\n/**\n * Formatear fecha.\n *\n * @param {*} fecha Fecha a formatear.\n * @param {boolean} incluir_segundos Indica si se debe incluir los segundos en la hora.\n * @param {string} formato Formato en el que se retornará la fecha.\n * @param {string} separador Símbolo que se usará para separar días, meses y años.\n * @returns {Object} Objeto con la fecha y hora formateada.\n * @author Daniel Beltrán\n */\nfunction formatearFechaConceptual(fecha, incluir_segundos = false, formato = 'Ymd', separador = '-') {\n    const NUEVA_FECHA = new Date(fecha);\n    const ANO         = NUEVA_FECHA.getFullYear();\n    const MES         = String(NUEVA_FECHA.getMonth() + 1).padStart(2, '0');\n    const DIA         = String(NUEVA_FECHA.getDate()).padStart(2, '0');\n    const HORAS       = String(NUEVA_FECHA.getHours()).padStart(2, '0');\n    const MINUTOS     = String(NUEVA_FECHA.getMinutes()).padStart(2, '0');\n    const SEGUNDOS    = String(NUEVA_FECHA.getSeconds()).padStart(2, '0');\n\n    let fecha_formateada = `${ANO}${separador}${MES}${separador}${DIA}`;\n\n    if (formato === 'dmY') {\n        fecha_formateada = `${DIA}${separador}${MES}${separador}${ANO}`;\n    }\n\n    return {\n        fecha: fecha_formateada,\n        hora : incluir_segundos ? `${HORAS}:${MINUTOS}:${SEGUNDOS}` : `${HORAS}:${MINUTOS}`\n    };\n}\n\n/**\n * Formatear fecha a May. 2023.\n *\n * @param {string} fechaISO Fecha a formatear.\n * @returns {string} Objeto con la fecha y hora formateada.\n * @author Andres Morales\n */\nfunction formatearFechaAnioMes(fechaISO) {\n    const fecha = new Date(fechaISO);\n    const opciones = { month: 'short', year: 'numeric' };\n    let fecha_formateada = fecha.toLocaleDateString('es-ES', opciones);\n\n    fecha_formateada = fecha_formateada.replace(\n        /^([a-zñ]+)(\\s\\d{4})$/,\n        (_, mes, anio) => `${mes.charAt(0).toUpperCase() + mes.slice(1)}. ${anio.trim()}`\n    );\n\n    return fecha_formateada;\n}\n\n/**\n * Formatear un numero a moneda.\n *\n * @param {string} valor Numero.\n * @returns {string} Numero formateado.\n * @author Andres Morales\n */\nfunction formatearMonedaCOP(valor) {\n    return new Intl.NumberFormat('es-CO', {\n        style: 'currency',\n        currency: 'COP',\n        minimumFractionDigits: 0,\n        maximumFractionDigits: 0\n    }).format(valor);\n}\n\n/**\n * Formatear fecha a un formato d/m/Y hh:mm:ss entendible para el usuario.\n *\n * @param {*} fecha_inicial Fecha a formatear.\n * @returns {String} String con la fecha y hora formateada.\n * @author José Manuel Jiménez\n */\nfunction fechaMostrar(fecha_inicial) {\n    if (!fecha_inicial) {\n        return \"\";\n    }\n    const fecha = new Date(fecha_inicial);\n    if (isNaN(fecha.getTime())) {\n        return \"\";\n    }\n    const dia = String(fecha.getUTCDate()).padStart(2, '0');\n    const mes = String(fecha.getUTCMonth() + 1).padStart(2, '0');\n    const anio = fecha.getUTCFullYear();\n    if (!fecha_inicial.includes(\" \")) {\n        return `${dia}/${mes}/${anio}`;\n    }\n    const horas = String(fecha.getUTCHours()).padStart(2, '0');\n    const minutos = String(fecha.getUTCMinutes()).padStart(2, '0');\n    const segundos = String(fecha.getUTCSeconds()).padStart(2, '0');\n    return `${dia}/${mes}/${anio} ${horas}:${minutos}:${segundos}`;\n}\n\n/**\n * Descargar Excel.\n *\n * @param {string} ruta Ruta desde donde se descarga el archivo.\n * @param {string} nombre_archivo Nombre del archivo descargado.\n * @param {boolean} marca_tiempo Indica si el nombre del archivo debe llevar marca de tiempo.\n * @param {Object} parametros Parámetros a enviar en la petición.\n * @returns {void}\n * @author Daniel Beltrán\n */\nasync function descargarExcel(ruta, nombre_archivo, marca_tiempo = true, parametros = {}) {\n    parametros._token = $('meta[name=\"csrf-token\"]').attr('content');\n\n    await $.ajax({\n        type     : 'POST',\n        url      : `/${ruta}`,\n        data     : parametros,\n        xhrFields: {\n            responseType: 'blob'\n        },\n        success: function (respuesta) {\n            // Crear una URL para el Blob\n            let url = window.URL.createObjectURL(respuesta); // 'respuesta' es el Blob\n            let a   = document.createElement('a'); // Crea un nuevo elemento <a> para iniciar la descarga\n            a.href  = url;\n            const fecha_actual     = new Date();\n            const dia              = fecha_actual.getDate();\n            const mes              = fecha_actual.getMonth() + 1;\n            const ano              = fecha_actual.getFullYear();\n            const hora             = fecha_actual.getHours();\n            const minutos          = fecha_actual.getMinutes();\n            const segundos         = fecha_actual.getSeconds();\n            const fecha_formateada = `${dia}${mes}${ano}${hora}${minutos}${segundos}`;\n\n            a.download = marca_tiempo ? `${nombre_archivo}-${fecha_formateada}.xlsx` : `${nombre_archivo}.xlsx`;\n            document.body.appendChild(a);\n            a.click();\n            window.URL.revokeObjectURL(url);\n            document.body.removeChild(a);\n        }\n    }).then(() => {\n        mostrarToast('success', 'Archivo descargado correctamente.');\n    }).catch((error) => {\n        mostrarToast('danger', 'Ocurrió un error al descargar el archivo.');\n    });\n}\n\n/**\n * Convierte un string a slug.\n *\n * @param {string} str\n * @returns {string}\n * @author Fahibram Cárcamo\n */\nfunction slug(str) {\n\n    // Quita espacios en blanco\n    str = str.replace(/^\\s+|\\s+$/g, \"\")\n\n    // Convierte el string a minusculas\n    str = str.toLowerCase()\n\n    // Quita los caracteres no alfanuméricos\n    str = str.replace(/[^a-z0-9 -]/g, \"\")\n\n    // Reemplaza los espacio con guiones\n    str = str.replace(/\\s+/g, \"-\")\n\n    // Remueve los guiones consecutivos\n    str = str.replace(/-+/g, \"-\")\n\n    return str\n}\n\n/**\n * Compara los elementos de dos arreglos y retorna `true` si son iguales y `false` en caso contrario\n * (Este función está pensada para comparar arreglos unidimensionales).\n *\n * @param {array} primer_arreglo\n * @param {array} segundo_arreglo\n * @param {boolean} comparar_orden\n * @return {boolean}\n * @author Fahibram Cárcamo\n */\nfunction sonArreglosIguales(primer_arreglo, segundo_arreglo, comparar_orden = false) {\n\n    if (!comparar_orden) {\n        primer_arreglo.sort()\n        segundo_arreglo.sort()\n    }\n\n    if (primer_arreglo.length !== segundo_arreglo.length) return false\n\n    for (let i = 0; i < primer_arreglo.length; i++) {\n        if (primer_arreglo[i] !== segundo_arreglo[i]) return false\n    }\n\n    return true\n}\n\n/**\n * Función para cambiar de empresa.\n *\n * @param {number} empresa_id ID de la empresa a la que se va a cambiar.\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Daniel Beltrán\n */\nfunction cambiarEmpresa(empresa_id) {\n    $.ajax({\n        type: 'POST',\n        url: '/suplantar-rol-admin-general',\n        data: {\n            _token    : $('meta[name=\"csrf-token\"]').attr('content'),\n            empresa_id: empresa_id\n        },\n        success: function (respuesta) {\n            localStorage.setItem('notificacionToast', JSON.stringify({\n                tipo_alerta: 'success',\n                texto_1    : 'Cambio de empresa exitoso'\n            }));\n\n            window.location.reload();\n        },\n        error: function (error) {\n            mostrarToast('danger', 'Ocurrió un error al cambiar de empresa');\n        }\n    });\n}\n\n/**\n * Enviar la solucitud de suplantación de rol y empresa al Back-end.\n *\n * @param {function|null} callback_exito Callback ejecutado en caso de éxito.\n * @param {string} url URL de suplantación.\n * @param {string} _token Token CSRF del formulario.\n * @param {number} empresa_id Id de la empresa a suplantar.\n * @param {number|null} rol_id Id del rol a suplantar.\n * @param {function|null} callback_error Callback ejecutado en caso de error.\n * @returns {void}\n * @author Fahibram Cárcamo\n */\nasync function enviarOrdenSuplantacionRolEmpresa (callback_exito, url, _token, empresa_id = null, rol_id = null, callback_error = null) {\n\n    let condicion_suplantacion = rol_id === null\n        ? empresa_id === null\n            ? true\n            : parseInt($('#empresa_sesion_id').val()) !== parseInt(empresa_id)\n        : parseInt($('#rol_sesion_id').val()) !== parseInt(rol_id) && parseInt($('#empresa_sesion_id').val()) !== parseInt(empresa_id);\n\n    if (condicion_suplantacion) {\n        let data = { _token };\n        if (empresa_id !== null) data.empresa_id = empresa_id;\n        if (rol_id !== null) data.rol_id = rol_id;\n\n        await $.ajax({ type: 'POST', url, data })\n            .then((respuesta, status, xhr) => {\n                if (xhr.status >= 200 && xhr.status < 300 && callback_exito !== null) callback_exito();\n            })\n            .catch(error => {\n                let swal_titulo, swal_texto;\n\n                if (error.status === 404) {\n                    if (error.responseJSON.mensaje) {\n                        swal_titulo = 'Algo salió mal';\n                        if (error.responseJSON.mensaje === 'no existe rol_suplantar') {\n                            swal_texto = 'El rol no existe.';\n                        } else if (error.responseJSON.mensaje === 'no existe empresa_suplantar') {\n                            swal_texto = 'La empresa no existe.';\n                        } else if (error.responseJSON.mensaje === 'no existe usuario_suplantar') {\n                            swal_texto = 'El usuario no existe.';\n                        } else {\n                            swal_texto = '';\n                        }\n                    } else if (error.responseJSON.empresa && error.responseJSON.rol) {\n                        swal_titulo = 'No fué posible cambiar de empresa';\n                        swal_texto = error.responseJSON.rol === 'Administrador general' || error.responseJSON.rol === 'Propietario'\n                            ? `La empresa ${error.responseJSON.empresa} no tiene ningún usuario con el rol Administrador general o Propietario.`\n                            : `La empresa ${error.responseJSON.empresa} no tiene ningún usuario con el rol ${error.responseJSON.rol}.`;\n                    } else {\n                        swal_titulo = 'Algo salió mal';\n                        swal_texto = error.responseJSON.errors;\n                    }\n                } else {\n                    swal_titulo = 'Algo salió mal';\n                    swal_texto = '';\n                }\n\n                if (callback_error !== null) callback_error();\n\n                Swal.fire({\n                    title: swal_titulo,\n                    text: swal_texto,\n                    icon: \"error\",\n                    confirmButtonText: \"Aceptar\"\n                });\n            });\n    }\n}\n\n/**\n * Mostrar tooltip según el div que lo contenga.\n *\n * @param {div} div Elemento en donde se va a mostrar el tooltip.\n * @returns {void}\n * @author Sol Espitia\n */\nfunction mostrarTooltip(div) {\n    const TOOLTIP         = div.querySelector('.tooltip-x');\n    TOOLTIP.style.display = 'block';\n}\n\n/**\n * Ocultar tooltip según el div que lo contenga.\n *\n * @param {div} div Elemento en donde se va a mostrar el tooltip.\n * @returns {void}\n * @author Sol Espitia\n */\nfunction ocultarTooltip(div) {\n    const TOOLTIP         = div.querySelector('.tooltip-x');\n    TOOLTIP.style.display = 'none';\n}\n\n/**\n * Retornar la diferencia en días de dos fechas dadas.\n *\n * @param {string} fecha_inicial Fecha inicial\n * @param {string} fecha_final Fecha final\n * @param {bool} valor_absoluto Retorna la diferencia en valor absoluto\n * @returns {number}\n * @author Fahibram Cárcamo\n * @author Andres Morales\n */\nfunction diferenciaFechasDias(fecha_inicial, fecha_final, valor_absoluto = false, sumar_dia = true) {\n    let fecha1 = new Date(fecha_inicial);\n    let fecha2 = new Date(fecha_final);\n\n    fecha1.setHours(0, 0, 0, 0);\n    fecha2.setHours(0, 0, 0, 0);\n\n    let diferencia_milisegundos = fecha2.getTime() - fecha1.getTime();\n\n    let diferencia_dias = diferencia_milisegundos / (1000 * 60 * 60 * 24);\n    let resultado = diferencia_dias;\n    if (sumar_dia) {\n        resultado = diferencia_dias + 1;\n    }\n\n    return valor_absoluto ? Math.abs(resultado) : resultado;\n}\n\n/**\n * Retornar `true` si una fecha dada está dentro de un rango de fechas dadas, `false` en otro caso.\n *\n * @param {string} fecha Fecha dada\n * @param {string} fecha_desde Fecha inicial del rango\n * @param {string} fecha_hasta Fecha final del rango\n * @returns {boolean}\n * @author Fahibram Cárcamo\n */\nfunction fechaDentroDelRango(fecha, fecha_desde, fecha_hasta) {\n    fecha = new Date(fecha);\n    fecha_desde = new Date(fecha_desde);\n    fecha_hasta = new Date(fecha_hasta);\n\n    if (isNaN(fecha) || isNaN(fecha_desde) || isNaN(fecha_hasta)) {\n        throw new Error('Una o más fechas no son válidas.');\n    }\n\n    return fecha >= fecha_desde && fecha <= fecha_hasta;\n}\n\n/**\n * Descuenta el tiempo para las respuestas.\n *\n * @param id - ID del elemento HTML donde mostrar el tiempo\n * @param tiempo - Tiempo inicial en segundos\n * @author Jair Carvajal\n */\nvar tiempos_usados = {};\n\nfunction descuentoTiempo(id, tiempo, callback, onTick) {\n    var $elemento = $('#' + id);\n    if ($elemento.length === 0) {\n        console.error('Elemento con id \"' + id + '\" no encontrado.');\n        return;\n    }\n    if (tiempos_usados[id]) {\n        clearInterval(tiempos_usados[id]);\n    }\n    let tiempoTotal = tiempo;\n    tiempos_usados[id] = setInterval(function() {\n        if (tiempo <= 0) {\n            clearInterval(tiempos_usados[id]);\n            delete tiempos_usados[id];\n            $elemento.text('Tiempo finalizado');\n            if (window.tiempoFinalizado()) {\n                tiempoFinalizado();\n            }\n            if (typeof callback === 'function') {\n                callback();\n            }\n            return;\n        }\n\n        var minutos = Math.floor(tiempo / 60);\n        var segundos = tiempo % 60;\n\n        var textoTiempo = minutos + ':' + (segundos < 10 ? '0' : '') + segundos + '<i class=\"bi bi-alarm ms-2\"></i>';\n\n        if (tiempo <= 15) {\n            $elemento.addClass('text-state-red');\n            $elemento.removeClass('text-state-green');\n        } else {\n            $elemento.addClass('text-state-green');\n            $elemento.removeClass('text-state-red');\n        }\n\n        $elemento.html(textoTiempo);\n\n        var tiempoUsado = tiempoTotal - tiempo;\n\n        if (typeof onTick === 'function') {\n            onTick((tiempoUsado % 5));\n        }\n        tiempo--;\n    }, 1000);\n}\n\n/**\n * Detengo el tiempo para las respuestas.\n *\n * @param id - ID del elemento HTML donde mostrar el tiempo\n * @param tiempo - Tiempo inicial en segundos\n * @author Jair Carvajal\n */\nfunction detenerDescuentoTiempo(id) {\n    if (tiempos_usados[id]) {\n        clearInterval(tiempos_usados[id]);\n        delete tiempos_usados[id];\n    }\n}\n\n/**\n * Genera un SVG de la imagen de usuario.\n *\n * @param id ID del usuario.\n * @param nombres Nombres del usuario.\n * @param apellidos Apellidos del usuario.\n * @return image\n * @author Andres Morales\n */\nfunction crearImagenUsuarioLetras(id, nombres, apellidos) {\n    var tamano = 200;\n    var iniciales = (nombres[0] + apellidos[0]).toUpperCase();\n    var hash = md5(id);\n\n    var r = parseInt(hash.substring(0, 2), 16);\n    var g = parseInt(hash.substring(2, 4), 16);\n    var b = parseInt(hash.substring(4, 6), 16);\n    var colorFondo = `rgb(${r},${g},${b})`;\n\n    var luminancia = 0.299 * r + 0.587 * g + 0.114 * b;\n    var colorTexto = luminancia > 150 ? \"#000000\" : \"#FFFFFF\";\n\n    // SVG como texto\n    var svg = `\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${tamano}\" height=\"${tamano}\">\n        <rect width=\"100%\" height=\"100%\" fill=\"${colorFondo}\" />\n        <text x=\"50%\" y=\"50%\" dy=\".35em\"\n            text-anchor=\"middle\"\n            font-family=\"Lato, sans-serif\"\n            font-size=\"${tamano * 0.4}\"\n            fill=\"${colorTexto}\">\n            ${iniciales}\n        </text>\n    </svg>`;\n    var svgEncoded = encodeURIComponent(svg)\n        .replace(/'/g, \"%27\")\n        .replace(/\"/g, \"%22\");\n\n    var dataUri = `data:image/svg+xml,${svgEncoded}`;\n    return dataUri;\n}\n\n/**\n * Carga las notificaciones\n *\n * @return void\n * @author Andres Morales\n * @author Andres Gonzalez\n * @author Esperanza Olivo\n */\nfunction cargarNotificiacionesHeader() {\n    $.ajax({\n        url: '/usuario-notificaciones',\n        type: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            let datos = respuesta.data;\n            let notificaciones_noleidas = datos?.unread_notifications?.length ?? 0;\n\n            // Siempre remover el badge existente\n            $('#dropdownNotificaciones #badge-notificaciones').remove();\n\n            // Solo agregar el badge si hay notificaciones no leídas\n            if (notificaciones_noleidas > 0) {\n                $('#dropdownNotificaciones').append(`<span id=\"badge-notificaciones\" class=\"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger border border-white\">${notificaciones_noleidas}</span>`);\n                $('#contador-notificaciones-abierto').append(`<span id=\"badge-notificaciones\" class=\"badge rounded-pill bg-danger border border-white\">${notificaciones_noleidas}</span>`);\n\n                $('#contenedor-boton-marcar-todas').html(`\n                    <button class=\"btn btn-link text-primary w-100 d-flex justify-content-center\" onclick=\"marcarNotificacionesLeidas('all')\">\n                        Marcar todo como leído\n                    </button>\n                `);\n            }\n\n            let no_leidos_ids = Array.isArray(datos?.unread_notifications) ? datos.unread_notifications.map(notificacion => notificacion.id): [];\n\n            if (Array.isArray(datos?.notifications) && datos.notifications.length > 0) {\n                $('#notificacion-sinnotificaciones').hide();\n                $('.notificaciones-listado').remove();\n                datos.notifications.forEach(notificacion => {\n                    const { id, data, updated_at } = notificacion;\n\n                    const NO_LEIDO = no_leidos_ids.includes(id);\n                    const MENSAJE = (data?.mensaje || '').slice(0, 120) + '...';\n                    const HORA = new Date(updated_at).toLocaleTimeString('es-CO', {\n                        hour: '2-digit',\n                        minute: '2-digit',\n                        hour12: false\n                    });\n\n                    const notificaciones = `\n                        <li class=\"${NO_LEIDO ? '' : 'bg-gray-90'} notificaciones-listado py-0\" id=\"notificacion-${id}\">\n                            <a class=\"dropdown-item text-gray-10 text-decoration-none border-top pt-0 pb-1\" href=\"javascript:void(0)\" onclick=\"marcarNotificacionesLeidas('${id}','${data?.ruta}')\">\n                                <div class=\"d-flex justify-content-between\">\n                                    <div class=\"w-auto flex-grow-1 pe-3\">\n                                        <p class=\"mt-1 mb-0 text-headline-6 text-gray-10\">${data?.titulo}</p>\n                                        <p class=\"mb-0 text-body-3 text-gray-30 notificacion-mensaje\">${MENSAJE}</p>\n                                    </div>\n                                    <div class=\"w-auto my-auto ${NO_LEIDO ? 'text-cta-azul' : 'text-gray-10'} text-label-2 flex-shrink-0\">\n                                        ${HORA}${NO_LEIDO ? `<i class=\"bi bi-circle-fill text-cta-azul my-auto texto-notificacion-icono ms-3\"></i>` : ''}\n                                    </div>\n                                </div>\n                            </a>\n                        </li>\n                    `;\n\n                    $(notificaciones).insertBefore('#contenedor-boton-marcar-todas');\n                });\n\n            } else {\n                $('#notificacion-sinnotificaciones').hide();\n                $('.notificaciones-listado').remove();\n            }\n\n        },\n        error: function(xhr, status, error) {\n            console.error('Error al cargar notificaciones:', error);\n        }\n    });\n}\n\n/**\n * Marcar las notificaciones leídas.\n *\n * @param {array} notificaciones_ids ids de las notificaciones\n * @param {string} ruta_destino ruta donde se va ha actualizar la pagina\n * @returns {void}\n * @author Andres Gonzalez\n * @author Esperanza Olivo\n */\nfunction marcarNotificacionesLeidas(notificaciones_ids = null, ruta_destino = null, soporte_id = null) {\n\n    let data = {\n        _token: $('meta[name=\"csrf-token\"]').attr('content')\n    };\n\n    if (notificaciones_ids === 'all') {\n        data.marcar_todo = true;\n    } else if (soporte_id) {\n        data.soporte_id = soporte_id;\n    } else if (notificaciones_ids) {\n        data.notificaciones_ids = Array.isArray(notificaciones_ids)\n            ? notificaciones_ids\n            : [notificaciones_ids];\n    }\n\n    $.ajax({\n        url: '/usuario-marcar-notificaciones-leidas',\n        type: 'POST',\n        data: data,\n        success: function(respuesta) {\n            cargarNotificiacionesHeader();\n\n            if (notificaciones_ids && notificaciones_ids !== 'all' && ruta_destino) {\n                window.location.href = \"/\" + ruta_destino;\n            }\n\n            if (notificaciones_ids === 'all') {\n                $('#badge-notificaciones').remove();\n                $('#contenedor-boton-marcar-todas').empty();\n                $('.notificaciones-listado').addClass('bg-gray-90');\n                $('.bi-circle-fill').remove();\n            }\n        },\n        error: function(xhr, estatus, error) {\n            console.error('Error al cargar notificaciones:', error);\n        }\n    });\n}\n\n/**\n * Configurar WebSocket para notificaciones en tiempo real\n *\n * @return void\n * @author Andres Gonzalez\n */\nfunction configurarWebSocketNotificaciones() {\n    try {\n        if (!window.configuracion_reverbg) {\n            return;\n        }\n\n        const PUSHER = new Pusher(window.configuracion_reverbg.appKey, {\n            wsHost: window.configuracion_reverbg.host,\n            wsPort: window.configuracion_reverbg.port,\n            wssPort: window.configuracion_reverbg.port,\n            cluster: 'mt1',\n            forceTLS: false,\n            enabledTransports: ['ws', 'wss'],\n            authEndpoint: '/broadcasting-auth',\n            auth: {\n                headers: {\n                    'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\n                }\n            }\n        });\n\n        PUSHER.connection.bind('failed', function() {\n            console.error('❌ Conexión WebSocket falló');\n        });\n\n        PUSHER.connection.bind('error', function(error) {\n            console.error('❌ Error de WebSocket:', error);\n        });\n\n        let usuario_id = window.configuracion_reverbg.usuario_id;\n\n        if (!usuario_id) {\n            return;\n        }\n\n        const NOMBRE_CANAL = `private-App.Models.Usuarios.User.${usuario_id}`;\n        const CANAL = PUSHER.subscribe(NOMBRE_CANAL);\n\n        CANAL.bind('pusher:subscription_error', function(error) {\n            console.error('❌ Error al suscribirse al canal:', error);\n        });\n\n        // Escuchar eventos específicos de notificaciones\n        CANAL.bind('Illuminate\\\\Notifications\\\\Events\\\\BroadcastNotificationCreated', function(data) {\n            if (data.tipo === 'nueva_notificacion') {\n                audio_notificacion.play();\n                cargarNotificiacionesHeader();\n            }\n\n            if (data.tipo === 'nuevo_mensaje') {\n                if (($('#soporte-guardado-id').val() == data.soporte_id) || ($('#soporte_empresa_id').val() == data.soporte_id)) {\n                    audio_notificacion.play();\n                    consultarChat(data.soporte_id);\n                }\n            }\n        });\n    } catch (error) {\n        console.error('💥 Error en configurarWebSocketNotificaciones:', error);\n        console.error('Stack trace:', error.stack);\n    }\n}\n\n/**\n * Retornar el string entrante en formato title case.\n *\n * @param {string} texto\n * @returns {string}\n * @author Fahibram Cárcamo\n */\nfunction titleCase(texto) {\n    return texto.toLowerCase().replace(/\\b\\w/g, caracter => caracter.toUpperCase());\n}\n\n/**\n * Número de horas que durará el almacenamiento de la variable `ulitmas_empresas` en el\n * almacenamiento local **LocalStorage**.\n *\n * @var {number}\n * @author Fahibram Cárcamo\n */\nconst CANTIDAD_HORAS_VENCIMIENTO_ULTIMAS_EMPRESAS_LOCALSTORAGE = 6;\n\n/**\n * Validar si ya debe removerse la variable `ultimas_empresas` del alamacenamiento local\n * **LocalStorage**, si no es tiempo de eliminarla entonces se reinicia el tiempo de vigencia de la\n * variable.\n *\n * @returns {void}\n * @author Fahibram Cárcamo\n */\nfunction validarYActualizarUltimasEmpresasLocalStorage() {\n    let fecha_hora_actuales = moment();\n    let fecha_hora_vencimiento_ultimas_empresas = fecha_hora_actuales.clone().add(CANTIDAD_HORAS_VENCIMIENTO_ULTIMAS_EMPRESAS_LOCALSTORAGE, 'hours');\n    let fecha_hora_vencimiento_ultimas_empresas_localstorage = localStorage.getItem('vencimiento_ultimas_empresas');\n    let ultimas_empresas = localStorage.getItem('ultimas_empresas');\n\n    if (\n        ultimas_empresas != null &&\n        fecha_hora_vencimiento_ultimas_empresas_localstorage != null &&\n        fecha_hora_actuales.clone().isBefore(moment(fecha_hora_vencimiento_ultimas_empresas_localstorage).clone())\n    ) {\n        localStorage.setItem('vencimiento_ultimas_empresas', fecha_hora_vencimiento_ultimas_empresas.format('YYYY-MM-DD HH:mm:ss'));\n        return;\n    }\n\n    localStorage.removeItem('vencimiento_ultimas_empresas');\n    localStorage.removeItem('ultimas_empresas');\n}\n\n/**\n * Obtener la edad actual de un usuario según su fecha de nacimiento.\n *\n * @param {string} fecha_nacimiento\n * @returns {string}\n * @author José Manuel Jiménez\n * @author Fahibram Cárcamo\n * @author Andres Morales\n */\nfunction obtenerEdad(fecha_nacimiento) {\n    if (!fecha_nacimiento) return \"N/A\";\n    let hoy = new Date();\n    let nacimiento = new Date(fecha_nacimiento);\n    let edad = hoy.getFullYear() - nacimiento.getFullYear();\n    let mes = hoy.getMonth() - nacimiento.getMonth();\n    if (mes < 0 || (mes === 0 && hoy.getDate() < nacimiento.getDate())) edad--;\n    return edad + \" años\";\n}\n\n/**\n * Restablecer un input de tipo file.\n *\n * @param {html} elemento_input_html Elemento input html.\n * @param {html} label_elemento_input_html Label del elemento input html.\n * @param {html} boton_eliminar_elemento_input_html Botón para eliminar archivo del elemento input html.\n * @author Fahibram Cárcamo\n */\nfunction reiniciarCampoArchivo(elemento_input_html, label_elemento_input_html, boton_eliminar_elemento_input_html) {\n    elemento_input_html.val('');\n    elemento_input_html.removeAttr('data-base64');\n    label_elemento_input_html.text('Ningún archivo seleccionado');\n    boton_eliminar_elemento_input_html.hide();\n\n    if (elemento_input_html.data('imagen')) {\n        $('#' + elemento_input_html.data('imagen')).val('');\n        $('#' + elemento_input_html.data('imagen') + '_previsualizacion').attr('src', '');\n        $('#' + elemento_input_html.data('imagen') + '_fondo_previsualizacion').removeClass('d-none');\n    }\n}\n\n/**\n * Definir un campo destinado a recibir un número de teléfono celular.\n *\n * Esta función debe llamarse en el evento ready del objeto global document:\n * `$(document).ready(...)`. Ademas debe incluirse un pequeño fragmento de código en la función\n * `validacionAdicional` para que se agregué el código del número de celular al valor de campo\n * cuando se envíe el formulario donde se encutra el campo.\n *\n * ```\n * if (\n *   $('#input_celular_id').length &&\n *   $('#input_celular_id').val() !== '' &&\n *   input_celular.getNumber() !== ''\n * ) {\n *   $('#input_celular_id').val(input_celular.getNumber().slice(1));\n * }\n * ```\n *\n * Donde `input_celular` es el objeto retornado por esta función.\n *\n * @param {string} input_celular_id Id del campo.\n * @param {string} nombre_input_celular Nombre del campo.\n * @param {string} placeholder_input_celular Placeholder del campo.\n * @param {boolean} obligatorio El campo es obligatorio en el formulario.\n * @returns {object}\n * @author Fahibram Cárcamo\n */\nfunction definirInputTipoCelular(input_celular_id, nombre_input_celular, placeholder_input_celular, obligatorio = true) {\n    /**\n     * 🌎 Campo para ingresar un número de telefono con selectór de código de país con banderas.\n     * Este componente se creó con la librería International Telephone Input\n     * (https://intl-tel-input.com).\n     *\n     * La linea hiddenInput: () => ({ phone: 'celular_contacto' }) tiene como función establecer el\n     * nombre del campo, es decir, la llave del par llave-valor que se adjuntará en los datos del\n     * formulario cuando se envíe, en este caso 'celular_contacto'.\n     *\n     * Las lienas autoPlaceholder: 'aggressive' y\n     * customPlaceholder: (placeholder, country) => 'Celular*' se usan para definir el placeholder\n     * del campo.\n     *\n     * Con $('#celular_contacto').attr('required', true); se establece el campo como requerido\n     * dentro del formulario, se hace de esta forma porque la librería no admite el atributo\n     * required directamente en el componente html.\n     *\n     * @author Fahibram Cárcamo\n     */\n    if (document.querySelector(`#${input_celular_id}`)) {\n        const dropdown_dinamico = document.createElement('div');\n        document.body.appendChild(dropdown_dinamico);\n\n        let campo_celular = window.intlTelInput(document.querySelector(`#${input_celular_id}`), {\n            nationalMode: true,\n            initialCountry: 'co',\n            separateDialCode: true,\n            autoInsertDialCode: false,\n            autoPlaceholder: 'aggressive',\n            dropdownContainer: dropdown_dinamico,\n            customPlaceholder: (placeholder, country) => placeholder_input_celular,\n            loadUtils: () => import('https://cdn.jsdelivr.net/npm/intl-tel-input@25.4.2/build/js/utils.js'),\n            onlyCountries: [\n                'CO', // Colombia\n                'EC', // Ecuador\n                'AR', // Argentina\n                'CL', // Chile\n                'VE', // Venezuela\n                'PE', // Perú\n                'BO', // Bolivia\n                'UY', // Uruguay\n                'PY', // Paraguay\n                'PA', // Panamá\n                'MX', // México\n                'CR', // Costa Rica\n                // 'PR', // Puerto Rico\n                'CU', // Cuba\n                // 'DO', // República Dominicana\n                'SV', // El Salvador\n                'GT', // Guatemala\n                'HN', // Honduras\n                'NI', // Nicaragua\n                'ES', // España\n                'US', // Estados Unidos\n                'GQ'  // Guinea Ecuatorial\n            ]\n        });\n\n        if (obligatorio) $(`#${input_celular_id}`).attr('required', true);\n\n        return campo_celular;\n    }\n\n    return null;\n}\n\n/**\n * Establece la validación adicional que se aplica a un campo de tipo celular antes de enviar sus\n * datos en un formulario.\n *\n * @param {HTMLInputElement} input Elemento HTML del campo de tipo celular.\n * @param {string} input_id Id del elemento HTML del campo de tipo celular.\n * @author Fahibram Cárcamo\n * @author Jair Carvajal\n */\nfunction validacionAdicionalInputTipoCelular(input, input_id) {\n    let numero_completo = input.getNumber();\n    let indicativo = '+' + input.getSelectedCountryData().dialCode;\n    let codigo_iso2_pais = input.getSelectedCountryData().iso2;\n    let numero_sin_indicativo = numero_completo.replace(indicativo, '');\n    $(`#indicativo_${input_id}`).val(indicativo);\n    $(`#codigo_iso2_pais_${input_id}`).val(codigo_iso2_pais);\n    $(`#${input_id}`).val(numero_sin_indicativo);\n}\n\n/**\n * Rellenar un input de tipo celular.\n *\n * @param {string} indicativo_celular Código del país del número de celular.\n * @param {string} codigo_pais_iso2 Código ISO2 del país del número de celular.\n * @param {string} numero_celular Número de celular sin código de país.\n * @param {string} input_celular_id ID del input de tipo celular.\n * @param {HTMLInputElement} input_celular Input de tipo celular.\n * @returns {void}\n * @author Daniel Beltrán\n * @author Fahibram Cárcamo\n */\nfunction rellenarInputCelular(indicativo_celular, codigo_pais_iso2, numero_celular, input_celular_id, input_celular) {\n    $(`#${input_celular_id}`).val(numero_celular);\n    if (![null, undefined].includes(codigo_pais_iso2)) input_celular.setCountry(codigo_pais_iso2);\n}\n\n/**\n * Convierte imágenes de base64 a Blob.\n *\n * @param {string} cadena_base_64 Base 64 de la imagen.\n * @returns {Promise<Array>}\n * @author Andres Gonzalez\n */\nfunction imagenBase64Blob(cadena_base_64) {\n    if (!cadena_base_64 || !cadena_base_64.startsWith('data:image')) return null;\n    let datos_base_64 = cadena_base_64.split(',')[1];\n    let tipo_mime = cadena_base_64.match(/data:(.*?);base64/)[1];\n    let caracteres_binarios = atob(datos_base_64);\n    let arreglo_bytes = new Array(caracteres_binarios.length).fill(0).map((_, i) => caracteres_binarios.charCodeAt(i));\n    let bytes_uint8 = new Uint8Array(arreglo_bytes);\n    return new Blob([bytes_uint8], { type: tipo_mime });\n}\n\n\n/**\n * Limpiar estructuras html innecesarias en el check editor.\n *\n * @param {string} html - Cadena HTML generada por CKEditor a limpiar\n * @returns {string} HTML limpio sin elementos específicos de CKEditor\n * @author Andres Gonzalez\n * @author Jair Carvajal\n */\nfunction limpiarHTMLCKEditor(html) {\n    // Remover todos los elementos con clases de CKEditor\n    html = html.replace(/<div class=\"ck[^\"]*\"[^>]*>.*?<\\/div>/gs, '');\n    html = html.replace(/<span class=\"[^\"]*ck[^\"]*\"[^>]*>/gi, '<span>');\n\n    // Limpiar spans de imagen inline\n    html = html.replace(/<span class=\"image-inline[^\"]*\"[^>]*>/gi, '');\n    html = html.replace(/<\\/span>/g, '');\n\n    // Remover elementos de upload y widgets\n    html = html.replace(/<div class=\"ck-image-upload[^\"]*\"[^>]*>.*?<\\/div>/gs, '');\n    html = html.replace(/<div class=\"ck-fake-selection[^\"]*\"[^>]*>.*?<\\/div>/gs, '');\n\n    // Remover atributos innecesarios\n    html = html.replace(/contenteditable=\"[^\"]*\"/gi, '');\n    html = html.replace(/data-cke-filler=\"[^\"]*\"/gi, '');\n\n    // Limpiar párrafos vacíos con br\n    html = html.replace(/<p><br[^>]*><\\/p>/gi, '');\n    html = html.replace(/<br data-cke[^>]*>/gi, '');\n\n    // Limpiar espacios múltiples y saltos de línea\n    html = html.replace(/\\s+/g, ' ');\n    html = html.replace(/>\\s+</g, '><');\n\n    return html.trim();\n}\n\n/**\n * Ordena estudios por fecha_inicio más reciente (de más nueva a más antigua).\n * Preserva los índices originales para permitir edición y eliminación correcta.\n *\n * @param {Array} estudios - Array de objetos con estudios\n * @returns {Array} Array de estudios ordenados con propiedad indice_original\n * @author Jair Carvajal\n */\nfunction ordenarEstudiosPorFecha(estudios) {\n    // Mapear con índice original\n    let estudios_con_indice = estudios.map((estudio, indice_original) => ({\n        ...estudio,\n        indice_original: indice_original\n    }));\n\n    // Ordenar estudios por fecha_inicio (más reciente primero)\n    let estudios_ordenados = estudios_con_indice.sort((a, b) => {\n        // Si ambos tienen fecha_inicio, ordenar por más reciente\n        if (a.fecha_inicio && b.fecha_inicio) {\n            return moment(b.fecha_inicio).diff(moment(a.fecha_inicio));\n        }\n        // Si solo uno tiene fecha_inicio, ese va primero\n        if (a.fecha_inicio && !b.fecha_inicio) return -1;\n        if (!a.fecha_inicio && b.fecha_inicio) return 1;\n        // Si ninguno tiene fecha_inicio, mantener orden original\n        return 0;\n    });\n\n    return estudios_ordenados;\n}\n\n/**\n * Ordena experiencias laborales por fecha: primero las que está trabajando actualmente (sin fecha_fin),\n * luego por fecha_fin más reciente.\n * Preserva los índices originales para permitir edición y eliminación correcta.\n *\n * @param {Array} experiencias - Array de objetos con experiencias laborales\n * @returns {Array} Array de experiencias ordenadas con propiedad indice_original\n * @author Jair Carvajal\n */\nfunction ordenarExperienciasPorFecha(experiencias) {\n    // Mapear con índice original\n    let experiencias_con_indice = experiencias.map((experiencia, indice_original) => ({\n        ...experiencia,\n        indice_original: indice_original\n    }));\n\n    // Ordenar experiencias\n    let experiencias_ordenadas = experiencias_con_indice.sort((a, b) => {\n        // Si 'a' no tiene fecha_fin (trabaja actualmente), va primero\n        if (!a.fecha_fin && b.fecha_fin) return -1;\n        // Si 'b' no tiene fecha_fin (trabaja actualmente), va primero\n        if (a.fecha_fin && !b.fecha_fin) return 1;\n        // Si ambos están trabajando actualmente (sin fecha_fin), mantener el orden actual\n        if (!a.fecha_fin && !b.fecha_fin) return 0;\n        // Si ambos tienen fecha_fin, ordenar por fecha más reciente primero (descendente)\n        return moment(b.fecha_fin).diff(moment(a.fecha_fin));\n    });\n\n    return experiencias_ordenadas;\n}\n","structuredPatch":[{"oldStart":1393,"oldLines":3,"newStart":1393,"newLines":56,"lines":[" ","     return experiencias_ordenadas;"," }","+","+/**","+ * Obtener créditos disponibles de la empresa y actualizar el tag.","+ * - Si tiene créditos >= 20% del plan: tag azul","+ * - Si tiene créditos < 20% del plan: tag amarillo","+ * - Si no tiene créditos: tag gris \"Sin créditos\"","+ *","+ * @param {number} empresa_id ID de la empresa","+ * @param {string} contenedor_id ID del contenedor donde se mostrará el tag","+ * @returns {void}","+ * @author Andres Gonzalez","+ */","+function obtenerCreditosDisponiblesEmpresa(empresa_id, contenedor_id = 'contenedor-tag-creditos') {","+    if (!empresa_id || !$(`#${contenedor_id}`).length) {","+        return;","+    }","+","+    $.ajax({","+        url: `/api/empresas/${empresa_id}/creditos`,","+        method: 'GET',","+        dataType: 'json',","+        success: function(respuesta) {","+            let creditos_disponibles = respuesta?.data?.creditos_disponibles ?? 0;","+            let creditos_plan = respuesta?.data?.creditos_plan ?? 0;","+            let porcentaje_disponible = creditos_plan > 0 ? (creditos_disponibles / creditos_plan) * 100 : 0;","+","+            let texto_tag = '';","+            let clase_tag = '';","+","+            if (creditos_disponibles <= 0) {","+                texto_tag = 'Sin créditos';","+                clase_tag = 'tag-tonal-gray';","+            } else if (porcentaje_disponible < 20) {","+                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;","+                clase_tag = 'tag-filled-yellow';","+            } else {","+                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;","+                clase_tag = 'tag-tonal-blue';","+            }","+","+            $(`#${contenedor_id}`).html(crearTag({","+                texto: texto_tag,","+                class: clase_tag,","+            }));","+        },","+        error: function() {","+            $(`#${contenedor_id}`).html(crearTag({","+                texto: 'Error al cargar créditos',","+                class: 'tag-tonal-gray',","+            }));","+        }","+    });","+}"]}],"userModified":false,"replaceAll":false},"sourceToolAssistantUUID":"e674d781-b9c5-4b33-87f3-73b062f8b334"}
{"parentUuid":"c5924423-d3bf-4968-a1b9-beb1a11f3748","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01Nt6xYsHjp5vo9svk4E5kXe","type":"message","role":"assistant","content":[{"type":"text","text":"Ahora necesito agregar la llamada a la función cuando carga la página de vacantes. Voy a leer el archivo de vacantes.js para ver dónde agregar la llamada:"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":2672,"cache_read_input_tokens":59203,"cache_creation":{"ephemeral_5m_input_tokens":2672,"ephemeral_1h_input_tokens":0},"output_tokens":4,"service_tier":"standard"}},"requestId":"req_011CXLo3CX8neaJcdz9Ydcpa","type":"assistant","uuid":"aabea48a-90e0-4c10-a6e6-89dab4216179","timestamp":"2026-01-21T15:54:48.875Z"}
{"parentUuid":"aabea48a-90e0-4c10-a6e6-89dab4216179","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01Nt6xYsHjp5vo9svk4E5kXe","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_014LBgaaqdYEykEzvRFxjvS5","name":"Read","input":{"file_path":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\vacantes\\vacantes.js","limit":50}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":2672,"cache_read_input_tokens":59203,"cache_creation":{"ephemeral_5m_input_tokens":2672,"ephemeral_1h_input_tokens":0},"output_tokens":4,"service_tier":"standard"}},"requestId":"req_011CXLo3CX8neaJcdz9Ydcpa","type":"assistant","uuid":"f0e04c11-bd5a-4dfd-8f99-288ac3be61d1","timestamp":"2026-01-21T15:54:49.453Z"}
{"parentUuid":"f0e04c11-bd5a-4dfd-8f99-288ac3be61d1","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_014LBgaaqdYEykEzvRFxjvS5","type":"tool_result","content":"     1→var vacantes_datos_ids = [];\n     2→var vacantes_seleccionadas = [];\n     3→var nombre_tabla_vacantes = 'tabla-vacantes';\n     4→var json_filtros = {};\n     5→var filtro_html = '';\n     6→\n     7→const CONFIGURACION_TABLAS = {\n     8→    autoWidth: false,\n     9→    responsive: true,\n    10→    processing: false,\n    11→    serverSide: false,\n    12→    searching: true,\n    13→    deferRender: true,\n    14→    paging: true,\n    15→    aaSorting: [],\n    16→    language: lenguaje_componente_datatables,\n    17→    lengthMenu: [\n    18→        [5, 10, 25, 50, 100, 200],\n    19→        [5, 10, 25, 50, 100, 200]\n    20→    ],\n    21→    pageLength: 5,\n    22→    scrollX: true,\n    23→    scrollY: 'calc(100vh)',\n    24→    scrollCollapse: true\n    25→};\n    26→\n    27→$(`#${nombre_tabla_vacantes}`).DataTable({\n    28→    ...CONFIGURACION_TABLAS,\n    29→    scrollY: false,\n    30→    ajax: {\n    31→        url : '/vacantes-listado-tabla',\n    32→        data: function (datos) {\n    33→            let filtro_ordenamiento = $('#filtro_mas_recientes').val();\n    34→            if (filtro_ordenamiento) {\n    35→                let partes = filtro_ordenamiento.split('-');\n    36→                datos.campo = partes[0];\n    37→                datos.orden = partes[1];\n    38→            }\n    39→            datos.activo = $('#vacantes_archivadas').val();\n    40→\n    41→            (json_filtros.estados_filtro)\n    42→                ? datos.estado_id = json_filtros.estados_filtro\n    43→                : '';\n    44→\n    45→            (json_filtros.creador_filtro)\n    46→                ? datos.usuario_id = json_filtros.creador_filtro\n    47→                : '';\n    48→\n    49→            if (typeof json_filtros.fecha_creacion_filtro === 'string') {\n    50→                let partes_fecha = json_filtros.fecha_creacion_filtro.split(' a ');\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"8f20bf43-9e46-4e5a-8c04-1507007fd026","timestamp":"2026-01-21T15:54:50.821Z","toolUseResult":{"type":"text","file":{"filePath":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\vacantes\\vacantes.js","content":"var vacantes_datos_ids = [];\nvar vacantes_seleccionadas = [];\nvar nombre_tabla_vacantes = 'tabla-vacantes';\nvar json_filtros = {};\nvar filtro_html = '';\n\nconst CONFIGURACION_TABLAS = {\n    autoWidth: false,\n    responsive: true,\n    processing: false,\n    serverSide: false,\n    searching: true,\n    deferRender: true,\n    paging: true,\n    aaSorting: [],\n    language: lenguaje_componente_datatables,\n    lengthMenu: [\n        [5, 10, 25, 50, 100, 200],\n        [5, 10, 25, 50, 100, 200]\n    ],\n    pageLength: 5,\n    scrollX: true,\n    scrollY: 'calc(100vh)',\n    scrollCollapse: true\n};\n\n$(`#${nombre_tabla_vacantes}`).DataTable({\n    ...CONFIGURACION_TABLAS,\n    scrollY: false,\n    ajax: {\n        url : '/vacantes-listado-tabla',\n        data: function (datos) {\n            let filtro_ordenamiento = $('#filtro_mas_recientes').val();\n            if (filtro_ordenamiento) {\n                let partes = filtro_ordenamiento.split('-');\n                datos.campo = partes[0];\n                datos.orden = partes[1];\n            }\n            datos.activo = $('#vacantes_archivadas').val();\n\n            (json_filtros.estados_filtro)\n                ? datos.estado_id = json_filtros.estados_filtro\n                : '';\n\n            (json_filtros.creador_filtro)\n                ? datos.usuario_id = json_filtros.creador_filtro\n                : '';\n\n            if (typeof json_filtros.fecha_creacion_filtro === 'string') {\n                let partes_fecha = json_filtros.fecha_creacion_filtro.split(' a ');","numLines":50,"startLine":1,"totalLines":570}},"sourceToolAssistantUUID":"f0e04c11-bd5a-4dfd-8f99-288ac3be61d1"}
{"parentUuid":"8f20bf43-9e46-4e5a-8c04-1507007fd026","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01NvF7k4C6ATjJETmbgPSGGD","type":"message","role":"assistant","content":[{"type":"text","text":"Veo que el archivo vacantes.js ya existe. Ahora necesito buscar si hay un `$(document).ready` o algún lugar donde se inicialice la página para agregar la llamada:"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":879,"cache_read_input_tokens":61875,"cache_creation":{"ephemeral_5m_input_tokens":879,"ephemeral_1h_input_tokens":0},"output_tokens":3,"service_tier":"standard"}},"requestId":"req_011CXLo3f4ZvXLZceDBXuWSW","type":"assistant","uuid":"e2a5de15-23ad-442c-97a6-8fd93cc8835e","timestamp":"2026-01-21T15:54:54.686Z"}
{"parentUuid":"e2a5de15-23ad-442c-97a6-8fd93cc8835e","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01NvF7k4C6ATjJETmbgPSGGD","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_0191RwNMRB2ZtgB2fkqq1xpG","name":"Grep","input":{"pattern":"\\$\\(document\\)\\.ready|document\\.ready","path":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\vacantes\\vacantes.js","output_mode":"content"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":879,"cache_read_input_tokens":61875,"cache_creation":{"ephemeral_5m_input_tokens":879,"ephemeral_1h_input_tokens":0},"output_tokens":3,"service_tier":"standard"}},"requestId":"req_011CXLo3f4ZvXLZceDBXuWSW","type":"assistant","uuid":"0bbb0aab-0fb4-4bbd-87eb-788f870f16a3","timestamp":"2026-01-21T15:54:55.835Z"}
{"parentUuid":"0bbb0aab-0fb4-4bbd-87eb-788f870f16a3","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_0191RwNMRB2ZtgB2fkqq1xpG","type":"tool_result","content":"106:$(document).ready(function() {"}]},"uuid":"2c84fd0e-f189-4c00-a68f-f0be13358558","timestamp":"2026-01-21T15:54:58.361Z","toolUseResult":{"mode":"content","numFiles":0,"filenames":[],"content":"106:$(document).ready(function() {","numLines":1},"sourceToolAssistantUUID":"0bbb0aab-0fb4-4bbd-87eb-788f870f16a3"}
{"parentUuid":"2c84fd0e-f189-4c00-a68f-f0be13358558","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_011y7fkGoePLDwZGxg6jJdWq","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_011soQHex9PQKdEmHCTavSUZ","name":"Read","input":{"file_path":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\vacantes\\vacantes.js","offset":100,"limit":40}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":195,"cache_read_input_tokens":62754,"cache_creation":{"ephemeral_5m_input_tokens":195,"ephemeral_1h_input_tokens":0},"output_tokens":25,"service_tier":"standard"}},"requestId":"req_011CXLo4DHoW4bS1tLWVyiC5","type":"assistant","uuid":"0b316c31-3530-4f86-a3c6-da004843f9ac","timestamp":"2026-01-21T15:55:02.102Z"}
{"parentUuid":"0b316c31-3530-4f86-a3c6-da004843f9ac","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_011soQHex9PQKdEmHCTavSUZ","type":"tool_result","content":"   100→        inicializarTooltips();\n   101→        cargarDataTablas();\n   102→        validarDatos();\n   103→    }\n   104→});\n   105→\n   106→$(document).ready(function() {\n   107→    $('#fecha_archivado').hide();\n   108→    $(document).on('change', '#filtro_mas_recientes', function() {\n   109→        actualizarDatatables(nombre_tabla_vacantes);\n   110→    });\n   111→\n   112→    $(document).on('change', 'input[name=\"checkbox_vacantes\"]', function() {\n   113→        alterarBotonDescargarExcelVacantes();\n   114→    });\n   115→    $.ajax({\n   116→        url: `/api/empresas/${empresa_id}/creditos`,\n   117→        method: 'GET',\n   118→        dataType: 'json',\n   119→        success: function(respuesta) {\n   120→            let porcentaje_creditos = ((respuesta.data.creditos_disponibles / respuesta.data.creditos_plan) * 100) || 0;\n   121→            if (porcentaje_creditos <= 20 && respuesta?.data?.plan_credito) {\n   122→                $('#porcentaje-creditos-disponibles-modal').text(porcentaje_creditos);\n   123→                $('#modal-solicitar-mas-creditos-ia').modal('show');\n   124→            }\n   125→            \n   126→        }\n   127→    });\n   128→\n   129→    $(document).on('click', '#btn-archivo-vacantes', function() {\n   130→        let estado_actual = $('#vacantes_archivadas').val();\n   131→        if (estado_actual == 0) {\n   132→            $('#vacantes_archivadas').val(1);\n   133→            $('#cabecera-pagina-sin-archivar').removeClass('d-none')\n   134→            $('#cabecera-pagina-con-archivar').addClass('d-none')\n   135→            $('#btn-archivo-vacantes').html(`<i class=\"bi bi-archive me-2\"></i> Archivo de vacantes`);\n   136→            $('#btn-crear-vacante').removeClass('d-none')\n   137→            $('#fecha_archivado').hide();\n   138→        } else {\n   139→            $('#vacantes_archivadas').val(0);\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"b2f54d9e-52f0-46fa-8c78-4f2666da179f","timestamp":"2026-01-21T15:55:03.346Z","toolUseResult":{"type":"text","file":{"filePath":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\vacantes\\vacantes.js","content":"        inicializarTooltips();\n        cargarDataTablas();\n        validarDatos();\n    }\n});\n\n$(document).ready(function() {\n    $('#fecha_archivado').hide();\n    $(document).on('change', '#filtro_mas_recientes', function() {\n        actualizarDatatables(nombre_tabla_vacantes);\n    });\n\n    $(document).on('change', 'input[name=\"checkbox_vacantes\"]', function() {\n        alterarBotonDescargarExcelVacantes();\n    });\n    $.ajax({\n        url: `/api/empresas/${empresa_id}/creditos`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            let porcentaje_creditos = ((respuesta.data.creditos_disponibles / respuesta.data.creditos_plan) * 100) || 0;\n            if (porcentaje_creditos <= 20 && respuesta?.data?.plan_credito) {\n                $('#porcentaje-creditos-disponibles-modal').text(porcentaje_creditos);\n                $('#modal-solicitar-mas-creditos-ia').modal('show');\n            }\n            \n        }\n    });\n\n    $(document).on('click', '#btn-archivo-vacantes', function() {\n        let estado_actual = $('#vacantes_archivadas').val();\n        if (estado_actual == 0) {\n            $('#vacantes_archivadas').val(1);\n            $('#cabecera-pagina-sin-archivar').removeClass('d-none')\n            $('#cabecera-pagina-con-archivar').addClass('d-none')\n            $('#btn-archivo-vacantes').html(`<i class=\"bi bi-archive me-2\"></i> Archivo de vacantes`);\n            $('#btn-crear-vacante').removeClass('d-none')\n            $('#fecha_archivado').hide();\n        } else {\n            $('#vacantes_archivadas').val(0);","numLines":40,"startLine":100,"totalLines":570}},"sourceToolAssistantUUID":"0b316c31-3530-4f86-a3c6-da004843f9ac"}
{"parentUuid":"b2f54d9e-52f0-46fa-8c78-4f2666da179f","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01JXfvtyEWrK6qCVGfYTMwZK","type":"message","role":"assistant","content":[{"type":"text","text":"Veo que ya hay un `$(document).ready` en vacantes.js. Voy a agregar la llamada a la función `obtenerCreditosDisponiblesEmpresa` justo después de la línea 107:"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":812,"cache_read_input_tokens":62949,"cache_creation":{"ephemeral_5m_input_tokens":812,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXLo4acx4oacMrS1rAzEP","type":"assistant","uuid":"c43f8480-dbf0-435a-b043-aba8dbc84228","timestamp":"2026-01-21T15:55:06.786Z"}
{"parentUuid":"c43f8480-dbf0-435a-b043-aba8dbc84228","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01JXfvtyEWrK6qCVGfYTMwZK","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01RwD1FFXwQNuVoTh4EmRphX","name":"Edit","input":{"replace_all":false,"file_path":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\vacantes\\vacantes.js","old_string":"$(document).ready(function() {\n    $('#fecha_archivado').hide();","new_string":"$(document).ready(function() {\n    $('#fecha_archivado').hide();\n    obtenerCreditosDisponiblesEmpresa(empresa_id);"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":812,"cache_read_input_tokens":62949,"cache_creation":{"ephemeral_5m_input_tokens":812,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXLo4acx4oacMrS1rAzEP","type":"assistant","uuid":"bda3f713-4020-49d8-8a65-fee397b55d10","timestamp":"2026-01-21T15:55:08.195Z"}
{"parentUuid":"bda3f713-4020-49d8-8a65-fee397b55d10","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"type":"tool_result","content":"The user doesn't want to proceed with this tool use. The tool use was rejected (eg. if it was a file edit, the new_string was NOT written to the file). The user provided the following reason for the rejection:  coloca eso de ultimas en el eready","is_error":true,"tool_use_id":"toolu_01RwD1FFXwQNuVoTh4EmRphX"}]},"uuid":"6b99cbc3-bb62-48f9-99b2-7e45365d1e27","timestamp":"2026-01-21T15:55:28.040Z","toolUseResult":"Error: The user doesn't want to proceed with this tool use. The tool use was rejected (eg. if it was a file edit, the new_string was NOT written to the file). The user provided the following reason for the rejection:  coloca eso de ultimas en el eready","sourceToolAssistantUUID":"bda3f713-4020-49d8-8a65-fee397b55d10"}
{"parentUuid":"6b99cbc3-bb62-48f9-99b2-7e45365d1e27","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_015fKsNttdDkoYbH8Kn2ruoT","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_017VSmewBhVJVaYPyyUD9K9W","name":"Read","input":{"file_path":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\vacantes\\vacantes.js","offset":140,"limit":80}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":326,"cache_read_input_tokens":63761,"cache_creation":{"ephemeral_5m_input_tokens":326,"ephemeral_1h_input_tokens":0},"output_tokens":25,"service_tier":"standard"}},"requestId":"req_011CXLo6Pv5Peap4kJi5bWWD","type":"assistant","uuid":"4ee7a8d8-6d04-42c8-b3c7-b5c67789359d","timestamp":"2026-01-21T15:55:31.398Z"}
{"parentUuid":"4ee7a8d8-6d04-42c8-b3c7-b5c67789359d","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_017VSmewBhVJVaYPyyUD9K9W","type":"tool_result","content":"   140→            $('#cabecera-pagina-sin-archivar').addClass('d-none')\n   141→            $('#cabecera-pagina-con-archivar').removeClass('d-none')\n   142→            $('#btn-archivo-vacantes').html(`<i class=\"bi bi-box-arrow-left me-2\"></i> Volver a vacantes`);\n   143→            $('#btn-crear-vacante').addClass('d-none')\n   144→        }\n   145→        actualizarDatatables(nombre_tabla_vacantes);\n   146→    });\n   147→});\n   148→\n   149→\n   150→/**\n   151→ * Muestra u oculta tablas según la existencia de datos en los procesos.\n   152→ *\n   153→ * @returns {void}\n   154→ * @author Andres Morales\n   155→ */\n   156→function validarDatos() {\n   157→    if (vacantes_datos_ids.length == 0) {\n   158→        $('#tabla-contenido').addClass('d-none');\n   159→        $('#tabla-sin-contenido').removeClass('d-none');\n   160→    } else {\n   161→        $('#tabla-contenido').removeClass('d-none');\n   162→        $('#tabla-sin-contenido').addClass('d-none');\n   163→    }\n   164→}\n   165→\n   166→/**\n   167→ * Generar la cabecera de la tabla de vacantes.\n   168→ *\n   169→ * @param {object} vacante Datos de la vacante.\n   170→ * @returns {html} Cabecera de la tabla de vacantes.\n   171→ * @author Fahibram Cárcamo\n   172→ * @author Andres Morales\n   173→ */\n   174→function cabeceraFilaTablaVacantes(vacante) {\n   175→    let nombre_truncado = vacante.nombre_vacante.length > 80\n   176→        ? vacante.nombre_vacante.substring(0, 80) + '...'\n   177→        : vacante.nombre_vacante;\n   178→\n   179→    return `\n   180→        <div class=\"col-12 border-bottom\">\n   181→            <div class=\"row mb-3\">\n   182→                <div class=\"col-auto d-flex align-items-center\">\n   183→                    ${crearCheckbox({ id: vacante.id, name: 'checkbox_vacantes' })}&nbsp;\n   184→                    <span class=\"text-body-2\">${vacante.id}</span></div>\n   185→                <div class=\"col\">\n   186→                    <div class=\"row w-100\">\n   187→                        <div class=\"col-auto\">\n   188→                            <a class=\"alineacion-contenido-left btn btn-text-primary text-dark\" ${crearTooltip({ placement: `top`, content: `${vacante.nombre_vacante}`, toggle: `popover` })} href=\"/vacantes-detalle/${vacante.id}\">\n   189→                                <span class=\"text-headline-5 text-gray-10 text-decoration-underline\">${nombre_truncado}</span>\n   190→                            </a>\n   191→                        </div>\n   192→                    </div>\n   193→                    <div class=\"row w-100 mb-2\">\n   194→                        <div class=\"col-auto text-label-2 d-flex px-1\" ${crearTooltip({ placement: `top`, content: `${vacante.creador?.nombres} ${vacante.creador?.apellidos}`, toggle: `popover` })}>\n   195→                            <div class=\"my-auto mx-1\"><i class=\"bi bi-person text-body-2 my-auto\"></i></div>\n   196→                            <div class=\"my-auto mx-1\">Creador:</div>\n   197→                            <div class=\"my-auto mx-1\"><img class=\"rounded-circle\" src=\"/usuarios-imagen/${vacante.creador.id}\" width=\"20px\" height=\"20px\"></div>\n   198→                        </div>\n   199→                        <div class=\"col-auto text-label-2 d-flex px-1\">\n   200→                            <div class=\"my-auto mx-1\"><i class=\"bi bi-briefcase text-body-2 my-auto\"></i></div>\n   201→                            <div class=\"my-auto mx-1\">Vacantes:</div>\n   202→                            <div class=\"my-auto mx-1\">${vacante.cantidad_vacantes}</div>\n   203→                        </div>\n   204→                    </div>\n   205→                </div>\n   206→                <div class=\"col-auto\">\n   207→                    <div class=\"row\">\n   208→                        ${vacante.activo == 1 ? `\n   209→                            <div class=\"col-auto\">${crearTag({ texto: `Total de candidatos: ${vacante.conteo_aplicantes}`, class: 'tag-tonal-gray' })}</div>\n   210→                        ` : ''}\n   211→                        <div class=\"col-auto\">${ESTADOS_VACANTES[vacante.estado_id]}</div>\n   212→                    </div>\n   213→                </div>\n   214→            </div>\n   215→        </div>\n   216→    `;\n   217→}\n   218→\n   219→/**\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"701f2648-04c0-4fb8-a92d-864b2aad0fee","timestamp":"2026-01-21T15:55:33.556Z","toolUseResult":{"type":"text","file":{"filePath":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\vacantes\\vacantes.js","content":"            $('#cabecera-pagina-sin-archivar').addClass('d-none')\n            $('#cabecera-pagina-con-archivar').removeClass('d-none')\n            $('#btn-archivo-vacantes').html(`<i class=\"bi bi-box-arrow-left me-2\"></i> Volver a vacantes`);\n            $('#btn-crear-vacante').addClass('d-none')\n        }\n        actualizarDatatables(nombre_tabla_vacantes);\n    });\n});\n\n\n/**\n * Muestra u oculta tablas según la existencia de datos en los procesos.\n *\n * @returns {void}\n * @author Andres Morales\n */\nfunction validarDatos() {\n    if (vacantes_datos_ids.length == 0) {\n        $('#tabla-contenido').addClass('d-none');\n        $('#tabla-sin-contenido').removeClass('d-none');\n    } else {\n        $('#tabla-contenido').removeClass('d-none');\n        $('#tabla-sin-contenido').addClass('d-none');\n    }\n}\n\n/**\n * Generar la cabecera de la tabla de vacantes.\n *\n * @param {object} vacante Datos de la vacante.\n * @returns {html} Cabecera de la tabla de vacantes.\n * @author Fahibram Cárcamo\n * @author Andres Morales\n */\nfunction cabeceraFilaTablaVacantes(vacante) {\n    let nombre_truncado = vacante.nombre_vacante.length > 80\n        ? vacante.nombre_vacante.substring(0, 80) + '...'\n        : vacante.nombre_vacante;\n\n    return `\n        <div class=\"col-12 border-bottom\">\n            <div class=\"row mb-3\">\n                <div class=\"col-auto d-flex align-items-center\">\n                    ${crearCheckbox({ id: vacante.id, name: 'checkbox_vacantes' })}&nbsp;\n                    <span class=\"text-body-2\">${vacante.id}</span></div>\n                <div class=\"col\">\n                    <div class=\"row w-100\">\n                        <div class=\"col-auto\">\n                            <a class=\"alineacion-contenido-left btn btn-text-primary text-dark\" ${crearTooltip({ placement: `top`, content: `${vacante.nombre_vacante}`, toggle: `popover` })} href=\"/vacantes-detalle/${vacante.id}\">\n                                <span class=\"text-headline-5 text-gray-10 text-decoration-underline\">${nombre_truncado}</span>\n                            </a>\n                        </div>\n                    </div>\n                    <div class=\"row w-100 mb-2\">\n                        <div class=\"col-auto text-label-2 d-flex px-1\" ${crearTooltip({ placement: `top`, content: `${vacante.creador?.nombres} ${vacante.creador?.apellidos}`, toggle: `popover` })}>\n                            <div class=\"my-auto mx-1\"><i class=\"bi bi-person text-body-2 my-auto\"></i></div>\n                            <div class=\"my-auto mx-1\">Creador:</div>\n                            <div class=\"my-auto mx-1\"><img class=\"rounded-circle\" src=\"/usuarios-imagen/${vacante.creador.id}\" width=\"20px\" height=\"20px\"></div>\n                        </div>\n                        <div class=\"col-auto text-label-2 d-flex px-1\">\n                            <div class=\"my-auto mx-1\"><i class=\"bi bi-briefcase text-body-2 my-auto\"></i></div>\n                            <div class=\"my-auto mx-1\">Vacantes:</div>\n                            <div class=\"my-auto mx-1\">${vacante.cantidad_vacantes}</div>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"col-auto\">\n                    <div class=\"row\">\n                        ${vacante.activo == 1 ? `\n                            <div class=\"col-auto\">${crearTag({ texto: `Total de candidatos: ${vacante.conteo_aplicantes}`, class: 'tag-tonal-gray' })}</div>\n                        ` : ''}\n                        <div class=\"col-auto\">${ESTADOS_VACANTES[vacante.estado_id]}</div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    `;\n}\n\n/**","numLines":80,"startLine":140,"totalLines":570}},"sourceToolAssistantUUID":"4ee7a8d8-6d04-42c8-b3c7-b5c67789359d"}
{"parentUuid":"701f2648-04c0-4fb8-a92d-864b2aad0fee","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01EzKGvAG8jDeAL7utATh2PY","type":"message","role":"assistant","content":[{"type":"text","text":"Ahora veo que el `$(document).ready` termina en la línea 147. Voy a agregar la llamada justo antes del cierre:"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":1587,"cache_read_input_tokens":64087,"cache_creation":{"ephemeral_5m_input_tokens":1587,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXLo6pVBiWoLCCXxDopRH","type":"assistant","uuid":"37c8f050-5d74-489b-9cc9-7ddd56718ea1","timestamp":"2026-01-21T15:55:37.340Z"}
{"parentUuid":"37c8f050-5d74-489b-9cc9-7ddd56718ea1","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01EzKGvAG8jDeAL7utATh2PY","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01Wbd1otihTH8Ff5KLdSUbze","name":"Edit","input":{"replace_all":false,"file_path":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\vacantes\\vacantes.js","old_string":"            $('#btn-crear-vacante').addClass('d-none')\n        }\n        actualizarDatatables(nombre_tabla_vacantes);\n    });\n});","new_string":"            $('#btn-crear-vacante').addClass('d-none')\n        }\n        actualizarDatatables(nombre_tabla_vacantes);\n    });\n\n    obtenerCreditosDisponiblesEmpresa(empresa_id);\n});"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":1587,"cache_read_input_tokens":64087,"cache_creation":{"ephemeral_5m_input_tokens":1587,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXLo6pVBiWoLCCXxDopRH","type":"assistant","uuid":"6978bf78-f99b-418f-b623-bea7d65cb974","timestamp":"2026-01-21T15:55:38.953Z"}
{"type":"file-history-snapshot","messageId":"6978bf78-f99b-418f-b623-bea7d65cb974","snapshot":{"messageId":"fa0b47ef-c747-4784-acba-90f74b050cec","trackedFileBackups":{"resources\\views\\vacantes\\paginas\\index.blade.php":{"backupFileName":"1ae59264a32091d1@v4","version":4,"backupTime":"2026-01-21T15:51:58.466Z"},"public\\js\\globales.js":{"backupFileName":"704f632e999527e6@v1","version":1,"backupTime":"2026-01-21T15:54:42.827Z"},"public\\js\\vacantes\\vacantes.js":{"backupFileName":"ca631dbb99127e3f@v1","version":1,"backupTime":"2026-01-21T15:55:53.702Z"}},"timestamp":"2026-01-21T15:51:58.451Z"},"isSnapshotUpdate":true}
{"parentUuid":"6978bf78-f99b-418f-b623-bea7d65cb974","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01Wbd1otihTH8Ff5KLdSUbze","type":"tool_result","content":"The file c:\\laragon\\www\\psicoalianza-2\\public\\js\\vacantes\\vacantes.js has been updated. Here's the result of running `cat -n` on a snippet of the edited file:\n   139→            $('#vacantes_archivadas').val(0);\n   140→            $('#cabecera-pagina-sin-archivar').addClass('d-none')\n   141→            $('#cabecera-pagina-con-archivar').removeClass('d-none')\n   142→            $('#btn-archivo-vacantes').html(`<i class=\"bi bi-box-arrow-left me-2\"></i> Volver a vacantes`);\n   143→            $('#btn-crear-vacante').addClass('d-none')\n   144→        }\n   145→        actualizarDatatables(nombre_tabla_vacantes);\n   146→    });\n   147→\n   148→    obtenerCreditosDisponiblesEmpresa(empresa_id);\n   149→});\n   150→\n   151→\n   152→/**\n   153→ * Muestra u oculta tablas según la existencia de datos en los procesos."}]},"uuid":"bee44925-8cc0-4b69-b9b4-6c451920f01f","timestamp":"2026-01-21T15:55:53.772Z","toolUseResult":{"filePath":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\vacantes\\vacantes.js","oldString":"            $('#btn-crear-vacante').addClass('d-none')\n        }\n        actualizarDatatables(nombre_tabla_vacantes);\n    });\n});","newString":"            $('#btn-crear-vacante').addClass('d-none')\n        }\n        actualizarDatatables(nombre_tabla_vacantes);\n    });\n\n    obtenerCreditosDisponiblesEmpresa(empresa_id);\n});","originalFile":"var vacantes_datos_ids = [];\nvar vacantes_seleccionadas = [];\nvar nombre_tabla_vacantes = 'tabla-vacantes';\nvar json_filtros = {};\nvar filtro_html = '';\n\nconst CONFIGURACION_TABLAS = {\n    autoWidth: false,\n    responsive: true,\n    processing: false,\n    serverSide: false,\n    searching: true,\n    deferRender: true,\n    paging: true,\n    aaSorting: [],\n    language: lenguaje_componente_datatables,\n    lengthMenu: [\n        [5, 10, 25, 50, 100, 200],\n        [5, 10, 25, 50, 100, 200]\n    ],\n    pageLength: 5,\n    scrollX: true,\n    scrollY: 'calc(100vh)',\n    scrollCollapse: true\n};\n\n$(`#${nombre_tabla_vacantes}`).DataTable({\n    ...CONFIGURACION_TABLAS,\n    scrollY: false,\n    ajax: {\n        url : '/vacantes-listado-tabla',\n        data: function (datos) {\n            let filtro_ordenamiento = $('#filtro_mas_recientes').val();\n            if (filtro_ordenamiento) {\n                let partes = filtro_ordenamiento.split('-');\n                datos.campo = partes[0];\n                datos.orden = partes[1];\n            }\n            datos.activo = $('#vacantes_archivadas').val();\n\n            (json_filtros.estados_filtro)\n                ? datos.estado_id = json_filtros.estados_filtro\n                : '';\n\n            (json_filtros.creador_filtro)\n                ? datos.usuario_id = json_filtros.creador_filtro\n                : '';\n\n            if (typeof json_filtros.fecha_creacion_filtro === 'string') {\n                let partes_fecha = json_filtros.fecha_creacion_filtro.split(' a ');\n                (partes_fecha[0]) ? datos.fecha_creacion_desde = partes_fecha[0] : '';\n                (partes_fecha[1]) ? datos.fecha_creacion_hasta = partes_fecha[1] : '';\n            }\n\n            if (typeof json_filtros.fecha_archivado_filtro === 'string') {\n                let partes_fecha_archivado = json_filtros.fecha_archivado_filtro.split(' a ');\n                (partes_fecha_archivado[0]) ? datos.fecha_archivado_desde = partes_fecha_archivado[0] : '';\n                (partes_fecha_archivado[1]) ? datos.fecha_archivado_hasta = partes_fecha_archivado[1] : '';\n            }\n\n            (json_filtros.aplicante_filtro)\n                ? datos.aplicante = json_filtros.aplicante_filtro\n                : '';\n\n            (json_filtros.etapa_filtro)\n                ? datos.etapa = json_filtros.etapa_filtro\n                : '';\n        },\n        dataSrc: function (json) {\n            return Object.values(json.data);\n        }\n    },\n    columns: [\n        {\n            data: null,\n            orderable: false,\n            render: (dato) => {\n                return `\n                    <div class=\"card shadow-none\">\n                        <div class=\"card-body\">\n                            <div class=\"row\">\n                                ${cabeceraFilaTablaVacantes(dato)}\n                                ${contenidoFilaTablaVacantes(dato)}\n                                ${footerTablaVacantes(dato)}\n                            </div>\n                        </div>\n                    </div>\n                `;\n            },\n        },\n    ],\n    drawCallback: function(settings) {\n        vacantes_datos_ids = $(`#${nombre_tabla_vacantes}`).DataTable().data().toArray();\n        inicializarTooltips();\n    },\n    initComplete: function(settings, json) {\n        vacantes_datos_ids = $(`#${nombre_tabla_vacantes}`).DataTable().data().toArray();\n        $('#tabla-vacantes').parent().css('height', '100vh');\n        $(`[aria-describedby=\"${nombre_tabla_vacantes}_info\"] .thead-componente`).hide();\n        inicializarTooltips();\n        cargarDataTablas();\n        validarDatos();\n    }\n});\n\n$(document).ready(function() {\n    $('#fecha_archivado').hide();\n    $(document).on('change', '#filtro_mas_recientes', function() {\n        actualizarDatatables(nombre_tabla_vacantes);\n    });\n\n    $(document).on('change', 'input[name=\"checkbox_vacantes\"]', function() {\n        alterarBotonDescargarExcelVacantes();\n    });\n    $.ajax({\n        url: `/api/empresas/${empresa_id}/creditos`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            let porcentaje_creditos = ((respuesta.data.creditos_disponibles / respuesta.data.creditos_plan) * 100) || 0;\n            if (porcentaje_creditos <= 20 && respuesta?.data?.plan_credito) {\n                $('#porcentaje-creditos-disponibles-modal').text(porcentaje_creditos);\n                $('#modal-solicitar-mas-creditos-ia').modal('show');\n            }\n            \n        }\n    });\n\n    $(document).on('click', '#btn-archivo-vacantes', function() {\n        let estado_actual = $('#vacantes_archivadas').val();\n        if (estado_actual == 0) {\n            $('#vacantes_archivadas').val(1);\n            $('#cabecera-pagina-sin-archivar').removeClass('d-none')\n            $('#cabecera-pagina-con-archivar').addClass('d-none')\n            $('#btn-archivo-vacantes').html(`<i class=\"bi bi-archive me-2\"></i> Archivo de vacantes`);\n            $('#btn-crear-vacante').removeClass('d-none')\n            $('#fecha_archivado').hide();\n        } else {\n            $('#vacantes_archivadas').val(0);\n            $('#cabecera-pagina-sin-archivar').addClass('d-none')\n            $('#cabecera-pagina-con-archivar').removeClass('d-none')\n            $('#btn-archivo-vacantes').html(`<i class=\"bi bi-box-arrow-left me-2\"></i> Volver a vacantes`);\n            $('#btn-crear-vacante').addClass('d-none')\n        }\n        actualizarDatatables(nombre_tabla_vacantes);\n    });\n});\n\n\n/**\n * Muestra u oculta tablas según la existencia de datos en los procesos.\n *\n * @returns {void}\n * @author Andres Morales\n */\nfunction validarDatos() {\n    if (vacantes_datos_ids.length == 0) {\n        $('#tabla-contenido').addClass('d-none');\n        $('#tabla-sin-contenido').removeClass('d-none');\n    } else {\n        $('#tabla-contenido').removeClass('d-none');\n        $('#tabla-sin-contenido').addClass('d-none');\n    }\n}\n\n/**\n * Generar la cabecera de la tabla de vacantes.\n *\n * @param {object} vacante Datos de la vacante.\n * @returns {html} Cabecera de la tabla de vacantes.\n * @author Fahibram Cárcamo\n * @author Andres Morales\n */\nfunction cabeceraFilaTablaVacantes(vacante) {\n    let nombre_truncado = vacante.nombre_vacante.length > 80\n        ? vacante.nombre_vacante.substring(0, 80) + '...'\n        : vacante.nombre_vacante;\n\n    return `\n        <div class=\"col-12 border-bottom\">\n            <div class=\"row mb-3\">\n                <div class=\"col-auto d-flex align-items-center\">\n                    ${crearCheckbox({ id: vacante.id, name: 'checkbox_vacantes' })}&nbsp;\n                    <span class=\"text-body-2\">${vacante.id}</span></div>\n                <div class=\"col\">\n                    <div class=\"row w-100\">\n                        <div class=\"col-auto\">\n                            <a class=\"alineacion-contenido-left btn btn-text-primary text-dark\" ${crearTooltip({ placement: `top`, content: `${vacante.nombre_vacante}`, toggle: `popover` })} href=\"/vacantes-detalle/${vacante.id}\">\n                                <span class=\"text-headline-5 text-gray-10 text-decoration-underline\">${nombre_truncado}</span>\n                            </a>\n                        </div>\n                    </div>\n                    <div class=\"row w-100 mb-2\">\n                        <div class=\"col-auto text-label-2 d-flex px-1\" ${crearTooltip({ placement: `top`, content: `${vacante.creador?.nombres} ${vacante.creador?.apellidos}`, toggle: `popover` })}>\n                            <div class=\"my-auto mx-1\"><i class=\"bi bi-person text-body-2 my-auto\"></i></div>\n                            <div class=\"my-auto mx-1\">Creador:</div>\n                            <div class=\"my-auto mx-1\"><img class=\"rounded-circle\" src=\"/usuarios-imagen/${vacante.creador.id}\" width=\"20px\" height=\"20px\"></div>\n                        </div>\n                        <div class=\"col-auto text-label-2 d-flex px-1\">\n                            <div class=\"my-auto mx-1\"><i class=\"bi bi-briefcase text-body-2 my-auto\"></i></div>\n                            <div class=\"my-auto mx-1\">Vacantes:</div>\n                            <div class=\"my-auto mx-1\">${vacante.cantidad_vacantes}</div>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"col-auto\">\n                    <div class=\"row\">\n                        ${vacante.activo == 1 ? `\n                            <div class=\"col-auto\">${crearTag({ texto: `Total de candidatos: ${vacante.conteo_aplicantes}`, class: 'tag-tonal-gray' })}</div>\n                        ` : ''}\n                        <div class=\"col-auto\">${ESTADOS_VACANTES[vacante.estado_id]}</div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    `;\n}\n\n/**\n * Generar el contenido HTML de una fila de la tabla de vacantes.\n *\n * @param {object} vacante Datos de la vacante.\n * @returns {html} Información de la vacante.\n * @author Andres Morales\n * @author Jair Carvajal\n * @author Andres Gonzalez\n */\nfunction contenidoFilaTablaVacantes(vacante) {\n    let etapas_html = '';\n    if (vacante.etapas && vacante.etapas.length > 0) {\n        const etapas_ordenadas = [...vacante.etapas].sort((a, b) => a.orden - b.orden);\n\n        etapas_html = etapas_ordenadas.map(etapa => {\n            let clase_tag = 'tag-tonal-blue';\n\n            if (etapa.nombre === 'Contratados') {\n                clase_tag = 'tag-tonal-green';\n            } else if (etapa.nombre === 'Descartados') {\n                clase_tag = 'tag-tonal-gray';\n            }\n\n            return `\n                <div class=\"col text-center d-flex flex-column\">\n                    <small class=\"text-gray-30 text-label-2 fw-semibold mb-2\">${etapa.nombre}</small>\n                    ${crearTag({\n                        class: `${clase_tag} fw-semibold mt-auto`,\n                        texto: etapa.conteo_usuarios_activos === 0 ? '-' : etapa.conteo_usuarios_activos\n                    })}\n                </div>\n\n            `;\n        }).join(' ');\n    } else {\n        etapas_html = `${crearTag({ texto: 'Sin etapas', class: 'text-label-1 tag-filled-gray' })}`;\n    }\n\n    return `\n        <div class=\"col-12 border-bottom mt-2\">\n            <div class=\"row mb-3\">\n                <div class=\"col-12\">\n                    <div class=\"row\">\n                        ${etapas_html}\n                    </div>\n                </div>\n            </div>\n        </div>\n    `;\n}\n\n/**\n * Genera el footer de la tabla de vacantes.\n *\n * @param {Object} dato Datos de la vacante.\n * @returns {html} Footer de tabla html.\n * @author Fahibram Cárcamo\n * @author Andres Gonzalez\n */\nfunction footerTablaVacantes(dato) {\n    let boton_ver_detalle = '';\n    let boton_editar = '';\n    let boton_duplicar = '';\n    let boton_suspender = '';\n    let boton_archivar  = '';\n    let boton_eliminar  = '';\n\n    if (dato.activo == 1) {\n        boton_ver_detalle = `<a href=\"/vacantes-detalle/${dato.id}\" class=\"dropdown-item no-visited pointer py-2\">Ver detalle</a>`;\n    }\n\n    if ([1, 2, 4].includes(dato.estado_id) && dato.conteo_aplicantes == 0) {\n        boton_editar = `<a href=\"/vacantes/${dato.id}/edit\" class=\"dropdown-item no-visited pointer py-2\">Editar</a>`;\n    }\n\n    if (1 == 1) {\n        boton_duplicar = `<button type=\"button\" class=\"dropdown-item no-visited pointer py-2\" onclick=\"duplicarVacante(${dato.id}, '${dato.nombre_vacante}')\">Duplicar</button>`;\n    }\n\n    if ([1, 2].includes(dato.estado_id)) {\n        boton_suspender = `<button type=\"button\" class=\"dropdown-item no-visited pointer py-2\" onclick=\"modalSuspender(${dato.id}, '${dato.nombre_vacante}', ${(dato.estado_id == 1) ? 2 : 1})\">${(dato.estado_id == 1) ? 'Suspender' : 'Reactivar'}</button>`;\n    }\n\n    if ([2, 3].includes(dato.estado_id)) {\n        boton_archivar = `<button type=\"button\" class=\"dropdown-item no-visited pointer py-2\" onclick=\"archivarDesarchivarVacante(${dato.id}, ${dato.activo}, '${dato.nombre_vacante}')\">${(dato.activo == 1) ? 'Archivar' : 'Desarchivar'}</button>`;\n    }\n\n    if ([1, 2, 3, 4].includes(dato.estado_id) && dato.conteo_aplicantes == 0) {\n        boton_eliminar = `<button type=\"button\" class=\"dropdown-item no-visited pointer py-2 text-danger\" onclick=\"modalEliminar(${dato.id}, '${dato.nombre_vacante}')\">Eliminar</button>`;\n    }\n\n    return `\n        <div class=\"col-12 mt-3\">\n            <div class=\"row\">\n                <div class=\"col-auto my-auto ps-5\">\n                    <p class=\"mb-0 h-fit-content\">\n                        <i class=\"bi bi-calendar4 me-2 text-body-2\"></i>\n                        <span class=\"text-label-2\"><span class=\"me-2\">Creado:</span>${formatearFecha(dato.created_at)}</span>\n                    </p>\n                </div>\n                <div class=\"col-auto ms-auto\">\n                    <div class=\"row\">\n                        <div class=\"col-auto pe-0\">\n                            ${crearBoton({\n                                clases: 'btn-outline-primary btn-circle',\n                                texto: '<i class=\"bi bi-person-add\"></i>',\n                                tooltip: `${crearTooltip({ placement: `bottom`, content: (dato.estado_id == 1) ? 'Agregar Candidato' : 'No es posible agregar candidatos en estado borrador.', toggle: `popover` })}`,\n                                onclick: (dato.estado_id == 1) ? `agregarCandidato(${dato.id})` : '',\n                                disabled: (dato.estado_id == 1) ? false : true\n                            })}\n                        </div>\n                        <div class=\"col-auto dropdown\">\n                            ${crearBoton({\n                                clases: 'btn-outline-primary btn-circle dropdown-toggle',\n                                texto: '<i class=\"bi bi-three-dots\"></i>',\n                                data: [\n                                    {texto: 'bs-toggle', value: 'dropdown'},\n                                    {texto: 'bs-auto-close', value: 'outside'}\n                                ]\n                            })}\n                            <div class=\"dropdown-menu\">\n                                ${boton_ver_detalle}\n                                ${boton_editar}\n                                ${boton_duplicar}\n                                ${boton_suspender}\n                                ${boton_archivar}\n                                ${boton_eliminar}\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    `;\n}\n\n/**\n * Función para aplicar los filtros avanzados aplicados.\n *\n * @param {string} filtro id del elemento html del filtro\n * @param {Object} filtros filtros aplicados\n * @returns {void}\n * @author Fahibram Cárcamo\n */\nfunction aplicarFiltrosDropdown(filtro, filtros) {\n    filtro_html = filtro;\n    json_filtros = filtros;\n    actualizarDatatables(nombre_tabla_vacantes);\n}\n\n\n/**\n * Guardar configuraciones para el movimiento de revisión de HV.\n *\n * Esta función es temporal, para que frontend pueda verificar y probar su comportamiento.\n *\n * @returns {void}\n * @author Daniel Beltrán\n */\nfunction configurarHV() {\n    $.ajax({\n        type: 'POST',\n        url : '/etapas-movimientos-vacantes-configuraciones',\n        data: {\n            _token         : $('input[name=\"_token\"]').val(),\n            configuraciones: [\n                {\n                    etapa_movimiento_vacante_id        : 2,\n                    movimiento_vacante_configuracion_id: 4,\n                    valor                              : 15\n                }\n            ]\n        }\n    }).done((respuesta) => {\n        mostrarToast('success', respuesta.message);\n    }).fail((error) => {\n        mostrarToast('danger', 'Ocurrió un error');\n    });\n}\n\n/**\n * Completar vacante.\n *\n * Esta función es temporal, para que frontend pueda verificar y probar su comportamiento.\n *\n * @returns {void}\n * @author Daniel Beltrán\n */\nfunction completarVacante() {\n    $.ajax({\n        type: 'POST',\n        url : '/vacantes-completar/21',\n        data: {\n            _token: $('input[name=\"_token\"]').val()\n        }\n    }).done((respuesta) => {\n        mostrarToast('success', respuesta.message);\n    }).fail((error) => {\n        mostrarToast('danger', 'Ocurrió un error');\n    });\n}\n\n/**\n * Guardar preguntas.\n *\n * Esta función es temporal, para que frontend pueda verificar y probar su comportamiento.\n *\n * @returns {void}\n * @author Daniel Beltrán\n */\nfunction guardarPreguntas() {\n    $.ajax({\n        type: 'POST',\n        url : '/vacantes-preguntas',\n        data: {\n            _token          : $('input[name=\"_token\"]').val(),\n            vacante_id      : 21,\n            etapa_vacante_id: 47,\n            preguntas       : JSON.stringify([\n                {\n                    // id        : 3,\n                    enunciado : 'Come ti chiami',\n                    es_abierta: true\n                },\n                {\n                    // id              : 5,\n                    enunciado       : 'Quale è il tuo cibo preferito',\n                    es_abierta      : false,\n                    tiempo_respuesta: 2,\n                    opciones        : [\n                        {\n                            // id         : 7,\n                            texto      : 'Uovo',\n                            orden      : 1,\n                            es_correcta: false\n                        },\n                        {\n                            texto      : 'Pizza',\n                            orden      : 2,\n                            es_correcta: false\n                        },\n                        {\n                            texto      : 'Riso',\n                            orden      : 3,\n                            es_correcta: true\n                        }\n                    ]\n                }\n            ])\n        }\n    }).done((respuesta) => {\n        mostrarToast('success', respuesta.message);\n    }).fail((error) => {\n        mostrarToast('danger', 'Ocurrió un error');\n    });\n}\n\n/**\n * Adjuntar archivos a una etapa de vacante.\n *\n * Esta función es temporal, para que frontend pueda verificar y probar su comportamiento.\n *\n * @returns {void}\n * @author Daniel Beltrán\n */\nfunction adjuntarArchivos() {\n    let etapa_vacante_id = $('#etapa_vacante_id_prueba').val();\n    let archivos         = $('#archivos_prueba')[0].files;\n\n    if (!etapa_vacante_id) {\n        mostrarToast('warning', 'Debe ingresar un ID de etapa de vacante');\n        return;\n    }\n\n    if (archivos.length === 0) {\n        mostrarToast('warning', 'Debe seleccionar al menos un archivo');\n        return;\n    }\n\n    let form_data = new FormData();\n    form_data.append('_token', $('input[name=\"_token\"]').val());\n    form_data.append('etapa_vacante_id', etapa_vacante_id);\n\n    for (let i = 0; i < archivos.length; i++) {\n        form_data.append('archivos[]', archivos[i]);\n    }\n\n    $.ajax({\n        type       : 'POST',\n        url        : '/etapas-vacantes-adjuntar-archivos',\n        data       : form_data,\n        processData: false,\n        contentType: false\n    }).done((respuesta) => {\n        mostrarToast('success', respuesta.message);\n        $('#etapa_vacante_id_prueba').val('');\n        $('#archivos_prueba').val('');\n    }).fail((error) => {\n        let mensaje = error.responseJSON?.message || 'Ocurrió un error al adjuntar los archivos';\n        mostrarToast('danger', mensaje);\n    });\n}\n\n/**\n * Procesar hoja de vida con inteligencia artificial.\n *\n * Envía un archivo de hoja de vida al servicio de IA para extraer información.\n *\n * @returns {void}\n * @author Daniel Beltrán\n * @deprecated\n */\nfunction procesarHojaVidaConIA() {\n    let archivo_input = $('#archivo_hv_ia')[0];\n    let archivo = archivo_input.files[0];\n\n    if (!archivo) {\n        mostrarToast('warning', 'Debe seleccionar un archivo para procesar');\n        return;\n    }\n\n    let form_data = new FormData();\n    form_data.append('archivo', archivo);\n    form_data.append('_token', $('meta[name=\"csrf-token\"]').attr('content'));\n\n    // Deshabilitar botón mientras se procesa\n    $('#btn-procesar-hv-ia').prop('disabled', true);\n    $('#btn-procesar-hv-ia').html('<i class=\"bi bi-hourglass-split me-2\"></i>Procesando...');\n\n    $.ajax({\n        type: 'POST',\n        url: '/perfiles-laborales-leer-hv-ia',\n        data: form_data,\n        processData: false,\n        contentType: false\n    }).done((respuesta) => {\n        mostrarToast('success', respuesta.message || 'Hoja de vida procesada correctamente');\n        console.log('Datos extraídos:', respuesta.data);\n\n        // Limpiar el input\n        $('#archivo_hv_ia').val('');\n    }).fail((error) => {\n        let mensaje = error.responseJSON?.message || 'Ocurrió un error al procesar la hoja de vida';\n        mostrarToast('danger', mensaje);\n        console.error('Error completo:', error);\n    }).always(() => {\n        // Rehabilitar botón\n        $('#btn-procesar-hv-ia').prop('disabled', false);\n        $('#btn-procesar-hv-ia').html('<i class=\"bi bi-robot me-2\"></i>Procesar con IA');\n    });\n}\n","structuredPatch":[{"oldStart":144,"oldLines":6,"newStart":144,"newLines":8,"lines":["         }","         actualizarDatatables(nombre_tabla_vacantes);","     });","+","+    obtenerCreditosDisponiblesEmpresa(empresa_id);"," });"," "," "]}],"userModified":false,"replaceAll":false},"sourceToolAssistantUUID":"6978bf78-f99b-418f-b623-bea7d65cb974"}
{"parentUuid":"bee44925-8cc0-4b69-b9b4-6c451920f01f","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01AgnqAGy5cW2Xj9XV4zz4cz","type":"message","role":"assistant","content":[{"type":"text","text":"Listo. He realizado los siguientes cambios:\n\n1. **En `index.blade.php`**: Agregué el ID `contenedor-tag-creditos` al div del tag y cambié el texto inicial a \"Cargando créditos...\"\n\n2. **En `globales.js`**: Agregué la función `obtenerCreditosDisponiblesEmpresa()` que:\n   - Consulta el endpoint `api/empresas/{id}/creditos`\n   - Si tiene créditos >= 20% del plan: muestra tag azul (`tag-tonal-blue`)\n   - Si tiene créditos < 20% del plan: muestra tag amarillo (`tag-filled-yellow`)\n   - Si no tiene créditos: muestra tag gris (`tag-tonal-gray`) con texto \"Sin créditos\"\n   - Formatea el número con separador de miles usando `formatearNumero()`\n\n3. **En `vacantes.js`**: Agregué la llamada `obtenerCreditosDisponiblesEmpresa(empresa_id)` al final del `$(document).ready()`"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":663,"cache_read_input_tokens":65674,"cache_creation":{"ephemeral_5m_input_tokens":663,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXLo8NzKPzmW2ddpwnUGm","type":"assistant","uuid":"1fa9cdb1-dda7-4ec6-955f-f3726e83831f","timestamp":"2026-01-21T15:56:02.598Z"}
{"type":"queue-operation","operation":"dequeue","timestamp":"2026-01-21T15:56:28.977Z","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961"}
{"type":"file-history-snapshot","messageId":"1ffd6edd-0488-49c3-b3a8-cb572e48ba2a","snapshot":{"messageId":"1ffd6edd-0488-49c3-b3a8-cb572e48ba2a","trackedFileBackups":{"resources\\views\\vacantes\\paginas\\index.blade.php":{"backupFileName":"1ae59264a32091d1@v5","version":5,"backupTime":"2026-01-21T15:56:30.672Z"},"public\\js\\globales.js":{"backupFileName":"704f632e999527e6@v2","version":2,"backupTime":"2026-01-21T15:56:30.707Z"},"public\\js\\vacantes\\vacantes.js":{"backupFileName":"ca631dbb99127e3f@v2","version":2,"backupTime":"2026-01-21T15:56:30.721Z"}},"timestamp":"2026-01-21T15:56:30.654Z"},"isSnapshotUpdate":false}
{"parentUuid":"894cca4e-b688-41d1-8443-4adde9b64dbc","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Read","command":"callback"},"toolUseID":"toolu_015Wf2yuSUTCHmnu1LTFYn2i","parentToolUseID":"toolu_015Wf2yuSUTCHmnu1LTFYn2i","uuid":"4eb26b54-a666-4279-8bfa-c7adb0a637e7","timestamp":"2026-01-21T15:52:10.572Z"}
{"parentUuid":"3658d915-69ea-4c42-91c4-deb0cfd48b86","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Edit","command":"callback"},"toolUseID":"toolu_01A8g2kL8uNY4XExzjv7KCgn","parentToolUseID":"toolu_01A8g2kL8uNY4XExzjv7KCgn","uuid":"12aa28dc-de88-46f4-805f-daab70020d2f","timestamp":"2026-01-21T15:52:21.307Z"}
{"parentUuid":"12aa28dc-de88-46f4-805f-daab70020d2f","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Edit","command":"callback"},"toolUseID":"toolu_01A8g2kL8uNY4XExzjv7KCgn","parentToolUseID":"toolu_01A8g2kL8uNY4XExzjv7KCgn","uuid":"c92450ad-356a-460e-890b-82fd257f9a7b","timestamp":"2026-01-21T15:52:21.307Z"}
{"parentUuid":"91ed1aaf-85ea-4c86-a996-2222558b52e6","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"callback"},"parentToolUseID":"toolu_01A8g2kL8uNY4XExzjv7KCgn","toolUseID":"toolu_01A8g2kL8uNY4XExzjv7KCgn","timestamp":"2026-01-21T15:53:55.480Z","uuid":"a50ab1ac-1e06-4014-a826-1ee39fbf3d2c"}
{"parentUuid":"14f8b4ab-88a2-44c9-8344-f211a380cb90","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Edit","command":"callback"},"toolUseID":"toolu_01Y8NJPsa2zSHf1CnZwnwUkF","parentToolUseID":"toolu_01Y8NJPsa2zSHf1CnZwnwUkF","uuid":"667a9ab8-a888-4ed1-bee1-e376e6d4d1c1","timestamp":"2026-01-21T15:54:12.461Z"}
{"parentUuid":"667a9ab8-a888-4ed1-bee1-e376e6d4d1c1","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Edit","command":"callback"},"toolUseID":"toolu_01Y8NJPsa2zSHf1CnZwnwUkF","parentToolUseID":"toolu_01Y8NJPsa2zSHf1CnZwnwUkF","uuid":"a5af6ee4-4e1a-4251-a9fc-53d17aea50e4","timestamp":"2026-01-21T15:54:12.461Z"}
{"parentUuid":"e674d781-b9c5-4b33-87f3-73b062f8b334","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Edit","command":"callback"},"toolUseID":"toolu_01QbUJ86cypCjpP9qi1XQit4","parentToolUseID":"toolu_01QbUJ86cypCjpP9qi1XQit4","uuid":"9ccc4e43-0fe6-48dc-bfa0-69a0bb965e08","timestamp":"2026-01-21T15:54:37.663Z"}
{"parentUuid":"9ccc4e43-0fe6-48dc-bfa0-69a0bb965e08","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Edit","command":"callback"},"toolUseID":"toolu_01QbUJ86cypCjpP9qi1XQit4","parentToolUseID":"toolu_01QbUJ86cypCjpP9qi1XQit4","uuid":"6fb65c59-d43a-4b0b-82c0-295d78c06359","timestamp":"2026-01-21T15:54:37.664Z"}
{"parentUuid":"c5924423-d3bf-4968-a1b9-beb1a11f3748","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"callback"},"parentToolUseID":"toolu_01QbUJ86cypCjpP9qi1XQit4","toolUseID":"toolu_01QbUJ86cypCjpP9qi1XQit4","timestamp":"2026-01-21T15:54:42.895Z","uuid":"d4610770-889a-4da8-8845-08cd3fe96819"}
{"parentUuid":"f0e04c11-bd5a-4dfd-8f99-288ac3be61d1","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Read","command":"callback"},"toolUseID":"toolu_014LBgaaqdYEykEzvRFxjvS5","parentToolUseID":"toolu_014LBgaaqdYEykEzvRFxjvS5","uuid":"255e2994-a60e-4048-baf2-d1bbe7f95012","timestamp":"2026-01-21T15:54:49.662Z"}
{"parentUuid":"0b316c31-3530-4f86-a3c6-da004843f9ac","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Read","command":"callback"},"toolUseID":"toolu_011soQHex9PQKdEmHCTavSUZ","parentToolUseID":"toolu_011soQHex9PQKdEmHCTavSUZ","uuid":"56c95405-4edc-4608-9a7c-9e81b417e16e","timestamp":"2026-01-21T15:55:02.288Z"}
{"parentUuid":"bda3f713-4020-49d8-8a65-fee397b55d10","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Edit","command":"callback"},"toolUseID":"toolu_01RwD1FFXwQNuVoTh4EmRphX","parentToolUseID":"toolu_01RwD1FFXwQNuVoTh4EmRphX","uuid":"6a75e8d0-85fd-4cb0-bd0b-58466777a066","timestamp":"2026-01-21T15:55:08.401Z"}
{"parentUuid":"6a75e8d0-85fd-4cb0-bd0b-58466777a066","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Edit","command":"callback"},"toolUseID":"toolu_01RwD1FFXwQNuVoTh4EmRphX","parentToolUseID":"toolu_01RwD1FFXwQNuVoTh4EmRphX","uuid":"f0c2a4ee-d8a5-422c-a030-090188e28527","timestamp":"2026-01-21T15:55:08.401Z"}
{"parentUuid":"4ee7a8d8-6d04-42c8-b3c7-b5c67789359d","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Read","command":"callback"},"toolUseID":"toolu_017VSmewBhVJVaYPyyUD9K9W","parentToolUseID":"toolu_017VSmewBhVJVaYPyyUD9K9W","uuid":"9def6f68-80d8-47ad-80ad-2ff6bcf73b65","timestamp":"2026-01-21T15:55:32.468Z"}
{"parentUuid":"6978bf78-f99b-418f-b623-bea7d65cb974","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Edit","command":"callback"},"toolUseID":"toolu_01Wbd1otihTH8Ff5KLdSUbze","parentToolUseID":"toolu_01Wbd1otihTH8Ff5KLdSUbze","uuid":"e06e3e67-9442-491a-9eec-f9d99bf2bf3a","timestamp":"2026-01-21T15:55:39.140Z"}
{"parentUuid":"e06e3e67-9442-491a-9eec-f9d99bf2bf3a","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Edit","command":"callback"},"toolUseID":"toolu_01Wbd1otihTH8Ff5KLdSUbze","parentToolUseID":"toolu_01Wbd1otihTH8Ff5KLdSUbze","uuid":"84148ce8-387a-4cea-a229-6176ed533566","timestamp":"2026-01-21T15:55:39.141Z"}
{"parentUuid":"bee44925-8cc0-4b69-b9b4-6c451920f01f","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"callback"},"parentToolUseID":"toolu_01Wbd1otihTH8Ff5KLdSUbze","toolUseID":"toolu_01Wbd1otihTH8Ff5KLdSUbze","timestamp":"2026-01-21T15:55:53.773Z","uuid":"131f8acf-1370-484c-b10d-23d0e6b5a16d"}
{"parentUuid":"1fa9cdb1-dda7-4ec6-955f-f3726e83831f","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"type":"text","text":"<ide_opened_file>The user opened the file c:\\laragon\\www\\psicoalianza-2\\public\\js\\vacantes\\vacantes.js in the IDE. This may or may not be related to the current task.</ide_opened_file>"},{"type":"text","text":"no pero nececito que se jecute desde globales js"}]},"uuid":"1ffd6edd-0488-49c3-b3a8-cb572e48ba2a","timestamp":"2026-01-21T15:56:30.650Z"}
{"parentUuid":"1ffd6edd-0488-49c3-b3a8-cb572e48ba2a","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01XM5xKxvoMDXvA2XxEwpciV","type":"message","role":"assistant","content":[{"type":"text","text":"Entendido. Voy a mover la lógica para que se ejecute automáticamente desde `globales.js` en el `$(document).ready()` que ya existe allí. Primero quito la llamada de vacantes.js:"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":2201,"cache_read_input_tokens":66337,"cache_creation":{"ephemeral_5m_input_tokens":2201,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXLoB1PtEQtrnedMbVwXE","type":"assistant","uuid":"6edaa168-292f-458d-9afd-ed6781d9da31","timestamp":"2026-01-21T15:56:34.781Z"}
{"parentUuid":"6edaa168-292f-458d-9afd-ed6781d9da31","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01XM5xKxvoMDXvA2XxEwpciV","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_012nt2qGumZ93qWvep8BYZNg","name":"Edit","input":{"replace_all":false,"file_path":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\vacantes\\vacantes.js","old_string":"            $('#btn-crear-vacante').addClass('d-none')\n        }\n        actualizarDatatables(nombre_tabla_vacantes);\n    });\n\n    obtenerCreditosDisponiblesEmpresa(empresa_id);\n});","new_string":"            $('#btn-crear-vacante').addClass('d-none')\n        }\n        actualizarDatatables(nombre_tabla_vacantes);\n    });\n});"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":2201,"cache_read_input_tokens":66337,"cache_creation":{"ephemeral_5m_input_tokens":2201,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXLoB1PtEQtrnedMbVwXE","type":"assistant","uuid":"6fab56ec-4648-463f-aade-1804f72950a4","timestamp":"2026-01-21T15:56:36.336Z"}
{"parentUuid":"6fab56ec-4648-463f-aade-1804f72950a4","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"type":"tool_result","content":"<tool_use_error>File has not been read yet. Read it first before writing to it.</tool_use_error>","is_error":true,"tool_use_id":"toolu_012nt2qGumZ93qWvep8BYZNg"}]},"uuid":"de17427a-1997-4986-be7a-50da2b61806f","timestamp":"2026-01-21T15:56:36.537Z","toolUseResult":"Error: File has not been read yet. Read it first before writing to it.","sourceToolAssistantUUID":"6fab56ec-4648-463f-aade-1804f72950a4"}
{"parentUuid":"de17427a-1997-4986-be7a-50da2b61806f","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01PgCN9ivxkQZpRf9ShXQCkh","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01BJGKFRWvfhP2fjVJ2FC7oM","name":"Read","input":{"file_path":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\vacantes\\vacantes.js","offset":140,"limit":20}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":338,"cache_read_input_tokens":68538,"cache_creation":{"ephemeral_5m_input_tokens":338,"ephemeral_1h_input_tokens":0},"output_tokens":25,"service_tier":"standard"}},"requestId":"req_011CXLoBTbULYn7BRHiLRhXf","type":"assistant","uuid":"63986e1d-1fef-4d89-8849-bf0f2d54631f","timestamp":"2026-01-21T15:56:40.738Z"}
{"parentUuid":"63986e1d-1fef-4d89-8849-bf0f2d54631f","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01BJGKFRWvfhP2fjVJ2FC7oM","type":"tool_result","content":"   140→            $('#cabecera-pagina-sin-archivar').addClass('d-none')\n   141→            $('#cabecera-pagina-con-archivar').removeClass('d-none')\n   142→            $('#btn-archivo-vacantes').html(`<i class=\"bi bi-box-arrow-left me-2\"></i> Volver a vacantes`);\n   143→            $('#btn-crear-vacante').addClass('d-none')\n   144→        }\n   145→        actualizarDatatables(nombre_tabla_vacantes);\n   146→    });\n   147→\n   148→    obtenerCreditosDisponiblesEmpresa(empresa_id);\n   149→});\n   150→\n   151→\n   152→/**\n   153→ * Muestra u oculta tablas según la existencia de datos en los procesos.\n   154→ *\n   155→ * @returns {void}\n   156→ * @author Andres Morales\n   157→ */\n   158→function validarDatos() {\n   159→    if (vacantes_datos_ids.length == 0) {\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"6d6d4e1e-c79b-4fa5-9e9c-55bff4e4f52a","timestamp":"2026-01-21T15:56:42.083Z","toolUseResult":{"type":"text","file":{"filePath":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\vacantes\\vacantes.js","content":"            $('#cabecera-pagina-sin-archivar').addClass('d-none')\n            $('#cabecera-pagina-con-archivar').removeClass('d-none')\n            $('#btn-archivo-vacantes').html(`<i class=\"bi bi-box-arrow-left me-2\"></i> Volver a vacantes`);\n            $('#btn-crear-vacante').addClass('d-none')\n        }\n        actualizarDatatables(nombre_tabla_vacantes);\n    });\n\n    obtenerCreditosDisponiblesEmpresa(empresa_id);\n});\n\n\n/**\n * Muestra u oculta tablas según la existencia de datos en los procesos.\n *\n * @returns {void}\n * @author Andres Morales\n */\nfunction validarDatos() {\n    if (vacantes_datos_ids.length == 0) {","numLines":20,"startLine":140,"totalLines":572}},"sourceToolAssistantUUID":"63986e1d-1fef-4d89-8849-bf0f2d54631f"}
{"parentUuid":"6d6d4e1e-c79b-4fa5-9e9c-55bff4e4f52a","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_014igKSVFAwPgzvds33x4EyS","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01HoUw2kS1YkaCHqPH2ci7p9","name":"Edit","input":{"replace_all":false,"file_path":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\vacantes\\vacantes.js","old_string":"        actualizarDatatables(nombre_tabla_vacantes);\n    });\n\n    obtenerCreditosDisponiblesEmpresa(empresa_id);\n});","new_string":"        actualizarDatatables(nombre_tabla_vacantes);\n    });\n});"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":482,"cache_read_input_tokens":68876,"cache_creation":{"ephemeral_5m_input_tokens":482,"ephemeral_1h_input_tokens":0},"output_tokens":25,"service_tier":"standard"}},"requestId":"req_011CXLoBrWs3c5e9sdDCgtzv","type":"assistant","uuid":"421eed83-88ed-451c-aa77-f50b0372667b","timestamp":"2026-01-21T15:56:46.164Z"}
{"parentUuid":"421eed83-88ed-451c-aa77-f50b0372667b","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01HoUw2kS1YkaCHqPH2ci7p9","type":"tool_result","content":"The file c:\\laragon\\www\\psicoalianza-2\\public\\js\\vacantes\\vacantes.js has been updated. Here's the result of running `cat -n` on a snippet of the edited file:\n   141→            $('#cabecera-pagina-con-archivar').removeClass('d-none')\n   142→            $('#btn-archivo-vacantes').html(`<i class=\"bi bi-box-arrow-left me-2\"></i> Volver a vacantes`);\n   143→            $('#btn-crear-vacante').addClass('d-none')\n   144→        }\n   145→        actualizarDatatables(nombre_tabla_vacantes);\n   146→    });\n   147→});\n   148→\n   149→\n   150→/**\n   151→ * Muestra u oculta tablas según la existencia de datos en los procesos."}]},"uuid":"b485d225-871f-4de6-9502-28efe8836ac7","timestamp":"2026-01-21T15:56:50.342Z","toolUseResult":{"filePath":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\vacantes\\vacantes.js","oldString":"        actualizarDatatables(nombre_tabla_vacantes);\n    });\n\n    obtenerCreditosDisponiblesEmpresa(empresa_id);\n});","newString":"        actualizarDatatables(nombre_tabla_vacantes);\n    });\n});","originalFile":"var vacantes_datos_ids = [];\nvar vacantes_seleccionadas = [];\nvar nombre_tabla_vacantes = 'tabla-vacantes';\nvar json_filtros = {};\nvar filtro_html = '';\n\nconst CONFIGURACION_TABLAS = {\n    autoWidth: false,\n    responsive: true,\n    processing: false,\n    serverSide: false,\n    searching: true,\n    deferRender: true,\n    paging: true,\n    aaSorting: [],\n    language: lenguaje_componente_datatables,\n    lengthMenu: [\n        [5, 10, 25, 50, 100, 200],\n        [5, 10, 25, 50, 100, 200]\n    ],\n    pageLength: 5,\n    scrollX: true,\n    scrollY: 'calc(100vh)',\n    scrollCollapse: true\n};\n\n$(`#${nombre_tabla_vacantes}`).DataTable({\n    ...CONFIGURACION_TABLAS,\n    scrollY: false,\n    ajax: {\n        url : '/vacantes-listado-tabla',\n        data: function (datos) {\n            let filtro_ordenamiento = $('#filtro_mas_recientes').val();\n            if (filtro_ordenamiento) {\n                let partes = filtro_ordenamiento.split('-');\n                datos.campo = partes[0];\n                datos.orden = partes[1];\n            }\n            datos.activo = $('#vacantes_archivadas').val();\n\n            (json_filtros.estados_filtro)\n                ? datos.estado_id = json_filtros.estados_filtro\n                : '';\n\n            (json_filtros.creador_filtro)\n                ? datos.usuario_id = json_filtros.creador_filtro\n                : '';\n\n            if (typeof json_filtros.fecha_creacion_filtro === 'string') {\n                let partes_fecha = json_filtros.fecha_creacion_filtro.split(' a ');\n                (partes_fecha[0]) ? datos.fecha_creacion_desde = partes_fecha[0] : '';\n                (partes_fecha[1]) ? datos.fecha_creacion_hasta = partes_fecha[1] : '';\n            }\n\n            if (typeof json_filtros.fecha_archivado_filtro === 'string') {\n                let partes_fecha_archivado = json_filtros.fecha_archivado_filtro.split(' a ');\n                (partes_fecha_archivado[0]) ? datos.fecha_archivado_desde = partes_fecha_archivado[0] : '';\n                (partes_fecha_archivado[1]) ? datos.fecha_archivado_hasta = partes_fecha_archivado[1] : '';\n            }\n\n            (json_filtros.aplicante_filtro)\n                ? datos.aplicante = json_filtros.aplicante_filtro\n                : '';\n\n            (json_filtros.etapa_filtro)\n                ? datos.etapa = json_filtros.etapa_filtro\n                : '';\n        },\n        dataSrc: function (json) {\n            return Object.values(json.data);\n        }\n    },\n    columns: [\n        {\n            data: null,\n            orderable: false,\n            render: (dato) => {\n                return `\n                    <div class=\"card shadow-none\">\n                        <div class=\"card-body\">\n                            <div class=\"row\">\n                                ${cabeceraFilaTablaVacantes(dato)}\n                                ${contenidoFilaTablaVacantes(dato)}\n                                ${footerTablaVacantes(dato)}\n                            </div>\n                        </div>\n                    </div>\n                `;\n            },\n        },\n    ],\n    drawCallback: function(settings) {\n        vacantes_datos_ids = $(`#${nombre_tabla_vacantes}`).DataTable().data().toArray();\n        inicializarTooltips();\n    },\n    initComplete: function(settings, json) {\n        vacantes_datos_ids = $(`#${nombre_tabla_vacantes}`).DataTable().data().toArray();\n        $('#tabla-vacantes').parent().css('height', '100vh');\n        $(`[aria-describedby=\"${nombre_tabla_vacantes}_info\"] .thead-componente`).hide();\n        inicializarTooltips();\n        cargarDataTablas();\n        validarDatos();\n    }\n});\n\n$(document).ready(function() {\n    $('#fecha_archivado').hide();\n    $(document).on('change', '#filtro_mas_recientes', function() {\n        actualizarDatatables(nombre_tabla_vacantes);\n    });\n\n    $(document).on('change', 'input[name=\"checkbox_vacantes\"]', function() {\n        alterarBotonDescargarExcelVacantes();\n    });\n    $.ajax({\n        url: `/api/empresas/${empresa_id}/creditos`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            let porcentaje_creditos = ((respuesta.data.creditos_disponibles / respuesta.data.creditos_plan) * 100) || 0;\n            if (porcentaje_creditos <= 20 && respuesta?.data?.plan_credito) {\n                $('#porcentaje-creditos-disponibles-modal').text(porcentaje_creditos);\n                $('#modal-solicitar-mas-creditos-ia').modal('show');\n            }\n            \n        }\n    });\n\n    $(document).on('click', '#btn-archivo-vacantes', function() {\n        let estado_actual = $('#vacantes_archivadas').val();\n        if (estado_actual == 0) {\n            $('#vacantes_archivadas').val(1);\n            $('#cabecera-pagina-sin-archivar').removeClass('d-none')\n            $('#cabecera-pagina-con-archivar').addClass('d-none')\n            $('#btn-archivo-vacantes').html(`<i class=\"bi bi-archive me-2\"></i> Archivo de vacantes`);\n            $('#btn-crear-vacante').removeClass('d-none')\n            $('#fecha_archivado').hide();\n        } else {\n            $('#vacantes_archivadas').val(0);\n            $('#cabecera-pagina-sin-archivar').addClass('d-none')\n            $('#cabecera-pagina-con-archivar').removeClass('d-none')\n            $('#btn-archivo-vacantes').html(`<i class=\"bi bi-box-arrow-left me-2\"></i> Volver a vacantes`);\n            $('#btn-crear-vacante').addClass('d-none')\n        }\n        actualizarDatatables(nombre_tabla_vacantes);\n    });\n\n    obtenerCreditosDisponiblesEmpresa(empresa_id);\n});\n\n\n/**\n * Muestra u oculta tablas según la existencia de datos en los procesos.\n *\n * @returns {void}\n * @author Andres Morales\n */\nfunction validarDatos() {\n    if (vacantes_datos_ids.length == 0) {\n        $('#tabla-contenido').addClass('d-none');\n        $('#tabla-sin-contenido').removeClass('d-none');\n    } else {\n        $('#tabla-contenido').removeClass('d-none');\n        $('#tabla-sin-contenido').addClass('d-none');\n    }\n}\n\n/**\n * Generar la cabecera de la tabla de vacantes.\n *\n * @param {object} vacante Datos de la vacante.\n * @returns {html} Cabecera de la tabla de vacantes.\n * @author Fahibram Cárcamo\n * @author Andres Morales\n */\nfunction cabeceraFilaTablaVacantes(vacante) {\n    let nombre_truncado = vacante.nombre_vacante.length > 80\n        ? vacante.nombre_vacante.substring(0, 80) + '...'\n        : vacante.nombre_vacante;\n\n    return `\n        <div class=\"col-12 border-bottom\">\n            <div class=\"row mb-3\">\n                <div class=\"col-auto d-flex align-items-center\">\n                    ${crearCheckbox({ id: vacante.id, name: 'checkbox_vacantes' })}&nbsp;\n                    <span class=\"text-body-2\">${vacante.id}</span></div>\n                <div class=\"col\">\n                    <div class=\"row w-100\">\n                        <div class=\"col-auto\">\n                            <a class=\"alineacion-contenido-left btn btn-text-primary text-dark\" ${crearTooltip({ placement: `top`, content: `${vacante.nombre_vacante}`, toggle: `popover` })} href=\"/vacantes-detalle/${vacante.id}\">\n                                <span class=\"text-headline-5 text-gray-10 text-decoration-underline\">${nombre_truncado}</span>\n                            </a>\n                        </div>\n                    </div>\n                    <div class=\"row w-100 mb-2\">\n                        <div class=\"col-auto text-label-2 d-flex px-1\" ${crearTooltip({ placement: `top`, content: `${vacante.creador?.nombres} ${vacante.creador?.apellidos}`, toggle: `popover` })}>\n                            <div class=\"my-auto mx-1\"><i class=\"bi bi-person text-body-2 my-auto\"></i></div>\n                            <div class=\"my-auto mx-1\">Creador:</div>\n                            <div class=\"my-auto mx-1\"><img class=\"rounded-circle\" src=\"/usuarios-imagen/${vacante.creador.id}\" width=\"20px\" height=\"20px\"></div>\n                        </div>\n                        <div class=\"col-auto text-label-2 d-flex px-1\">\n                            <div class=\"my-auto mx-1\"><i class=\"bi bi-briefcase text-body-2 my-auto\"></i></div>\n                            <div class=\"my-auto mx-1\">Vacantes:</div>\n                            <div class=\"my-auto mx-1\">${vacante.cantidad_vacantes}</div>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"col-auto\">\n                    <div class=\"row\">\n                        ${vacante.activo == 1 ? `\n                            <div class=\"col-auto\">${crearTag({ texto: `Total de candidatos: ${vacante.conteo_aplicantes}`, class: 'tag-tonal-gray' })}</div>\n                        ` : ''}\n                        <div class=\"col-auto\">${ESTADOS_VACANTES[vacante.estado_id]}</div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    `;\n}\n\n/**\n * Generar el contenido HTML de una fila de la tabla de vacantes.\n *\n * @param {object} vacante Datos de la vacante.\n * @returns {html} Información de la vacante.\n * @author Andres Morales\n * @author Jair Carvajal\n * @author Andres Gonzalez\n */\nfunction contenidoFilaTablaVacantes(vacante) {\n    let etapas_html = '';\n    if (vacante.etapas && vacante.etapas.length > 0) {\n        const etapas_ordenadas = [...vacante.etapas].sort((a, b) => a.orden - b.orden);\n\n        etapas_html = etapas_ordenadas.map(etapa => {\n            let clase_tag = 'tag-tonal-blue';\n\n            if (etapa.nombre === 'Contratados') {\n                clase_tag = 'tag-tonal-green';\n            } else if (etapa.nombre === 'Descartados') {\n                clase_tag = 'tag-tonal-gray';\n            }\n\n            return `\n                <div class=\"col text-center d-flex flex-column\">\n                    <small class=\"text-gray-30 text-label-2 fw-semibold mb-2\">${etapa.nombre}</small>\n                    ${crearTag({\n                        class: `${clase_tag} fw-semibold mt-auto`,\n                        texto: etapa.conteo_usuarios_activos === 0 ? '-' : etapa.conteo_usuarios_activos\n                    })}\n                </div>\n\n            `;\n        }).join(' ');\n    } else {\n        etapas_html = `${crearTag({ texto: 'Sin etapas', class: 'text-label-1 tag-filled-gray' })}`;\n    }\n\n    return `\n        <div class=\"col-12 border-bottom mt-2\">\n            <div class=\"row mb-3\">\n                <div class=\"col-12\">\n                    <div class=\"row\">\n                        ${etapas_html}\n                    </div>\n                </div>\n            </div>\n        </div>\n    `;\n}\n\n/**\n * Genera el footer de la tabla de vacantes.\n *\n * @param {Object} dato Datos de la vacante.\n * @returns {html} Footer de tabla html.\n * @author Fahibram Cárcamo\n * @author Andres Gonzalez\n */\nfunction footerTablaVacantes(dato) {\n    let boton_ver_detalle = '';\n    let boton_editar = '';\n    let boton_duplicar = '';\n    let boton_suspender = '';\n    let boton_archivar  = '';\n    let boton_eliminar  = '';\n\n    if (dato.activo == 1) {\n        boton_ver_detalle = `<a href=\"/vacantes-detalle/${dato.id}\" class=\"dropdown-item no-visited pointer py-2\">Ver detalle</a>`;\n    }\n\n    if ([1, 2, 4].includes(dato.estado_id) && dato.conteo_aplicantes == 0) {\n        boton_editar = `<a href=\"/vacantes/${dato.id}/edit\" class=\"dropdown-item no-visited pointer py-2\">Editar</a>`;\n    }\n\n    if (1 == 1) {\n        boton_duplicar = `<button type=\"button\" class=\"dropdown-item no-visited pointer py-2\" onclick=\"duplicarVacante(${dato.id}, '${dato.nombre_vacante}')\">Duplicar</button>`;\n    }\n\n    if ([1, 2].includes(dato.estado_id)) {\n        boton_suspender = `<button type=\"button\" class=\"dropdown-item no-visited pointer py-2\" onclick=\"modalSuspender(${dato.id}, '${dato.nombre_vacante}', ${(dato.estado_id == 1) ? 2 : 1})\">${(dato.estado_id == 1) ? 'Suspender' : 'Reactivar'}</button>`;\n    }\n\n    if ([2, 3].includes(dato.estado_id)) {\n        boton_archivar = `<button type=\"button\" class=\"dropdown-item no-visited pointer py-2\" onclick=\"archivarDesarchivarVacante(${dato.id}, ${dato.activo}, '${dato.nombre_vacante}')\">${(dato.activo == 1) ? 'Archivar' : 'Desarchivar'}</button>`;\n    }\n\n    if ([1, 2, 3, 4].includes(dato.estado_id) && dato.conteo_aplicantes == 0) {\n        boton_eliminar = `<button type=\"button\" class=\"dropdown-item no-visited pointer py-2 text-danger\" onclick=\"modalEliminar(${dato.id}, '${dato.nombre_vacante}')\">Eliminar</button>`;\n    }\n\n    return `\n        <div class=\"col-12 mt-3\">\n            <div class=\"row\">\n                <div class=\"col-auto my-auto ps-5\">\n                    <p class=\"mb-0 h-fit-content\">\n                        <i class=\"bi bi-calendar4 me-2 text-body-2\"></i>\n                        <span class=\"text-label-2\"><span class=\"me-2\">Creado:</span>${formatearFecha(dato.created_at)}</span>\n                    </p>\n                </div>\n                <div class=\"col-auto ms-auto\">\n                    <div class=\"row\">\n                        <div class=\"col-auto pe-0\">\n                            ${crearBoton({\n                                clases: 'btn-outline-primary btn-circle',\n                                texto: '<i class=\"bi bi-person-add\"></i>',\n                                tooltip: `${crearTooltip({ placement: `bottom`, content: (dato.estado_id == 1) ? 'Agregar Candidato' : 'No es posible agregar candidatos en estado borrador.', toggle: `popover` })}`,\n                                onclick: (dato.estado_id == 1) ? `agregarCandidato(${dato.id})` : '',\n                                disabled: (dato.estado_id == 1) ? false : true\n                            })}\n                        </div>\n                        <div class=\"col-auto dropdown\">\n                            ${crearBoton({\n                                clases: 'btn-outline-primary btn-circle dropdown-toggle',\n                                texto: '<i class=\"bi bi-three-dots\"></i>',\n                                data: [\n                                    {texto: 'bs-toggle', value: 'dropdown'},\n                                    {texto: 'bs-auto-close', value: 'outside'}\n                                ]\n                            })}\n                            <div class=\"dropdown-menu\">\n                                ${boton_ver_detalle}\n                                ${boton_editar}\n                                ${boton_duplicar}\n                                ${boton_suspender}\n                                ${boton_archivar}\n                                ${boton_eliminar}\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    `;\n}\n\n/**\n * Función para aplicar los filtros avanzados aplicados.\n *\n * @param {string} filtro id del elemento html del filtro\n * @param {Object} filtros filtros aplicados\n * @returns {void}\n * @author Fahibram Cárcamo\n */\nfunction aplicarFiltrosDropdown(filtro, filtros) {\n    filtro_html = filtro;\n    json_filtros = filtros;\n    actualizarDatatables(nombre_tabla_vacantes);\n}\n\n\n/**\n * Guardar configuraciones para el movimiento de revisión de HV.\n *\n * Esta función es temporal, para que frontend pueda verificar y probar su comportamiento.\n *\n * @returns {void}\n * @author Daniel Beltrán\n */\nfunction configurarHV() {\n    $.ajax({\n        type: 'POST',\n        url : '/etapas-movimientos-vacantes-configuraciones',\n        data: {\n            _token         : $('input[name=\"_token\"]').val(),\n            configuraciones: [\n                {\n                    etapa_movimiento_vacante_id        : 2,\n                    movimiento_vacante_configuracion_id: 4,\n                    valor                              : 15\n                }\n            ]\n        }\n    }).done((respuesta) => {\n        mostrarToast('success', respuesta.message);\n    }).fail((error) => {\n        mostrarToast('danger', 'Ocurrió un error');\n    });\n}\n\n/**\n * Completar vacante.\n *\n * Esta función es temporal, para que frontend pueda verificar y probar su comportamiento.\n *\n * @returns {void}\n * @author Daniel Beltrán\n */\nfunction completarVacante() {\n    $.ajax({\n        type: 'POST',\n        url : '/vacantes-completar/21',\n        data: {\n            _token: $('input[name=\"_token\"]').val()\n        }\n    }).done((respuesta) => {\n        mostrarToast('success', respuesta.message);\n    }).fail((error) => {\n        mostrarToast('danger', 'Ocurrió un error');\n    });\n}\n\n/**\n * Guardar preguntas.\n *\n * Esta función es temporal, para que frontend pueda verificar y probar su comportamiento.\n *\n * @returns {void}\n * @author Daniel Beltrán\n */\nfunction guardarPreguntas() {\n    $.ajax({\n        type: 'POST',\n        url : '/vacantes-preguntas',\n        data: {\n            _token          : $('input[name=\"_token\"]').val(),\n            vacante_id      : 21,\n            etapa_vacante_id: 47,\n            preguntas       : JSON.stringify([\n                {\n                    // id        : 3,\n                    enunciado : 'Come ti chiami',\n                    es_abierta: true\n                },\n                {\n                    // id              : 5,\n                    enunciado       : 'Quale è il tuo cibo preferito',\n                    es_abierta      : false,\n                    tiempo_respuesta: 2,\n                    opciones        : [\n                        {\n                            // id         : 7,\n                            texto      : 'Uovo',\n                            orden      : 1,\n                            es_correcta: false\n                        },\n                        {\n                            texto      : 'Pizza',\n                            orden      : 2,\n                            es_correcta: false\n                        },\n                        {\n                            texto      : 'Riso',\n                            orden      : 3,\n                            es_correcta: true\n                        }\n                    ]\n                }\n            ])\n        }\n    }).done((respuesta) => {\n        mostrarToast('success', respuesta.message);\n    }).fail((error) => {\n        mostrarToast('danger', 'Ocurrió un error');\n    });\n}\n\n/**\n * Adjuntar archivos a una etapa de vacante.\n *\n * Esta función es temporal, para que frontend pueda verificar y probar su comportamiento.\n *\n * @returns {void}\n * @author Daniel Beltrán\n */\nfunction adjuntarArchivos() {\n    let etapa_vacante_id = $('#etapa_vacante_id_prueba').val();\n    let archivos         = $('#archivos_prueba')[0].files;\n\n    if (!etapa_vacante_id) {\n        mostrarToast('warning', 'Debe ingresar un ID de etapa de vacante');\n        return;\n    }\n\n    if (archivos.length === 0) {\n        mostrarToast('warning', 'Debe seleccionar al menos un archivo');\n        return;\n    }\n\n    let form_data = new FormData();\n    form_data.append('_token', $('input[name=\"_token\"]').val());\n    form_data.append('etapa_vacante_id', etapa_vacante_id);\n\n    for (let i = 0; i < archivos.length; i++) {\n        form_data.append('archivos[]', archivos[i]);\n    }\n\n    $.ajax({\n        type       : 'POST',\n        url        : '/etapas-vacantes-adjuntar-archivos',\n        data       : form_data,\n        processData: false,\n        contentType: false\n    }).done((respuesta) => {\n        mostrarToast('success', respuesta.message);\n        $('#etapa_vacante_id_prueba').val('');\n        $('#archivos_prueba').val('');\n    }).fail((error) => {\n        let mensaje = error.responseJSON?.message || 'Ocurrió un error al adjuntar los archivos';\n        mostrarToast('danger', mensaje);\n    });\n}\n\n/**\n * Procesar hoja de vida con inteligencia artificial.\n *\n * Envía un archivo de hoja de vida al servicio de IA para extraer información.\n *\n * @returns {void}\n * @author Daniel Beltrán\n * @deprecated\n */\nfunction procesarHojaVidaConIA() {\n    let archivo_input = $('#archivo_hv_ia')[0];\n    let archivo = archivo_input.files[0];\n\n    if (!archivo) {\n        mostrarToast('warning', 'Debe seleccionar un archivo para procesar');\n        return;\n    }\n\n    let form_data = new FormData();\n    form_data.append('archivo', archivo);\n    form_data.append('_token', $('meta[name=\"csrf-token\"]').attr('content'));\n\n    // Deshabilitar botón mientras se procesa\n    $('#btn-procesar-hv-ia').prop('disabled', true);\n    $('#btn-procesar-hv-ia').html('<i class=\"bi bi-hourglass-split me-2\"></i>Procesando...');\n\n    $.ajax({\n        type: 'POST',\n        url: '/perfiles-laborales-leer-hv-ia',\n        data: form_data,\n        processData: false,\n        contentType: false\n    }).done((respuesta) => {\n        mostrarToast('success', respuesta.message || 'Hoja de vida procesada correctamente');\n        console.log('Datos extraídos:', respuesta.data);\n\n        // Limpiar el input\n        $('#archivo_hv_ia').val('');\n    }).fail((error) => {\n        let mensaje = error.responseJSON?.message || 'Ocurrió un error al procesar la hoja de vida';\n        mostrarToast('danger', mensaje);\n        console.error('Error completo:', error);\n    }).always(() => {\n        // Rehabilitar botón\n        $('#btn-procesar-hv-ia').prop('disabled', false);\n        $('#btn-procesar-hv-ia').html('<i class=\"bi bi-robot me-2\"></i>Procesar con IA');\n    });\n}\n","structuredPatch":[{"oldStart":144,"oldLines":8,"newStart":144,"newLines":6,"lines":["         }","         actualizarDatatables(nombre_tabla_vacantes);","     });","-","-    obtenerCreditosDisponiblesEmpresa(empresa_id);"," });"," "," "]}],"userModified":false,"replaceAll":false},"sourceToolAssistantUUID":"421eed83-88ed-451c-aa77-f50b0372667b"}
{"parentUuid":"b485d225-871f-4de6-9502-28efe8836ac7","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01Vy9DUW3hU5wF5GLxLNBo4x","type":"message","role":"assistant","content":[{"type":"text","text":"Ahora agrego la llamada automática en el `$(document).ready()` de `globales.js`:"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":414,"cache_read_input_tokens":69358,"cache_creation":{"ephemeral_5m_input_tokens":414,"ephemeral_1h_input_tokens":0},"output_tokens":4,"service_tier":"standard"}},"requestId":"req_011CXLoCbRnp1kVNFfkWMMJD","type":"assistant","uuid":"6630444d-c1f6-4193-a54b-2553f4a71285","timestamp":"2026-01-21T15:56:56.124Z"}
{"parentUuid":"6630444d-c1f6-4193-a54b-2553f4a71285","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01Vy9DUW3hU5wF5GLxLNBo4x","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01CKp7eosqkbyrWHteQSkPCz","name":"Read","input":{"file_path":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\globales.js","offset":155,"limit":30}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":414,"cache_read_input_tokens":69358,"cache_creation":{"ephemeral_5m_input_tokens":414,"ephemeral_1h_input_tokens":0},"output_tokens":4,"service_tier":"standard"}},"requestId":"req_011CXLoCbRnp1kVNFfkWMMJD","type":"assistant","uuid":"e767d7e7-fdea-46d4-be38-0de5132235be","timestamp":"2026-01-21T15:56:56.756Z"}
{"parentUuid":"e767d7e7-fdea-46d4-be38-0de5132235be","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01CKp7eosqkbyrWHteQSkPCz","type":"tool_result","content":"   155→ * @returns {void}\n   156→ * @author Andres Morales\n   157→ */\n   158→$(document).ready(function () {\n   159→    cargarNotificiacionesHeader();\n   160→    if (window.configuracion_reverbg && window.configuracion_reverbg.activar_websocket) {\n   161→        configurarWebSocketNotificaciones();\n   162→    }\n   163→    setTimeout(() => {\n   164→        $(\".input-container\").each(function () {\n   165→            let $container = $(this);\n   166→            let $select = $container.find(\"select[multiple]\");\n   167→            let $icon = $container.find(\".input-icono1\");\n   168→            if ($select.length && $icon.length) {\n   169→                $(this).find('.select2-selection--multiple').addClass('ps-5')\n   170→            }\n   171→        });\n   172→    }, 1000);\n   173→    $('#modal-consumo-creditos-ia').on('hidden.bs.modal', function () {\n   174→        if (mostro_modal_creditos_ia) {\n   175→            $(modals_abiertos_ia).removeClass('d-none');\n   176→        }\n   177→        mostro_modal_creditos_ia = false;\n   178→    });\n   179→});\n   180→\n   181→/**\n   182→ * Formatear fecha a formato dd/mm/yyyy - hh:mm AM/PM.  Ejemplo: 01/Feb/2022 - 12:00 PM\n   183→ *\n   184→ * @param {string} fecha_entrada fecha en formato ISO\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"4048ba56-7b13-4004-9941-e0a51d430d8e","timestamp":"2026-01-21T15:56:58.126Z","toolUseResult":{"type":"text","file":{"filePath":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\globales.js","content":" * @returns {void}\n * @author Andres Morales\n */\n$(document).ready(function () {\n    cargarNotificiacionesHeader();\n    if (window.configuracion_reverbg && window.configuracion_reverbg.activar_websocket) {\n        configurarWebSocketNotificaciones();\n    }\n    setTimeout(() => {\n        $(\".input-container\").each(function () {\n            let $container = $(this);\n            let $select = $container.find(\"select[multiple]\");\n            let $icon = $container.find(\".input-icono1\");\n            if ($select.length && $icon.length) {\n                $(this).find('.select2-selection--multiple').addClass('ps-5')\n            }\n        });\n    }, 1000);\n    $('#modal-consumo-creditos-ia').on('hidden.bs.modal', function () {\n        if (mostro_modal_creditos_ia) {\n            $(modals_abiertos_ia).removeClass('d-none');\n        }\n        mostro_modal_creditos_ia = false;\n    });\n});\n\n/**\n * Formatear fecha a formato dd/mm/yyyy - hh:mm AM/PM.  Ejemplo: 01/Feb/2022 - 12:00 PM\n *\n * @param {string} fecha_entrada fecha en formato ISO","numLines":30,"startLine":155,"totalLines":1449}},"sourceToolAssistantUUID":"e767d7e7-fdea-46d4-be38-0de5132235be"}
{"parentUuid":"4048ba56-7b13-4004-9941-e0a51d430d8e","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_013gxG6KAuH7qrGqYAQ3nKHe","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01R42a5XQWAJhmauDHG8EUi8","name":"Edit","input":{"replace_all":false,"file_path":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\globales.js","old_string":"    $('#modal-consumo-creditos-ia').on('hidden.bs.modal', function () {\n        if (mostro_modal_creditos_ia) {\n            $(modals_abiertos_ia).removeClass('d-none');\n        }\n        mostro_modal_creditos_ia = false;\n    });\n});","new_string":"    $('#modal-consumo-creditos-ia').on('hidden.bs.modal', function () {\n        if (mostro_modal_creditos_ia) {\n            $(modals_abiertos_ia).removeClass('d-none');\n        }\n        mostro_modal_creditos_ia = false;\n    });\n\n    // Cargar créditos disponibles si existe el contenedor y el ID de empresa\n    if ($('#contenedor-tag-creditos').length && $('#empresa_sesion_id').length) {\n        obtenerCreditosDisponiblesEmpresa($('#empresa_sesion_id').val());\n    }\n});"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":651,"cache_read_input_tokens":69772,"cache_creation":{"ephemeral_5m_input_tokens":651,"ephemeral_1h_input_tokens":0},"output_tokens":24,"service_tier":"standard"}},"requestId":"req_011CXLoD3Eowx95AjPgajxjg","type":"assistant","uuid":"fe455c57-a850-444e-b7bb-b9b5dfc0037b","timestamp":"2026-01-21T15:57:04.129Z"}
{"parentUuid":"fe455c57-a850-444e-b7bb-b9b5dfc0037b","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01R42a5XQWAJhmauDHG8EUi8","type":"tool_result","content":"The file c:\\laragon\\www\\psicoalianza-2\\public\\js\\globales.js has been updated. Here's the result of running `cat -n` on a snippet of the edited file:\n   169→                $(this).find('.select2-selection--multiple').addClass('ps-5')\n   170→            }\n   171→        });\n   172→    }, 1000);\n   173→    $('#modal-consumo-creditos-ia').on('hidden.bs.modal', function () {\n   174→        if (mostro_modal_creditos_ia) {\n   175→            $(modals_abiertos_ia).removeClass('d-none');\n   176→        }\n   177→        mostro_modal_creditos_ia = false;\n   178→    });\n   179→\n   180→    // Cargar créditos disponibles si existe el contenedor y el ID de empresa\n   181→    if ($('#contenedor-tag-creditos').length && $('#empresa_sesion_id').length) {\n   182→        obtenerCreditosDisponiblesEmpresa($('#empresa_sesion_id').val());\n   183→    }\n   184→});\n   185→\n   186→/**\n   187→ * Formatear fecha a formato dd/mm/yyyy - hh:mm AM/PM.  Ejemplo: 01/Feb/2022 - 12:00 PM\n   188→ *"}]},"uuid":"a98e6350-38a8-417d-843b-61acdedfd96f","timestamp":"2026-01-21T15:57:28.734Z","toolUseResult":{"filePath":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\globales.js","oldString":"    $('#modal-consumo-creditos-ia').on('hidden.bs.modal', function () {\n        if (mostro_modal_creditos_ia) {\n            $(modals_abiertos_ia).removeClass('d-none');\n        }\n        mostro_modal_creditos_ia = false;\n    });\n});","newString":"    $('#modal-consumo-creditos-ia').on('hidden.bs.modal', function () {\n        if (mostro_modal_creditos_ia) {\n            $(modals_abiertos_ia).removeClass('d-none');\n        }\n        mostro_modal_creditos_ia = false;\n    });\n\n    // Cargar créditos disponibles si existe el contenedor y el ID de empresa\n    if ($('#contenedor-tag-creditos').length && $('#empresa_sesion_id').length) {\n        obtenerCreditosDisponiblesEmpresa($('#empresa_sesion_id').val());\n    }\n});","originalFile":"// Mensajes en español para el plugin Select2\nconst mensajes_select2 = {\n    'noResults'              : () => { return 'No hay resultados para la búsqueda.'; },\n    'searching'              : () => { return 'Buscando...'; },\n    'Loading'                : () => { return 'Cargando...'; },\n    'loadingMore'            : () => { return 'Cargando más resultados...'; },\n    'dropdownFooter'         : (texto) => { return `Mostrando ${texto} resultados`; },\n    'emptyOptions'           : () => { return 'No hay opciones disponibles.'; },\n    'appendItems'            : (items) => { return `Agregando ${items.length} elementos.`; },\n    'maximumSelectionReached': () => { return 'Se ha alcanzado el número máximo de selecciones.'; },\n    'selectOnClose'          : () => { return 'Seleccione una opción al cerrar el menú.'; },\n    'escapeKeyUp'            : () => { return 'Presione \\'Escape\\' para cerrar el menú.'; },\n    'errorLoading'           : () => { return 'Error al cargar datos. Inténtalo de nuevo más tarde.'; },\n    'inputTooShort'          : (elemento) => { return `Ingresa al menos ${elemento.minimum} caracteres para iniciar una búsqueda.`; },\n    'noMatches'              : () => { return 'No se encontraron coincidencias para tu búsqueda.'; },\n    'allowClear'             : () => { return 'Borrar selección'; },\n    'SelectionTooLong'       : (conteo, maximo) => { return `Solo puedes seleccionar ${maximo} opciones.`; },\n    'loadMore'               : () => { return 'Cargando más resultados...'; },\n    'removing'               : (seleccion) => { return 'Eliminando...'; },\n    'matches'                : (coincidencias, total) => {\n        if (coincidencias === 0) {\n            return 'No hay coincidencias.';\n        } else if (coincidencias === 1) {\n            return 'Se encontró 1 coincidencia.';\n        } else {\n            return `Se encontraron ${coincidencias} coincidencias entre ${total}.`;\n        }\n    }\n};\n\n// audios\nvar audio_notificacion = new Audio('/audios/notificacion.mp3');\n\nlet mostro_modal_creditos_ia = false;\nlet funcion_ejecucion_ia = null;\nlet modals_abiertos_ia = null;\n\n/**\n * Mostrar modal de créditos IA\n * \n * @return void\n * @author José Manuel Jiménez\n */\nfunction mostrarModalCreditosIA(servicio_ia_id) {\n    $.ajax({\n        url: `/api/empresas/${$('#empresa_sesion_id').val()}/creditos`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta_empresa) {\n            if (respuesta_empresa?.data?.creditos_disponibles > 0) {\n                $.ajax({\n                    url: `/api/servicios-ia/${servicio_ia_id}/creditos`,\n                    method: 'GET',\n                    dataType: 'json',\n                    success: function(respuesta) {\n                        if (respuesta?.data?.consume_creditos && respuesta?.data?.consume_creditos <= respuesta_empresa.data.creditos_disponibles) {\n                            $('#cantidad-creditos-descontar-modal').text(respuesta.data.consume_creditos);\n                            $('#modal-consumo-creditos-ia').modal('show');\n                            mostro_modal_creditos_ia = true;\n                            modals_abiertos_ia = $('.modal.show').not('#modal-consumo-creditos-ia').not('#modal-generando-ia');\n                            $(modals_abiertos_ia).addClass('d-none');\n                        } else {\n                            mostrarToastSolicitarCreditosIA();\n                        }\n                    }\n                });\n            } else {\n                mostrarToastSolicitarCreditosIA();\n            }\n        }\n    });\n}\n\n/**\n * Mostrar toast para solicitar créditos IA\n * \n * @return void\n * @author José Manuel Jiménez\n */\nfunction mostrarToastSolicitarCreditosIA() {\n    $.ajax({\n        url: `/empresas/${$('#empresa_sesion_id').val()}`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            let adicional_toast = '';\n            if (respuesta?.data?.ejecutivo?.telefono) {\n                adicional_toast = `<a href=\"https://wa.me/${respuesta.data.ejecutivo.telefono.replace(/\\D/g, '')}?text=Hola,%20me%20gustar%C3%ADa%20solicitar%20cr%C3%A9ditos%20adicionales%20para%20mi%20empresa.\" target=\"_blank\">\n                    <p class=\"text-label-1 text-white no-visited text-decoration-none mb-0\">Solicitar</p>\n                </a>`;\n            }\n            setTimeout(() => {\n                $('#modal-generando-ia').modal('hide');\n                $('#modal-cargue-ia').modal('hide');\n                mostrarToast('danger', 'No cuentas con créditos. Solicita créditos adicionales.', '', adicional_toast);\n            }, 300);\n        }\n    });\n}\n\n/**\n * Continuar ejecución IA luego del modal de créditos\n * \n * @return void\n * @author José Manuel Jiménez\n */\nfunction continuarEjecucionIA() {\n    if (funcion_ejecucion_ia) {\n        funcion_ejecucion_ia();\n        funcion_ejecucion_ia = null;\n    }\n    mostro_modal_creditos_ia = false;\n    $('#modal-consumo-creditos-ia').modal('hide');\n}\n\n/**\n * Solicitar más créditos IA\n * \n * @return void\n * @author José Manuel Jiménez\n */\nfunction solicitarMasCreditosIA() {\n    $.ajax({\n        url: `/empresas/${$('#empresa_sesion_id').val()}`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            if (respuesta?.data?.ejecutivo?.telefono) {\n                window.open(`https://wa.me/${respuesta.data.ejecutivo.telefono.replace(/\\D/g, '')}?text=Hola,%20me%20gustar%C3%ADa%20solicitar%20cr%C3%A9ditos%20adicionales%20para%20mi%20empresa.`, '_blank');\n            } else {\n                mostrarToast('danger', 'No se encontró un ejecutivo asignado a la empresa. Por favor, comunícate con soporte para recargar créditos.');\n            }\n            $('#modal-solicitar-mas-creditos-ia').modal('hide');\n        }\n    });\n}\n\n/**\n * Validar respuesta de créditos IA\n * \n * @return void\n * @author José Manuel Jiménez\n */\nfunction validarRespuestaCreditosIA(error_ia) {\n    if (error_ia == 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.') {\n        mostrarToastSolicitarCreditosIA();\n        return true;\n    }\n    return false;\n}\n\n/**\n * Ajustar el ancho de los elementos select2 asincrono multiple.\n *\n * @returns {void}\n * @author Andres Morales\n */\n$(document).ready(function () {\n    cargarNotificiacionesHeader();\n    if (window.configuracion_reverbg && window.configuracion_reverbg.activar_websocket) {\n        configurarWebSocketNotificaciones();\n    }\n    setTimeout(() => {\n        $(\".input-container\").each(function () {\n            let $container = $(this);\n            let $select = $container.find(\"select[multiple]\");\n            let $icon = $container.find(\".input-icono1\");\n            if ($select.length && $icon.length) {\n                $(this).find('.select2-selection--multiple').addClass('ps-5')\n            }\n        });\n    }, 1000);\n    $('#modal-consumo-creditos-ia').on('hidden.bs.modal', function () {\n        if (mostro_modal_creditos_ia) {\n            $(modals_abiertos_ia).removeClass('d-none');\n        }\n        mostro_modal_creditos_ia = false;\n    });\n});\n\n/**\n * Formatear fecha a formato dd/mm/yyyy - hh:mm AM/PM.  Ejemplo: 01/Feb/2022 - 12:00 PM\n *\n * @param {string} fecha_entrada fecha en formato ISO\n * @returns {string} fecha y hora formateada\n * @author Andres Morales\n */\nfunction formatearFecha(fecha_entrada) {\n    var fecha = new Date(fecha_entrada);\n    var dia = fecha.getDate();\n    var mes = fecha.toLocaleString('es-ES', { month: 'short' });\n    var anio = fecha.getFullYear();\n    let hora = fecha.getHours();\n    let minuto = fecha.getMinutes();\n    let ampm = hora >= 12 ? 'PM' : 'AM';\n    hora = hora % 12 || 12;\n    minuto = minuto.toString().padStart(2, '0');\n    return `${dia}/${mes}/${anio} - ${hora}:${minuto} ${ampm}`;\n}\n\nfunction formatearFecha2(fecha_entrada) {\n    let partes = fecha_entrada.split(' ');\n    let fecha = partes[0].split('-');\n    let hora = partes[1];\n    let fechaISO = `${fecha[2]}-${fecha[1]}-${fecha[0]}T${hora}`;\n\n    let date = new Date(fechaISO);\n\n    if (isNaN(date.getTime())) {\n        return 'Fecha inválida';\n    }\n\n    let dia = date.getDate();\n    let mes = date.toLocaleString('eu-EU', { month: 'short' });\n    let anio = date.getFullYear();\n    return `${dia}/${mes}/${anio}`;\n}\n\n/**\n * Opción para contraer o agrandar el menú principal\n *\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Andres Morales\n */\nfunction contraerMenu() {\n    if ($('.sidebar-menu').hasClass('close')) {\n        $('.sidebar-menu').removeClass('d-none');\n        localStorage.setItem('opcion_menu_storage', 'abierto');\n        $('#btn-collapse').attr('data-bs-original-title', 'Contraer');\n        $('#btn-collapse').attr('data-bs-title', 'Contraer');\n        $(\".menu-bar\").each(function() {\n            $(this).removeClass(\"px-2\").addClass(\"px-5\");\n        });\n        $('[data-bs-toggle=\"tooltip\"]').each(function () { new bootstrap.Tooltip(this); });\n        $('.lista-primary[data-bs-toggle=\"tooltip\"]').each(function () {\n            var tooltip_instancia = bootstrap.Tooltip.getInstance(this);\n            if (tooltip_instancia) {\n                tooltip_instancia.dispose();\n            }\n        });\n    } else {\n        $('.sidebar-menu').addClass('d-none');\n        localStorage.setItem('opcion_menu_storage', 'cerrado');\n        $('#btn-collapse').attr('data-bs-original-title', 'Expandir');\n        $('#btn-collapse').attr('data-bs-title', 'Expandir');\n        $(\".menu-bar\").each(function() {\n            $(this).removeClass(\"px-5\").addClass(\"px-2\");\n        });\n        $('[data-bs-toggle=\"tooltip\"]').each(function () { new bootstrap.Tooltip(this); });\n    }\n    $('.tooltip.bs-tooltip-auto').remove();\n    $('.sidebar-menu').toggleClass('close');\n    $('.contenedor-vista').toggleClass('close');\n    $('#btn-collapse').toggleClass('close');\n    $('.nombre-usuario-empresa').toggle();\n    $('.menu-bar .text-menu').toggle();\n}\n\n/**\n * Opción para abrir o cerrar el menu segun la elección guardada\n *\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Andres Morales\n */\nfunction mostrarMenuStorage() {\n    $(document).ready(function() {\n        $('.lista-primary[data-bs-toggle=\"tooltip\"]').each(function () {\n            var tooltip_instancia = bootstrap.Tooltip.getInstance(this);\n            if (tooltip_instancia) {\n                tooltip_instancia.dispose();\n            }\n        });\n\n        if (window.innerWidth < 768) {\n            localStorage.setItem('opcion_menu_storage', 'cerrado');\n        }\n\n        if (localStorage.getItem('opcion_menu_storage') === 'cerrado') {\n            contraerMenu();\n        }\n        let $active = $('.menu-bar .active');\n\n        if ($active.length) {\n            $('.menu-bar').scrollTop($active.position().top);\n        }\n    });\n}\nmostrarMenuStorage();\n\n/**\n * Funcion para hacer el slug de un texto desde jquery.\n *\n * @returns {void}\n * @author Andres Morales\n */\nfunction slugify(text) {\n    return $.trim(text)\n        .toLowerCase()\n        .normalize(\"NFD\")\n        .replace(/[\\u0300-\\u036f]/g, \"\")\n        .replace(/[^a-z0-9 -]/g, \"\")\n        .replace(/\\s+/g, \"-\")\n        .replace(/-+/g, \"-\");\n}\n\n/**\n * Función generica para mostrar mensajes de respuesta\n *\n * @param {string} tipo_alerta define el color de la alerta segun alerts de botstrap.\n * @param {string} texto_1 Texto que mostrara la alerta.\n * @param {string} texto_2 Texto secundario en la alerta.\n * @param {string} accion Acción adicional(por definir).\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Andres Gonzalez\n */\nfunction mostrarToast(tipo_alerta, texto_1, texto_2 = '', accion = '', icono2 = '') {\n    let icono = '';\n    let texto_color = 'text-white';\n    if (accion != '') {\n        accion = `<div class=\"col-auto p-0 text-label-1\">${accion}</div>`;\n    }\n\n    if (tipo_alerta == 'success') {\n        icono = 'bi bi-check-circle';\n    }\n\n    if (tipo_alerta == 'neutral') {\n        icono = 'bi bi-info-circle';\n    }\n\n    if (tipo_alerta == 'warning') {\n        icono = 'bi bi-info-circle';\n        texto_color = \"text-red-letras\";\n    }\n\n    if (tipo_alerta == 'danger') {\n        icono = 'bi bi-x-circle';\n    }\n\n    if (icono2 != '') {\n        icono = icono2;\n    }\n\n    if (texto_2 != '') {\n        texto_2 = `<div class=\"col-12 p-0 text-label-1 ${texto_color}\">${texto_2}</div>`;\n    }\n\n    let alert_toast = $(`\n        <div class=\"alert toast-${tipo_alerta} alert-dismissible fade show d-flex align-items-center pe-3 py-3 me-3\" role=\"alert\" style=\"display:none\">\n            <div class=\"col-auto\">\n                <span class=\"${icono} ${texto_color}\"></span>\n            </div>\n            <div class=\"col px-3\">\n                <div class=\"row m-0 ${texto_color}\">\n                    <div class=\"col-12 p-0 text-label-1 ${texto_color}\">\n                        ${texto_1}\n                    </div>\n                    ${texto_2}\n                </div>\n            </div>\n            ${accion}\n            <div class=\"col-auto ms-3 pointer\" data-bs-dismiss=\"alert\">\n                <span class=\"bi bi-x ${texto_color}\"></span>\n            </div>\n        </div>\n    `);\n    $('#contenedor-alert-toast').append(alert_toast);\n    alert_toast.fadeIn();\n    setTimeout(function() {\n        alert_toast.fadeOut();\n        alert_toast.alert('close');\n    }, 5000);\n}\n\n/**\n * Formatear número.\n *\n * @param {number} numero número a formatear\n * @author Andres Morales\n */\nfunction formatearNumero(numero) {\n    return parseInt(numero).toLocaleString('es-ES');\n}\n\n/**\n * Formatear fecha.\n *\n * @param {*} fecha Fecha a formatear.\n * @param {boolean} incluir_segundos Indica si se debe incluir los segundos en la hora.\n * @param {string} formato Formato en el que se retornará la fecha.\n * @param {string} separador Símbolo que se usará para separar días, meses y años.\n * @returns {Object} Objeto con la fecha y hora formateada.\n * @author Daniel Beltrán\n */\nfunction formatearFechaConceptual(fecha, incluir_segundos = false, formato = 'Ymd', separador = '-') {\n    const NUEVA_FECHA = new Date(fecha);\n    const ANO         = NUEVA_FECHA.getFullYear();\n    const MES         = String(NUEVA_FECHA.getMonth() + 1).padStart(2, '0');\n    const DIA         = String(NUEVA_FECHA.getDate()).padStart(2, '0');\n    const HORAS       = String(NUEVA_FECHA.getHours()).padStart(2, '0');\n    const MINUTOS     = String(NUEVA_FECHA.getMinutes()).padStart(2, '0');\n    const SEGUNDOS    = String(NUEVA_FECHA.getSeconds()).padStart(2, '0');\n\n    let fecha_formateada = `${ANO}${separador}${MES}${separador}${DIA}`;\n\n    if (formato === 'dmY') {\n        fecha_formateada = `${DIA}${separador}${MES}${separador}${ANO}`;\n    }\n\n    return {\n        fecha: fecha_formateada,\n        hora : incluir_segundos ? `${HORAS}:${MINUTOS}:${SEGUNDOS}` : `${HORAS}:${MINUTOS}`\n    };\n}\n\n/**\n * Formatear fecha a May. 2023.\n *\n * @param {string} fechaISO Fecha a formatear.\n * @returns {string} Objeto con la fecha y hora formateada.\n * @author Andres Morales\n */\nfunction formatearFechaAnioMes(fechaISO) {\n    const fecha = new Date(fechaISO);\n    const opciones = { month: 'short', year: 'numeric' };\n    let fecha_formateada = fecha.toLocaleDateString('es-ES', opciones);\n\n    fecha_formateada = fecha_formateada.replace(\n        /^([a-zñ]+)(\\s\\d{4})$/,\n        (_, mes, anio) => `${mes.charAt(0).toUpperCase() + mes.slice(1)}. ${anio.trim()}`\n    );\n\n    return fecha_formateada;\n}\n\n/**\n * Formatear un numero a moneda.\n *\n * @param {string} valor Numero.\n * @returns {string} Numero formateado.\n * @author Andres Morales\n */\nfunction formatearMonedaCOP(valor) {\n    return new Intl.NumberFormat('es-CO', {\n        style: 'currency',\n        currency: 'COP',\n        minimumFractionDigits: 0,\n        maximumFractionDigits: 0\n    }).format(valor);\n}\n\n/**\n * Formatear fecha a un formato d/m/Y hh:mm:ss entendible para el usuario.\n *\n * @param {*} fecha_inicial Fecha a formatear.\n * @returns {String} String con la fecha y hora formateada.\n * @author José Manuel Jiménez\n */\nfunction fechaMostrar(fecha_inicial) {\n    if (!fecha_inicial) {\n        return \"\";\n    }\n    const fecha = new Date(fecha_inicial);\n    if (isNaN(fecha.getTime())) {\n        return \"\";\n    }\n    const dia = String(fecha.getUTCDate()).padStart(2, '0');\n    const mes = String(fecha.getUTCMonth() + 1).padStart(2, '0');\n    const anio = fecha.getUTCFullYear();\n    if (!fecha_inicial.includes(\" \")) {\n        return `${dia}/${mes}/${anio}`;\n    }\n    const horas = String(fecha.getUTCHours()).padStart(2, '0');\n    const minutos = String(fecha.getUTCMinutes()).padStart(2, '0');\n    const segundos = String(fecha.getUTCSeconds()).padStart(2, '0');\n    return `${dia}/${mes}/${anio} ${horas}:${minutos}:${segundos}`;\n}\n\n/**\n * Descargar Excel.\n *\n * @param {string} ruta Ruta desde donde se descarga el archivo.\n * @param {string} nombre_archivo Nombre del archivo descargado.\n * @param {boolean} marca_tiempo Indica si el nombre del archivo debe llevar marca de tiempo.\n * @param {Object} parametros Parámetros a enviar en la petición.\n * @returns {void}\n * @author Daniel Beltrán\n */\nasync function descargarExcel(ruta, nombre_archivo, marca_tiempo = true, parametros = {}) {\n    parametros._token = $('meta[name=\"csrf-token\"]').attr('content');\n\n    await $.ajax({\n        type     : 'POST',\n        url      : `/${ruta}`,\n        data     : parametros,\n        xhrFields: {\n            responseType: 'blob'\n        },\n        success: function (respuesta) {\n            // Crear una URL para el Blob\n            let url = window.URL.createObjectURL(respuesta); // 'respuesta' es el Blob\n            let a   = document.createElement('a'); // Crea un nuevo elemento <a> para iniciar la descarga\n            a.href  = url;\n            const fecha_actual     = new Date();\n            const dia              = fecha_actual.getDate();\n            const mes              = fecha_actual.getMonth() + 1;\n            const ano              = fecha_actual.getFullYear();\n            const hora             = fecha_actual.getHours();\n            const minutos          = fecha_actual.getMinutes();\n            const segundos         = fecha_actual.getSeconds();\n            const fecha_formateada = `${dia}${mes}${ano}${hora}${minutos}${segundos}`;\n\n            a.download = marca_tiempo ? `${nombre_archivo}-${fecha_formateada}.xlsx` : `${nombre_archivo}.xlsx`;\n            document.body.appendChild(a);\n            a.click();\n            window.URL.revokeObjectURL(url);\n            document.body.removeChild(a);\n        }\n    }).then(() => {\n        mostrarToast('success', 'Archivo descargado correctamente.');\n    }).catch((error) => {\n        mostrarToast('danger', 'Ocurrió un error al descargar el archivo.');\n    });\n}\n\n/**\n * Convierte un string a slug.\n *\n * @param {string} str\n * @returns {string}\n * @author Fahibram Cárcamo\n */\nfunction slug(str) {\n\n    // Quita espacios en blanco\n    str = str.replace(/^\\s+|\\s+$/g, \"\")\n\n    // Convierte el string a minusculas\n    str = str.toLowerCase()\n\n    // Quita los caracteres no alfanuméricos\n    str = str.replace(/[^a-z0-9 -]/g, \"\")\n\n    // Reemplaza los espacio con guiones\n    str = str.replace(/\\s+/g, \"-\")\n\n    // Remueve los guiones consecutivos\n    str = str.replace(/-+/g, \"-\")\n\n    return str\n}\n\n/**\n * Compara los elementos de dos arreglos y retorna `true` si son iguales y `false` en caso contrario\n * (Este función está pensada para comparar arreglos unidimensionales).\n *\n * @param {array} primer_arreglo\n * @param {array} segundo_arreglo\n * @param {boolean} comparar_orden\n * @return {boolean}\n * @author Fahibram Cárcamo\n */\nfunction sonArreglosIguales(primer_arreglo, segundo_arreglo, comparar_orden = false) {\n\n    if (!comparar_orden) {\n        primer_arreglo.sort()\n        segundo_arreglo.sort()\n    }\n\n    if (primer_arreglo.length !== segundo_arreglo.length) return false\n\n    for (let i = 0; i < primer_arreglo.length; i++) {\n        if (primer_arreglo[i] !== segundo_arreglo[i]) return false\n    }\n\n    return true\n}\n\n/**\n * Función para cambiar de empresa.\n *\n * @param {number} empresa_id ID de la empresa a la que se va a cambiar.\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Daniel Beltrán\n */\nfunction cambiarEmpresa(empresa_id) {\n    $.ajax({\n        type: 'POST',\n        url: '/suplantar-rol-admin-general',\n        data: {\n            _token    : $('meta[name=\"csrf-token\"]').attr('content'),\n            empresa_id: empresa_id\n        },\n        success: function (respuesta) {\n            localStorage.setItem('notificacionToast', JSON.stringify({\n                tipo_alerta: 'success',\n                texto_1    : 'Cambio de empresa exitoso'\n            }));\n\n            window.location.reload();\n        },\n        error: function (error) {\n            mostrarToast('danger', 'Ocurrió un error al cambiar de empresa');\n        }\n    });\n}\n\n/**\n * Enviar la solucitud de suplantación de rol y empresa al Back-end.\n *\n * @param {function|null} callback_exito Callback ejecutado en caso de éxito.\n * @param {string} url URL de suplantación.\n * @param {string} _token Token CSRF del formulario.\n * @param {number} empresa_id Id de la empresa a suplantar.\n * @param {number|null} rol_id Id del rol a suplantar.\n * @param {function|null} callback_error Callback ejecutado en caso de error.\n * @returns {void}\n * @author Fahibram Cárcamo\n */\nasync function enviarOrdenSuplantacionRolEmpresa (callback_exito, url, _token, empresa_id = null, rol_id = null, callback_error = null) {\n\n    let condicion_suplantacion = rol_id === null\n        ? empresa_id === null\n            ? true\n            : parseInt($('#empresa_sesion_id').val()) !== parseInt(empresa_id)\n        : parseInt($('#rol_sesion_id').val()) !== parseInt(rol_id) && parseInt($('#empresa_sesion_id').val()) !== parseInt(empresa_id);\n\n    if (condicion_suplantacion) {\n        let data = { _token };\n        if (empresa_id !== null) data.empresa_id = empresa_id;\n        if (rol_id !== null) data.rol_id = rol_id;\n\n        await $.ajax({ type: 'POST', url, data })\n            .then((respuesta, status, xhr) => {\n                if (xhr.status >= 200 && xhr.status < 300 && callback_exito !== null) callback_exito();\n            })\n            .catch(error => {\n                let swal_titulo, swal_texto;\n\n                if (error.status === 404) {\n                    if (error.responseJSON.mensaje) {\n                        swal_titulo = 'Algo salió mal';\n                        if (error.responseJSON.mensaje === 'no existe rol_suplantar') {\n                            swal_texto = 'El rol no existe.';\n                        } else if (error.responseJSON.mensaje === 'no existe empresa_suplantar') {\n                            swal_texto = 'La empresa no existe.';\n                        } else if (error.responseJSON.mensaje === 'no existe usuario_suplantar') {\n                            swal_texto = 'El usuario no existe.';\n                        } else {\n                            swal_texto = '';\n                        }\n                    } else if (error.responseJSON.empresa && error.responseJSON.rol) {\n                        swal_titulo = 'No fué posible cambiar de empresa';\n                        swal_texto = error.responseJSON.rol === 'Administrador general' || error.responseJSON.rol === 'Propietario'\n                            ? `La empresa ${error.responseJSON.empresa} no tiene ningún usuario con el rol Administrador general o Propietario.`\n                            : `La empresa ${error.responseJSON.empresa} no tiene ningún usuario con el rol ${error.responseJSON.rol}.`;\n                    } else {\n                        swal_titulo = 'Algo salió mal';\n                        swal_texto = error.responseJSON.errors;\n                    }\n                } else {\n                    swal_titulo = 'Algo salió mal';\n                    swal_texto = '';\n                }\n\n                if (callback_error !== null) callback_error();\n\n                Swal.fire({\n                    title: swal_titulo,\n                    text: swal_texto,\n                    icon: \"error\",\n                    confirmButtonText: \"Aceptar\"\n                });\n            });\n    }\n}\n\n/**\n * Mostrar tooltip según el div que lo contenga.\n *\n * @param {div} div Elemento en donde se va a mostrar el tooltip.\n * @returns {void}\n * @author Sol Espitia\n */\nfunction mostrarTooltip(div) {\n    const TOOLTIP         = div.querySelector('.tooltip-x');\n    TOOLTIP.style.display = 'block';\n}\n\n/**\n * Ocultar tooltip según el div que lo contenga.\n *\n * @param {div} div Elemento en donde se va a mostrar el tooltip.\n * @returns {void}\n * @author Sol Espitia\n */\nfunction ocultarTooltip(div) {\n    const TOOLTIP         = div.querySelector('.tooltip-x');\n    TOOLTIP.style.display = 'none';\n}\n\n/**\n * Retornar la diferencia en días de dos fechas dadas.\n *\n * @param {string} fecha_inicial Fecha inicial\n * @param {string} fecha_final Fecha final\n * @param {bool} valor_absoluto Retorna la diferencia en valor absoluto\n * @returns {number}\n * @author Fahibram Cárcamo\n * @author Andres Morales\n */\nfunction diferenciaFechasDias(fecha_inicial, fecha_final, valor_absoluto = false, sumar_dia = true) {\n    let fecha1 = new Date(fecha_inicial);\n    let fecha2 = new Date(fecha_final);\n\n    fecha1.setHours(0, 0, 0, 0);\n    fecha2.setHours(0, 0, 0, 0);\n\n    let diferencia_milisegundos = fecha2.getTime() - fecha1.getTime();\n\n    let diferencia_dias = diferencia_milisegundos / (1000 * 60 * 60 * 24);\n    let resultado = diferencia_dias;\n    if (sumar_dia) {\n        resultado = diferencia_dias + 1;\n    }\n\n    return valor_absoluto ? Math.abs(resultado) : resultado;\n}\n\n/**\n * Retornar `true` si una fecha dada está dentro de un rango de fechas dadas, `false` en otro caso.\n *\n * @param {string} fecha Fecha dada\n * @param {string} fecha_desde Fecha inicial del rango\n * @param {string} fecha_hasta Fecha final del rango\n * @returns {boolean}\n * @author Fahibram Cárcamo\n */\nfunction fechaDentroDelRango(fecha, fecha_desde, fecha_hasta) {\n    fecha = new Date(fecha);\n    fecha_desde = new Date(fecha_desde);\n    fecha_hasta = new Date(fecha_hasta);\n\n    if (isNaN(fecha) || isNaN(fecha_desde) || isNaN(fecha_hasta)) {\n        throw new Error('Una o más fechas no son válidas.');\n    }\n\n    return fecha >= fecha_desde && fecha <= fecha_hasta;\n}\n\n/**\n * Descuenta el tiempo para las respuestas.\n *\n * @param id - ID del elemento HTML donde mostrar el tiempo\n * @param tiempo - Tiempo inicial en segundos\n * @author Jair Carvajal\n */\nvar tiempos_usados = {};\n\nfunction descuentoTiempo(id, tiempo, callback, onTick) {\n    var $elemento = $('#' + id);\n    if ($elemento.length === 0) {\n        console.error('Elemento con id \"' + id + '\" no encontrado.');\n        return;\n    }\n    if (tiempos_usados[id]) {\n        clearInterval(tiempos_usados[id]);\n    }\n    let tiempoTotal = tiempo;\n    tiempos_usados[id] = setInterval(function() {\n        if (tiempo <= 0) {\n            clearInterval(tiempos_usados[id]);\n            delete tiempos_usados[id];\n            $elemento.text('Tiempo finalizado');\n            if (window.tiempoFinalizado()) {\n                tiempoFinalizado();\n            }\n            if (typeof callback === 'function') {\n                callback();\n            }\n            return;\n        }\n\n        var minutos = Math.floor(tiempo / 60);\n        var segundos = tiempo % 60;\n\n        var textoTiempo = minutos + ':' + (segundos < 10 ? '0' : '') + segundos + '<i class=\"bi bi-alarm ms-2\"></i>';\n\n        if (tiempo <= 15) {\n            $elemento.addClass('text-state-red');\n            $elemento.removeClass('text-state-green');\n        } else {\n            $elemento.addClass('text-state-green');\n            $elemento.removeClass('text-state-red');\n        }\n\n        $elemento.html(textoTiempo);\n\n        var tiempoUsado = tiempoTotal - tiempo;\n\n        if (typeof onTick === 'function') {\n            onTick((tiempoUsado % 5));\n        }\n        tiempo--;\n    }, 1000);\n}\n\n/**\n * Detengo el tiempo para las respuestas.\n *\n * @param id - ID del elemento HTML donde mostrar el tiempo\n * @param tiempo - Tiempo inicial en segundos\n * @author Jair Carvajal\n */\nfunction detenerDescuentoTiempo(id) {\n    if (tiempos_usados[id]) {\n        clearInterval(tiempos_usados[id]);\n        delete tiempos_usados[id];\n    }\n}\n\n/**\n * Genera un SVG de la imagen de usuario.\n *\n * @param id ID del usuario.\n * @param nombres Nombres del usuario.\n * @param apellidos Apellidos del usuario.\n * @return image\n * @author Andres Morales\n */\nfunction crearImagenUsuarioLetras(id, nombres, apellidos) {\n    var tamano = 200;\n    var iniciales = (nombres[0] + apellidos[0]).toUpperCase();\n    var hash = md5(id);\n\n    var r = parseInt(hash.substring(0, 2), 16);\n    var g = parseInt(hash.substring(2, 4), 16);\n    var b = parseInt(hash.substring(4, 6), 16);\n    var colorFondo = `rgb(${r},${g},${b})`;\n\n    var luminancia = 0.299 * r + 0.587 * g + 0.114 * b;\n    var colorTexto = luminancia > 150 ? \"#000000\" : \"#FFFFFF\";\n\n    // SVG como texto\n    var svg = `\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${tamano}\" height=\"${tamano}\">\n        <rect width=\"100%\" height=\"100%\" fill=\"${colorFondo}\" />\n        <text x=\"50%\" y=\"50%\" dy=\".35em\"\n            text-anchor=\"middle\"\n            font-family=\"Lato, sans-serif\"\n            font-size=\"${tamano * 0.4}\"\n            fill=\"${colorTexto}\">\n            ${iniciales}\n        </text>\n    </svg>`;\n    var svgEncoded = encodeURIComponent(svg)\n        .replace(/'/g, \"%27\")\n        .replace(/\"/g, \"%22\");\n\n    var dataUri = `data:image/svg+xml,${svgEncoded}`;\n    return dataUri;\n}\n\n/**\n * Carga las notificaciones\n *\n * @return void\n * @author Andres Morales\n * @author Andres Gonzalez\n * @author Esperanza Olivo\n */\nfunction cargarNotificiacionesHeader() {\n    $.ajax({\n        url: '/usuario-notificaciones',\n        type: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            let datos = respuesta.data;\n            let notificaciones_noleidas = datos?.unread_notifications?.length ?? 0;\n\n            // Siempre remover el badge existente\n            $('#dropdownNotificaciones #badge-notificaciones').remove();\n\n            // Solo agregar el badge si hay notificaciones no leídas\n            if (notificaciones_noleidas > 0) {\n                $('#dropdownNotificaciones').append(`<span id=\"badge-notificaciones\" class=\"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger border border-white\">${notificaciones_noleidas}</span>`);\n                $('#contador-notificaciones-abierto').append(`<span id=\"badge-notificaciones\" class=\"badge rounded-pill bg-danger border border-white\">${notificaciones_noleidas}</span>`);\n\n                $('#contenedor-boton-marcar-todas').html(`\n                    <button class=\"btn btn-link text-primary w-100 d-flex justify-content-center\" onclick=\"marcarNotificacionesLeidas('all')\">\n                        Marcar todo como leído\n                    </button>\n                `);\n            }\n\n            let no_leidos_ids = Array.isArray(datos?.unread_notifications) ? datos.unread_notifications.map(notificacion => notificacion.id): [];\n\n            if (Array.isArray(datos?.notifications) && datos.notifications.length > 0) {\n                $('#notificacion-sinnotificaciones').hide();\n                $('.notificaciones-listado').remove();\n                datos.notifications.forEach(notificacion => {\n                    const { id, data, updated_at } = notificacion;\n\n                    const NO_LEIDO = no_leidos_ids.includes(id);\n                    const MENSAJE = (data?.mensaje || '').slice(0, 120) + '...';\n                    const HORA = new Date(updated_at).toLocaleTimeString('es-CO', {\n                        hour: '2-digit',\n                        minute: '2-digit',\n                        hour12: false\n                    });\n\n                    const notificaciones = `\n                        <li class=\"${NO_LEIDO ? '' : 'bg-gray-90'} notificaciones-listado py-0\" id=\"notificacion-${id}\">\n                            <a class=\"dropdown-item text-gray-10 text-decoration-none border-top pt-0 pb-1\" href=\"javascript:void(0)\" onclick=\"marcarNotificacionesLeidas('${id}','${data?.ruta}')\">\n                                <div class=\"d-flex justify-content-between\">\n                                    <div class=\"w-auto flex-grow-1 pe-3\">\n                                        <p class=\"mt-1 mb-0 text-headline-6 text-gray-10\">${data?.titulo}</p>\n                                        <p class=\"mb-0 text-body-3 text-gray-30 notificacion-mensaje\">${MENSAJE}</p>\n                                    </div>\n                                    <div class=\"w-auto my-auto ${NO_LEIDO ? 'text-cta-azul' : 'text-gray-10'} text-label-2 flex-shrink-0\">\n                                        ${HORA}${NO_LEIDO ? `<i class=\"bi bi-circle-fill text-cta-azul my-auto texto-notificacion-icono ms-3\"></i>` : ''}\n                                    </div>\n                                </div>\n                            </a>\n                        </li>\n                    `;\n\n                    $(notificaciones).insertBefore('#contenedor-boton-marcar-todas');\n                });\n\n            } else {\n                $('#notificacion-sinnotificaciones').hide();\n                $('.notificaciones-listado').remove();\n            }\n\n        },\n        error: function(xhr, status, error) {\n            console.error('Error al cargar notificaciones:', error);\n        }\n    });\n}\n\n/**\n * Marcar las notificaciones leídas.\n *\n * @param {array} notificaciones_ids ids de las notificaciones\n * @param {string} ruta_destino ruta donde se va ha actualizar la pagina\n * @returns {void}\n * @author Andres Gonzalez\n * @author Esperanza Olivo\n */\nfunction marcarNotificacionesLeidas(notificaciones_ids = null, ruta_destino = null, soporte_id = null) {\n\n    let data = {\n        _token: $('meta[name=\"csrf-token\"]').attr('content')\n    };\n\n    if (notificaciones_ids === 'all') {\n        data.marcar_todo = true;\n    } else if (soporte_id) {\n        data.soporte_id = soporte_id;\n    } else if (notificaciones_ids) {\n        data.notificaciones_ids = Array.isArray(notificaciones_ids)\n            ? notificaciones_ids\n            : [notificaciones_ids];\n    }\n\n    $.ajax({\n        url: '/usuario-marcar-notificaciones-leidas',\n        type: 'POST',\n        data: data,\n        success: function(respuesta) {\n            cargarNotificiacionesHeader();\n\n            if (notificaciones_ids && notificaciones_ids !== 'all' && ruta_destino) {\n                window.location.href = \"/\" + ruta_destino;\n            }\n\n            if (notificaciones_ids === 'all') {\n                $('#badge-notificaciones').remove();\n                $('#contenedor-boton-marcar-todas').empty();\n                $('.notificaciones-listado').addClass('bg-gray-90');\n                $('.bi-circle-fill').remove();\n            }\n        },\n        error: function(xhr, estatus, error) {\n            console.error('Error al cargar notificaciones:', error);\n        }\n    });\n}\n\n/**\n * Configurar WebSocket para notificaciones en tiempo real\n *\n * @return void\n * @author Andres Gonzalez\n */\nfunction configurarWebSocketNotificaciones() {\n    try {\n        if (!window.configuracion_reverbg) {\n            return;\n        }\n\n        const PUSHER = new Pusher(window.configuracion_reverbg.appKey, {\n            wsHost: window.configuracion_reverbg.host,\n            wsPort: window.configuracion_reverbg.port,\n            wssPort: window.configuracion_reverbg.port,\n            cluster: 'mt1',\n            forceTLS: false,\n            enabledTransports: ['ws', 'wss'],\n            authEndpoint: '/broadcasting-auth',\n            auth: {\n                headers: {\n                    'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\n                }\n            }\n        });\n\n        PUSHER.connection.bind('failed', function() {\n            console.error('❌ Conexión WebSocket falló');\n        });\n\n        PUSHER.connection.bind('error', function(error) {\n            console.error('❌ Error de WebSocket:', error);\n        });\n\n        let usuario_id = window.configuracion_reverbg.usuario_id;\n\n        if (!usuario_id) {\n            return;\n        }\n\n        const NOMBRE_CANAL = `private-App.Models.Usuarios.User.${usuario_id}`;\n        const CANAL = PUSHER.subscribe(NOMBRE_CANAL);\n\n        CANAL.bind('pusher:subscription_error', function(error) {\n            console.error('❌ Error al suscribirse al canal:', error);\n        });\n\n        // Escuchar eventos específicos de notificaciones\n        CANAL.bind('Illuminate\\\\Notifications\\\\Events\\\\BroadcastNotificationCreated', function(data) {\n            if (data.tipo === 'nueva_notificacion') {\n                audio_notificacion.play();\n                cargarNotificiacionesHeader();\n            }\n\n            if (data.tipo === 'nuevo_mensaje') {\n                if (($('#soporte-guardado-id').val() == data.soporte_id) || ($('#soporte_empresa_id').val() == data.soporte_id)) {\n                    audio_notificacion.play();\n                    consultarChat(data.soporte_id);\n                }\n            }\n        });\n    } catch (error) {\n        console.error('💥 Error en configurarWebSocketNotificaciones:', error);\n        console.error('Stack trace:', error.stack);\n    }\n}\n\n/**\n * Retornar el string entrante en formato title case.\n *\n * @param {string} texto\n * @returns {string}\n * @author Fahibram Cárcamo\n */\nfunction titleCase(texto) {\n    return texto.toLowerCase().replace(/\\b\\w/g, caracter => caracter.toUpperCase());\n}\n\n/**\n * Número de horas que durará el almacenamiento de la variable `ulitmas_empresas` en el\n * almacenamiento local **LocalStorage**.\n *\n * @var {number}\n * @author Fahibram Cárcamo\n */\nconst CANTIDAD_HORAS_VENCIMIENTO_ULTIMAS_EMPRESAS_LOCALSTORAGE = 6;\n\n/**\n * Validar si ya debe removerse la variable `ultimas_empresas` del alamacenamiento local\n * **LocalStorage**, si no es tiempo de eliminarla entonces se reinicia el tiempo de vigencia de la\n * variable.\n *\n * @returns {void}\n * @author Fahibram Cárcamo\n */\nfunction validarYActualizarUltimasEmpresasLocalStorage() {\n    let fecha_hora_actuales = moment();\n    let fecha_hora_vencimiento_ultimas_empresas = fecha_hora_actuales.clone().add(CANTIDAD_HORAS_VENCIMIENTO_ULTIMAS_EMPRESAS_LOCALSTORAGE, 'hours');\n    let fecha_hora_vencimiento_ultimas_empresas_localstorage = localStorage.getItem('vencimiento_ultimas_empresas');\n    let ultimas_empresas = localStorage.getItem('ultimas_empresas');\n\n    if (\n        ultimas_empresas != null &&\n        fecha_hora_vencimiento_ultimas_empresas_localstorage != null &&\n        fecha_hora_actuales.clone().isBefore(moment(fecha_hora_vencimiento_ultimas_empresas_localstorage).clone())\n    ) {\n        localStorage.setItem('vencimiento_ultimas_empresas', fecha_hora_vencimiento_ultimas_empresas.format('YYYY-MM-DD HH:mm:ss'));\n        return;\n    }\n\n    localStorage.removeItem('vencimiento_ultimas_empresas');\n    localStorage.removeItem('ultimas_empresas');\n}\n\n/**\n * Obtener la edad actual de un usuario según su fecha de nacimiento.\n *\n * @param {string} fecha_nacimiento\n * @returns {string}\n * @author José Manuel Jiménez\n * @author Fahibram Cárcamo\n * @author Andres Morales\n */\nfunction obtenerEdad(fecha_nacimiento) {\n    if (!fecha_nacimiento) return \"N/A\";\n    let hoy = new Date();\n    let nacimiento = new Date(fecha_nacimiento);\n    let edad = hoy.getFullYear() - nacimiento.getFullYear();\n    let mes = hoy.getMonth() - nacimiento.getMonth();\n    if (mes < 0 || (mes === 0 && hoy.getDate() < nacimiento.getDate())) edad--;\n    return edad + \" años\";\n}\n\n/**\n * Restablecer un input de tipo file.\n *\n * @param {html} elemento_input_html Elemento input html.\n * @param {html} label_elemento_input_html Label del elemento input html.\n * @param {html} boton_eliminar_elemento_input_html Botón para eliminar archivo del elemento input html.\n * @author Fahibram Cárcamo\n */\nfunction reiniciarCampoArchivo(elemento_input_html, label_elemento_input_html, boton_eliminar_elemento_input_html) {\n    elemento_input_html.val('');\n    elemento_input_html.removeAttr('data-base64');\n    label_elemento_input_html.text('Ningún archivo seleccionado');\n    boton_eliminar_elemento_input_html.hide();\n\n    if (elemento_input_html.data('imagen')) {\n        $('#' + elemento_input_html.data('imagen')).val('');\n        $('#' + elemento_input_html.data('imagen') + '_previsualizacion').attr('src', '');\n        $('#' + elemento_input_html.data('imagen') + '_fondo_previsualizacion').removeClass('d-none');\n    }\n}\n\n/**\n * Definir un campo destinado a recibir un número de teléfono celular.\n *\n * Esta función debe llamarse en el evento ready del objeto global document:\n * `$(document).ready(...)`. Ademas debe incluirse un pequeño fragmento de código en la función\n * `validacionAdicional` para que se agregué el código del número de celular al valor de campo\n * cuando se envíe el formulario donde se encutra el campo.\n *\n * ```\n * if (\n *   $('#input_celular_id').length &&\n *   $('#input_celular_id').val() !== '' &&\n *   input_celular.getNumber() !== ''\n * ) {\n *   $('#input_celular_id').val(input_celular.getNumber().slice(1));\n * }\n * ```\n *\n * Donde `input_celular` es el objeto retornado por esta función.\n *\n * @param {string} input_celular_id Id del campo.\n * @param {string} nombre_input_celular Nombre del campo.\n * @param {string} placeholder_input_celular Placeholder del campo.\n * @param {boolean} obligatorio El campo es obligatorio en el formulario.\n * @returns {object}\n * @author Fahibram Cárcamo\n */\nfunction definirInputTipoCelular(input_celular_id, nombre_input_celular, placeholder_input_celular, obligatorio = true) {\n    /**\n     * 🌎 Campo para ingresar un número de telefono con selectór de código de país con banderas.\n     * Este componente se creó con la librería International Telephone Input\n     * (https://intl-tel-input.com).\n     *\n     * La linea hiddenInput: () => ({ phone: 'celular_contacto' }) tiene como función establecer el\n     * nombre del campo, es decir, la llave del par llave-valor que se adjuntará en los datos del\n     * formulario cuando se envíe, en este caso 'celular_contacto'.\n     *\n     * Las lienas autoPlaceholder: 'aggressive' y\n     * customPlaceholder: (placeholder, country) => 'Celular*' se usan para definir el placeholder\n     * del campo.\n     *\n     * Con $('#celular_contacto').attr('required', true); se establece el campo como requerido\n     * dentro del formulario, se hace de esta forma porque la librería no admite el atributo\n     * required directamente en el componente html.\n     *\n     * @author Fahibram Cárcamo\n     */\n    if (document.querySelector(`#${input_celular_id}`)) {\n        const dropdown_dinamico = document.createElement('div');\n        document.body.appendChild(dropdown_dinamico);\n\n        let campo_celular = window.intlTelInput(document.querySelector(`#${input_celular_id}`), {\n            nationalMode: true,\n            initialCountry: 'co',\n            separateDialCode: true,\n            autoInsertDialCode: false,\n            autoPlaceholder: 'aggressive',\n            dropdownContainer: dropdown_dinamico,\n            customPlaceholder: (placeholder, country) => placeholder_input_celular,\n            loadUtils: () => import('https://cdn.jsdelivr.net/npm/intl-tel-input@25.4.2/build/js/utils.js'),\n            onlyCountries: [\n                'CO', // Colombia\n                'EC', // Ecuador\n                'AR', // Argentina\n                'CL', // Chile\n                'VE', // Venezuela\n                'PE', // Perú\n                'BO', // Bolivia\n                'UY', // Uruguay\n                'PY', // Paraguay\n                'PA', // Panamá\n                'MX', // México\n                'CR', // Costa Rica\n                // 'PR', // Puerto Rico\n                'CU', // Cuba\n                // 'DO', // República Dominicana\n                'SV', // El Salvador\n                'GT', // Guatemala\n                'HN', // Honduras\n                'NI', // Nicaragua\n                'ES', // España\n                'US', // Estados Unidos\n                'GQ'  // Guinea Ecuatorial\n            ]\n        });\n\n        if (obligatorio) $(`#${input_celular_id}`).attr('required', true);\n\n        return campo_celular;\n    }\n\n    return null;\n}\n\n/**\n * Establece la validación adicional que se aplica a un campo de tipo celular antes de enviar sus\n * datos en un formulario.\n *\n * @param {HTMLInputElement} input Elemento HTML del campo de tipo celular.\n * @param {string} input_id Id del elemento HTML del campo de tipo celular.\n * @author Fahibram Cárcamo\n * @author Jair Carvajal\n */\nfunction validacionAdicionalInputTipoCelular(input, input_id) {\n    let numero_completo = input.getNumber();\n    let indicativo = '+' + input.getSelectedCountryData().dialCode;\n    let codigo_iso2_pais = input.getSelectedCountryData().iso2;\n    let numero_sin_indicativo = numero_completo.replace(indicativo, '');\n    $(`#indicativo_${input_id}`).val(indicativo);\n    $(`#codigo_iso2_pais_${input_id}`).val(codigo_iso2_pais);\n    $(`#${input_id}`).val(numero_sin_indicativo);\n}\n\n/**\n * Rellenar un input de tipo celular.\n *\n * @param {string} indicativo_celular Código del país del número de celular.\n * @param {string} codigo_pais_iso2 Código ISO2 del país del número de celular.\n * @param {string} numero_celular Número de celular sin código de país.\n * @param {string} input_celular_id ID del input de tipo celular.\n * @param {HTMLInputElement} input_celular Input de tipo celular.\n * @returns {void}\n * @author Daniel Beltrán\n * @author Fahibram Cárcamo\n */\nfunction rellenarInputCelular(indicativo_celular, codigo_pais_iso2, numero_celular, input_celular_id, input_celular) {\n    $(`#${input_celular_id}`).val(numero_celular);\n    if (![null, undefined].includes(codigo_pais_iso2)) input_celular.setCountry(codigo_pais_iso2);\n}\n\n/**\n * Convierte imágenes de base64 a Blob.\n *\n * @param {string} cadena_base_64 Base 64 de la imagen.\n * @returns {Promise<Array>}\n * @author Andres Gonzalez\n */\nfunction imagenBase64Blob(cadena_base_64) {\n    if (!cadena_base_64 || !cadena_base_64.startsWith('data:image')) return null;\n    let datos_base_64 = cadena_base_64.split(',')[1];\n    let tipo_mime = cadena_base_64.match(/data:(.*?);base64/)[1];\n    let caracteres_binarios = atob(datos_base_64);\n    let arreglo_bytes = new Array(caracteres_binarios.length).fill(0).map((_, i) => caracteres_binarios.charCodeAt(i));\n    let bytes_uint8 = new Uint8Array(arreglo_bytes);\n    return new Blob([bytes_uint8], { type: tipo_mime });\n}\n\n\n/**\n * Limpiar estructuras html innecesarias en el check editor.\n *\n * @param {string} html - Cadena HTML generada por CKEditor a limpiar\n * @returns {string} HTML limpio sin elementos específicos de CKEditor\n * @author Andres Gonzalez\n * @author Jair Carvajal\n */\nfunction limpiarHTMLCKEditor(html) {\n    // Remover todos los elementos con clases de CKEditor\n    html = html.replace(/<div class=\"ck[^\"]*\"[^>]*>.*?<\\/div>/gs, '');\n    html = html.replace(/<span class=\"[^\"]*ck[^\"]*\"[^>]*>/gi, '<span>');\n\n    // Limpiar spans de imagen inline\n    html = html.replace(/<span class=\"image-inline[^\"]*\"[^>]*>/gi, '');\n    html = html.replace(/<\\/span>/g, '');\n\n    // Remover elementos de upload y widgets\n    html = html.replace(/<div class=\"ck-image-upload[^\"]*\"[^>]*>.*?<\\/div>/gs, '');\n    html = html.replace(/<div class=\"ck-fake-selection[^\"]*\"[^>]*>.*?<\\/div>/gs, '');\n\n    // Remover atributos innecesarios\n    html = html.replace(/contenteditable=\"[^\"]*\"/gi, '');\n    html = html.replace(/data-cke-filler=\"[^\"]*\"/gi, '');\n\n    // Limpiar párrafos vacíos con br\n    html = html.replace(/<p><br[^>]*><\\/p>/gi, '');\n    html = html.replace(/<br data-cke[^>]*>/gi, '');\n\n    // Limpiar espacios múltiples y saltos de línea\n    html = html.replace(/\\s+/g, ' ');\n    html = html.replace(/>\\s+</g, '><');\n\n    return html.trim();\n}\n\n/**\n * Ordena estudios por fecha_inicio más reciente (de más nueva a más antigua).\n * Preserva los índices originales para permitir edición y eliminación correcta.\n *\n * @param {Array} estudios - Array de objetos con estudios\n * @returns {Array} Array de estudios ordenados con propiedad indice_original\n * @author Jair Carvajal\n */\nfunction ordenarEstudiosPorFecha(estudios) {\n    // Mapear con índice original\n    let estudios_con_indice = estudios.map((estudio, indice_original) => ({\n        ...estudio,\n        indice_original: indice_original\n    }));\n\n    // Ordenar estudios por fecha_inicio (más reciente primero)\n    let estudios_ordenados = estudios_con_indice.sort((a, b) => {\n        // Si ambos tienen fecha_inicio, ordenar por más reciente\n        if (a.fecha_inicio && b.fecha_inicio) {\n            return moment(b.fecha_inicio).diff(moment(a.fecha_inicio));\n        }\n        // Si solo uno tiene fecha_inicio, ese va primero\n        if (a.fecha_inicio && !b.fecha_inicio) return -1;\n        if (!a.fecha_inicio && b.fecha_inicio) return 1;\n        // Si ninguno tiene fecha_inicio, mantener orden original\n        return 0;\n    });\n\n    return estudios_ordenados;\n}\n\n/**\n * Ordena experiencias laborales por fecha: primero las que está trabajando actualmente (sin fecha_fin),\n * luego por fecha_fin más reciente.\n * Preserva los índices originales para permitir edición y eliminación correcta.\n *\n * @param {Array} experiencias - Array de objetos con experiencias laborales\n * @returns {Array} Array de experiencias ordenadas con propiedad indice_original\n * @author Jair Carvajal\n */\nfunction ordenarExperienciasPorFecha(experiencias) {\n    // Mapear con índice original\n    let experiencias_con_indice = experiencias.map((experiencia, indice_original) => ({\n        ...experiencia,\n        indice_original: indice_original\n    }));\n\n    // Ordenar experiencias\n    let experiencias_ordenadas = experiencias_con_indice.sort((a, b) => {\n        // Si 'a' no tiene fecha_fin (trabaja actualmente), va primero\n        if (!a.fecha_fin && b.fecha_fin) return -1;\n        // Si 'b' no tiene fecha_fin (trabaja actualmente), va primero\n        if (a.fecha_fin && !b.fecha_fin) return 1;\n        // Si ambos están trabajando actualmente (sin fecha_fin), mantener el orden actual\n        if (!a.fecha_fin && !b.fecha_fin) return 0;\n        // Si ambos tienen fecha_fin, ordenar por fecha más reciente primero (descendente)\n        return moment(b.fecha_fin).diff(moment(a.fecha_fin));\n    });\n\n    return experiencias_ordenadas;\n}\n\n/**\n * Obtener créditos disponibles de la empresa y actualizar el tag.\n * - Si tiene créditos >= 20% del plan: tag azul\n * - Si tiene créditos < 20% del plan: tag amarillo\n * - Si no tiene créditos: tag gris \"Sin créditos\"\n *\n * @param {number} empresa_id ID de la empresa\n * @param {string} contenedor_id ID del contenedor donde se mostrará el tag\n * @returns {void}\n * @author Andres Gonzalez\n */\nfunction obtenerCreditosDisponiblesEmpresa(empresa_id, contenedor_id = 'contenedor-tag-creditos') {\n    if (!empresa_id || !$(`#${contenedor_id}`).length) {\n        return;\n    }\n\n    $.ajax({\n        url: `/api/empresas/${empresa_id}/creditos`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            let creditos_disponibles = respuesta?.data?.creditos_disponibles ?? 0;\n            let creditos_plan = respuesta?.data?.creditos_plan ?? 0;\n            let porcentaje_disponible = creditos_plan > 0 ? (creditos_disponibles / creditos_plan) * 100 : 0;\n\n            let texto_tag = '';\n            let clase_tag = '';\n\n            if (creditos_disponibles <= 0) {\n                texto_tag = 'Sin créditos';\n                clase_tag = 'tag-tonal-gray';\n            } else if (porcentaje_disponible < 20) {\n                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                clase_tag = 'tag-filled-yellow';\n            } else {\n                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                clase_tag = 'tag-tonal-blue';\n            }\n\n            $(`#${contenedor_id}`).html(crearTag({\n                texto: texto_tag,\n                class: clase_tag,\n            }));\n        },\n        error: function() {\n            $(`#${contenedor_id}`).html(crearTag({\n                texto: 'Error al cargar créditos',\n                class: 'tag-tonal-gray',\n            }));\n        }\n    });\n}\n","structuredPatch":[{"oldStart":176,"oldLines":6,"newStart":176,"newLines":11,"lines":["         }","         mostro_modal_creditos_ia = false;","     });","+","+    // Cargar créditos disponibles si existe el contenedor y el ID de empresa","+    if ($('#contenedor-tag-creditos').length && $('#empresa_sesion_id').length) {","+        obtenerCreditosDisponiblesEmpresa($('#empresa_sesion_id').val());","+    }"," });"," "," /**"]}],"userModified":false,"replaceAll":false},"sourceToolAssistantUUID":"fe455c57-a850-444e-b7bb-b9b5dfc0037b"}
{"parentUuid":"a98e6350-38a8-417d-843b-61acdedfd96f","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01MjsDrVWq9kPvnVSWiogqf6","type":"message","role":"assistant","content":[{"type":"text","text":"Listo. Ahora la función se ejecuta automáticamente desde `globales.js` cuando:\n1. Existe el contenedor `#contenedor-tag-creditos` en la página\n2. Existe el input oculto `#empresa_sesion_id` con el ID de la empresa\n\nEsto hace que sea reutilizable en cualquier página que tenga ese contenedor, sin necesidad de llamar manualmente la función desde cada archivo JS específico."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":717,"cache_read_input_tokens":70423,"cache_creation":{"ephemeral_5m_input_tokens":717,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXLoFSTNKpoR3A4KJd1RZ","type":"assistant","uuid":"104f5576-2800-4fcc-922b-cfea1a76e620","timestamp":"2026-01-21T15:57:34.569Z"}
{"type":"queue-operation","operation":"dequeue","timestamp":"2026-01-21T16:33:38.734Z","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961"}
{"type":"file-history-snapshot","messageId":"1fc8f748-2ff1-426a-8f5b-bd3776cc25a9","snapshot":{"messageId":"1fc8f748-2ff1-426a-8f5b-bd3776cc25a9","trackedFileBackups":{"resources\\views\\vacantes\\paginas\\index.blade.php":{"backupFileName":"1ae59264a32091d1@v6","version":6,"backupTime":"2026-01-21T16:33:41.207Z"},"public\\js\\globales.js":{"backupFileName":"704f632e999527e6@v3","version":3,"backupTime":"2026-01-21T16:33:41.242Z"},"public\\js\\vacantes\\vacantes.js":{"backupFileName":"ca631dbb99127e3f@v3","version":3,"backupTime":"2026-01-21T16:33:41.257Z"}},"timestamp":"2026-01-21T16:33:41.194Z"},"isSnapshotUpdate":false}
{"parentUuid":"63986e1d-1fef-4d89-8849-bf0f2d54631f","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Read","command":"callback"},"toolUseID":"toolu_01BJGKFRWvfhP2fjVJ2FC7oM","parentToolUseID":"toolu_01BJGKFRWvfhP2fjVJ2FC7oM","uuid":"55654221-d598-4117-9560-528b5066a91e","timestamp":"2026-01-21T15:56:41.029Z"}
{"parentUuid":"421eed83-88ed-451c-aa77-f50b0372667b","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Edit","command":"callback"},"toolUseID":"toolu_01HoUw2kS1YkaCHqPH2ci7p9","parentToolUseID":"toolu_01HoUw2kS1YkaCHqPH2ci7p9","uuid":"ddee0e93-270f-40bd-820b-56cdadab791a","timestamp":"2026-01-21T15:56:46.377Z"}
{"parentUuid":"ddee0e93-270f-40bd-820b-56cdadab791a","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Edit","command":"callback"},"toolUseID":"toolu_01HoUw2kS1YkaCHqPH2ci7p9","parentToolUseID":"toolu_01HoUw2kS1YkaCHqPH2ci7p9","uuid":"8da314fd-5b6b-49e0-9995-f7a9564c2319","timestamp":"2026-01-21T15:56:46.377Z"}
{"parentUuid":"b485d225-871f-4de6-9502-28efe8836ac7","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"callback"},"parentToolUseID":"toolu_01HoUw2kS1YkaCHqPH2ci7p9","toolUseID":"toolu_01HoUw2kS1YkaCHqPH2ci7p9","timestamp":"2026-01-21T15:56:50.343Z","uuid":"a29bc9f1-f33e-4d78-a713-3a248f39b8b4"}
{"parentUuid":"e767d7e7-fdea-46d4-be38-0de5132235be","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Read","command":"callback"},"toolUseID":"toolu_01CKp7eosqkbyrWHteQSkPCz","parentToolUseID":"toolu_01CKp7eosqkbyrWHteQSkPCz","uuid":"2d514277-7c0c-4a87-962d-42080850d296","timestamp":"2026-01-21T15:56:56.975Z"}
{"parentUuid":"fe455c57-a850-444e-b7bb-b9b5dfc0037b","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Edit","command":"callback"},"toolUseID":"toolu_01R42a5XQWAJhmauDHG8EUi8","parentToolUseID":"toolu_01R42a5XQWAJhmauDHG8EUi8","uuid":"8de76126-53e7-4c0f-9923-1db2261d1e64","timestamp":"2026-01-21T15:57:04.343Z"}
{"parentUuid":"8de76126-53e7-4c0f-9923-1db2261d1e64","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Edit","command":"callback"},"toolUseID":"toolu_01R42a5XQWAJhmauDHG8EUi8","parentToolUseID":"toolu_01R42a5XQWAJhmauDHG8EUi8","uuid":"eb01a55d-48c0-4541-bb40-48c573164402","timestamp":"2026-01-21T15:57:04.344Z"}
{"parentUuid":"a98e6350-38a8-417d-843b-61acdedfd96f","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"callback"},"parentToolUseID":"toolu_01R42a5XQWAJhmauDHG8EUi8","toolUseID":"toolu_01R42a5XQWAJhmauDHG8EUi8","timestamp":"2026-01-21T15:57:28.735Z","uuid":"4d35b9ea-aa2e-4149-8098-938d9fe516cb"}
{"parentUuid":"104f5576-2800-4fcc-922b-cfea1a76e620","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"type":"text","text":"<ide_selection>The user selected the lines 14 to 18 from c:\\laragon\\www\\psicoalianza-2\\resources\\views\\vacantes\\paginas\\index.blade.php:\n${crearTag({\n                    texto: 'Cargando créditos...',\n                    class: 'tag-tonal-blue',\n                    icono: '<i class=\"bi bi-info-circle\"></i>'\n                })}\n\nThis may or may not be related to the current task.</ide_selection>"},{"type":"text","text":"listo aqui ${crearTag({\n                    texto: 'Cargando créditos...',\n                    class: 'tag-tonal-blue',\n                    icono: '<i class=\"bi bi-info-circle\"></i>'\n                })} estoy colocando ese icono pero quiero que el icono salga de ultimas y no de primeras"}]},"uuid":"1fc8f748-2ff1-426a-8f5b-bd3776cc25a9","timestamp":"2026-01-21T16:33:41.192Z"}
{"parentUuid":"1fc8f748-2ff1-426a-8f5b-bd3776cc25a9","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01XN4bNKY7UGFhDLWDbn9nCY","type":"message","role":"assistant","content":[{"type":"text","text":"Entiendo. Necesito revisar el componente `crearTag` para ver cómo modificar el orden del icono. Déjame buscarlo:"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":73660,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":73660,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXLr1RvLRUJJfs4moYGMu","type":"assistant","uuid":"597d7d1a-be2e-4713-bce7-0ec64b1aba96","timestamp":"2026-01-21T16:33:45.701Z"}
{"parentUuid":"597d7d1a-be2e-4713-bce7-0ec64b1aba96","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01XN4bNKY7UGFhDLWDbn9nCY","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01AuigmCUjXke6AAWWP4UcR7","name":"Glob","input":{"pattern":"**/crearTag*"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":73660,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":73660,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXLr1RvLRUJJfs4moYGMu","type":"assistant","uuid":"1b3f9e3e-d744-4a3c-a96b-37a89366cdd0","timestamp":"2026-01-21T16:33:46.646Z"}
{"parentUuid":"1b3f9e3e-d744-4a3c-a96b-37a89366cdd0","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01AuigmCUjXke6AAWWP4UcR7","type":"tool_result","content":"No files found"}]},"uuid":"8a863233-ee14-4adc-96ee-46ac1165fb78","timestamp":"2026-01-21T16:33:49.780Z","toolUseResult":{"filenames":[],"durationMs":1903,"numFiles":0,"truncated":false},"sourceToolAssistantUUID":"1b3f9e3e-d744-4a3c-a96b-37a89366cdd0"}
{"parentUuid":"8a863233-ee14-4adc-96ee-46ac1165fb78","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_018Wbt5Tk6kFuome8FhcGakM","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01QimWm1UM7N6SKeYd3vLSqB","name":"Grep","input":{"pattern":"function crearTag","output_mode":"files_with_matches"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":216,"cache_read_input_tokens":73660,"cache_creation":{"ephemeral_5m_input_tokens":216,"ephemeral_1h_input_tokens":0},"output_tokens":26,"service_tier":"standard"}},"requestId":"req_011CXLr24ktJssvoA3qsRuBB","type":"assistant","uuid":"d941bb1a-2551-4594-b4ba-643e277c3769","timestamp":"2026-01-21T16:33:53.259Z"}
{"parentUuid":"d941bb1a-2551-4594-b4ba-643e277c3769","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01QimWm1UM7N6SKeYd3vLSqB","type":"tool_result","content":"Found 4 files\npublic\\js\\vacantes\\detalles\\detalle-resultados.js\npublic\\js\\procesos\\procesos.js\npublic\\js\\ofertas-laborales\\index.js\npublic\\componentes\\componentes\\tags.js"}]},"uuid":"a1e3ac2a-333d-405e-8586-60aed9fd4aec","timestamp":"2026-01-21T16:33:55.757Z","toolUseResult":{"mode":"files_with_matches","filenames":["public\\js\\vacantes\\detalles\\detalle-resultados.js","public\\js\\procesos\\procesos.js","public\\js\\ofertas-laborales\\index.js","public\\componentes\\componentes\\tags.js"],"numFiles":4},"sourceToolAssistantUUID":"d941bb1a-2551-4594-b4ba-643e277c3769"}
{"parentUuid":"a1e3ac2a-333d-405e-8586-60aed9fd4aec","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01FboaKsAqyQtCLAnqMnQYyP","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01C8zHR3HA1eWg6wv1KRrJ4Z","name":"Read","input":{"file_path":"c:\\laragon\\www\\psicoalianza-2\\public\\componentes\\componentes\\tags.js"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":152,"cache_read_input_tokens":73876,"cache_creation":{"ephemeral_5m_input_tokens":152,"ephemeral_1h_input_tokens":0},"output_tokens":25,"service_tier":"standard"}},"requestId":"req_011CXLr2VRhaHmwC7abKvYYs","type":"assistant","uuid":"ef1c8518-fe91-4467-9e19-525c11dcfee9","timestamp":"2026-01-21T16:33:58.908Z"}
{"parentUuid":"ef1c8518-fe91-4467-9e19-525c11dcfee9","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01C8zHR3HA1eWg6wv1KRrJ4Z","type":"tool_result","content":"     1→/**\n     2→ * Función que permite crear un componente tag\n     3→ * \n     4→ * @param {Object} componente Objeto con las propiedades del componente\n     5→ * @returns {string} Código HTML del componente\n     6→ * @author José Manuel Jiménez\n     7→ */\n     8→function crearTag(componente) {\n     9→    let clase_texto = 'text-label-1';\n    10→    if (componente.class.includes('tag-sm')) {\n    11→        clase_texto = 'text-label-2';\n    12→    }\n    13→    return `\n    14→        <div class=\"tag ${componente.class ? componente.class : ''} ${clase_texto}\">\n    15→            ${componente.icono ? componente.icono : ''}\n    16→            ${componente.texto ? componente.texto : ''}\n    17→        </div>\n    18→    `;\n    19→}\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"c3f00d2e-f618-4ff5-b43b-5283fbd44a2e","timestamp":"2026-01-21T16:34:00.230Z","toolUseResult":{"type":"text","file":{"filePath":"c:\\laragon\\www\\psicoalianza-2\\public\\componentes\\componentes\\tags.js","content":"/**\n * Función que permite crear un componente tag\n * \n * @param {Object} componente Objeto con las propiedades del componente\n * @returns {string} Código HTML del componente\n * @author José Manuel Jiménez\n */\nfunction crearTag(componente) {\n    let clase_texto = 'text-label-1';\n    if (componente.class.includes('tag-sm')) {\n        clase_texto = 'text-label-2';\n    }\n    return `\n        <div class=\"tag ${componente.class ? componente.class : ''} ${clase_texto}\">\n            ${componente.icono ? componente.icono : ''}\n            ${componente.texto ? componente.texto : ''}\n        </div>\n    `;\n}","numLines":19,"startLine":1,"totalLines":19}},"sourceToolAssistantUUID":"ef1c8518-fe91-4467-9e19-525c11dcfee9"}
{"parentUuid":"c3f00d2e-f618-4ff5-b43b-5283fbd44a2e","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_012nhMXfdAXpwDTc4buFV25N","type":"message","role":"assistant","content":[{"type":"text","text":"Veo que el componente tiene el icono antes del texto. Voy a agregar una opción `icono_final` para que puedas poner el icono al final:"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":423,"cache_read_input_tokens":74028,"cache_creation":{"ephemeral_5m_input_tokens":423,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXLr2qPzX2o89zqBXyEZk","type":"assistant","uuid":"2abbf08a-0241-4730-83ab-fda252ea93cb","timestamp":"2026-01-21T16:34:04.542Z"}
{"parentUuid":"2abbf08a-0241-4730-83ab-fda252ea93cb","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_012nhMXfdAXpwDTc4buFV25N","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01SrGryztnuPu4He7a3Fa8MT","name":"Edit","input":{"replace_all":false,"file_path":"c:\\laragon\\www\\psicoalianza-2\\public\\componentes\\componentes\\tags.js","old_string":"/**\n * Función que permite crear un componente tag\n * \n * @param {Object} componente Objeto con las propiedades del componente\n * @returns {string} Código HTML del componente\n * @author José Manuel Jiménez\n */\nfunction crearTag(componente) {\n    let clase_texto = 'text-label-1';\n    if (componente.class.includes('tag-sm')) {\n        clase_texto = 'text-label-2';\n    }\n    return `\n        <div class=\"tag ${componente.class ? componente.class : ''} ${clase_texto}\">\n            ${componente.icono ? componente.icono : ''}\n            ${componente.texto ? componente.texto : ''}\n        </div>\n    `;\n}","new_string":"/**\n * Función que permite crear un componente tag\n *\n * @param {Object} componente Objeto con las propiedades del componente\n * @param {string} componente.texto Texto del tag\n * @param {string} componente.class Clases CSS del tag\n * @param {string} componente.icono Icono al inicio del tag\n * @param {string} componente.icono_final Icono al final del tag\n * @returns {string} Código HTML del componente\n * @author José Manuel Jiménez\n * @author Andres Gonzalez\n */\nfunction crearTag(componente) {\n    let clase_texto = 'text-label-1';\n    if (componente.class.includes('tag-sm')) {\n        clase_texto = 'text-label-2';\n    }\n    return `\n        <div class=\"tag ${componente.class ? componente.class : ''} ${clase_texto}\">\n            ${componente.icono ? componente.icono : ''}\n            ${componente.texto ? componente.texto : ''}\n            ${componente.icono_final ? componente.icono_final : ''}\n        </div>\n    `;\n}"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":423,"cache_read_input_tokens":74028,"cache_creation":{"ephemeral_5m_input_tokens":423,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXLr2qPzX2o89zqBXyEZk","type":"assistant","uuid":"f0af395c-487a-4741-b0fc-f16b383124cf","timestamp":"2026-01-21T16:34:09.269Z"}
{"type":"file-history-snapshot","messageId":"f0af395c-487a-4741-b0fc-f16b383124cf","snapshot":{"messageId":"1fc8f748-2ff1-426a-8f5b-bd3776cc25a9","trackedFileBackups":{"resources\\views\\vacantes\\paginas\\index.blade.php":{"backupFileName":"1ae59264a32091d1@v6","version":6,"backupTime":"2026-01-21T16:33:41.207Z"},"public\\js\\globales.js":{"backupFileName":"704f632e999527e6@v3","version":3,"backupTime":"2026-01-21T16:33:41.242Z"},"public\\js\\vacantes\\vacantes.js":{"backupFileName":"ca631dbb99127e3f@v3","version":3,"backupTime":"2026-01-21T16:33:41.257Z"},"public\\componentes\\componentes\\tags.js":{"backupFileName":"247759b31878023a@v1","version":1,"backupTime":"2026-01-21T16:38:18.566Z"}},"timestamp":"2026-01-21T16:33:41.194Z"},"isSnapshotUpdate":true}
{"parentUuid":"f0af395c-487a-4741-b0fc-f16b383124cf","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01SrGryztnuPu4He7a3Fa8MT","type":"tool_result","content":"The file c:\\laragon\\www\\psicoalianza-2\\public\\componentes\\componentes\\tags.js has been updated. Here's the result of running `cat -n` on a snippet of the edited file:\n     1→/**\n     2→ * Función que permite crear un componente tag\n     3→ *\n     4→ * @param {Object} componente Objeto con las propiedades del componente\n     5→ * @param {string} componente.texto Texto del tag\n     6→ * @param {string} componente.class Clases CSS del tag\n     7→ * @param {string} componente.icono Icono al inicio del tag\n     8→ * @param {string} componente.icono_final Icono al final del tag\n     9→ * @returns {string} Código HTML del componente\n    10→ * @author José Manuel Jiménez\n    11→ * @author Andres Gonzalez\n    12→ */\n    13→function crearTag(componente) {\n    14→    let clase_texto = 'text-label-1';\n    15→    if (componente.class.includes('tag-sm')) {\n    16→        clase_texto = 'text-label-2';\n    17→    }\n    18→    return `\n    19→        <div class=\"tag ${componente.class ? componente.class : ''} ${clase_texto}\">\n    20→            ${componente.icono ? componente.icono : ''}\n    21→            ${componente.texto ? componente.texto : ''}\n    22→            ${componente.icono_final ? componente.icono_final : ''}\n    23→        </div>\n    24→    `;\n    25→}"}]},"uuid":"1c23c652-23fd-40fc-af68-2212d370420f","timestamp":"2026-01-21T16:38:18.647Z","toolUseResult":{"filePath":"c:\\laragon\\www\\psicoalianza-2\\public\\componentes\\componentes\\tags.js","oldString":"/**\n * Función que permite crear un componente tag\n * \n * @param {Object} componente Objeto con las propiedades del componente\n * @returns {string} Código HTML del componente\n * @author José Manuel Jiménez\n */\nfunction crearTag(componente) {\n    let clase_texto = 'text-label-1';\n    if (componente.class.includes('tag-sm')) {\n        clase_texto = 'text-label-2';\n    }\n    return `\n        <div class=\"tag ${componente.class ? componente.class : ''} ${clase_texto}\">\n            ${componente.icono ? componente.icono : ''}\n            ${componente.texto ? componente.texto : ''}\n        </div>\n    `;\n}","newString":"/**\n * Función que permite crear un componente tag\n *\n * @param {Object} componente Objeto con las propiedades del componente\n * @param {string} componente.texto Texto del tag\n * @param {string} componente.class Clases CSS del tag\n * @param {string} componente.icono Icono al inicio del tag\n * @param {string} componente.icono_final Icono al final del tag\n * @returns {string} Código HTML del componente\n * @author José Manuel Jiménez\n * @author Andres Gonzalez\n */\nfunction crearTag(componente) {\n    let clase_texto = 'text-label-1';\n    if (componente.class.includes('tag-sm')) {\n        clase_texto = 'text-label-2';\n    }\n    return `\n        <div class=\"tag ${componente.class ? componente.class : ''} ${clase_texto}\">\n            ${componente.icono ? componente.icono : ''}\n            ${componente.texto ? componente.texto : ''}\n            ${componente.icono_final ? componente.icono_final : ''}\n        </div>\n    `;\n}","originalFile":"/**\n * Función que permite crear un componente tag\n * \n * @param {Object} componente Objeto con las propiedades del componente\n * @returns {string} Código HTML del componente\n * @author José Manuel Jiménez\n */\nfunction crearTag(componente) {\n    let clase_texto = 'text-label-1';\n    if (componente.class.includes('tag-sm')) {\n        clase_texto = 'text-label-2';\n    }\n    return `\n        <div class=\"tag ${componente.class ? componente.class : ''} ${clase_texto}\">\n            ${componente.icono ? componente.icono : ''}\n            ${componente.texto ? componente.texto : ''}\n        </div>\n    `;\n}","structuredPatch":[{"oldStart":1,"oldLines":9,"newStart":1,"newLines":14,"lines":[" /**","  * Función que permite crear un componente tag","- * ","+ *","  * @param {Object} componente Objeto con las propiedades del componente","+ * @param {string} componente.texto Texto del tag","+ * @param {string} componente.class Clases CSS del tag","+ * @param {string} componente.icono Icono al inicio del tag","+ * @param {string} componente.icono_final Icono al final del tag","  * @returns {string} Código HTML del componente","  * @author José Manuel Jiménez","+ * @author Andres Gonzalez","  */"," function crearTag(componente) {","     let clase_texto = 'text-label-1';"]},{"oldStart":14,"oldLines":6,"newStart":19,"newLines":7,"lines":["         <div class=\"tag ${componente.class ? componente.class : ''} ${clase_texto}\">","             ${componente.icono ? componente.icono : ''}","             ${componente.texto ? componente.texto : ''}","+            ${componente.icono_final ? componente.icono_final : ''}","         </div>","     `;"," }","\\ No newline at end of file"]}],"userModified":false,"replaceAll":false},"sourceToolAssistantUUID":"f0af395c-487a-4741-b0fc-f16b383124cf"}
{"parentUuid":"1c23c652-23fd-40fc-af68-2212d370420f","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01TtznFm5kcXwvZgYqAKk7V6","type":"message","role":"assistant","content":[{"type":"text","text":"Ahora puedes usar `icono_final` en lugar de `icono` en tu vista:\n\n```blade\n${crearTag({\n    texto: 'Cargando créditos...',\n    class: 'tag-tonal-blue',\n    icono_final: '<i class=\"bi bi-info-circle\"></i>'\n})}\n```\n\n¿Quieres que actualice también la vista y la función `obtenerCreditosDisponiblesEmpresa` en globales.js para que use `icono_final`?"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":1117,"cache_read_input_tokens":74451,"cache_creation":{"ephemeral_5m_input_tokens":1117,"ephemeral_1h_input_tokens":0},"output_tokens":4,"service_tier":"standard"}},"requestId":"req_011CXLrN5cnbVZdgWxnFjYA8","type":"assistant","uuid":"c14a423a-f615-40e6-aa53-4f90236a42c5","timestamp":"2026-01-21T16:38:25.666Z"}
{"type":"queue-operation","operation":"dequeue","timestamp":"2026-01-21T16:39:56.281Z","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961"}
{"type":"file-history-snapshot","messageId":"4572b85f-d0e7-47b5-b639-6988f91f3f40","snapshot":{"messageId":"4572b85f-d0e7-47b5-b639-6988f91f3f40","trackedFileBackups":{"resources\\views\\vacantes\\paginas\\index.blade.php":{"backupFileName":"1ae59264a32091d1@v7","version":7,"backupTime":"2026-01-21T16:39:57.907Z"},"public\\js\\globales.js":{"backupFileName":"704f632e999527e6@v3","version":3,"backupTime":"2026-01-21T16:33:41.242Z"},"public\\js\\vacantes\\vacantes.js":{"backupFileName":"ca631dbb99127e3f@v3","version":3,"backupTime":"2026-01-21T16:33:41.257Z"},"public\\componentes\\componentes\\tags.js":{"backupFileName":"247759b31878023a@v2","version":2,"backupTime":"2026-01-21T16:39:57.931Z"}},"timestamp":"2026-01-21T16:39:57.893Z"},"isSnapshotUpdate":false}
{"parentUuid":"ef1c8518-fe91-4467-9e19-525c11dcfee9","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Read","command":"callback"},"toolUseID":"toolu_01C8zHR3HA1eWg6wv1KRrJ4Z","parentToolUseID":"toolu_01C8zHR3HA1eWg6wv1KRrJ4Z","uuid":"29b764d0-f8f4-4a25-ab02-4997a66de427","timestamp":"2026-01-21T16:33:59.117Z"}
{"parentUuid":"f0af395c-487a-4741-b0fc-f16b383124cf","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Edit","command":"callback"},"toolUseID":"toolu_01SrGryztnuPu4He7a3Fa8MT","parentToolUseID":"toolu_01SrGryztnuPu4He7a3Fa8MT","uuid":"00761dc2-3345-4d9c-ab2c-8a2e86ee5ea5","timestamp":"2026-01-21T16:34:09.498Z"}
{"parentUuid":"00761dc2-3345-4d9c-ab2c-8a2e86ee5ea5","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Edit","command":"callback"},"toolUseID":"toolu_01SrGryztnuPu4He7a3Fa8MT","parentToolUseID":"toolu_01SrGryztnuPu4He7a3Fa8MT","uuid":"0d3ddd1f-e5f0-43f9-ac13-3bca1419d846","timestamp":"2026-01-21T16:34:09.499Z"}
{"parentUuid":"1c23c652-23fd-40fc-af68-2212d370420f","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"callback"},"parentToolUseID":"toolu_01SrGryztnuPu4He7a3Fa8MT","toolUseID":"toolu_01SrGryztnuPu4He7a3Fa8MT","timestamp":"2026-01-21T16:38:18.648Z","uuid":"b823f488-a01c-4bce-a654-6583bc83e985"}
{"parentUuid":"c14a423a-f615-40e6-aa53-4f90236a42c5","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"type":"text","text":"<ide_selection>The user selected the lines 18 to 18 from c:\\laragon\\www\\psicoalianza-2\\public\\componentes\\componentes\\tags.js:\nicono_final\n\nThis may or may not be related to the current task.</ide_selection>"},{"type":"text","text":"y ese ajute no afecta el funcionaiento normal d ela funcion?"}]},"uuid":"4572b85f-d0e7-47b5-b639-6988f91f3f40","timestamp":"2026-01-21T16:39:57.890Z"}
{"parentUuid":"4572b85f-d0e7-47b5-b639-6988f91f3f40","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_0178cGJJVEZyEJW6keEbEkyH","type":"message","role":"assistant","content":[{"type":"text","text":"No, el ajuste no afecta el funcionamiento normal de la función. \n\nLa línea que agregué:\n```javascript\n${componente.icono_final ? componente.icono_final : ''}\n```\n\nSolo renderiza algo si pasas el parámetro `icono_final`. Si no lo pasas, simplemente agrega una cadena vacía `''`, que no afecta el HTML resultante.\n\nPor ejemplo:\n\n**Uso anterior (sigue funcionando igual):**\n```javascript\ncrearTag({\n    texto: 'Mi tag',\n    class: 'tag-tonal-blue',\n    icono: '<i class=\"bi bi-person\"></i>'\n})\n// Resultado: icono + texto\n```\n\n**Uso con icono al final (nuevo):**\n```javascript\ncrearTag({\n    texto: 'Mi tag',\n    class: 'tag-tonal-blue',\n    icono_final: '<i class=\"bi bi-info-circle\"></i>'\n})\n// Resultado: texto + icono\n```\n\n**Uso sin iconos (sigue funcionando igual):**\n```javascript\ncrearTag({\n    texto: 'Mi tag',\n    class: 'tag-tonal-gray'\n})\n// Resultado: solo texto\n```\n\nEs retrocompatible con todos los usos existentes."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":2818,"cache_read_input_tokens":75568,"cache_creation":{"ephemeral_5m_input_tokens":2818,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard"}},"requestId":"req_011CXLrVCKoensk8PyJaaaNF","type":"assistant","uuid":"8628ad32-929e-439e-baeb-b82303f0e326","timestamp":"2026-01-21T16:40:05.298Z"}
{"type":"queue-operation","operation":"dequeue","timestamp":"2026-01-21T16:46:07.149Z","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961"}
{"type":"file-history-snapshot","messageId":"7e1c3d4e-ffd3-4612-9f32-2a9b33d5ee62","snapshot":{"messageId":"7e1c3d4e-ffd3-4612-9f32-2a9b33d5ee62","trackedFileBackups":{"resources\\views\\vacantes\\paginas\\index.blade.php":{"backupFileName":"1ae59264a32091d1@v8","version":8,"backupTime":"2026-01-21T16:46:08.963Z"},"public\\js\\globales.js":{"backupFileName":"704f632e999527e6@v3","version":3,"backupTime":"2026-01-21T16:33:41.242Z"},"public\\js\\vacantes\\vacantes.js":{"backupFileName":"ca631dbb99127e3f@v3","version":3,"backupTime":"2026-01-21T16:33:41.257Z"},"public\\componentes\\componentes\\tags.js":{"backupFileName":"247759b31878023a@v2","version":2,"backupTime":"2026-01-21T16:39:57.931Z"}},"timestamp":"2026-01-21T16:46:08.935Z"},"isSnapshotUpdate":false}
{"parentUuid":"8628ad32-929e-439e-baeb-b82303f0e326","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"type":"text","text":"<ide_selection>The user selected the lines 11 to 24 from c:\\laragon\\www\\psicoalianza-2\\resources\\views\\vacantes\\paginas\\index.blade.php:\ncabecera: `\n            <div class=\"col-auto text-headline-2 text-gray-30 fw-bold\">Producto selección</div>\n            <div class=\"col-auto ps-2 pe-0 my-auto\" id=\"contenedor-tag-creditos\">\n                ${crearTag({\n                    texto: 'Cargando créditos...',\n                    class: 'tag-tonal-blue',\n                    icono_final: '<i class=\"bi bi-info-circle\" role=\"button\" tabindex=\"0\"\n                                    ${crearTooltip({\n                                        placement: 'top',\n                                        content: 'Menciona los programas, plataformas o lenguajes que utilizas con frecuencia.'\n                                    })}>\n                                </i>'\n                })}\n            </div>\n\nThis may or may not be related to the current task.</ide_selection>"},{"type":"text","text":"listo entonces ese icono que apresca con el de credoitos bajos el amrillo  y el sin creditos pero que paresca con ese toast cabecera: `\n            <div class=\"col-auto text-headline-2 text-gray-30 fw-bold\">Producto selección</div>\n            <div class=\"col-auto ps-2 pe-0 my-auto\" id=\"contenedor-tag-creditos\">\n                ${crearTag({\n                    texto: 'Cargando créditos...',\n                    class: 'tag-tonal-blue',\n                    icono_final: '<i class=\"bi bi-info-circle\" role=\"button\" tabindex=\"0\"\n                                    ${crearTooltip({\n                                        placement: 'top',\n                                        content: 'Menciona los programas, plataformas o lenguajes que utilizas con frecuencia.'\n                                    })}>\n                                </i>'\n                })}\n            </div>"}]},"uuid":"7e1c3d4e-ffd3-4612-9f32-2a9b33d5ee62","timestamp":"2026-01-21T16:46:08.930Z"}
{"parentUuid":"7e1c3d4e-ffd3-4612-9f32-2a9b33d5ee62","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01VeykqXM8mii283ZGfcPXne","type":"message","role":"assistant","content":[{"type":"text","text":"Entendido. Voy a actualizar la función `obtenerCreditosDisponiblesEmpresa` en `globales.js` para que muestre el icono con tooltip solo cuando los créditos estén bajos (amarillo) o sin créditos (gris)."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":81910,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":81910,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXLrxYcwiuVMDriK3VieA","type":"assistant","uuid":"dbfa1680-864c-4812-8d3d-24ab61ba80ad","timestamp":"2026-01-21T16:46:12.964Z"}
{"parentUuid":"dbfa1680-864c-4812-8d3d-24ab61ba80ad","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01VeykqXM8mii283ZGfcPXne","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01DZ6foFT64AK8jC1BxKjvgV","name":"Read","input":{"file_path":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\globales.js","offset":1395,"limit":60}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":81910,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":81910,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXLrxYcwiuVMDriK3VieA","type":"assistant","uuid":"12d87223-8ec3-47b8-ad9c-3d9c0f17dccd","timestamp":"2026-01-21T16:46:13.744Z"}
{"parentUuid":"12d87223-8ec3-47b8-ad9c-3d9c0f17dccd","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01DZ6foFT64AK8jC1BxKjvgV","type":"tool_result","content":"  1395→        // Si ambos tienen fecha_fin, ordenar por fecha más reciente primero (descendente)\n  1396→        return moment(b.fecha_fin).diff(moment(a.fecha_fin));\n  1397→    });\n  1398→\n  1399→    return experiencias_ordenadas;\n  1400→}\n  1401→\n  1402→/**\n  1403→ * Obtener créditos disponibles de la empresa y actualizar el tag.\n  1404→ * - Si tiene créditos >= 20% del plan: tag azul\n  1405→ * - Si tiene créditos < 20% del plan: tag amarillo\n  1406→ * - Si no tiene créditos: tag gris \"Sin créditos\"\n  1407→ *\n  1408→ * @param {number} empresa_id ID de la empresa\n  1409→ * @param {string} contenedor_id ID del contenedor donde se mostrará el tag\n  1410→ * @returns {void}\n  1411→ * @author Andres Gonzalez\n  1412→ */\n  1413→function obtenerCreditosDisponiblesEmpresa(empresa_id, contenedor_id = 'contenedor-tag-creditos') {\n  1414→    if (!empresa_id || !$(`#${contenedor_id}`).length) {\n  1415→        return;\n  1416→    }\n  1417→\n  1418→    $.ajax({\n  1419→        url: `/api/empresas/${empresa_id}/creditos`,\n  1420→        method: 'GET',\n  1421→        dataType: 'json',\n  1422→        success: function(respuesta) {\n  1423→            let creditos_disponibles = respuesta?.data?.creditos_disponibles ?? 0;\n  1424→            let creditos_plan = respuesta?.data?.creditos_plan ?? 0;\n  1425→            let porcentaje_disponible = creditos_plan > 0 ? (creditos_disponibles / creditos_plan) * 100 : 0;\n  1426→\n  1427→            let texto_tag = '';\n  1428→            let clase_tag = '';\n  1429→\n  1430→            if (creditos_disponibles <= 0) {\n  1431→                texto_tag = 'Sin créditos';\n  1432→                clase_tag = 'tag-tonal-gray';\n  1433→            } else if (porcentaje_disponible < 20) {\n  1434→                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n  1435→                clase_tag = 'tag-filled-yellow';\n  1436→            } else {\n  1437→                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n  1438→                clase_tag = 'tag-tonal-blue';\n  1439→            }\n  1440→\n  1441→            $(`#${contenedor_id}`).html(crearTag({\n  1442→                texto: texto_tag,\n  1443→                class: clase_tag,\n  1444→            }));\n  1445→        },\n  1446→        error: function() {\n  1447→            $(`#${contenedor_id}`).html(crearTag({\n  1448→                texto: 'Error al cargar créditos',\n  1449→                class: 'tag-tonal-gray',\n  1450→            }));\n  1451→        }\n  1452→    });\n  1453→}\n  1454→\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"1f3e735a-4951-4fb0-bd19-be2452c1b966","timestamp":"2026-01-21T16:46:15.057Z","toolUseResult":{"type":"text","file":{"filePath":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\globales.js","content":"        // Si ambos tienen fecha_fin, ordenar por fecha más reciente primero (descendente)\n        return moment(b.fecha_fin).diff(moment(a.fecha_fin));\n    });\n\n    return experiencias_ordenadas;\n}\n\n/**\n * Obtener créditos disponibles de la empresa y actualizar el tag.\n * - Si tiene créditos >= 20% del plan: tag azul\n * - Si tiene créditos < 20% del plan: tag amarillo\n * - Si no tiene créditos: tag gris \"Sin créditos\"\n *\n * @param {number} empresa_id ID de la empresa\n * @param {string} contenedor_id ID del contenedor donde se mostrará el tag\n * @returns {void}\n * @author Andres Gonzalez\n */\nfunction obtenerCreditosDisponiblesEmpresa(empresa_id, contenedor_id = 'contenedor-tag-creditos') {\n    if (!empresa_id || !$(`#${contenedor_id}`).length) {\n        return;\n    }\n\n    $.ajax({\n        url: `/api/empresas/${empresa_id}/creditos`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            let creditos_disponibles = respuesta?.data?.creditos_disponibles ?? 0;\n            let creditos_plan = respuesta?.data?.creditos_plan ?? 0;\n            let porcentaje_disponible = creditos_plan > 0 ? (creditos_disponibles / creditos_plan) * 100 : 0;\n\n            let texto_tag = '';\n            let clase_tag = '';\n\n            if (creditos_disponibles <= 0) {\n                texto_tag = 'Sin créditos';\n                clase_tag = 'tag-tonal-gray';\n            } else if (porcentaje_disponible < 20) {\n                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                clase_tag = 'tag-filled-yellow';\n            } else {\n                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                clase_tag = 'tag-tonal-blue';\n            }\n\n            $(`#${contenedor_id}`).html(crearTag({\n                texto: texto_tag,\n                class: clase_tag,\n            }));\n        },\n        error: function() {\n            $(`#${contenedor_id}`).html(crearTag({\n                texto: 'Error al cargar créditos',\n                class: 'tag-tonal-gray',\n            }));\n        }\n    });\n}\n","numLines":60,"startLine":1395,"totalLines":1454}},"sourceToolAssistantUUID":"12d87223-8ec3-47b8-ad9c-3d9c0f17dccd"}
{"parentUuid":"1f3e735a-4951-4fb0-bd19-be2452c1b966","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_013E1nU9HLGFjNTBG75AA8uY","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_015V7kcjnon6avTMjNuzrckH","name":"Edit","input":{"replace_all":false,"file_path":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\globales.js","old_string":"function obtenerCreditosDisponiblesEmpresa(empresa_id, contenedor_id = 'contenedor-tag-creditos') {\n    if (!empresa_id || !$(`#${contenedor_id}`).length) {\n        return;\n    }\n\n    $.ajax({\n        url: `/api/empresas/${empresa_id}/creditos`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            let creditos_disponibles = respuesta?.data?.creditos_disponibles ?? 0;\n            let creditos_plan = respuesta?.data?.creditos_plan ?? 0;\n            let porcentaje_disponible = creditos_plan > 0 ? (creditos_disponibles / creditos_plan) * 100 : 0;\n\n            let texto_tag = '';\n            let clase_tag = '';\n\n            if (creditos_disponibles <= 0) {\n                texto_tag = 'Sin créditos';\n                clase_tag = 'tag-tonal-gray';\n            } else if (porcentaje_disponible < 20) {\n                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                clase_tag = 'tag-filled-yellow';\n            } else {\n                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                clase_tag = 'tag-tonal-blue';\n            }\n\n            $(`#${contenedor_id}`).html(crearTag({\n                texto: texto_tag,\n                class: clase_tag,\n            }));\n        },\n        error: function() {\n            $(`#${contenedor_id}`).html(crearTag({\n                texto: 'Error al cargar créditos',\n                class: 'tag-tonal-gray',\n            }));\n        }\n    });\n}","new_string":"function obtenerCreditosDisponiblesEmpresa(empresa_id, contenedor_id = 'contenedor-tag-creditos') {\n    if (!empresa_id || !$(`#${contenedor_id}`).length) {\n        return;\n    }\n\n    $.ajax({\n        url: `/api/empresas/${empresa_id}/creditos`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            let creditos_disponibles = respuesta?.data?.creditos_disponibles ?? 0;\n            let creditos_plan = respuesta?.data?.creditos_plan ?? 0;\n            let porcentaje_disponible = creditos_plan > 0 ? (creditos_disponibles / creditos_plan) * 100 : 0;\n\n            let texto_tag = '';\n            let clase_tag = '';\n            let icono_final = '';\n            let mensaje_tooltip = 'Comunícate con tu ejecutivo para adquirir más créditos.';\n\n            if (creditos_disponibles <= 0) {\n                texto_tag = 'Sin créditos';\n                clase_tag = 'tag-tonal-gray';\n                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'top', content: mensaje_tooltip })}></i>`;\n            } else if (porcentaje_disponible < 20) {\n                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                clase_tag = 'tag-filled-yellow';\n                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'top', content: mensaje_tooltip })}></i>`;\n            } else {\n                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                clase_tag = 'tag-tonal-blue';\n            }\n\n            $(`#${contenedor_id}`).html(crearTag({\n                texto: texto_tag,\n                class: clase_tag,\n                icono_final: icono_final,\n            }));\n        },\n        error: function() {\n            $(`#${contenedor_id}`).html(crearTag({\n                texto: 'Error al cargar créditos',\n                class: 'tag-tonal-gray',\n            }));\n        }\n    });\n}"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":1187,"cache_read_input_tokens":81910,"cache_creation":{"ephemeral_5m_input_tokens":1187,"ephemeral_1h_input_tokens":0},"output_tokens":25,"service_tier":"standard"}},"requestId":"req_011CXLry13gJ1wypKYS3NDQq","type":"assistant","uuid":"8167d419-0eca-4548-9451-677f829035b6","timestamp":"2026-01-21T16:46:27.097Z"}
{"parentUuid":"8167d419-0eca-4548-9451-677f829035b6","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_015V7kcjnon6avTMjNuzrckH","type":"tool_result","content":"The file c:\\laragon\\www\\psicoalianza-2\\public\\js\\globales.js has been updated. Here's the result of running `cat -n` on a snippet of the edited file:\n  1409→ * @param {string} contenedor_id ID del contenedor donde se mostrará el tag\n  1410→ * @returns {void}\n  1411→ * @author Andres Gonzalez\n  1412→ */\n  1413→function obtenerCreditosDisponiblesEmpresa(empresa_id, contenedor_id = 'contenedor-tag-creditos') {\n  1414→    if (!empresa_id || !$(`#${contenedor_id}`).length) {\n  1415→        return;\n  1416→    }\n  1417→\n  1418→    $.ajax({\n  1419→        url: `/api/empresas/${empresa_id}/creditos`,\n  1420→        method: 'GET',\n  1421→        dataType: 'json',\n  1422→        success: function(respuesta) {\n  1423→            let creditos_disponibles = respuesta?.data?.creditos_disponibles ?? 0;\n  1424→            let creditos_plan = respuesta?.data?.creditos_plan ?? 0;\n  1425→            let porcentaje_disponible = creditos_plan > 0 ? (creditos_disponibles / creditos_plan) * 100 : 0;\n  1426→\n  1427→            let texto_tag = '';\n  1428→            let clase_tag = '';\n  1429→            let icono_final = '';\n  1430→            let mensaje_tooltip = 'Comunícate con tu ejecutivo para adquirir más créditos.';\n  1431→\n  1432→            if (creditos_disponibles <= 0) {\n  1433→                texto_tag = 'Sin créditos';\n  1434→                clase_tag = 'tag-tonal-gray';\n  1435→                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'top', content: mensaje_tooltip })}></i>`;\n  1436→            } else if (porcentaje_disponible < 20) {\n  1437→                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n  1438→                clase_tag = 'tag-filled-yellow';\n  1439→                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'top', content: mensaje_tooltip })}></i>`;\n  1440→            } else {\n  1441→                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n  1442→                clase_tag = 'tag-tonal-blue';\n  1443→            }\n  1444→\n  1445→            $(`#${contenedor_id}`).html(crearTag({\n  1446→                texto: texto_tag,\n  1447→                class: clase_tag,\n  1448→                icono_final: icono_final,\n  1449→            }));\n  1450→        },\n  1451→        error: function() {\n  1452→            $(`#${contenedor_id}`).html(crearTag({\n  1453→                texto: 'Error al cargar créditos',\n  1454→                class: 'tag-tonal-gray',\n  1455→            }));\n  1456→        }\n  1457→    });\n  1458→}\n  1459→"}]},"uuid":"fc9af04b-4335-464f-bd11-58e2c9711851","timestamp":"2026-01-21T16:47:20.145Z","toolUseResult":{"filePath":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\globales.js","oldString":"function obtenerCreditosDisponiblesEmpresa(empresa_id, contenedor_id = 'contenedor-tag-creditos') {\n    if (!empresa_id || !$(`#${contenedor_id}`).length) {\n        return;\n    }\n\n    $.ajax({\n        url: `/api/empresas/${empresa_id}/creditos`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            let creditos_disponibles = respuesta?.data?.creditos_disponibles ?? 0;\n            let creditos_plan = respuesta?.data?.creditos_plan ?? 0;\n            let porcentaje_disponible = creditos_plan > 0 ? (creditos_disponibles / creditos_plan) * 100 : 0;\n\n            let texto_tag = '';\n            let clase_tag = '';\n\n            if (creditos_disponibles <= 0) {\n                texto_tag = 'Sin créditos';\n                clase_tag = 'tag-tonal-gray';\n            } else if (porcentaje_disponible < 20) {\n                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                clase_tag = 'tag-filled-yellow';\n            } else {\n                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                clase_tag = 'tag-tonal-blue';\n            }\n\n            $(`#${contenedor_id}`).html(crearTag({\n                texto: texto_tag,\n                class: clase_tag,\n            }));\n        },\n        error: function() {\n            $(`#${contenedor_id}`).html(crearTag({\n                texto: 'Error al cargar créditos',\n                class: 'tag-tonal-gray',\n            }));\n        }\n    });\n}","newString":"function obtenerCreditosDisponiblesEmpresa(empresa_id, contenedor_id = 'contenedor-tag-creditos') {\n    if (!empresa_id || !$(`#${contenedor_id}`).length) {\n        return;\n    }\n\n    $.ajax({\n        url: `/api/empresas/${empresa_id}/creditos`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            let creditos_disponibles = respuesta?.data?.creditos_disponibles ?? 0;\n            let creditos_plan = respuesta?.data?.creditos_plan ?? 0;\n            let porcentaje_disponible = creditos_plan > 0 ? (creditos_disponibles / creditos_plan) * 100 : 0;\n\n            let texto_tag = '';\n            let clase_tag = '';\n            let icono_final = '';\n            let mensaje_tooltip = 'Comunícate con tu ejecutivo para adquirir más créditos.';\n\n            if (creditos_disponibles <= 0) {\n                texto_tag = 'Sin créditos';\n                clase_tag = 'tag-tonal-gray';\n                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'top', content: mensaje_tooltip })}></i>`;\n            } else if (porcentaje_disponible < 20) {\n                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                clase_tag = 'tag-filled-yellow';\n                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'top', content: mensaje_tooltip })}></i>`;\n            } else {\n                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                clase_tag = 'tag-tonal-blue';\n            }\n\n            $(`#${contenedor_id}`).html(crearTag({\n                texto: texto_tag,\n                class: clase_tag,\n                icono_final: icono_final,\n            }));\n        },\n        error: function() {\n            $(`#${contenedor_id}`).html(crearTag({\n                texto: 'Error al cargar créditos',\n                class: 'tag-tonal-gray',\n            }));\n        }\n    });\n}","originalFile":"// Mensajes en español para el plugin Select2\nconst mensajes_select2 = {\n    'noResults'              : () => { return 'No hay resultados para la búsqueda.'; },\n    'searching'              : () => { return 'Buscando...'; },\n    'Loading'                : () => { return 'Cargando...'; },\n    'loadingMore'            : () => { return 'Cargando más resultados...'; },\n    'dropdownFooter'         : (texto) => { return `Mostrando ${texto} resultados`; },\n    'emptyOptions'           : () => { return 'No hay opciones disponibles.'; },\n    'appendItems'            : (items) => { return `Agregando ${items.length} elementos.`; },\n    'maximumSelectionReached': () => { return 'Se ha alcanzado el número máximo de selecciones.'; },\n    'selectOnClose'          : () => { return 'Seleccione una opción al cerrar el menú.'; },\n    'escapeKeyUp'            : () => { return 'Presione \\'Escape\\' para cerrar el menú.'; },\n    'errorLoading'           : () => { return 'Error al cargar datos. Inténtalo de nuevo más tarde.'; },\n    'inputTooShort'          : (elemento) => { return `Ingresa al menos ${elemento.minimum} caracteres para iniciar una búsqueda.`; },\n    'noMatches'              : () => { return 'No se encontraron coincidencias para tu búsqueda.'; },\n    'allowClear'             : () => { return 'Borrar selección'; },\n    'SelectionTooLong'       : (conteo, maximo) => { return `Solo puedes seleccionar ${maximo} opciones.`; },\n    'loadMore'               : () => { return 'Cargando más resultados...'; },\n    'removing'               : (seleccion) => { return 'Eliminando...'; },\n    'matches'                : (coincidencias, total) => {\n        if (coincidencias === 0) {\n            return 'No hay coincidencias.';\n        } else if (coincidencias === 1) {\n            return 'Se encontró 1 coincidencia.';\n        } else {\n            return `Se encontraron ${coincidencias} coincidencias entre ${total}.`;\n        }\n    }\n};\n\n// audios\nvar audio_notificacion = new Audio('/audios/notificacion.mp3');\n\nlet mostro_modal_creditos_ia = false;\nlet funcion_ejecucion_ia = null;\nlet modals_abiertos_ia = null;\n\n/**\n * Mostrar modal de créditos IA\n * \n * @return void\n * @author José Manuel Jiménez\n */\nfunction mostrarModalCreditosIA(servicio_ia_id) {\n    $.ajax({\n        url: `/api/empresas/${$('#empresa_sesion_id').val()}/creditos`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta_empresa) {\n            if (respuesta_empresa?.data?.creditos_disponibles > 0) {\n                $.ajax({\n                    url: `/api/servicios-ia/${servicio_ia_id}/creditos`,\n                    method: 'GET',\n                    dataType: 'json',\n                    success: function(respuesta) {\n                        if (respuesta?.data?.consume_creditos && respuesta?.data?.consume_creditos <= respuesta_empresa.data.creditos_disponibles) {\n                            $('#cantidad-creditos-descontar-modal').text(respuesta.data.consume_creditos);\n                            $('#modal-consumo-creditos-ia').modal('show');\n                            mostro_modal_creditos_ia = true;\n                            modals_abiertos_ia = $('.modal.show').not('#modal-consumo-creditos-ia').not('#modal-generando-ia');\n                            $(modals_abiertos_ia).addClass('d-none');\n                        } else {\n                            mostrarToastSolicitarCreditosIA();\n                        }\n                    }\n                });\n            } else {\n                mostrarToastSolicitarCreditosIA();\n            }\n        }\n    });\n}\n\n/**\n * Mostrar toast para solicitar créditos IA\n * \n * @return void\n * @author José Manuel Jiménez\n */\nfunction mostrarToastSolicitarCreditosIA() {\n    $.ajax({\n        url: `/empresas/${$('#empresa_sesion_id').val()}`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            let adicional_toast = '';\n            if (respuesta?.data?.ejecutivo?.telefono) {\n                adicional_toast = `<a href=\"https://wa.me/${respuesta.data.ejecutivo.telefono.replace(/\\D/g, '')}?text=Hola,%20me%20gustar%C3%ADa%20solicitar%20cr%C3%A9ditos%20adicionales%20para%20mi%20empresa.\" target=\"_blank\">\n                    <p class=\"text-label-1 text-white no-visited text-decoration-none mb-0\">Solicitar</p>\n                </a>`;\n            }\n            setTimeout(() => {\n                $('#modal-generando-ia').modal('hide');\n                $('#modal-cargue-ia').modal('hide');\n                mostrarToast('danger', 'No cuentas con créditos. Solicita créditos adicionales.', '', adicional_toast);\n            }, 300);\n        }\n    });\n}\n\n/**\n * Continuar ejecución IA luego del modal de créditos\n * \n * @return void\n * @author José Manuel Jiménez\n */\nfunction continuarEjecucionIA() {\n    if (funcion_ejecucion_ia) {\n        funcion_ejecucion_ia();\n        funcion_ejecucion_ia = null;\n    }\n    mostro_modal_creditos_ia = false;\n    $('#modal-consumo-creditos-ia').modal('hide');\n}\n\n/**\n * Solicitar más créditos IA\n * \n * @return void\n * @author José Manuel Jiménez\n */\nfunction solicitarMasCreditosIA() {\n    $.ajax({\n        url: `/empresas/${$('#empresa_sesion_id').val()}`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            if (respuesta?.data?.ejecutivo?.telefono) {\n                window.open(`https://wa.me/${respuesta.data.ejecutivo.telefono.replace(/\\D/g, '')}?text=Hola,%20me%20gustar%C3%ADa%20solicitar%20cr%C3%A9ditos%20adicionales%20para%20mi%20empresa.`, '_blank');\n            } else {\n                mostrarToast('danger', 'No se encontró un ejecutivo asignado a la empresa. Por favor, comunícate con soporte para recargar créditos.');\n            }\n            $('#modal-solicitar-mas-creditos-ia').modal('hide');\n        }\n    });\n}\n\n/**\n * Validar respuesta de créditos IA\n * \n * @return void\n * @author José Manuel Jiménez\n */\nfunction validarRespuestaCreditosIA(error_ia) {\n    if (error_ia == 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.') {\n        mostrarToastSolicitarCreditosIA();\n        return true;\n    }\n    return false;\n}\n\n/**\n * Ajustar el ancho de los elementos select2 asincrono multiple.\n *\n * @returns {void}\n * @author Andres Morales\n */\n$(document).ready(function () {\n    cargarNotificiacionesHeader();\n    if (window.configuracion_reverbg && window.configuracion_reverbg.activar_websocket) {\n        configurarWebSocketNotificaciones();\n    }\n    setTimeout(() => {\n        $(\".input-container\").each(function () {\n            let $container = $(this);\n            let $select = $container.find(\"select[multiple]\");\n            let $icon = $container.find(\".input-icono1\");\n            if ($select.length && $icon.length) {\n                $(this).find('.select2-selection--multiple').addClass('ps-5')\n            }\n        });\n    }, 1000);\n    $('#modal-consumo-creditos-ia').on('hidden.bs.modal', function () {\n        if (mostro_modal_creditos_ia) {\n            $(modals_abiertos_ia).removeClass('d-none');\n        }\n        mostro_modal_creditos_ia = false;\n    });\n\n    // Cargar créditos disponibles si existe el contenedor y el ID de empresa\n    if ($('#contenedor-tag-creditos').length && $('#empresa_sesion_id').length) {\n        obtenerCreditosDisponiblesEmpresa($('#empresa_sesion_id').val());\n    }\n});\n\n/**\n * Formatear fecha a formato dd/mm/yyyy - hh:mm AM/PM.  Ejemplo: 01/Feb/2022 - 12:00 PM\n *\n * @param {string} fecha_entrada fecha en formato ISO\n * @returns {string} fecha y hora formateada\n * @author Andres Morales\n */\nfunction formatearFecha(fecha_entrada) {\n    var fecha = new Date(fecha_entrada);\n    var dia = fecha.getDate();\n    var mes = fecha.toLocaleString('es-ES', { month: 'short' });\n    var anio = fecha.getFullYear();\n    let hora = fecha.getHours();\n    let minuto = fecha.getMinutes();\n    let ampm = hora >= 12 ? 'PM' : 'AM';\n    hora = hora % 12 || 12;\n    minuto = minuto.toString().padStart(2, '0');\n    return `${dia}/${mes}/${anio} - ${hora}:${minuto} ${ampm}`;\n}\n\nfunction formatearFecha2(fecha_entrada) {\n    let partes = fecha_entrada.split(' ');\n    let fecha = partes[0].split('-');\n    let hora = partes[1];\n    let fechaISO = `${fecha[2]}-${fecha[1]}-${fecha[0]}T${hora}`;\n\n    let date = new Date(fechaISO);\n\n    if (isNaN(date.getTime())) {\n        return 'Fecha inválida';\n    }\n\n    let dia = date.getDate();\n    let mes = date.toLocaleString('eu-EU', { month: 'short' });\n    let anio = date.getFullYear();\n    return `${dia}/${mes}/${anio}`;\n}\n\n/**\n * Opción para contraer o agrandar el menú principal\n *\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Andres Morales\n */\nfunction contraerMenu() {\n    if ($('.sidebar-menu').hasClass('close')) {\n        $('.sidebar-menu').removeClass('d-none');\n        localStorage.setItem('opcion_menu_storage', 'abierto');\n        $('#btn-collapse').attr('data-bs-original-title', 'Contraer');\n        $('#btn-collapse').attr('data-bs-title', 'Contraer');\n        $(\".menu-bar\").each(function() {\n            $(this).removeClass(\"px-2\").addClass(\"px-5\");\n        });\n        $('[data-bs-toggle=\"tooltip\"]').each(function () { new bootstrap.Tooltip(this); });\n        $('.lista-primary[data-bs-toggle=\"tooltip\"]').each(function () {\n            var tooltip_instancia = bootstrap.Tooltip.getInstance(this);\n            if (tooltip_instancia) {\n                tooltip_instancia.dispose();\n            }\n        });\n    } else {\n        $('.sidebar-menu').addClass('d-none');\n        localStorage.setItem('opcion_menu_storage', 'cerrado');\n        $('#btn-collapse').attr('data-bs-original-title', 'Expandir');\n        $('#btn-collapse').attr('data-bs-title', 'Expandir');\n        $(\".menu-bar\").each(function() {\n            $(this).removeClass(\"px-5\").addClass(\"px-2\");\n        });\n        $('[data-bs-toggle=\"tooltip\"]').each(function () { new bootstrap.Tooltip(this); });\n    }\n    $('.tooltip.bs-tooltip-auto').remove();\n    $('.sidebar-menu').toggleClass('close');\n    $('.contenedor-vista').toggleClass('close');\n    $('#btn-collapse').toggleClass('close');\n    $('.nombre-usuario-empresa').toggle();\n    $('.menu-bar .text-menu').toggle();\n}\n\n/**\n * Opción para abrir o cerrar el menu segun la elección guardada\n *\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Andres Morales\n */\nfunction mostrarMenuStorage() {\n    $(document).ready(function() {\n        $('.lista-primary[data-bs-toggle=\"tooltip\"]').each(function () {\n            var tooltip_instancia = bootstrap.Tooltip.getInstance(this);\n            if (tooltip_instancia) {\n                tooltip_instancia.dispose();\n            }\n        });\n\n        if (window.innerWidth < 768) {\n            localStorage.setItem('opcion_menu_storage', 'cerrado');\n        }\n\n        if (localStorage.getItem('opcion_menu_storage') === 'cerrado') {\n            contraerMenu();\n        }\n        let $active = $('.menu-bar .active');\n\n        if ($active.length) {\n            $('.menu-bar').scrollTop($active.position().top);\n        }\n    });\n}\nmostrarMenuStorage();\n\n/**\n * Funcion para hacer el slug de un texto desde jquery.\n *\n * @returns {void}\n * @author Andres Morales\n */\nfunction slugify(text) {\n    return $.trim(text)\n        .toLowerCase()\n        .normalize(\"NFD\")\n        .replace(/[\\u0300-\\u036f]/g, \"\")\n        .replace(/[^a-z0-9 -]/g, \"\")\n        .replace(/\\s+/g, \"-\")\n        .replace(/-+/g, \"-\");\n}\n\n/**\n * Función generica para mostrar mensajes de respuesta\n *\n * @param {string} tipo_alerta define el color de la alerta segun alerts de botstrap.\n * @param {string} texto_1 Texto que mostrara la alerta.\n * @param {string} texto_2 Texto secundario en la alerta.\n * @param {string} accion Acción adicional(por definir).\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Andres Gonzalez\n */\nfunction mostrarToast(tipo_alerta, texto_1, texto_2 = '', accion = '', icono2 = '') {\n    let icono = '';\n    let texto_color = 'text-white';\n    if (accion != '') {\n        accion = `<div class=\"col-auto p-0 text-label-1\">${accion}</div>`;\n    }\n\n    if (tipo_alerta == 'success') {\n        icono = 'bi bi-check-circle';\n    }\n\n    if (tipo_alerta == 'neutral') {\n        icono = 'bi bi-info-circle';\n    }\n\n    if (tipo_alerta == 'warning') {\n        icono = 'bi bi-info-circle';\n        texto_color = \"text-red-letras\";\n    }\n\n    if (tipo_alerta == 'danger') {\n        icono = 'bi bi-x-circle';\n    }\n\n    if (icono2 != '') {\n        icono = icono2;\n    }\n\n    if (texto_2 != '') {\n        texto_2 = `<div class=\"col-12 p-0 text-label-1 ${texto_color}\">${texto_2}</div>`;\n    }\n\n    let alert_toast = $(`\n        <div class=\"alert toast-${tipo_alerta} alert-dismissible fade show d-flex align-items-center pe-3 py-3 me-3\" role=\"alert\" style=\"display:none\">\n            <div class=\"col-auto\">\n                <span class=\"${icono} ${texto_color}\"></span>\n            </div>\n            <div class=\"col px-3\">\n                <div class=\"row m-0 ${texto_color}\">\n                    <div class=\"col-12 p-0 text-label-1 ${texto_color}\">\n                        ${texto_1}\n                    </div>\n                    ${texto_2}\n                </div>\n            </div>\n            ${accion}\n            <div class=\"col-auto ms-3 pointer\" data-bs-dismiss=\"alert\">\n                <span class=\"bi bi-x ${texto_color}\"></span>\n            </div>\n        </div>\n    `);\n    $('#contenedor-alert-toast').append(alert_toast);\n    alert_toast.fadeIn();\n    setTimeout(function() {\n        alert_toast.fadeOut();\n        alert_toast.alert('close');\n    }, 5000);\n}\n\n/**\n * Formatear número.\n *\n * @param {number} numero número a formatear\n * @author Andres Morales\n */\nfunction formatearNumero(numero) {\n    return parseInt(numero).toLocaleString('es-ES');\n}\n\n/**\n * Formatear fecha.\n *\n * @param {*} fecha Fecha a formatear.\n * @param {boolean} incluir_segundos Indica si se debe incluir los segundos en la hora.\n * @param {string} formato Formato en el que se retornará la fecha.\n * @param {string} separador Símbolo que se usará para separar días, meses y años.\n * @returns {Object} Objeto con la fecha y hora formateada.\n * @author Daniel Beltrán\n */\nfunction formatearFechaConceptual(fecha, incluir_segundos = false, formato = 'Ymd', separador = '-') {\n    const NUEVA_FECHA = new Date(fecha);\n    const ANO         = NUEVA_FECHA.getFullYear();\n    const MES         = String(NUEVA_FECHA.getMonth() + 1).padStart(2, '0');\n    const DIA         = String(NUEVA_FECHA.getDate()).padStart(2, '0');\n    const HORAS       = String(NUEVA_FECHA.getHours()).padStart(2, '0');\n    const MINUTOS     = String(NUEVA_FECHA.getMinutes()).padStart(2, '0');\n    const SEGUNDOS    = String(NUEVA_FECHA.getSeconds()).padStart(2, '0');\n\n    let fecha_formateada = `${ANO}${separador}${MES}${separador}${DIA}`;\n\n    if (formato === 'dmY') {\n        fecha_formateada = `${DIA}${separador}${MES}${separador}${ANO}`;\n    }\n\n    return {\n        fecha: fecha_formateada,\n        hora : incluir_segundos ? `${HORAS}:${MINUTOS}:${SEGUNDOS}` : `${HORAS}:${MINUTOS}`\n    };\n}\n\n/**\n * Formatear fecha a May. 2023.\n *\n * @param {string} fechaISO Fecha a formatear.\n * @returns {string} Objeto con la fecha y hora formateada.\n * @author Andres Morales\n */\nfunction formatearFechaAnioMes(fechaISO) {\n    const fecha = new Date(fechaISO);\n    const opciones = { month: 'short', year: 'numeric' };\n    let fecha_formateada = fecha.toLocaleDateString('es-ES', opciones);\n\n    fecha_formateada = fecha_formateada.replace(\n        /^([a-zñ]+)(\\s\\d{4})$/,\n        (_, mes, anio) => `${mes.charAt(0).toUpperCase() + mes.slice(1)}. ${anio.trim()}`\n    );\n\n    return fecha_formateada;\n}\n\n/**\n * Formatear un numero a moneda.\n *\n * @param {string} valor Numero.\n * @returns {string} Numero formateado.\n * @author Andres Morales\n */\nfunction formatearMonedaCOP(valor) {\n    return new Intl.NumberFormat('es-CO', {\n        style: 'currency',\n        currency: 'COP',\n        minimumFractionDigits: 0,\n        maximumFractionDigits: 0\n    }).format(valor);\n}\n\n/**\n * Formatear fecha a un formato d/m/Y hh:mm:ss entendible para el usuario.\n *\n * @param {*} fecha_inicial Fecha a formatear.\n * @returns {String} String con la fecha y hora formateada.\n * @author José Manuel Jiménez\n */\nfunction fechaMostrar(fecha_inicial) {\n    if (!fecha_inicial) {\n        return \"\";\n    }\n    const fecha = new Date(fecha_inicial);\n    if (isNaN(fecha.getTime())) {\n        return \"\";\n    }\n    const dia = String(fecha.getUTCDate()).padStart(2, '0');\n    const mes = String(fecha.getUTCMonth() + 1).padStart(2, '0');\n    const anio = fecha.getUTCFullYear();\n    if (!fecha_inicial.includes(\" \")) {\n        return `${dia}/${mes}/${anio}`;\n    }\n    const horas = String(fecha.getUTCHours()).padStart(2, '0');\n    const minutos = String(fecha.getUTCMinutes()).padStart(2, '0');\n    const segundos = String(fecha.getUTCSeconds()).padStart(2, '0');\n    return `${dia}/${mes}/${anio} ${horas}:${minutos}:${segundos}`;\n}\n\n/**\n * Descargar Excel.\n *\n * @param {string} ruta Ruta desde donde se descarga el archivo.\n * @param {string} nombre_archivo Nombre del archivo descargado.\n * @param {boolean} marca_tiempo Indica si el nombre del archivo debe llevar marca de tiempo.\n * @param {Object} parametros Parámetros a enviar en la petición.\n * @returns {void}\n * @author Daniel Beltrán\n */\nasync function descargarExcel(ruta, nombre_archivo, marca_tiempo = true, parametros = {}) {\n    parametros._token = $('meta[name=\"csrf-token\"]').attr('content');\n\n    await $.ajax({\n        type     : 'POST',\n        url      : `/${ruta}`,\n        data     : parametros,\n        xhrFields: {\n            responseType: 'blob'\n        },\n        success: function (respuesta) {\n            // Crear una URL para el Blob\n            let url = window.URL.createObjectURL(respuesta); // 'respuesta' es el Blob\n            let a   = document.createElement('a'); // Crea un nuevo elemento <a> para iniciar la descarga\n            a.href  = url;\n            const fecha_actual     = new Date();\n            const dia              = fecha_actual.getDate();\n            const mes              = fecha_actual.getMonth() + 1;\n            const ano              = fecha_actual.getFullYear();\n            const hora             = fecha_actual.getHours();\n            const minutos          = fecha_actual.getMinutes();\n            const segundos         = fecha_actual.getSeconds();\n            const fecha_formateada = `${dia}${mes}${ano}${hora}${minutos}${segundos}`;\n\n            a.download = marca_tiempo ? `${nombre_archivo}-${fecha_formateada}.xlsx` : `${nombre_archivo}.xlsx`;\n            document.body.appendChild(a);\n            a.click();\n            window.URL.revokeObjectURL(url);\n            document.body.removeChild(a);\n        }\n    }).then(() => {\n        mostrarToast('success', 'Archivo descargado correctamente.');\n    }).catch((error) => {\n        mostrarToast('danger', 'Ocurrió un error al descargar el archivo.');\n    });\n}\n\n/**\n * Convierte un string a slug.\n *\n * @param {string} str\n * @returns {string}\n * @author Fahibram Cárcamo\n */\nfunction slug(str) {\n\n    // Quita espacios en blanco\n    str = str.replace(/^\\s+|\\s+$/g, \"\")\n\n    // Convierte el string a minusculas\n    str = str.toLowerCase()\n\n    // Quita los caracteres no alfanuméricos\n    str = str.replace(/[^a-z0-9 -]/g, \"\")\n\n    // Reemplaza los espacio con guiones\n    str = str.replace(/\\s+/g, \"-\")\n\n    // Remueve los guiones consecutivos\n    str = str.replace(/-+/g, \"-\")\n\n    return str\n}\n\n/**\n * Compara los elementos de dos arreglos y retorna `true` si son iguales y `false` en caso contrario\n * (Este función está pensada para comparar arreglos unidimensionales).\n *\n * @param {array} primer_arreglo\n * @param {array} segundo_arreglo\n * @param {boolean} comparar_orden\n * @return {boolean}\n * @author Fahibram Cárcamo\n */\nfunction sonArreglosIguales(primer_arreglo, segundo_arreglo, comparar_orden = false) {\n\n    if (!comparar_orden) {\n        primer_arreglo.sort()\n        segundo_arreglo.sort()\n    }\n\n    if (primer_arreglo.length !== segundo_arreglo.length) return false\n\n    for (let i = 0; i < primer_arreglo.length; i++) {\n        if (primer_arreglo[i] !== segundo_arreglo[i]) return false\n    }\n\n    return true\n}\n\n/**\n * Función para cambiar de empresa.\n *\n * @param {number} empresa_id ID de la empresa a la que se va a cambiar.\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Daniel Beltrán\n */\nfunction cambiarEmpresa(empresa_id) {\n    $.ajax({\n        type: 'POST',\n        url: '/suplantar-rol-admin-general',\n        data: {\n            _token    : $('meta[name=\"csrf-token\"]').attr('content'),\n            empresa_id: empresa_id\n        },\n        success: function (respuesta) {\n            localStorage.setItem('notificacionToast', JSON.stringify({\n                tipo_alerta: 'success',\n                texto_1    : 'Cambio de empresa exitoso'\n            }));\n\n            window.location.reload();\n        },\n        error: function (error) {\n            mostrarToast('danger', 'Ocurrió un error al cambiar de empresa');\n        }\n    });\n}\n\n/**\n * Enviar la solucitud de suplantación de rol y empresa al Back-end.\n *\n * @param {function|null} callback_exito Callback ejecutado en caso de éxito.\n * @param {string} url URL de suplantación.\n * @param {string} _token Token CSRF del formulario.\n * @param {number} empresa_id Id de la empresa a suplantar.\n * @param {number|null} rol_id Id del rol a suplantar.\n * @param {function|null} callback_error Callback ejecutado en caso de error.\n * @returns {void}\n * @author Fahibram Cárcamo\n */\nasync function enviarOrdenSuplantacionRolEmpresa (callback_exito, url, _token, empresa_id = null, rol_id = null, callback_error = null) {\n\n    let condicion_suplantacion = rol_id === null\n        ? empresa_id === null\n            ? true\n            : parseInt($('#empresa_sesion_id').val()) !== parseInt(empresa_id)\n        : parseInt($('#rol_sesion_id').val()) !== parseInt(rol_id) && parseInt($('#empresa_sesion_id').val()) !== parseInt(empresa_id);\n\n    if (condicion_suplantacion) {\n        let data = { _token };\n        if (empresa_id !== null) data.empresa_id = empresa_id;\n        if (rol_id !== null) data.rol_id = rol_id;\n\n        await $.ajax({ type: 'POST', url, data })\n            .then((respuesta, status, xhr) => {\n                if (xhr.status >= 200 && xhr.status < 300 && callback_exito !== null) callback_exito();\n            })\n            .catch(error => {\n                let swal_titulo, swal_texto;\n\n                if (error.status === 404) {\n                    if (error.responseJSON.mensaje) {\n                        swal_titulo = 'Algo salió mal';\n                        if (error.responseJSON.mensaje === 'no existe rol_suplantar') {\n                            swal_texto = 'El rol no existe.';\n                        } else if (error.responseJSON.mensaje === 'no existe empresa_suplantar') {\n                            swal_texto = 'La empresa no existe.';\n                        } else if (error.responseJSON.mensaje === 'no existe usuario_suplantar') {\n                            swal_texto = 'El usuario no existe.';\n                        } else {\n                            swal_texto = '';\n                        }\n                    } else if (error.responseJSON.empresa && error.responseJSON.rol) {\n                        swal_titulo = 'No fué posible cambiar de empresa';\n                        swal_texto = error.responseJSON.rol === 'Administrador general' || error.responseJSON.rol === 'Propietario'\n                            ? `La empresa ${error.responseJSON.empresa} no tiene ningún usuario con el rol Administrador general o Propietario.`\n                            : `La empresa ${error.responseJSON.empresa} no tiene ningún usuario con el rol ${error.responseJSON.rol}.`;\n                    } else {\n                        swal_titulo = 'Algo salió mal';\n                        swal_texto = error.responseJSON.errors;\n                    }\n                } else {\n                    swal_titulo = 'Algo salió mal';\n                    swal_texto = '';\n                }\n\n                if (callback_error !== null) callback_error();\n\n                Swal.fire({\n                    title: swal_titulo,\n                    text: swal_texto,\n                    icon: \"error\",\n                    confirmButtonText: \"Aceptar\"\n                });\n            });\n    }\n}\n\n/**\n * Mostrar tooltip según el div que lo contenga.\n *\n * @param {div} div Elemento en donde se va a mostrar el tooltip.\n * @returns {void}\n * @author Sol Espitia\n */\nfunction mostrarTooltip(div) {\n    const TOOLTIP         = div.querySelector('.tooltip-x');\n    TOOLTIP.style.display = 'block';\n}\n\n/**\n * Ocultar tooltip según el div que lo contenga.\n *\n * @param {div} div Elemento en donde se va a mostrar el tooltip.\n * @returns {void}\n * @author Sol Espitia\n */\nfunction ocultarTooltip(div) {\n    const TOOLTIP         = div.querySelector('.tooltip-x');\n    TOOLTIP.style.display = 'none';\n}\n\n/**\n * Retornar la diferencia en días de dos fechas dadas.\n *\n * @param {string} fecha_inicial Fecha inicial\n * @param {string} fecha_final Fecha final\n * @param {bool} valor_absoluto Retorna la diferencia en valor absoluto\n * @returns {number}\n * @author Fahibram Cárcamo\n * @author Andres Morales\n */\nfunction diferenciaFechasDias(fecha_inicial, fecha_final, valor_absoluto = false, sumar_dia = true) {\n    let fecha1 = new Date(fecha_inicial);\n    let fecha2 = new Date(fecha_final);\n\n    fecha1.setHours(0, 0, 0, 0);\n    fecha2.setHours(0, 0, 0, 0);\n\n    let diferencia_milisegundos = fecha2.getTime() - fecha1.getTime();\n\n    let diferencia_dias = diferencia_milisegundos / (1000 * 60 * 60 * 24);\n    let resultado = diferencia_dias;\n    if (sumar_dia) {\n        resultado = diferencia_dias + 1;\n    }\n\n    return valor_absoluto ? Math.abs(resultado) : resultado;\n}\n\n/**\n * Retornar `true` si una fecha dada está dentro de un rango de fechas dadas, `false` en otro caso.\n *\n * @param {string} fecha Fecha dada\n * @param {string} fecha_desde Fecha inicial del rango\n * @param {string} fecha_hasta Fecha final del rango\n * @returns {boolean}\n * @author Fahibram Cárcamo\n */\nfunction fechaDentroDelRango(fecha, fecha_desde, fecha_hasta) {\n    fecha = new Date(fecha);\n    fecha_desde = new Date(fecha_desde);\n    fecha_hasta = new Date(fecha_hasta);\n\n    if (isNaN(fecha) || isNaN(fecha_desde) || isNaN(fecha_hasta)) {\n        throw new Error('Una o más fechas no son válidas.');\n    }\n\n    return fecha >= fecha_desde && fecha <= fecha_hasta;\n}\n\n/**\n * Descuenta el tiempo para las respuestas.\n *\n * @param id - ID del elemento HTML donde mostrar el tiempo\n * @param tiempo - Tiempo inicial en segundos\n * @author Jair Carvajal\n */\nvar tiempos_usados = {};\n\nfunction descuentoTiempo(id, tiempo, callback, onTick) {\n    var $elemento = $('#' + id);\n    if ($elemento.length === 0) {\n        console.error('Elemento con id \"' + id + '\" no encontrado.');\n        return;\n    }\n    if (tiempos_usados[id]) {\n        clearInterval(tiempos_usados[id]);\n    }\n    let tiempoTotal = tiempo;\n    tiempos_usados[id] = setInterval(function() {\n        if (tiempo <= 0) {\n            clearInterval(tiempos_usados[id]);\n            delete tiempos_usados[id];\n            $elemento.text('Tiempo finalizado');\n            if (window.tiempoFinalizado()) {\n                tiempoFinalizado();\n            }\n            if (typeof callback === 'function') {\n                callback();\n            }\n            return;\n        }\n\n        var minutos = Math.floor(tiempo / 60);\n        var segundos = tiempo % 60;\n\n        var textoTiempo = minutos + ':' + (segundos < 10 ? '0' : '') + segundos + '<i class=\"bi bi-alarm ms-2\"></i>';\n\n        if (tiempo <= 15) {\n            $elemento.addClass('text-state-red');\n            $elemento.removeClass('text-state-green');\n        } else {\n            $elemento.addClass('text-state-green');\n            $elemento.removeClass('text-state-red');\n        }\n\n        $elemento.html(textoTiempo);\n\n        var tiempoUsado = tiempoTotal - tiempo;\n\n        if (typeof onTick === 'function') {\n            onTick((tiempoUsado % 5));\n        }\n        tiempo--;\n    }, 1000);\n}\n\n/**\n * Detengo el tiempo para las respuestas.\n *\n * @param id - ID del elemento HTML donde mostrar el tiempo\n * @param tiempo - Tiempo inicial en segundos\n * @author Jair Carvajal\n */\nfunction detenerDescuentoTiempo(id) {\n    if (tiempos_usados[id]) {\n        clearInterval(tiempos_usados[id]);\n        delete tiempos_usados[id];\n    }\n}\n\n/**\n * Genera un SVG de la imagen de usuario.\n *\n * @param id ID del usuario.\n * @param nombres Nombres del usuario.\n * @param apellidos Apellidos del usuario.\n * @return image\n * @author Andres Morales\n */\nfunction crearImagenUsuarioLetras(id, nombres, apellidos) {\n    var tamano = 200;\n    var iniciales = (nombres[0] + apellidos[0]).toUpperCase();\n    var hash = md5(id);\n\n    var r = parseInt(hash.substring(0, 2), 16);\n    var g = parseInt(hash.substring(2, 4), 16);\n    var b = parseInt(hash.substring(4, 6), 16);\n    var colorFondo = `rgb(${r},${g},${b})`;\n\n    var luminancia = 0.299 * r + 0.587 * g + 0.114 * b;\n    var colorTexto = luminancia > 150 ? \"#000000\" : \"#FFFFFF\";\n\n    // SVG como texto\n    var svg = `\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${tamano}\" height=\"${tamano}\">\n        <rect width=\"100%\" height=\"100%\" fill=\"${colorFondo}\" />\n        <text x=\"50%\" y=\"50%\" dy=\".35em\"\n            text-anchor=\"middle\"\n            font-family=\"Lato, sans-serif\"\n            font-size=\"${tamano * 0.4}\"\n            fill=\"${colorTexto}\">\n            ${iniciales}\n        </text>\n    </svg>`;\n    var svgEncoded = encodeURIComponent(svg)\n        .replace(/'/g, \"%27\")\n        .replace(/\"/g, \"%22\");\n\n    var dataUri = `data:image/svg+xml,${svgEncoded}`;\n    return dataUri;\n}\n\n/**\n * Carga las notificaciones\n *\n * @return void\n * @author Andres Morales\n * @author Andres Gonzalez\n * @author Esperanza Olivo\n */\nfunction cargarNotificiacionesHeader() {\n    $.ajax({\n        url: '/usuario-notificaciones',\n        type: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            let datos = respuesta.data;\n            let notificaciones_noleidas = datos?.unread_notifications?.length ?? 0;\n\n            // Siempre remover el badge existente\n            $('#dropdownNotificaciones #badge-notificaciones').remove();\n\n            // Solo agregar el badge si hay notificaciones no leídas\n            if (notificaciones_noleidas > 0) {\n                $('#dropdownNotificaciones').append(`<span id=\"badge-notificaciones\" class=\"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger border border-white\">${notificaciones_noleidas}</span>`);\n                $('#contador-notificaciones-abierto').append(`<span id=\"badge-notificaciones\" class=\"badge rounded-pill bg-danger border border-white\">${notificaciones_noleidas}</span>`);\n\n                $('#contenedor-boton-marcar-todas').html(`\n                    <button class=\"btn btn-link text-primary w-100 d-flex justify-content-center\" onclick=\"marcarNotificacionesLeidas('all')\">\n                        Marcar todo como leído\n                    </button>\n                `);\n            }\n\n            let no_leidos_ids = Array.isArray(datos?.unread_notifications) ? datos.unread_notifications.map(notificacion => notificacion.id): [];\n\n            if (Array.isArray(datos?.notifications) && datos.notifications.length > 0) {\n                $('#notificacion-sinnotificaciones').hide();\n                $('.notificaciones-listado').remove();\n                datos.notifications.forEach(notificacion => {\n                    const { id, data, updated_at } = notificacion;\n\n                    const NO_LEIDO = no_leidos_ids.includes(id);\n                    const MENSAJE = (data?.mensaje || '').slice(0, 120) + '...';\n                    const HORA = new Date(updated_at).toLocaleTimeString('es-CO', {\n                        hour: '2-digit',\n                        minute: '2-digit',\n                        hour12: false\n                    });\n\n                    const notificaciones = `\n                        <li class=\"${NO_LEIDO ? '' : 'bg-gray-90'} notificaciones-listado py-0\" id=\"notificacion-${id}\">\n                            <a class=\"dropdown-item text-gray-10 text-decoration-none border-top pt-0 pb-1\" href=\"javascript:void(0)\" onclick=\"marcarNotificacionesLeidas('${id}','${data?.ruta}')\">\n                                <div class=\"d-flex justify-content-between\">\n                                    <div class=\"w-auto flex-grow-1 pe-3\">\n                                        <p class=\"mt-1 mb-0 text-headline-6 text-gray-10\">${data?.titulo}</p>\n                                        <p class=\"mb-0 text-body-3 text-gray-30 notificacion-mensaje\">${MENSAJE}</p>\n                                    </div>\n                                    <div class=\"w-auto my-auto ${NO_LEIDO ? 'text-cta-azul' : 'text-gray-10'} text-label-2 flex-shrink-0\">\n                                        ${HORA}${NO_LEIDO ? `<i class=\"bi bi-circle-fill text-cta-azul my-auto texto-notificacion-icono ms-3\"></i>` : ''}\n                                    </div>\n                                </div>\n                            </a>\n                        </li>\n                    `;\n\n                    $(notificaciones).insertBefore('#contenedor-boton-marcar-todas');\n                });\n\n            } else {\n                $('#notificacion-sinnotificaciones').hide();\n                $('.notificaciones-listado').remove();\n            }\n\n        },\n        error: function(xhr, status, error) {\n            console.error('Error al cargar notificaciones:', error);\n        }\n    });\n}\n\n/**\n * Marcar las notificaciones leídas.\n *\n * @param {array} notificaciones_ids ids de las notificaciones\n * @param {string} ruta_destino ruta donde se va ha actualizar la pagina\n * @returns {void}\n * @author Andres Gonzalez\n * @author Esperanza Olivo\n */\nfunction marcarNotificacionesLeidas(notificaciones_ids = null, ruta_destino = null, soporte_id = null) {\n\n    let data = {\n        _token: $('meta[name=\"csrf-token\"]').attr('content')\n    };\n\n    if (notificaciones_ids === 'all') {\n        data.marcar_todo = true;\n    } else if (soporte_id) {\n        data.soporte_id = soporte_id;\n    } else if (notificaciones_ids) {\n        data.notificaciones_ids = Array.isArray(notificaciones_ids)\n            ? notificaciones_ids\n            : [notificaciones_ids];\n    }\n\n    $.ajax({\n        url: '/usuario-marcar-notificaciones-leidas',\n        type: 'POST',\n        data: data,\n        success: function(respuesta) {\n            cargarNotificiacionesHeader();\n\n            if (notificaciones_ids && notificaciones_ids !== 'all' && ruta_destino) {\n                window.location.href = \"/\" + ruta_destino;\n            }\n\n            if (notificaciones_ids === 'all') {\n                $('#badge-notificaciones').remove();\n                $('#contenedor-boton-marcar-todas').empty();\n                $('.notificaciones-listado').addClass('bg-gray-90');\n                $('.bi-circle-fill').remove();\n            }\n        },\n        error: function(xhr, estatus, error) {\n            console.error('Error al cargar notificaciones:', error);\n        }\n    });\n}\n\n/**\n * Configurar WebSocket para notificaciones en tiempo real\n *\n * @return void\n * @author Andres Gonzalez\n */\nfunction configurarWebSocketNotificaciones() {\n    try {\n        if (!window.configuracion_reverbg) {\n            return;\n        }\n\n        const PUSHER = new Pusher(window.configuracion_reverbg.appKey, {\n            wsHost: window.configuracion_reverbg.host,\n            wsPort: window.configuracion_reverbg.port,\n            wssPort: window.configuracion_reverbg.port,\n            cluster: 'mt1',\n            forceTLS: false,\n            enabledTransports: ['ws', 'wss'],\n            authEndpoint: '/broadcasting-auth',\n            auth: {\n                headers: {\n                    'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\n                }\n            }\n        });\n\n        PUSHER.connection.bind('failed', function() {\n            console.error('❌ Conexión WebSocket falló');\n        });\n\n        PUSHER.connection.bind('error', function(error) {\n            console.error('❌ Error de WebSocket:', error);\n        });\n\n        let usuario_id = window.configuracion_reverbg.usuario_id;\n\n        if (!usuario_id) {\n            return;\n        }\n\n        const NOMBRE_CANAL = `private-App.Models.Usuarios.User.${usuario_id}`;\n        const CANAL = PUSHER.subscribe(NOMBRE_CANAL);\n\n        CANAL.bind('pusher:subscription_error', function(error) {\n            console.error('❌ Error al suscribirse al canal:', error);\n        });\n\n        // Escuchar eventos específicos de notificaciones\n        CANAL.bind('Illuminate\\\\Notifications\\\\Events\\\\BroadcastNotificationCreated', function(data) {\n            if (data.tipo === 'nueva_notificacion') {\n                audio_notificacion.play();\n                cargarNotificiacionesHeader();\n            }\n\n            if (data.tipo === 'nuevo_mensaje') {\n                if (($('#soporte-guardado-id').val() == data.soporte_id) || ($('#soporte_empresa_id').val() == data.soporte_id)) {\n                    audio_notificacion.play();\n                    consultarChat(data.soporte_id);\n                }\n            }\n        });\n    } catch (error) {\n        console.error('💥 Error en configurarWebSocketNotificaciones:', error);\n        console.error('Stack trace:', error.stack);\n    }\n}\n\n/**\n * Retornar el string entrante en formato title case.\n *\n * @param {string} texto\n * @returns {string}\n * @author Fahibram Cárcamo\n */\nfunction titleCase(texto) {\n    return texto.toLowerCase().replace(/\\b\\w/g, caracter => caracter.toUpperCase());\n}\n\n/**\n * Número de horas que durará el almacenamiento de la variable `ulitmas_empresas` en el\n * almacenamiento local **LocalStorage**.\n *\n * @var {number}\n * @author Fahibram Cárcamo\n */\nconst CANTIDAD_HORAS_VENCIMIENTO_ULTIMAS_EMPRESAS_LOCALSTORAGE = 6;\n\n/**\n * Validar si ya debe removerse la variable `ultimas_empresas` del alamacenamiento local\n * **LocalStorage**, si no es tiempo de eliminarla entonces se reinicia el tiempo de vigencia de la\n * variable.\n *\n * @returns {void}\n * @author Fahibram Cárcamo\n */\nfunction validarYActualizarUltimasEmpresasLocalStorage() {\n    let fecha_hora_actuales = moment();\n    let fecha_hora_vencimiento_ultimas_empresas = fecha_hora_actuales.clone().add(CANTIDAD_HORAS_VENCIMIENTO_ULTIMAS_EMPRESAS_LOCALSTORAGE, 'hours');\n    let fecha_hora_vencimiento_ultimas_empresas_localstorage = localStorage.getItem('vencimiento_ultimas_empresas');\n    let ultimas_empresas = localStorage.getItem('ultimas_empresas');\n\n    if (\n        ultimas_empresas != null &&\n        fecha_hora_vencimiento_ultimas_empresas_localstorage != null &&\n        fecha_hora_actuales.clone().isBefore(moment(fecha_hora_vencimiento_ultimas_empresas_localstorage).clone())\n    ) {\n        localStorage.setItem('vencimiento_ultimas_empresas', fecha_hora_vencimiento_ultimas_empresas.format('YYYY-MM-DD HH:mm:ss'));\n        return;\n    }\n\n    localStorage.removeItem('vencimiento_ultimas_empresas');\n    localStorage.removeItem('ultimas_empresas');\n}\n\n/**\n * Obtener la edad actual de un usuario según su fecha de nacimiento.\n *\n * @param {string} fecha_nacimiento\n * @returns {string}\n * @author José Manuel Jiménez\n * @author Fahibram Cárcamo\n * @author Andres Morales\n */\nfunction obtenerEdad(fecha_nacimiento) {\n    if (!fecha_nacimiento) return \"N/A\";\n    let hoy = new Date();\n    let nacimiento = new Date(fecha_nacimiento);\n    let edad = hoy.getFullYear() - nacimiento.getFullYear();\n    let mes = hoy.getMonth() - nacimiento.getMonth();\n    if (mes < 0 || (mes === 0 && hoy.getDate() < nacimiento.getDate())) edad--;\n    return edad + \" años\";\n}\n\n/**\n * Restablecer un input de tipo file.\n *\n * @param {html} elemento_input_html Elemento input html.\n * @param {html} label_elemento_input_html Label del elemento input html.\n * @param {html} boton_eliminar_elemento_input_html Botón para eliminar archivo del elemento input html.\n * @author Fahibram Cárcamo\n */\nfunction reiniciarCampoArchivo(elemento_input_html, label_elemento_input_html, boton_eliminar_elemento_input_html) {\n    elemento_input_html.val('');\n    elemento_input_html.removeAttr('data-base64');\n    label_elemento_input_html.text('Ningún archivo seleccionado');\n    boton_eliminar_elemento_input_html.hide();\n\n    if (elemento_input_html.data('imagen')) {\n        $('#' + elemento_input_html.data('imagen')).val('');\n        $('#' + elemento_input_html.data('imagen') + '_previsualizacion').attr('src', '');\n        $('#' + elemento_input_html.data('imagen') + '_fondo_previsualizacion').removeClass('d-none');\n    }\n}\n\n/**\n * Definir un campo destinado a recibir un número de teléfono celular.\n *\n * Esta función debe llamarse en el evento ready del objeto global document:\n * `$(document).ready(...)`. Ademas debe incluirse un pequeño fragmento de código en la función\n * `validacionAdicional` para que se agregué el código del número de celular al valor de campo\n * cuando se envíe el formulario donde se encutra el campo.\n *\n * ```\n * if (\n *   $('#input_celular_id').length &&\n *   $('#input_celular_id').val() !== '' &&\n *   input_celular.getNumber() !== ''\n * ) {\n *   $('#input_celular_id').val(input_celular.getNumber().slice(1));\n * }\n * ```\n *\n * Donde `input_celular` es el objeto retornado por esta función.\n *\n * @param {string} input_celular_id Id del campo.\n * @param {string} nombre_input_celular Nombre del campo.\n * @param {string} placeholder_input_celular Placeholder del campo.\n * @param {boolean} obligatorio El campo es obligatorio en el formulario.\n * @returns {object}\n * @author Fahibram Cárcamo\n */\nfunction definirInputTipoCelular(input_celular_id, nombre_input_celular, placeholder_input_celular, obligatorio = true) {\n    /**\n     * 🌎 Campo para ingresar un número de telefono con selectór de código de país con banderas.\n     * Este componente se creó con la librería International Telephone Input\n     * (https://intl-tel-input.com).\n     *\n     * La linea hiddenInput: () => ({ phone: 'celular_contacto' }) tiene como función establecer el\n     * nombre del campo, es decir, la llave del par llave-valor que se adjuntará en los datos del\n     * formulario cuando se envíe, en este caso 'celular_contacto'.\n     *\n     * Las lienas autoPlaceholder: 'aggressive' y\n     * customPlaceholder: (placeholder, country) => 'Celular*' se usan para definir el placeholder\n     * del campo.\n     *\n     * Con $('#celular_contacto').attr('required', true); se establece el campo como requerido\n     * dentro del formulario, se hace de esta forma porque la librería no admite el atributo\n     * required directamente en el componente html.\n     *\n     * @author Fahibram Cárcamo\n     */\n    if (document.querySelector(`#${input_celular_id}`)) {\n        const dropdown_dinamico = document.createElement('div');\n        document.body.appendChild(dropdown_dinamico);\n\n        let campo_celular = window.intlTelInput(document.querySelector(`#${input_celular_id}`), {\n            nationalMode: true,\n            initialCountry: 'co',\n            separateDialCode: true,\n            autoInsertDialCode: false,\n            autoPlaceholder: 'aggressive',\n            dropdownContainer: dropdown_dinamico,\n            customPlaceholder: (placeholder, country) => placeholder_input_celular,\n            loadUtils: () => import('https://cdn.jsdelivr.net/npm/intl-tel-input@25.4.2/build/js/utils.js'),\n            onlyCountries: [\n                'CO', // Colombia\n                'EC', // Ecuador\n                'AR', // Argentina\n                'CL', // Chile\n                'VE', // Venezuela\n                'PE', // Perú\n                'BO', // Bolivia\n                'UY', // Uruguay\n                'PY', // Paraguay\n                'PA', // Panamá\n                'MX', // México\n                'CR', // Costa Rica\n                // 'PR', // Puerto Rico\n                'CU', // Cuba\n                // 'DO', // República Dominicana\n                'SV', // El Salvador\n                'GT', // Guatemala\n                'HN', // Honduras\n                'NI', // Nicaragua\n                'ES', // España\n                'US', // Estados Unidos\n                'GQ'  // Guinea Ecuatorial\n            ]\n        });\n\n        if (obligatorio) $(`#${input_celular_id}`).attr('required', true);\n\n        return campo_celular;\n    }\n\n    return null;\n}\n\n/**\n * Establece la validación adicional que se aplica a un campo de tipo celular antes de enviar sus\n * datos en un formulario.\n *\n * @param {HTMLInputElement} input Elemento HTML del campo de tipo celular.\n * @param {string} input_id Id del elemento HTML del campo de tipo celular.\n * @author Fahibram Cárcamo\n * @author Jair Carvajal\n */\nfunction validacionAdicionalInputTipoCelular(input, input_id) {\n    let numero_completo = input.getNumber();\n    let indicativo = '+' + input.getSelectedCountryData().dialCode;\n    let codigo_iso2_pais = input.getSelectedCountryData().iso2;\n    let numero_sin_indicativo = numero_completo.replace(indicativo, '');\n    $(`#indicativo_${input_id}`).val(indicativo);\n    $(`#codigo_iso2_pais_${input_id}`).val(codigo_iso2_pais);\n    $(`#${input_id}`).val(numero_sin_indicativo);\n}\n\n/**\n * Rellenar un input de tipo celular.\n *\n * @param {string} indicativo_celular Código del país del número de celular.\n * @param {string} codigo_pais_iso2 Código ISO2 del país del número de celular.\n * @param {string} numero_celular Número de celular sin código de país.\n * @param {string} input_celular_id ID del input de tipo celular.\n * @param {HTMLInputElement} input_celular Input de tipo celular.\n * @returns {void}\n * @author Daniel Beltrán\n * @author Fahibram Cárcamo\n */\nfunction rellenarInputCelular(indicativo_celular, codigo_pais_iso2, numero_celular, input_celular_id, input_celular) {\n    $(`#${input_celular_id}`).val(numero_celular);\n    if (![null, undefined].includes(codigo_pais_iso2)) input_celular.setCountry(codigo_pais_iso2);\n}\n\n/**\n * Convierte imágenes de base64 a Blob.\n *\n * @param {string} cadena_base_64 Base 64 de la imagen.\n * @returns {Promise<Array>}\n * @author Andres Gonzalez\n */\nfunction imagenBase64Blob(cadena_base_64) {\n    if (!cadena_base_64 || !cadena_base_64.startsWith('data:image')) return null;\n    let datos_base_64 = cadena_base_64.split(',')[1];\n    let tipo_mime = cadena_base_64.match(/data:(.*?);base64/)[1];\n    let caracteres_binarios = atob(datos_base_64);\n    let arreglo_bytes = new Array(caracteres_binarios.length).fill(0).map((_, i) => caracteres_binarios.charCodeAt(i));\n    let bytes_uint8 = new Uint8Array(arreglo_bytes);\n    return new Blob([bytes_uint8], { type: tipo_mime });\n}\n\n\n/**\n * Limpiar estructuras html innecesarias en el check editor.\n *\n * @param {string} html - Cadena HTML generada por CKEditor a limpiar\n * @returns {string} HTML limpio sin elementos específicos de CKEditor\n * @author Andres Gonzalez\n * @author Jair Carvajal\n */\nfunction limpiarHTMLCKEditor(html) {\n    // Remover todos los elementos con clases de CKEditor\n    html = html.replace(/<div class=\"ck[^\"]*\"[^>]*>.*?<\\/div>/gs, '');\n    html = html.replace(/<span class=\"[^\"]*ck[^\"]*\"[^>]*>/gi, '<span>');\n\n    // Limpiar spans de imagen inline\n    html = html.replace(/<span class=\"image-inline[^\"]*\"[^>]*>/gi, '');\n    html = html.replace(/<\\/span>/g, '');\n\n    // Remover elementos de upload y widgets\n    html = html.replace(/<div class=\"ck-image-upload[^\"]*\"[^>]*>.*?<\\/div>/gs, '');\n    html = html.replace(/<div class=\"ck-fake-selection[^\"]*\"[^>]*>.*?<\\/div>/gs, '');\n\n    // Remover atributos innecesarios\n    html = html.replace(/contenteditable=\"[^\"]*\"/gi, '');\n    html = html.replace(/data-cke-filler=\"[^\"]*\"/gi, '');\n\n    // Limpiar párrafos vacíos con br\n    html = html.replace(/<p><br[^>]*><\\/p>/gi, '');\n    html = html.replace(/<br data-cke[^>]*>/gi, '');\n\n    // Limpiar espacios múltiples y saltos de línea\n    html = html.replace(/\\s+/g, ' ');\n    html = html.replace(/>\\s+</g, '><');\n\n    return html.trim();\n}\n\n/**\n * Ordena estudios por fecha_inicio más reciente (de más nueva a más antigua).\n * Preserva los índices originales para permitir edición y eliminación correcta.\n *\n * @param {Array} estudios - Array de objetos con estudios\n * @returns {Array} Array de estudios ordenados con propiedad indice_original\n * @author Jair Carvajal\n */\nfunction ordenarEstudiosPorFecha(estudios) {\n    // Mapear con índice original\n    let estudios_con_indice = estudios.map((estudio, indice_original) => ({\n        ...estudio,\n        indice_original: indice_original\n    }));\n\n    // Ordenar estudios por fecha_inicio (más reciente primero)\n    let estudios_ordenados = estudios_con_indice.sort((a, b) => {\n        // Si ambos tienen fecha_inicio, ordenar por más reciente\n        if (a.fecha_inicio && b.fecha_inicio) {\n            return moment(b.fecha_inicio).diff(moment(a.fecha_inicio));\n        }\n        // Si solo uno tiene fecha_inicio, ese va primero\n        if (a.fecha_inicio && !b.fecha_inicio) return -1;\n        if (!a.fecha_inicio && b.fecha_inicio) return 1;\n        // Si ninguno tiene fecha_inicio, mantener orden original\n        return 0;\n    });\n\n    return estudios_ordenados;\n}\n\n/**\n * Ordena experiencias laborales por fecha: primero las que está trabajando actualmente (sin fecha_fin),\n * luego por fecha_fin más reciente.\n * Preserva los índices originales para permitir edición y eliminación correcta.\n *\n * @param {Array} experiencias - Array de objetos con experiencias laborales\n * @returns {Array} Array de experiencias ordenadas con propiedad indice_original\n * @author Jair Carvajal\n */\nfunction ordenarExperienciasPorFecha(experiencias) {\n    // Mapear con índice original\n    let experiencias_con_indice = experiencias.map((experiencia, indice_original) => ({\n        ...experiencia,\n        indice_original: indice_original\n    }));\n\n    // Ordenar experiencias\n    let experiencias_ordenadas = experiencias_con_indice.sort((a, b) => {\n        // Si 'a' no tiene fecha_fin (trabaja actualmente), va primero\n        if (!a.fecha_fin && b.fecha_fin) return -1;\n        // Si 'b' no tiene fecha_fin (trabaja actualmente), va primero\n        if (a.fecha_fin && !b.fecha_fin) return 1;\n        // Si ambos están trabajando actualmente (sin fecha_fin), mantener el orden actual\n        if (!a.fecha_fin && !b.fecha_fin) return 0;\n        // Si ambos tienen fecha_fin, ordenar por fecha más reciente primero (descendente)\n        return moment(b.fecha_fin).diff(moment(a.fecha_fin));\n    });\n\n    return experiencias_ordenadas;\n}\n\n/**\n * Obtener créditos disponibles de la empresa y actualizar el tag.\n * - Si tiene créditos >= 20% del plan: tag azul\n * - Si tiene créditos < 20% del plan: tag amarillo\n * - Si no tiene créditos: tag gris \"Sin créditos\"\n *\n * @param {number} empresa_id ID de la empresa\n * @param {string} contenedor_id ID del contenedor donde se mostrará el tag\n * @returns {void}\n * @author Andres Gonzalez\n */\nfunction obtenerCreditosDisponiblesEmpresa(empresa_id, contenedor_id = 'contenedor-tag-creditos') {\n    if (!empresa_id || !$(`#${contenedor_id}`).length) {\n        return;\n    }\n\n    $.ajax({\n        url: `/api/empresas/${empresa_id}/creditos`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            let creditos_disponibles = respuesta?.data?.creditos_disponibles ?? 0;\n            let creditos_plan = respuesta?.data?.creditos_plan ?? 0;\n            let porcentaje_disponible = creditos_plan > 0 ? (creditos_disponibles / creditos_plan) * 100 : 0;\n\n            let texto_tag = '';\n            let clase_tag = '';\n\n            if (creditos_disponibles <= 0) {\n                texto_tag = 'Sin créditos';\n                clase_tag = 'tag-tonal-gray';\n            } else if (porcentaje_disponible < 20) {\n                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                clase_tag = 'tag-filled-yellow';\n            } else {\n                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                clase_tag = 'tag-tonal-blue';\n            }\n\n            $(`#${contenedor_id}`).html(crearTag({\n                texto: texto_tag,\n                class: clase_tag,\n            }));\n        },\n        error: function() {\n            $(`#${contenedor_id}`).html(crearTag({\n                texto: 'Error al cargar créditos',\n                class: 'tag-tonal-gray',\n            }));\n        }\n    });\n}\n","structuredPatch":[{"oldStart":1426,"oldLines":13,"newStart":1426,"newLines":17,"lines":[" ","             let texto_tag = '';","             let clase_tag = '';","+            let icono_final = '';","+            let mensaje_tooltip = 'Comunícate con tu ejecutivo para adquirir más créditos.';"," ","             if (creditos_disponibles <= 0) {","                 texto_tag = 'Sin créditos';","                 clase_tag = 'tag-tonal-gray';","+                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'top', content: mensaje_tooltip })}></i>`;","             } else if (porcentaje_disponible < 20) {","                 texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;","                 clase_tag = 'tag-filled-yellow';","+                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'top', content: mensaje_tooltip })}></i>`;","             } else {","                 texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;","                 clase_tag = 'tag-tonal-blue';"]},{"oldStart":1441,"oldLines":6,"newStart":1445,"newLines":7,"lines":["             $(`#${contenedor_id}`).html(crearTag({","                 texto: texto_tag,","                 class: clase_tag,","+                icono_final: icono_final,","             }));","         },","         error: function() {"]}],"userModified":false,"replaceAll":false},"sourceToolAssistantUUID":"8167d419-0eca-4548-9451-677f829035b6"}
{"parentUuid":"fc9af04b-4335-464f-bd11-58e2c9711851","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01KFCBqYSZBiCVCrarWsmi35","type":"message","role":"assistant","content":[{"type":"text","text":"Listo. Ahora la función muestra:\n\n- **Tag azul** (>= 20% créditos): Solo texto, sin icono\n- **Tag amarillo** (< 20% créditos): Texto + icono info con tooltip\n- **Tag gris** (sin créditos): Texto \"Sin créditos\" + icono info con tooltip\n\nEl tooltip muestra el mensaje: \"Comunícate con tu ejecutivo para adquirir más créditos.\""}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":2160,"cache_read_input_tokens":83097,"cache_creation":{"ephemeral_5m_input_tokens":2160,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXLs3vroSSTckvhni2M9J","type":"assistant","uuid":"f9ba2a7d-6b6d-4d28-bb91-d7a773688301","timestamp":"2026-01-21T16:47:26.403Z"}
{"type":"queue-operation","operation":"dequeue","timestamp":"2026-01-21T16:50:04.000Z","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961"}
{"type":"file-history-snapshot","messageId":"778383d2-df02-4594-933e-4e104e4a8c2f","snapshot":{"messageId":"778383d2-df02-4594-933e-4e104e4a8c2f","trackedFileBackups":{"resources\\views\\vacantes\\paginas\\index.blade.php":{"backupFileName":"1ae59264a32091d1@v9","version":9,"backupTime":"2026-01-21T16:50:05.680Z"},"public\\js\\globales.js":{"backupFileName":"704f632e999527e6@v4","version":4,"backupTime":"2026-01-21T16:50:05.708Z"},"public\\js\\vacantes\\vacantes.js":{"backupFileName":"ca631dbb99127e3f@v3","version":3,"backupTime":"2026-01-21T16:33:41.257Z"},"public\\componentes\\componentes\\tags.js":{"backupFileName":"247759b31878023a@v2","version":2,"backupTime":"2026-01-21T16:39:57.931Z"}},"timestamp":"2026-01-21T16:50:05.651Z"},"isSnapshotUpdate":false}
{"parentUuid":"12d87223-8ec3-47b8-ad9c-3d9c0f17dccd","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Read","command":"callback"},"toolUseID":"toolu_01DZ6foFT64AK8jC1BxKjvgV","parentToolUseID":"toolu_01DZ6foFT64AK8jC1BxKjvgV","uuid":"19ac3e88-1c9d-4569-9737-ea87028ed0d3","timestamp":"2026-01-21T16:46:13.951Z"}
{"parentUuid":"8167d419-0eca-4548-9451-677f829035b6","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Edit","command":"callback"},"toolUseID":"toolu_015V7kcjnon6avTMjNuzrckH","parentToolUseID":"toolu_015V7kcjnon6avTMjNuzrckH","uuid":"dcebd076-0f7a-44bb-9dc4-71e717f777d7","timestamp":"2026-01-21T16:46:27.311Z"}
{"parentUuid":"dcebd076-0f7a-44bb-9dc4-71e717f777d7","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Edit","command":"callback"},"toolUseID":"toolu_015V7kcjnon6avTMjNuzrckH","parentToolUseID":"toolu_015V7kcjnon6avTMjNuzrckH","uuid":"da00e9d3-15a8-4668-a45e-462a2db215c8","timestamp":"2026-01-21T16:46:27.312Z"}
{"parentUuid":"fc9af04b-4335-464f-bd11-58e2c9711851","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"callback"},"parentToolUseID":"toolu_015V7kcjnon6avTMjNuzrckH","toolUseID":"toolu_015V7kcjnon6avTMjNuzrckH","timestamp":"2026-01-21T16:47:20.147Z","uuid":"7d2b1056-88cd-4d50-8741-87033c9057df"}
{"parentUuid":"f9ba2a7d-6b6d-4d28-bb91-d7a773688301","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"type":"text","text":"<ide_selection>The user selected the lines 1434 to 1439 from c:\\laragon\\www\\psicoalianza-2\\public\\js\\globales.js:\nicono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'top', content: 'Estás cerca de agotar tus créditos. Te queda menos del 20% del total disponible. Considera recargar o revisar tu consumo para evitar interrupciones.' })}></i>`;\n            } else if (porcentaje_disponible < 20) {\n                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                clase_tag = 'tag-filled-yellow';\n                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'top', content: 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.' })}></i>`;\n            } else {\n\nThis may or may not be related to the current task.</ide_selection>"},{"type":"text","text":"que stos tootips queden ala derechaicono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'top', content: 'Estás cerca de agotar tus créditos. Te queda menos del 20% del total disponible. Considera recargar o revisar tu consumo para evitar interrupciones.' })}></i>`;\n            } else if (porcentaje_disponible < 20) {\n                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                clase_tag = 'tag-filled-yellow';\n                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'top', content: 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.' })}></i>`;\n            } else {"}]},"uuid":"778383d2-df02-4594-933e-4e104e4a8c2f","timestamp":"2026-01-21T16:50:05.649Z"}
{"parentUuid":"778383d2-df02-4594-933e-4e104e4a8c2f","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_011EXukwgKMPjn2XLoDoqnzR","type":"message","role":"assistant","content":[{"type":"text","text":"Voy a cambiar el `placement` de `'top'` a `'right'` en los tooltips."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":3577,"cache_read_input_tokens":85257,"cache_creation":{"ephemeral_5m_input_tokens":3577,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXLsFzjJPg1c5CSB2c6f2","type":"assistant","uuid":"475a18ed-4eec-4413-91a4-929c4e9ba3f0","timestamp":"2026-01-21T16:50:09.048Z"}
{"parentUuid":"475a18ed-4eec-4413-91a4-929c4e9ba3f0","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_011EXukwgKMPjn2XLoDoqnzR","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01KPboBFZAbnupDfgub5wkFF","name":"Read","input":{"file_path":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\globales.js","offset":1425,"limit":20}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":3577,"cache_read_input_tokens":85257,"cache_creation":{"ephemeral_5m_input_tokens":3577,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXLsFzjJPg1c5CSB2c6f2","type":"assistant","uuid":"c759bd75-70e3-4756-80d1-2c5bc0f9b445","timestamp":"2026-01-21T16:50:09.844Z"}
{"parentUuid":"c759bd75-70e3-4756-80d1-2c5bc0f9b445","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01KPboBFZAbnupDfgub5wkFF","type":"tool_result","content":"  1425→            let porcentaje_disponible = creditos_plan > 0 ? (creditos_disponibles / creditos_plan) * 100 : 0;\n  1426→\n  1427→            let texto_tag = '';\n  1428→            let clase_tag = '';\n  1429→            let icono_final = '';\n  1430→\n  1431→            if (creditos_disponibles <= 0) {\n  1432→                texto_tag = 'Sin créditos';\n  1433→                clase_tag = 'tag-tonal-gray';\n  1434→                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'top', content: 'Estás cerca de agotar tus créditos. Te queda menos del 20% del total disponible. Considera recargar o revisar tu consumo para evitar interrupciones.' })}></i>`;\n  1435→            } else if (porcentaje_disponible < 20) {\n  1436→                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n  1437→                clase_tag = 'tag-filled-yellow';\n  1438→                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'top', content: 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.' })}></i>`;\n  1439→            } else {\n  1440→                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n  1441→                clase_tag = 'tag-tonal-blue';\n  1442→            }\n  1443→\n  1444→            $(`#${contenedor_id}`).html(crearTag({\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"a8b9e1dd-3960-42d5-8aed-ce779c981c63","timestamp":"2026-01-21T16:50:11.180Z","toolUseResult":{"type":"text","file":{"filePath":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\globales.js","content":"            let porcentaje_disponible = creditos_plan > 0 ? (creditos_disponibles / creditos_plan) * 100 : 0;\n\n            let texto_tag = '';\n            let clase_tag = '';\n            let icono_final = '';\n\n            if (creditos_disponibles <= 0) {\n                texto_tag = 'Sin créditos';\n                clase_tag = 'tag-tonal-gray';\n                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'top', content: 'Estás cerca de agotar tus créditos. Te queda menos del 20% del total disponible. Considera recargar o revisar tu consumo para evitar interrupciones.' })}></i>`;\n            } else if (porcentaje_disponible < 20) {\n                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                clase_tag = 'tag-filled-yellow';\n                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'top', content: 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.' })}></i>`;\n            } else {\n                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                clase_tag = 'tag-tonal-blue';\n            }\n\n            $(`#${contenedor_id}`).html(crearTag({","numLines":20,"startLine":1425,"totalLines":1458}},"sourceToolAssistantUUID":"c759bd75-70e3-4756-80d1-2c5bc0f9b445"}
{"parentUuid":"a8b9e1dd-3960-42d5-8aed-ce779c981c63","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01PEhumD3FBo8SyfGQ7Aw55G","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01Hn5B1KCdUd75KdcJAUEB4Q","name":"Edit","input":{"replace_all":false,"file_path":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\globales.js","old_string":"            if (creditos_disponibles <= 0) {\n                texto_tag = 'Sin créditos';\n                clase_tag = 'tag-tonal-gray';\n                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'top', content: 'Estás cerca de agotar tus créditos. Te queda menos del 20% del total disponible. Considera recargar o revisar tu consumo para evitar interrupciones.' })}></i>`;\n            } else if (porcentaje_disponible < 20) {\n                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                clase_tag = 'tag-filled-yellow';\n                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'top', content: 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.' })}></i>`;\n            } else {","new_string":"            if (creditos_disponibles <= 0) {\n                texto_tag = 'Sin créditos';\n                clase_tag = 'tag-tonal-gray';\n                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.' })}></i>`;\n            } else if (porcentaje_disponible < 20) {\n                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                clase_tag = 'tag-filled-yellow';\n                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'Estás cerca de agotar tus créditos. Te queda menos del 20% del total disponible. Considera recargar o revisar tu consumo para evitar interrupciones.' })}></i>`;\n            } else {"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":729,"cache_read_input_tokens":88834,"cache_creation":{"ephemeral_5m_input_tokens":729,"ephemeral_1h_input_tokens":0},"output_tokens":25,"service_tier":"standard"}},"requestId":"req_011CXLsGPxoC91hWzoqBMarQ","type":"assistant","uuid":"2c520aa2-b652-438f-a961-f401f55328ba","timestamp":"2026-01-21T16:50:18.611Z"}
{"parentUuid":"2c520aa2-b652-438f-a961-f401f55328ba","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01Hn5B1KCdUd75KdcJAUEB4Q","type":"tool_result","content":"The file c:\\laragon\\www\\psicoalianza-2\\public\\js\\globales.js has been updated. Here's the result of running `cat -n` on a snippet of the edited file:\n  1427→            let texto_tag = '';\n  1428→            let clase_tag = '';\n  1429→            let icono_final = '';\n  1430→\n  1431→            if (creditos_disponibles <= 0) {\n  1432→                texto_tag = 'Sin créditos';\n  1433→                clase_tag = 'tag-tonal-gray';\n  1434→                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.' })}></i>`;\n  1435→            } else if (porcentaje_disponible < 20) {\n  1436→                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n  1437→                clase_tag = 'tag-filled-yellow';\n  1438→                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'Estás cerca de agotar tus créditos. Te queda menos del 20% del total disponible. Considera recargar o revisar tu consumo para evitar interrupciones.' })}></i>`;\n  1439→            } else {\n  1440→                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n  1441→                clase_tag = 'tag-tonal-blue';\n  1442→            }\n  1443→"}]},"uuid":"54158024-11c8-485d-92f1-e4016ff9fc8e","timestamp":"2026-01-21T16:51:34.475Z","toolUseResult":{"filePath":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\globales.js","oldString":"            if (creditos_disponibles <= 0) {\n                texto_tag = 'Sin créditos';\n                clase_tag = 'tag-tonal-gray';\n                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'top', content: 'Estás cerca de agotar tus créditos. Te queda menos del 20% del total disponible. Considera recargar o revisar tu consumo para evitar interrupciones.' })}></i>`;\n            } else if (porcentaje_disponible < 20) {\n                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                clase_tag = 'tag-filled-yellow';\n                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'top', content: 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.' })}></i>`;\n            } else {","newString":"            if (creditos_disponibles <= 0) {\n                texto_tag = 'Sin créditos';\n                clase_tag = 'tag-tonal-gray';\n                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.' })}></i>`;\n            } else if (porcentaje_disponible < 20) {\n                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                clase_tag = 'tag-filled-yellow';\n                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'Estás cerca de agotar tus créditos. Te queda menos del 20% del total disponible. Considera recargar o revisar tu consumo para evitar interrupciones.' })}></i>`;\n            } else {","originalFile":"// Mensajes en español para el plugin Select2\nconst mensajes_select2 = {\n    'noResults'              : () => { return 'No hay resultados para la búsqueda.'; },\n    'searching'              : () => { return 'Buscando...'; },\n    'Loading'                : () => { return 'Cargando...'; },\n    'loadingMore'            : () => { return 'Cargando más resultados...'; },\n    'dropdownFooter'         : (texto) => { return `Mostrando ${texto} resultados`; },\n    'emptyOptions'           : () => { return 'No hay opciones disponibles.'; },\n    'appendItems'            : (items) => { return `Agregando ${items.length} elementos.`; },\n    'maximumSelectionReached': () => { return 'Se ha alcanzado el número máximo de selecciones.'; },\n    'selectOnClose'          : () => { return 'Seleccione una opción al cerrar el menú.'; },\n    'escapeKeyUp'            : () => { return 'Presione \\'Escape\\' para cerrar el menú.'; },\n    'errorLoading'           : () => { return 'Error al cargar datos. Inténtalo de nuevo más tarde.'; },\n    'inputTooShort'          : (elemento) => { return `Ingresa al menos ${elemento.minimum} caracteres para iniciar una búsqueda.`; },\n    'noMatches'              : () => { return 'No se encontraron coincidencias para tu búsqueda.'; },\n    'allowClear'             : () => { return 'Borrar selección'; },\n    'SelectionTooLong'       : (conteo, maximo) => { return `Solo puedes seleccionar ${maximo} opciones.`; },\n    'loadMore'               : () => { return 'Cargando más resultados...'; },\n    'removing'               : (seleccion) => { return 'Eliminando...'; },\n    'matches'                : (coincidencias, total) => {\n        if (coincidencias === 0) {\n            return 'No hay coincidencias.';\n        } else if (coincidencias === 1) {\n            return 'Se encontró 1 coincidencia.';\n        } else {\n            return `Se encontraron ${coincidencias} coincidencias entre ${total}.`;\n        }\n    }\n};\n\n// audios\nvar audio_notificacion = new Audio('/audios/notificacion.mp3');\n\nlet mostro_modal_creditos_ia = false;\nlet funcion_ejecucion_ia = null;\nlet modals_abiertos_ia = null;\n\n/**\n * Mostrar modal de créditos IA\n * \n * @return void\n * @author José Manuel Jiménez\n */\nfunction mostrarModalCreditosIA(servicio_ia_id) {\n    $.ajax({\n        url: `/api/empresas/${$('#empresa_sesion_id').val()}/creditos`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta_empresa) {\n            if (respuesta_empresa?.data?.creditos_disponibles > 0) {\n                $.ajax({\n                    url: `/api/servicios-ia/${servicio_ia_id}/creditos`,\n                    method: 'GET',\n                    dataType: 'json',\n                    success: function(respuesta) {\n                        if (respuesta?.data?.consume_creditos && respuesta?.data?.consume_creditos <= respuesta_empresa.data.creditos_disponibles) {\n                            $('#cantidad-creditos-descontar-modal').text(respuesta.data.consume_creditos);\n                            $('#modal-consumo-creditos-ia').modal('show');\n                            mostro_modal_creditos_ia = true;\n                            modals_abiertos_ia = $('.modal.show').not('#modal-consumo-creditos-ia').not('#modal-generando-ia');\n                            $(modals_abiertos_ia).addClass('d-none');\n                        } else {\n                            mostrarToastSolicitarCreditosIA();\n                        }\n                    }\n                });\n            } else {\n                mostrarToastSolicitarCreditosIA();\n            }\n        }\n    });\n}\n\n/**\n * Mostrar toast para solicitar créditos IA\n * \n * @return void\n * @author José Manuel Jiménez\n */\nfunction mostrarToastSolicitarCreditosIA() {\n    $.ajax({\n        url: `/empresas/${$('#empresa_sesion_id').val()}`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            let adicional_toast = '';\n            if (respuesta?.data?.ejecutivo?.telefono) {\n                adicional_toast = `<a href=\"https://wa.me/${respuesta.data.ejecutivo.telefono.replace(/\\D/g, '')}?text=Hola,%20me%20gustar%C3%ADa%20solicitar%20cr%C3%A9ditos%20adicionales%20para%20mi%20empresa.\" target=\"_blank\">\n                    <p class=\"text-label-1 text-white no-visited text-decoration-none mb-0\">Solicitar</p>\n                </a>`;\n            }\n            setTimeout(() => {\n                $('#modal-generando-ia').modal('hide');\n                $('#modal-cargue-ia').modal('hide');\n                mostrarToast('danger', 'No cuentas con créditos. Solicita créditos adicionales.', '', adicional_toast);\n            }, 300);\n        }\n    });\n}\n\n/**\n * Continuar ejecución IA luego del modal de créditos\n * \n * @return void\n * @author José Manuel Jiménez\n */\nfunction continuarEjecucionIA() {\n    if (funcion_ejecucion_ia) {\n        funcion_ejecucion_ia();\n        funcion_ejecucion_ia = null;\n    }\n    mostro_modal_creditos_ia = false;\n    $('#modal-consumo-creditos-ia').modal('hide');\n}\n\n/**\n * Solicitar más créditos IA\n * \n * @return void\n * @author José Manuel Jiménez\n */\nfunction solicitarMasCreditosIA() {\n    $.ajax({\n        url: `/empresas/${$('#empresa_sesion_id').val()}`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            if (respuesta?.data?.ejecutivo?.telefono) {\n                window.open(`https://wa.me/${respuesta.data.ejecutivo.telefono.replace(/\\D/g, '')}?text=Hola,%20me%20gustar%C3%ADa%20solicitar%20cr%C3%A9ditos%20adicionales%20para%20mi%20empresa.`, '_blank');\n            } else {\n                mostrarToast('danger', 'No se encontró un ejecutivo asignado a la empresa. Por favor, comunícate con soporte para recargar créditos.');\n            }\n            $('#modal-solicitar-mas-creditos-ia').modal('hide');\n        }\n    });\n}\n\n/**\n * Validar respuesta de créditos IA\n * \n * @return void\n * @author José Manuel Jiménez\n */\nfunction validarRespuestaCreditosIA(error_ia) {\n    if (error_ia == 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.') {\n        mostrarToastSolicitarCreditosIA();\n        return true;\n    }\n    return false;\n}\n\n/**\n * Ajustar el ancho de los elementos select2 asincrono multiple.\n *\n * @returns {void}\n * @author Andres Morales\n */\n$(document).ready(function () {\n    cargarNotificiacionesHeader();\n    if (window.configuracion_reverbg && window.configuracion_reverbg.activar_websocket) {\n        configurarWebSocketNotificaciones();\n    }\n    setTimeout(() => {\n        $(\".input-container\").each(function () {\n            let $container = $(this);\n            let $select = $container.find(\"select[multiple]\");\n            let $icon = $container.find(\".input-icono1\");\n            if ($select.length && $icon.length) {\n                $(this).find('.select2-selection--multiple').addClass('ps-5')\n            }\n        });\n    }, 1000);\n    $('#modal-consumo-creditos-ia').on('hidden.bs.modal', function () {\n        if (mostro_modal_creditos_ia) {\n            $(modals_abiertos_ia).removeClass('d-none');\n        }\n        mostro_modal_creditos_ia = false;\n    });\n\n    // Cargar créditos disponibles si existe el contenedor y el ID de empresa\n    if ($('#contenedor-tag-creditos').length && $('#empresa_sesion_id').length) {\n        obtenerCreditosDisponiblesEmpresa($('#empresa_sesion_id').val());\n    }\n});\n\n/**\n * Formatear fecha a formato dd/mm/yyyy - hh:mm AM/PM.  Ejemplo: 01/Feb/2022 - 12:00 PM\n *\n * @param {string} fecha_entrada fecha en formato ISO\n * @returns {string} fecha y hora formateada\n * @author Andres Morales\n */\nfunction formatearFecha(fecha_entrada) {\n    var fecha = new Date(fecha_entrada);\n    var dia = fecha.getDate();\n    var mes = fecha.toLocaleString('es-ES', { month: 'short' });\n    var anio = fecha.getFullYear();\n    let hora = fecha.getHours();\n    let minuto = fecha.getMinutes();\n    let ampm = hora >= 12 ? 'PM' : 'AM';\n    hora = hora % 12 || 12;\n    minuto = minuto.toString().padStart(2, '0');\n    return `${dia}/${mes}/${anio} - ${hora}:${minuto} ${ampm}`;\n}\n\nfunction formatearFecha2(fecha_entrada) {\n    let partes = fecha_entrada.split(' ');\n    let fecha = partes[0].split('-');\n    let hora = partes[1];\n    let fechaISO = `${fecha[2]}-${fecha[1]}-${fecha[0]}T${hora}`;\n\n    let date = new Date(fechaISO);\n\n    if (isNaN(date.getTime())) {\n        return 'Fecha inválida';\n    }\n\n    let dia = date.getDate();\n    let mes = date.toLocaleString('eu-EU', { month: 'short' });\n    let anio = date.getFullYear();\n    return `${dia}/${mes}/${anio}`;\n}\n\n/**\n * Opción para contraer o agrandar el menú principal\n *\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Andres Morales\n */\nfunction contraerMenu() {\n    if ($('.sidebar-menu').hasClass('close')) {\n        $('.sidebar-menu').removeClass('d-none');\n        localStorage.setItem('opcion_menu_storage', 'abierto');\n        $('#btn-collapse').attr('data-bs-original-title', 'Contraer');\n        $('#btn-collapse').attr('data-bs-title', 'Contraer');\n        $(\".menu-bar\").each(function() {\n            $(this).removeClass(\"px-2\").addClass(\"px-5\");\n        });\n        $('[data-bs-toggle=\"tooltip\"]').each(function () { new bootstrap.Tooltip(this); });\n        $('.lista-primary[data-bs-toggle=\"tooltip\"]').each(function () {\n            var tooltip_instancia = bootstrap.Tooltip.getInstance(this);\n            if (tooltip_instancia) {\n                tooltip_instancia.dispose();\n            }\n        });\n    } else {\n        $('.sidebar-menu').addClass('d-none');\n        localStorage.setItem('opcion_menu_storage', 'cerrado');\n        $('#btn-collapse').attr('data-bs-original-title', 'Expandir');\n        $('#btn-collapse').attr('data-bs-title', 'Expandir');\n        $(\".menu-bar\").each(function() {\n            $(this).removeClass(\"px-5\").addClass(\"px-2\");\n        });\n        $('[data-bs-toggle=\"tooltip\"]').each(function () { new bootstrap.Tooltip(this); });\n    }\n    $('.tooltip.bs-tooltip-auto').remove();\n    $('.sidebar-menu').toggleClass('close');\n    $('.contenedor-vista').toggleClass('close');\n    $('#btn-collapse').toggleClass('close');\n    $('.nombre-usuario-empresa').toggle();\n    $('.menu-bar .text-menu').toggle();\n}\n\n/**\n * Opción para abrir o cerrar el menu segun la elección guardada\n *\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Andres Morales\n */\nfunction mostrarMenuStorage() {\n    $(document).ready(function() {\n        $('.lista-primary[data-bs-toggle=\"tooltip\"]').each(function () {\n            var tooltip_instancia = bootstrap.Tooltip.getInstance(this);\n            if (tooltip_instancia) {\n                tooltip_instancia.dispose();\n            }\n        });\n\n        if (window.innerWidth < 768) {\n            localStorage.setItem('opcion_menu_storage', 'cerrado');\n        }\n\n        if (localStorage.getItem('opcion_menu_storage') === 'cerrado') {\n            contraerMenu();\n        }\n        let $active = $('.menu-bar .active');\n\n        if ($active.length) {\n            $('.menu-bar').scrollTop($active.position().top);\n        }\n    });\n}\nmostrarMenuStorage();\n\n/**\n * Funcion para hacer el slug de un texto desde jquery.\n *\n * @returns {void}\n * @author Andres Morales\n */\nfunction slugify(text) {\n    return $.trim(text)\n        .toLowerCase()\n        .normalize(\"NFD\")\n        .replace(/[\\u0300-\\u036f]/g, \"\")\n        .replace(/[^a-z0-9 -]/g, \"\")\n        .replace(/\\s+/g, \"-\")\n        .replace(/-+/g, \"-\");\n}\n\n/**\n * Función generica para mostrar mensajes de respuesta\n *\n * @param {string} tipo_alerta define el color de la alerta segun alerts de botstrap.\n * @param {string} texto_1 Texto que mostrara la alerta.\n * @param {string} texto_2 Texto secundario en la alerta.\n * @param {string} accion Acción adicional(por definir).\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Andres Gonzalez\n */\nfunction mostrarToast(tipo_alerta, texto_1, texto_2 = '', accion = '', icono2 = '') {\n    let icono = '';\n    let texto_color = 'text-white';\n    if (accion != '') {\n        accion = `<div class=\"col-auto p-0 text-label-1\">${accion}</div>`;\n    }\n\n    if (tipo_alerta == 'success') {\n        icono = 'bi bi-check-circle';\n    }\n\n    if (tipo_alerta == 'neutral') {\n        icono = 'bi bi-info-circle';\n    }\n\n    if (tipo_alerta == 'warning') {\n        icono = 'bi bi-info-circle';\n        texto_color = \"text-red-letras\";\n    }\n\n    if (tipo_alerta == 'danger') {\n        icono = 'bi bi-x-circle';\n    }\n\n    if (icono2 != '') {\n        icono = icono2;\n    }\n\n    if (texto_2 != '') {\n        texto_2 = `<div class=\"col-12 p-0 text-label-1 ${texto_color}\">${texto_2}</div>`;\n    }\n\n    let alert_toast = $(`\n        <div class=\"alert toast-${tipo_alerta} alert-dismissible fade show d-flex align-items-center pe-3 py-3 me-3\" role=\"alert\" style=\"display:none\">\n            <div class=\"col-auto\">\n                <span class=\"${icono} ${texto_color}\"></span>\n            </div>\n            <div class=\"col px-3\">\n                <div class=\"row m-0 ${texto_color}\">\n                    <div class=\"col-12 p-0 text-label-1 ${texto_color}\">\n                        ${texto_1}\n                    </div>\n                    ${texto_2}\n                </div>\n            </div>\n            ${accion}\n            <div class=\"col-auto ms-3 pointer\" data-bs-dismiss=\"alert\">\n                <span class=\"bi bi-x ${texto_color}\"></span>\n            </div>\n        </div>\n    `);\n    $('#contenedor-alert-toast').append(alert_toast);\n    alert_toast.fadeIn();\n    setTimeout(function() {\n        alert_toast.fadeOut();\n        alert_toast.alert('close');\n    }, 5000);\n}\n\n/**\n * Formatear número.\n *\n * @param {number} numero número a formatear\n * @author Andres Morales\n */\nfunction formatearNumero(numero) {\n    return parseInt(numero).toLocaleString('es-ES');\n}\n\n/**\n * Formatear fecha.\n *\n * @param {*} fecha Fecha a formatear.\n * @param {boolean} incluir_segundos Indica si se debe incluir los segundos en la hora.\n * @param {string} formato Formato en el que se retornará la fecha.\n * @param {string} separador Símbolo que se usará para separar días, meses y años.\n * @returns {Object} Objeto con la fecha y hora formateada.\n * @author Daniel Beltrán\n */\nfunction formatearFechaConceptual(fecha, incluir_segundos = false, formato = 'Ymd', separador = '-') {\n    const NUEVA_FECHA = new Date(fecha);\n    const ANO         = NUEVA_FECHA.getFullYear();\n    const MES         = String(NUEVA_FECHA.getMonth() + 1).padStart(2, '0');\n    const DIA         = String(NUEVA_FECHA.getDate()).padStart(2, '0');\n    const HORAS       = String(NUEVA_FECHA.getHours()).padStart(2, '0');\n    const MINUTOS     = String(NUEVA_FECHA.getMinutes()).padStart(2, '0');\n    const SEGUNDOS    = String(NUEVA_FECHA.getSeconds()).padStart(2, '0');\n\n    let fecha_formateada = `${ANO}${separador}${MES}${separador}${DIA}`;\n\n    if (formato === 'dmY') {\n        fecha_formateada = `${DIA}${separador}${MES}${separador}${ANO}`;\n    }\n\n    return {\n        fecha: fecha_formateada,\n        hora : incluir_segundos ? `${HORAS}:${MINUTOS}:${SEGUNDOS}` : `${HORAS}:${MINUTOS}`\n    };\n}\n\n/**\n * Formatear fecha a May. 2023.\n *\n * @param {string} fechaISO Fecha a formatear.\n * @returns {string} Objeto con la fecha y hora formateada.\n * @author Andres Morales\n */\nfunction formatearFechaAnioMes(fechaISO) {\n    const fecha = new Date(fechaISO);\n    const opciones = { month: 'short', year: 'numeric' };\n    let fecha_formateada = fecha.toLocaleDateString('es-ES', opciones);\n\n    fecha_formateada = fecha_formateada.replace(\n        /^([a-zñ]+)(\\s\\d{4})$/,\n        (_, mes, anio) => `${mes.charAt(0).toUpperCase() + mes.slice(1)}. ${anio.trim()}`\n    );\n\n    return fecha_formateada;\n}\n\n/**\n * Formatear un numero a moneda.\n *\n * @param {string} valor Numero.\n * @returns {string} Numero formateado.\n * @author Andres Morales\n */\nfunction formatearMonedaCOP(valor) {\n    return new Intl.NumberFormat('es-CO', {\n        style: 'currency',\n        currency: 'COP',\n        minimumFractionDigits: 0,\n        maximumFractionDigits: 0\n    }).format(valor);\n}\n\n/**\n * Formatear fecha a un formato d/m/Y hh:mm:ss entendible para el usuario.\n *\n * @param {*} fecha_inicial Fecha a formatear.\n * @returns {String} String con la fecha y hora formateada.\n * @author José Manuel Jiménez\n */\nfunction fechaMostrar(fecha_inicial) {\n    if (!fecha_inicial) {\n        return \"\";\n    }\n    const fecha = new Date(fecha_inicial);\n    if (isNaN(fecha.getTime())) {\n        return \"\";\n    }\n    const dia = String(fecha.getUTCDate()).padStart(2, '0');\n    const mes = String(fecha.getUTCMonth() + 1).padStart(2, '0');\n    const anio = fecha.getUTCFullYear();\n    if (!fecha_inicial.includes(\" \")) {\n        return `${dia}/${mes}/${anio}`;\n    }\n    const horas = String(fecha.getUTCHours()).padStart(2, '0');\n    const minutos = String(fecha.getUTCMinutes()).padStart(2, '0');\n    const segundos = String(fecha.getUTCSeconds()).padStart(2, '0');\n    return `${dia}/${mes}/${anio} ${horas}:${minutos}:${segundos}`;\n}\n\n/**\n * Descargar Excel.\n *\n * @param {string} ruta Ruta desde donde se descarga el archivo.\n * @param {string} nombre_archivo Nombre del archivo descargado.\n * @param {boolean} marca_tiempo Indica si el nombre del archivo debe llevar marca de tiempo.\n * @param {Object} parametros Parámetros a enviar en la petición.\n * @returns {void}\n * @author Daniel Beltrán\n */\nasync function descargarExcel(ruta, nombre_archivo, marca_tiempo = true, parametros = {}) {\n    parametros._token = $('meta[name=\"csrf-token\"]').attr('content');\n\n    await $.ajax({\n        type     : 'POST',\n        url      : `/${ruta}`,\n        data     : parametros,\n        xhrFields: {\n            responseType: 'blob'\n        },\n        success: function (respuesta) {\n            // Crear una URL para el Blob\n            let url = window.URL.createObjectURL(respuesta); // 'respuesta' es el Blob\n            let a   = document.createElement('a'); // Crea un nuevo elemento <a> para iniciar la descarga\n            a.href  = url;\n            const fecha_actual     = new Date();\n            const dia              = fecha_actual.getDate();\n            const mes              = fecha_actual.getMonth() + 1;\n            const ano              = fecha_actual.getFullYear();\n            const hora             = fecha_actual.getHours();\n            const minutos          = fecha_actual.getMinutes();\n            const segundos         = fecha_actual.getSeconds();\n            const fecha_formateada = `${dia}${mes}${ano}${hora}${minutos}${segundos}`;\n\n            a.download = marca_tiempo ? `${nombre_archivo}-${fecha_formateada}.xlsx` : `${nombre_archivo}.xlsx`;\n            document.body.appendChild(a);\n            a.click();\n            window.URL.revokeObjectURL(url);\n            document.body.removeChild(a);\n        }\n    }).then(() => {\n        mostrarToast('success', 'Archivo descargado correctamente.');\n    }).catch((error) => {\n        mostrarToast('danger', 'Ocurrió un error al descargar el archivo.');\n    });\n}\n\n/**\n * Convierte un string a slug.\n *\n * @param {string} str\n * @returns {string}\n * @author Fahibram Cárcamo\n */\nfunction slug(str) {\n\n    // Quita espacios en blanco\n    str = str.replace(/^\\s+|\\s+$/g, \"\")\n\n    // Convierte el string a minusculas\n    str = str.toLowerCase()\n\n    // Quita los caracteres no alfanuméricos\n    str = str.replace(/[^a-z0-9 -]/g, \"\")\n\n    // Reemplaza los espacio con guiones\n    str = str.replace(/\\s+/g, \"-\")\n\n    // Remueve los guiones consecutivos\n    str = str.replace(/-+/g, \"-\")\n\n    return str\n}\n\n/**\n * Compara los elementos de dos arreglos y retorna `true` si son iguales y `false` en caso contrario\n * (Este función está pensada para comparar arreglos unidimensionales).\n *\n * @param {array} primer_arreglo\n * @param {array} segundo_arreglo\n * @param {boolean} comparar_orden\n * @return {boolean}\n * @author Fahibram Cárcamo\n */\nfunction sonArreglosIguales(primer_arreglo, segundo_arreglo, comparar_orden = false) {\n\n    if (!comparar_orden) {\n        primer_arreglo.sort()\n        segundo_arreglo.sort()\n    }\n\n    if (primer_arreglo.length !== segundo_arreglo.length) return false\n\n    for (let i = 0; i < primer_arreglo.length; i++) {\n        if (primer_arreglo[i] !== segundo_arreglo[i]) return false\n    }\n\n    return true\n}\n\n/**\n * Función para cambiar de empresa.\n *\n * @param {number} empresa_id ID de la empresa a la que se va a cambiar.\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Daniel Beltrán\n */\nfunction cambiarEmpresa(empresa_id) {\n    $.ajax({\n        type: 'POST',\n        url: '/suplantar-rol-admin-general',\n        data: {\n            _token    : $('meta[name=\"csrf-token\"]').attr('content'),\n            empresa_id: empresa_id\n        },\n        success: function (respuesta) {\n            localStorage.setItem('notificacionToast', JSON.stringify({\n                tipo_alerta: 'success',\n                texto_1    : 'Cambio de empresa exitoso'\n            }));\n\n            window.location.reload();\n        },\n        error: function (error) {\n            mostrarToast('danger', 'Ocurrió un error al cambiar de empresa');\n        }\n    });\n}\n\n/**\n * Enviar la solucitud de suplantación de rol y empresa al Back-end.\n *\n * @param {function|null} callback_exito Callback ejecutado en caso de éxito.\n * @param {string} url URL de suplantación.\n * @param {string} _token Token CSRF del formulario.\n * @param {number} empresa_id Id de la empresa a suplantar.\n * @param {number|null} rol_id Id del rol a suplantar.\n * @param {function|null} callback_error Callback ejecutado en caso de error.\n * @returns {void}\n * @author Fahibram Cárcamo\n */\nasync function enviarOrdenSuplantacionRolEmpresa (callback_exito, url, _token, empresa_id = null, rol_id = null, callback_error = null) {\n\n    let condicion_suplantacion = rol_id === null\n        ? empresa_id === null\n            ? true\n            : parseInt($('#empresa_sesion_id').val()) !== parseInt(empresa_id)\n        : parseInt($('#rol_sesion_id').val()) !== parseInt(rol_id) && parseInt($('#empresa_sesion_id').val()) !== parseInt(empresa_id);\n\n    if (condicion_suplantacion) {\n        let data = { _token };\n        if (empresa_id !== null) data.empresa_id = empresa_id;\n        if (rol_id !== null) data.rol_id = rol_id;\n\n        await $.ajax({ type: 'POST', url, data })\n            .then((respuesta, status, xhr) => {\n                if (xhr.status >= 200 && xhr.status < 300 && callback_exito !== null) callback_exito();\n            })\n            .catch(error => {\n                let swal_titulo, swal_texto;\n\n                if (error.status === 404) {\n                    if (error.responseJSON.mensaje) {\n                        swal_titulo = 'Algo salió mal';\n                        if (error.responseJSON.mensaje === 'no existe rol_suplantar') {\n                            swal_texto = 'El rol no existe.';\n                        } else if (error.responseJSON.mensaje === 'no existe empresa_suplantar') {\n                            swal_texto = 'La empresa no existe.';\n                        } else if (error.responseJSON.mensaje === 'no existe usuario_suplantar') {\n                            swal_texto = 'El usuario no existe.';\n                        } else {\n                            swal_texto = '';\n                        }\n                    } else if (error.responseJSON.empresa && error.responseJSON.rol) {\n                        swal_titulo = 'No fué posible cambiar de empresa';\n                        swal_texto = error.responseJSON.rol === 'Administrador general' || error.responseJSON.rol === 'Propietario'\n                            ? `La empresa ${error.responseJSON.empresa} no tiene ningún usuario con el rol Administrador general o Propietario.`\n                            : `La empresa ${error.responseJSON.empresa} no tiene ningún usuario con el rol ${error.responseJSON.rol}.`;\n                    } else {\n                        swal_titulo = 'Algo salió mal';\n                        swal_texto = error.responseJSON.errors;\n                    }\n                } else {\n                    swal_titulo = 'Algo salió mal';\n                    swal_texto = '';\n                }\n\n                if (callback_error !== null) callback_error();\n\n                Swal.fire({\n                    title: swal_titulo,\n                    text: swal_texto,\n                    icon: \"error\",\n                    confirmButtonText: \"Aceptar\"\n                });\n            });\n    }\n}\n\n/**\n * Mostrar tooltip según el div que lo contenga.\n *\n * @param {div} div Elemento en donde se va a mostrar el tooltip.\n * @returns {void}\n * @author Sol Espitia\n */\nfunction mostrarTooltip(div) {\n    const TOOLTIP         = div.querySelector('.tooltip-x');\n    TOOLTIP.style.display = 'block';\n}\n\n/**\n * Ocultar tooltip según el div que lo contenga.\n *\n * @param {div} div Elemento en donde se va a mostrar el tooltip.\n * @returns {void}\n * @author Sol Espitia\n */\nfunction ocultarTooltip(div) {\n    const TOOLTIP         = div.querySelector('.tooltip-x');\n    TOOLTIP.style.display = 'none';\n}\n\n/**\n * Retornar la diferencia en días de dos fechas dadas.\n *\n * @param {string} fecha_inicial Fecha inicial\n * @param {string} fecha_final Fecha final\n * @param {bool} valor_absoluto Retorna la diferencia en valor absoluto\n * @returns {number}\n * @author Fahibram Cárcamo\n * @author Andres Morales\n */\nfunction diferenciaFechasDias(fecha_inicial, fecha_final, valor_absoluto = false, sumar_dia = true) {\n    let fecha1 = new Date(fecha_inicial);\n    let fecha2 = new Date(fecha_final);\n\n    fecha1.setHours(0, 0, 0, 0);\n    fecha2.setHours(0, 0, 0, 0);\n\n    let diferencia_milisegundos = fecha2.getTime() - fecha1.getTime();\n\n    let diferencia_dias = diferencia_milisegundos / (1000 * 60 * 60 * 24);\n    let resultado = diferencia_dias;\n    if (sumar_dia) {\n        resultado = diferencia_dias + 1;\n    }\n\n    return valor_absoluto ? Math.abs(resultado) : resultado;\n}\n\n/**\n * Retornar `true` si una fecha dada está dentro de un rango de fechas dadas, `false` en otro caso.\n *\n * @param {string} fecha Fecha dada\n * @param {string} fecha_desde Fecha inicial del rango\n * @param {string} fecha_hasta Fecha final del rango\n * @returns {boolean}\n * @author Fahibram Cárcamo\n */\nfunction fechaDentroDelRango(fecha, fecha_desde, fecha_hasta) {\n    fecha = new Date(fecha);\n    fecha_desde = new Date(fecha_desde);\n    fecha_hasta = new Date(fecha_hasta);\n\n    if (isNaN(fecha) || isNaN(fecha_desde) || isNaN(fecha_hasta)) {\n        throw new Error('Una o más fechas no son válidas.');\n    }\n\n    return fecha >= fecha_desde && fecha <= fecha_hasta;\n}\n\n/**\n * Descuenta el tiempo para las respuestas.\n *\n * @param id - ID del elemento HTML donde mostrar el tiempo\n * @param tiempo - Tiempo inicial en segundos\n * @author Jair Carvajal\n */\nvar tiempos_usados = {};\n\nfunction descuentoTiempo(id, tiempo, callback, onTick) {\n    var $elemento = $('#' + id);\n    if ($elemento.length === 0) {\n        console.error('Elemento con id \"' + id + '\" no encontrado.');\n        return;\n    }\n    if (tiempos_usados[id]) {\n        clearInterval(tiempos_usados[id]);\n    }\n    let tiempoTotal = tiempo;\n    tiempos_usados[id] = setInterval(function() {\n        if (tiempo <= 0) {\n            clearInterval(tiempos_usados[id]);\n            delete tiempos_usados[id];\n            $elemento.text('Tiempo finalizado');\n            if (window.tiempoFinalizado()) {\n                tiempoFinalizado();\n            }\n            if (typeof callback === 'function') {\n                callback();\n            }\n            return;\n        }\n\n        var minutos = Math.floor(tiempo / 60);\n        var segundos = tiempo % 60;\n\n        var textoTiempo = minutos + ':' + (segundos < 10 ? '0' : '') + segundos + '<i class=\"bi bi-alarm ms-2\"></i>';\n\n        if (tiempo <= 15) {\n            $elemento.addClass('text-state-red');\n            $elemento.removeClass('text-state-green');\n        } else {\n            $elemento.addClass('text-state-green');\n            $elemento.removeClass('text-state-red');\n        }\n\n        $elemento.html(textoTiempo);\n\n        var tiempoUsado = tiempoTotal - tiempo;\n\n        if (typeof onTick === 'function') {\n            onTick((tiempoUsado % 5));\n        }\n        tiempo--;\n    }, 1000);\n}\n\n/**\n * Detengo el tiempo para las respuestas.\n *\n * @param id - ID del elemento HTML donde mostrar el tiempo\n * @param tiempo - Tiempo inicial en segundos\n * @author Jair Carvajal\n */\nfunction detenerDescuentoTiempo(id) {\n    if (tiempos_usados[id]) {\n        clearInterval(tiempos_usados[id]);\n        delete tiempos_usados[id];\n    }\n}\n\n/**\n * Genera un SVG de la imagen de usuario.\n *\n * @param id ID del usuario.\n * @param nombres Nombres del usuario.\n * @param apellidos Apellidos del usuario.\n * @return image\n * @author Andres Morales\n */\nfunction crearImagenUsuarioLetras(id, nombres, apellidos) {\n    var tamano = 200;\n    var iniciales = (nombres[0] + apellidos[0]).toUpperCase();\n    var hash = md5(id);\n\n    var r = parseInt(hash.substring(0, 2), 16);\n    var g = parseInt(hash.substring(2, 4), 16);\n    var b = parseInt(hash.substring(4, 6), 16);\n    var colorFondo = `rgb(${r},${g},${b})`;\n\n    var luminancia = 0.299 * r + 0.587 * g + 0.114 * b;\n    var colorTexto = luminancia > 150 ? \"#000000\" : \"#FFFFFF\";\n\n    // SVG como texto\n    var svg = `\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${tamano}\" height=\"${tamano}\">\n        <rect width=\"100%\" height=\"100%\" fill=\"${colorFondo}\" />\n        <text x=\"50%\" y=\"50%\" dy=\".35em\"\n            text-anchor=\"middle\"\n            font-family=\"Lato, sans-serif\"\n            font-size=\"${tamano * 0.4}\"\n            fill=\"${colorTexto}\">\n            ${iniciales}\n        </text>\n    </svg>`;\n    var svgEncoded = encodeURIComponent(svg)\n        .replace(/'/g, \"%27\")\n        .replace(/\"/g, \"%22\");\n\n    var dataUri = `data:image/svg+xml,${svgEncoded}`;\n    return dataUri;\n}\n\n/**\n * Carga las notificaciones\n *\n * @return void\n * @author Andres Morales\n * @author Andres Gonzalez\n * @author Esperanza Olivo\n */\nfunction cargarNotificiacionesHeader() {\n    $.ajax({\n        url: '/usuario-notificaciones',\n        type: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            let datos = respuesta.data;\n            let notificaciones_noleidas = datos?.unread_notifications?.length ?? 0;\n\n            // Siempre remover el badge existente\n            $('#dropdownNotificaciones #badge-notificaciones').remove();\n\n            // Solo agregar el badge si hay notificaciones no leídas\n            if (notificaciones_noleidas > 0) {\n                $('#dropdownNotificaciones').append(`<span id=\"badge-notificaciones\" class=\"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger border border-white\">${notificaciones_noleidas}</span>`);\n                $('#contador-notificaciones-abierto').append(`<span id=\"badge-notificaciones\" class=\"badge rounded-pill bg-danger border border-white\">${notificaciones_noleidas}</span>`);\n\n                $('#contenedor-boton-marcar-todas').html(`\n                    <button class=\"btn btn-link text-primary w-100 d-flex justify-content-center\" onclick=\"marcarNotificacionesLeidas('all')\">\n                        Marcar todo como leído\n                    </button>\n                `);\n            }\n\n            let no_leidos_ids = Array.isArray(datos?.unread_notifications) ? datos.unread_notifications.map(notificacion => notificacion.id): [];\n\n            if (Array.isArray(datos?.notifications) && datos.notifications.length > 0) {\n                $('#notificacion-sinnotificaciones').hide();\n                $('.notificaciones-listado').remove();\n                datos.notifications.forEach(notificacion => {\n                    const { id, data, updated_at } = notificacion;\n\n                    const NO_LEIDO = no_leidos_ids.includes(id);\n                    const MENSAJE = (data?.mensaje || '').slice(0, 120) + '...';\n                    const HORA = new Date(updated_at).toLocaleTimeString('es-CO', {\n                        hour: '2-digit',\n                        minute: '2-digit',\n                        hour12: false\n                    });\n\n                    const notificaciones = `\n                        <li class=\"${NO_LEIDO ? '' : 'bg-gray-90'} notificaciones-listado py-0\" id=\"notificacion-${id}\">\n                            <a class=\"dropdown-item text-gray-10 text-decoration-none border-top pt-0 pb-1\" href=\"javascript:void(0)\" onclick=\"marcarNotificacionesLeidas('${id}','${data?.ruta}')\">\n                                <div class=\"d-flex justify-content-between\">\n                                    <div class=\"w-auto flex-grow-1 pe-3\">\n                                        <p class=\"mt-1 mb-0 text-headline-6 text-gray-10\">${data?.titulo}</p>\n                                        <p class=\"mb-0 text-body-3 text-gray-30 notificacion-mensaje\">${MENSAJE}</p>\n                                    </div>\n                                    <div class=\"w-auto my-auto ${NO_LEIDO ? 'text-cta-azul' : 'text-gray-10'} text-label-2 flex-shrink-0\">\n                                        ${HORA}${NO_LEIDO ? `<i class=\"bi bi-circle-fill text-cta-azul my-auto texto-notificacion-icono ms-3\"></i>` : ''}\n                                    </div>\n                                </div>\n                            </a>\n                        </li>\n                    `;\n\n                    $(notificaciones).insertBefore('#contenedor-boton-marcar-todas');\n                });\n\n            } else {\n                $('#notificacion-sinnotificaciones').hide();\n                $('.notificaciones-listado').remove();\n            }\n\n        },\n        error: function(xhr, status, error) {\n            console.error('Error al cargar notificaciones:', error);\n        }\n    });\n}\n\n/**\n * Marcar las notificaciones leídas.\n *\n * @param {array} notificaciones_ids ids de las notificaciones\n * @param {string} ruta_destino ruta donde se va ha actualizar la pagina\n * @returns {void}\n * @author Andres Gonzalez\n * @author Esperanza Olivo\n */\nfunction marcarNotificacionesLeidas(notificaciones_ids = null, ruta_destino = null, soporte_id = null) {\n\n    let data = {\n        _token: $('meta[name=\"csrf-token\"]').attr('content')\n    };\n\n    if (notificaciones_ids === 'all') {\n        data.marcar_todo = true;\n    } else if (soporte_id) {\n        data.soporte_id = soporte_id;\n    } else if (notificaciones_ids) {\n        data.notificaciones_ids = Array.isArray(notificaciones_ids)\n            ? notificaciones_ids\n            : [notificaciones_ids];\n    }\n\n    $.ajax({\n        url: '/usuario-marcar-notificaciones-leidas',\n        type: 'POST',\n        data: data,\n        success: function(respuesta) {\n            cargarNotificiacionesHeader();\n\n            if (notificaciones_ids && notificaciones_ids !== 'all' && ruta_destino) {\n                window.location.href = \"/\" + ruta_destino;\n            }\n\n            if (notificaciones_ids === 'all') {\n                $('#badge-notificaciones').remove();\n                $('#contenedor-boton-marcar-todas').empty();\n                $('.notificaciones-listado').addClass('bg-gray-90');\n                $('.bi-circle-fill').remove();\n            }\n        },\n        error: function(xhr, estatus, error) {\n            console.error('Error al cargar notificaciones:', error);\n        }\n    });\n}\n\n/**\n * Configurar WebSocket para notificaciones en tiempo real\n *\n * @return void\n * @author Andres Gonzalez\n */\nfunction configurarWebSocketNotificaciones() {\n    try {\n        if (!window.configuracion_reverbg) {\n            return;\n        }\n\n        const PUSHER = new Pusher(window.configuracion_reverbg.appKey, {\n            wsHost: window.configuracion_reverbg.host,\n            wsPort: window.configuracion_reverbg.port,\n            wssPort: window.configuracion_reverbg.port,\n            cluster: 'mt1',\n            forceTLS: false,\n            enabledTransports: ['ws', 'wss'],\n            authEndpoint: '/broadcasting-auth',\n            auth: {\n                headers: {\n                    'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\n                }\n            }\n        });\n\n        PUSHER.connection.bind('failed', function() {\n            console.error('❌ Conexión WebSocket falló');\n        });\n\n        PUSHER.connection.bind('error', function(error) {\n            console.error('❌ Error de WebSocket:', error);\n        });\n\n        let usuario_id = window.configuracion_reverbg.usuario_id;\n\n        if (!usuario_id) {\n            return;\n        }\n\n        const NOMBRE_CANAL = `private-App.Models.Usuarios.User.${usuario_id}`;\n        const CANAL = PUSHER.subscribe(NOMBRE_CANAL);\n\n        CANAL.bind('pusher:subscription_error', function(error) {\n            console.error('❌ Error al suscribirse al canal:', error);\n        });\n\n        // Escuchar eventos específicos de notificaciones\n        CANAL.bind('Illuminate\\\\Notifications\\\\Events\\\\BroadcastNotificationCreated', function(data) {\n            if (data.tipo === 'nueva_notificacion') {\n                audio_notificacion.play();\n                cargarNotificiacionesHeader();\n            }\n\n            if (data.tipo === 'nuevo_mensaje') {\n                if (($('#soporte-guardado-id').val() == data.soporte_id) || ($('#soporte_empresa_id').val() == data.soporte_id)) {\n                    audio_notificacion.play();\n                    consultarChat(data.soporte_id);\n                }\n            }\n        });\n    } catch (error) {\n        console.error('💥 Error en configurarWebSocketNotificaciones:', error);\n        console.error('Stack trace:', error.stack);\n    }\n}\n\n/**\n * Retornar el string entrante en formato title case.\n *\n * @param {string} texto\n * @returns {string}\n * @author Fahibram Cárcamo\n */\nfunction titleCase(texto) {\n    return texto.toLowerCase().replace(/\\b\\w/g, caracter => caracter.toUpperCase());\n}\n\n/**\n * Número de horas que durará el almacenamiento de la variable `ulitmas_empresas` en el\n * almacenamiento local **LocalStorage**.\n *\n * @var {number}\n * @author Fahibram Cárcamo\n */\nconst CANTIDAD_HORAS_VENCIMIENTO_ULTIMAS_EMPRESAS_LOCALSTORAGE = 6;\n\n/**\n * Validar si ya debe removerse la variable `ultimas_empresas` del alamacenamiento local\n * **LocalStorage**, si no es tiempo de eliminarla entonces se reinicia el tiempo de vigencia de la\n * variable.\n *\n * @returns {void}\n * @author Fahibram Cárcamo\n */\nfunction validarYActualizarUltimasEmpresasLocalStorage() {\n    let fecha_hora_actuales = moment();\n    let fecha_hora_vencimiento_ultimas_empresas = fecha_hora_actuales.clone().add(CANTIDAD_HORAS_VENCIMIENTO_ULTIMAS_EMPRESAS_LOCALSTORAGE, 'hours');\n    let fecha_hora_vencimiento_ultimas_empresas_localstorage = localStorage.getItem('vencimiento_ultimas_empresas');\n    let ultimas_empresas = localStorage.getItem('ultimas_empresas');\n\n    if (\n        ultimas_empresas != null &&\n        fecha_hora_vencimiento_ultimas_empresas_localstorage != null &&\n        fecha_hora_actuales.clone().isBefore(moment(fecha_hora_vencimiento_ultimas_empresas_localstorage).clone())\n    ) {\n        localStorage.setItem('vencimiento_ultimas_empresas', fecha_hora_vencimiento_ultimas_empresas.format('YYYY-MM-DD HH:mm:ss'));\n        return;\n    }\n\n    localStorage.removeItem('vencimiento_ultimas_empresas');\n    localStorage.removeItem('ultimas_empresas');\n}\n\n/**\n * Obtener la edad actual de un usuario según su fecha de nacimiento.\n *\n * @param {string} fecha_nacimiento\n * @returns {string}\n * @author José Manuel Jiménez\n * @author Fahibram Cárcamo\n * @author Andres Morales\n */\nfunction obtenerEdad(fecha_nacimiento) {\n    if (!fecha_nacimiento) return \"N/A\";\n    let hoy = new Date();\n    let nacimiento = new Date(fecha_nacimiento);\n    let edad = hoy.getFullYear() - nacimiento.getFullYear();\n    let mes = hoy.getMonth() - nacimiento.getMonth();\n    if (mes < 0 || (mes === 0 && hoy.getDate() < nacimiento.getDate())) edad--;\n    return edad + \" años\";\n}\n\n/**\n * Restablecer un input de tipo file.\n *\n * @param {html} elemento_input_html Elemento input html.\n * @param {html} label_elemento_input_html Label del elemento input html.\n * @param {html} boton_eliminar_elemento_input_html Botón para eliminar archivo del elemento input html.\n * @author Fahibram Cárcamo\n */\nfunction reiniciarCampoArchivo(elemento_input_html, label_elemento_input_html, boton_eliminar_elemento_input_html) {\n    elemento_input_html.val('');\n    elemento_input_html.removeAttr('data-base64');\n    label_elemento_input_html.text('Ningún archivo seleccionado');\n    boton_eliminar_elemento_input_html.hide();\n\n    if (elemento_input_html.data('imagen')) {\n        $('#' + elemento_input_html.data('imagen')).val('');\n        $('#' + elemento_input_html.data('imagen') + '_previsualizacion').attr('src', '');\n        $('#' + elemento_input_html.data('imagen') + '_fondo_previsualizacion').removeClass('d-none');\n    }\n}\n\n/**\n * Definir un campo destinado a recibir un número de teléfono celular.\n *\n * Esta función debe llamarse en el evento ready del objeto global document:\n * `$(document).ready(...)`. Ademas debe incluirse un pequeño fragmento de código en la función\n * `validacionAdicional` para que se agregué el código del número de celular al valor de campo\n * cuando se envíe el formulario donde se encutra el campo.\n *\n * ```\n * if (\n *   $('#input_celular_id').length &&\n *   $('#input_celular_id').val() !== '' &&\n *   input_celular.getNumber() !== ''\n * ) {\n *   $('#input_celular_id').val(input_celular.getNumber().slice(1));\n * }\n * ```\n *\n * Donde `input_celular` es el objeto retornado por esta función.\n *\n * @param {string} input_celular_id Id del campo.\n * @param {string} nombre_input_celular Nombre del campo.\n * @param {string} placeholder_input_celular Placeholder del campo.\n * @param {boolean} obligatorio El campo es obligatorio en el formulario.\n * @returns {object}\n * @author Fahibram Cárcamo\n */\nfunction definirInputTipoCelular(input_celular_id, nombre_input_celular, placeholder_input_celular, obligatorio = true) {\n    /**\n     * 🌎 Campo para ingresar un número de telefono con selectór de código de país con banderas.\n     * Este componente se creó con la librería International Telephone Input\n     * (https://intl-tel-input.com).\n     *\n     * La linea hiddenInput: () => ({ phone: 'celular_contacto' }) tiene como función establecer el\n     * nombre del campo, es decir, la llave del par llave-valor que se adjuntará en los datos del\n     * formulario cuando se envíe, en este caso 'celular_contacto'.\n     *\n     * Las lienas autoPlaceholder: 'aggressive' y\n     * customPlaceholder: (placeholder, country) => 'Celular*' se usan para definir el placeholder\n     * del campo.\n     *\n     * Con $('#celular_contacto').attr('required', true); se establece el campo como requerido\n     * dentro del formulario, se hace de esta forma porque la librería no admite el atributo\n     * required directamente en el componente html.\n     *\n     * @author Fahibram Cárcamo\n     */\n    if (document.querySelector(`#${input_celular_id}`)) {\n        const dropdown_dinamico = document.createElement('div');\n        document.body.appendChild(dropdown_dinamico);\n\n        let campo_celular = window.intlTelInput(document.querySelector(`#${input_celular_id}`), {\n            nationalMode: true,\n            initialCountry: 'co',\n            separateDialCode: true,\n            autoInsertDialCode: false,\n            autoPlaceholder: 'aggressive',\n            dropdownContainer: dropdown_dinamico,\n            customPlaceholder: (placeholder, country) => placeholder_input_celular,\n            loadUtils: () => import('https://cdn.jsdelivr.net/npm/intl-tel-input@25.4.2/build/js/utils.js'),\n            onlyCountries: [\n                'CO', // Colombia\n                'EC', // Ecuador\n                'AR', // Argentina\n                'CL', // Chile\n                'VE', // Venezuela\n                'PE', // Perú\n                'BO', // Bolivia\n                'UY', // Uruguay\n                'PY', // Paraguay\n                'PA', // Panamá\n                'MX', // México\n                'CR', // Costa Rica\n                // 'PR', // Puerto Rico\n                'CU', // Cuba\n                // 'DO', // República Dominicana\n                'SV', // El Salvador\n                'GT', // Guatemala\n                'HN', // Honduras\n                'NI', // Nicaragua\n                'ES', // España\n                'US', // Estados Unidos\n                'GQ'  // Guinea Ecuatorial\n            ]\n        });\n\n        if (obligatorio) $(`#${input_celular_id}`).attr('required', true);\n\n        return campo_celular;\n    }\n\n    return null;\n}\n\n/**\n * Establece la validación adicional que se aplica a un campo de tipo celular antes de enviar sus\n * datos en un formulario.\n *\n * @param {HTMLInputElement} input Elemento HTML del campo de tipo celular.\n * @param {string} input_id Id del elemento HTML del campo de tipo celular.\n * @author Fahibram Cárcamo\n * @author Jair Carvajal\n */\nfunction validacionAdicionalInputTipoCelular(input, input_id) {\n    let numero_completo = input.getNumber();\n    let indicativo = '+' + input.getSelectedCountryData().dialCode;\n    let codigo_iso2_pais = input.getSelectedCountryData().iso2;\n    let numero_sin_indicativo = numero_completo.replace(indicativo, '');\n    $(`#indicativo_${input_id}`).val(indicativo);\n    $(`#codigo_iso2_pais_${input_id}`).val(codigo_iso2_pais);\n    $(`#${input_id}`).val(numero_sin_indicativo);\n}\n\n/**\n * Rellenar un input de tipo celular.\n *\n * @param {string} indicativo_celular Código del país del número de celular.\n * @param {string} codigo_pais_iso2 Código ISO2 del país del número de celular.\n * @param {string} numero_celular Número de celular sin código de país.\n * @param {string} input_celular_id ID del input de tipo celular.\n * @param {HTMLInputElement} input_celular Input de tipo celular.\n * @returns {void}\n * @author Daniel Beltrán\n * @author Fahibram Cárcamo\n */\nfunction rellenarInputCelular(indicativo_celular, codigo_pais_iso2, numero_celular, input_celular_id, input_celular) {\n    $(`#${input_celular_id}`).val(numero_celular);\n    if (![null, undefined].includes(codigo_pais_iso2)) input_celular.setCountry(codigo_pais_iso2);\n}\n\n/**\n * Convierte imágenes de base64 a Blob.\n *\n * @param {string} cadena_base_64 Base 64 de la imagen.\n * @returns {Promise<Array>}\n * @author Andres Gonzalez\n */\nfunction imagenBase64Blob(cadena_base_64) {\n    if (!cadena_base_64 || !cadena_base_64.startsWith('data:image')) return null;\n    let datos_base_64 = cadena_base_64.split(',')[1];\n    let tipo_mime = cadena_base_64.match(/data:(.*?);base64/)[1];\n    let caracteres_binarios = atob(datos_base_64);\n    let arreglo_bytes = new Array(caracteres_binarios.length).fill(0).map((_, i) => caracteres_binarios.charCodeAt(i));\n    let bytes_uint8 = new Uint8Array(arreglo_bytes);\n    return new Blob([bytes_uint8], { type: tipo_mime });\n}\n\n\n/**\n * Limpiar estructuras html innecesarias en el check editor.\n *\n * @param {string} html - Cadena HTML generada por CKEditor a limpiar\n * @returns {string} HTML limpio sin elementos específicos de CKEditor\n * @author Andres Gonzalez\n * @author Jair Carvajal\n */\nfunction limpiarHTMLCKEditor(html) {\n    // Remover todos los elementos con clases de CKEditor\n    html = html.replace(/<div class=\"ck[^\"]*\"[^>]*>.*?<\\/div>/gs, '');\n    html = html.replace(/<span class=\"[^\"]*ck[^\"]*\"[^>]*>/gi, '<span>');\n\n    // Limpiar spans de imagen inline\n    html = html.replace(/<span class=\"image-inline[^\"]*\"[^>]*>/gi, '');\n    html = html.replace(/<\\/span>/g, '');\n\n    // Remover elementos de upload y widgets\n    html = html.replace(/<div class=\"ck-image-upload[^\"]*\"[^>]*>.*?<\\/div>/gs, '');\n    html = html.replace(/<div class=\"ck-fake-selection[^\"]*\"[^>]*>.*?<\\/div>/gs, '');\n\n    // Remover atributos innecesarios\n    html = html.replace(/contenteditable=\"[^\"]*\"/gi, '');\n    html = html.replace(/data-cke-filler=\"[^\"]*\"/gi, '');\n\n    // Limpiar párrafos vacíos con br\n    html = html.replace(/<p><br[^>]*><\\/p>/gi, '');\n    html = html.replace(/<br data-cke[^>]*>/gi, '');\n\n    // Limpiar espacios múltiples y saltos de línea\n    html = html.replace(/\\s+/g, ' ');\n    html = html.replace(/>\\s+</g, '><');\n\n    return html.trim();\n}\n\n/**\n * Ordena estudios por fecha_inicio más reciente (de más nueva a más antigua).\n * Preserva los índices originales para permitir edición y eliminación correcta.\n *\n * @param {Array} estudios - Array de objetos con estudios\n * @returns {Array} Array de estudios ordenados con propiedad indice_original\n * @author Jair Carvajal\n */\nfunction ordenarEstudiosPorFecha(estudios) {\n    // Mapear con índice original\n    let estudios_con_indice = estudios.map((estudio, indice_original) => ({\n        ...estudio,\n        indice_original: indice_original\n    }));\n\n    // Ordenar estudios por fecha_inicio (más reciente primero)\n    let estudios_ordenados = estudios_con_indice.sort((a, b) => {\n        // Si ambos tienen fecha_inicio, ordenar por más reciente\n        if (a.fecha_inicio && b.fecha_inicio) {\n            return moment(b.fecha_inicio).diff(moment(a.fecha_inicio));\n        }\n        // Si solo uno tiene fecha_inicio, ese va primero\n        if (a.fecha_inicio && !b.fecha_inicio) return -1;\n        if (!a.fecha_inicio && b.fecha_inicio) return 1;\n        // Si ninguno tiene fecha_inicio, mantener orden original\n        return 0;\n    });\n\n    return estudios_ordenados;\n}\n\n/**\n * Ordena experiencias laborales por fecha: primero las que está trabajando actualmente (sin fecha_fin),\n * luego por fecha_fin más reciente.\n * Preserva los índices originales para permitir edición y eliminación correcta.\n *\n * @param {Array} experiencias - Array de objetos con experiencias laborales\n * @returns {Array} Array de experiencias ordenadas con propiedad indice_original\n * @author Jair Carvajal\n */\nfunction ordenarExperienciasPorFecha(experiencias) {\n    // Mapear con índice original\n    let experiencias_con_indice = experiencias.map((experiencia, indice_original) => ({\n        ...experiencia,\n        indice_original: indice_original\n    }));\n\n    // Ordenar experiencias\n    let experiencias_ordenadas = experiencias_con_indice.sort((a, b) => {\n        // Si 'a' no tiene fecha_fin (trabaja actualmente), va primero\n        if (!a.fecha_fin && b.fecha_fin) return -1;\n        // Si 'b' no tiene fecha_fin (trabaja actualmente), va primero\n        if (a.fecha_fin && !b.fecha_fin) return 1;\n        // Si ambos están trabajando actualmente (sin fecha_fin), mantener el orden actual\n        if (!a.fecha_fin && !b.fecha_fin) return 0;\n        // Si ambos tienen fecha_fin, ordenar por fecha más reciente primero (descendente)\n        return moment(b.fecha_fin).diff(moment(a.fecha_fin));\n    });\n\n    return experiencias_ordenadas;\n}\n\n/**\n * Obtener créditos disponibles de la empresa y actualizar el tag.\n * - Si tiene créditos >= 20% del plan: tag azul\n * - Si tiene créditos < 20% del plan: tag amarillo\n * - Si no tiene créditos: tag gris \"Sin créditos\"\n *\n * @param {number} empresa_id ID de la empresa\n * @param {string} contenedor_id ID del contenedor donde se mostrará el tag\n * @returns {void}\n * @author Andres Gonzalez\n */\nfunction obtenerCreditosDisponiblesEmpresa(empresa_id, contenedor_id = 'contenedor-tag-creditos') {\n    if (!empresa_id || !$(`#${contenedor_id}`).length) {\n        return;\n    }\n\n    $.ajax({\n        url: `/api/empresas/${empresa_id}/creditos`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            let creditos_disponibles = respuesta?.data?.creditos_disponibles ?? 0;\n            let creditos_plan = respuesta?.data?.creditos_plan ?? 0;\n            let porcentaje_disponible = creditos_plan > 0 ? (creditos_disponibles / creditos_plan) * 100 : 0;\n\n            let texto_tag = '';\n            let clase_tag = '';\n            let icono_final = '';\n\n            if (creditos_disponibles <= 0) {\n                texto_tag = 'Sin créditos';\n                clase_tag = 'tag-tonal-gray';\n                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'top', content: 'Estás cerca de agotar tus créditos. Te queda menos del 20% del total disponible. Considera recargar o revisar tu consumo para evitar interrupciones.' })}></i>`;\n            } else if (porcentaje_disponible < 20) {\n                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                clase_tag = 'tag-filled-yellow';\n                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'top', content: 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.' })}></i>`;\n            } else {\n                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                clase_tag = 'tag-tonal-blue';\n            }\n\n            $(`#${contenedor_id}`).html(crearTag({\n                texto: texto_tag,\n                class: clase_tag,\n                icono_final: icono_final,\n            }));\n        },\n        error: function() {\n            $(`#${contenedor_id}`).html(crearTag({\n                texto: 'Error al cargar créditos',\n                class: 'tag-tonal-gray',\n            }));\n        }\n    });\n}\n","structuredPatch":[{"oldStart":1431,"oldLines":11,"newStart":1431,"newLines":11,"lines":["             if (creditos_disponibles <= 0) {","                 texto_tag = 'Sin créditos';","                 clase_tag = 'tag-tonal-gray';","-                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'top', content: 'Estás cerca de agotar tus créditos. Te queda menos del 20% del total disponible. Considera recargar o revisar tu consumo para evitar interrupciones.' })}></i>`;","+                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.' })}></i>`;","             } else if (porcentaje_disponible < 20) {","                 texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;","                 clase_tag = 'tag-filled-yellow';","-                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'top', content: 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.' })}></i>`;","+                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'Estás cerca de agotar tus créditos. Te queda menos del 20% del total disponible. Considera recargar o revisar tu consumo para evitar interrupciones.' })}></i>`;","             } else {","                 texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;","                 clase_tag = 'tag-tonal-blue';"]}],"userModified":false,"replaceAll":false},"sourceToolAssistantUUID":"2c520aa2-b652-438f-a961-f401f55328ba"}
{"parentUuid":"54158024-11c8-485d-92f1-e4016ff9fc8e","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01DGZNagjmSLYJjvX1tV2cCz","type":"message","role":"assistant","content":[{"type":"text","text":"Listo. Cambié el `placement` a `'right'` en ambos tooltips. También corregí los mensajes que estaban intercambiados:\n\n- **Sin créditos (gris)**: \"No tienes créditos disponibles en este momento...\"\n- **Créditos bajos (amarillo)**: \"Estás cerca de agotar tus créditos...\""}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":1192,"cache_read_input_tokens":89563,"cache_creation":{"ephemeral_5m_input_tokens":1192,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXLsNj4uvPZiucfjtEWLK","type":"assistant","uuid":"a73aa4d2-7e68-47f1-9037-b4009a960dd5","timestamp":"2026-01-21T16:51:41.325Z"}
{"type":"queue-operation","operation":"dequeue","timestamp":"2026-01-21T17:15:35.888Z","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961"}
{"type":"file-history-snapshot","messageId":"88b4fff2-8972-4906-ad20-e90f78fd21b1","snapshot":{"messageId":"88b4fff2-8972-4906-ad20-e90f78fd21b1","trackedFileBackups":{"resources\\views\\vacantes\\paginas\\index.blade.php":{"backupFileName":"1ae59264a32091d1@v9","version":9,"backupTime":"2026-01-21T16:50:05.680Z"},"public\\js\\globales.js":{"backupFileName":"704f632e999527e6@v5","version":5,"backupTime":"2026-01-21T17:15:37.877Z"},"public\\js\\vacantes\\vacantes.js":{"backupFileName":"ca631dbb99127e3f@v3","version":3,"backupTime":"2026-01-21T16:33:41.257Z"},"public\\componentes\\componentes\\tags.js":{"backupFileName":"247759b31878023a@v2","version":2,"backupTime":"2026-01-21T16:39:57.931Z"}},"timestamp":"2026-01-21T17:15:37.855Z"},"isSnapshotUpdate":false}
{"parentUuid":"c759bd75-70e3-4756-80d1-2c5bc0f9b445","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Read","command":"callback"},"toolUseID":"toolu_01KPboBFZAbnupDfgub5wkFF","parentToolUseID":"toolu_01KPboBFZAbnupDfgub5wkFF","uuid":"863047b9-3f30-4ef1-b579-b9a6811ce176","timestamp":"2026-01-21T16:50:10.072Z"}
{"parentUuid":"2c520aa2-b652-438f-a961-f401f55328ba","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Edit","command":"callback"},"toolUseID":"toolu_01Hn5B1KCdUd75KdcJAUEB4Q","parentToolUseID":"toolu_01Hn5B1KCdUd75KdcJAUEB4Q","uuid":"1533594e-4884-4cbf-9747-89c08bb4d1fc","timestamp":"2026-01-21T16:50:18.842Z"}
{"parentUuid":"1533594e-4884-4cbf-9747-89c08bb4d1fc","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Edit","command":"callback"},"toolUseID":"toolu_01Hn5B1KCdUd75KdcJAUEB4Q","parentToolUseID":"toolu_01Hn5B1KCdUd75KdcJAUEB4Q","uuid":"a10aa598-a4fe-46ce-a6b7-6782a0dded7e","timestamp":"2026-01-21T16:50:18.843Z"}
{"parentUuid":"54158024-11c8-485d-92f1-e4016ff9fc8e","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"callback"},"parentToolUseID":"toolu_01Hn5B1KCdUd75KdcJAUEB4Q","toolUseID":"toolu_01Hn5B1KCdUd75KdcJAUEB4Q","timestamp":"2026-01-21T16:51:34.476Z","uuid":"1f879c60-1529-4b1a-932a-7c787f45a56a"}
{"parentUuid":"a73aa4d2-7e68-47f1-9037-b4009a960dd5","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"type":"text","text":"<ide_opened_file>The user opened the file c:\\laragon\\www\\psicoalianza-2\\public\\js\\globales.js in the IDE. This may or may not be related to the current task.</ide_opened_file>"},{"type":"text","text":"listo en la validacion de que no tiene creditos es que no tenga creditos disponibles pero si no tiene un plan de creditos asociado tamnvien puestre ses tag de sin credtos"}]},"uuid":"88b4fff2-8972-4906-ad20-e90f78fd21b1","timestamp":"2026-01-21T17:15:37.851Z"}
{"parentUuid":"88b4fff2-8972-4906-ad20-e90f78fd21b1","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01TiPEgSPS56V8xNKzMm2i9H","type":"message","role":"assistant","content":[{"type":"text","text":"Entendido. Voy a modificar la validación para que también muestre \"Sin créditos\" cuando no hay un plan de créditos asociado (es decir, cuando `creditos_plan` es 0 o null)."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":93747,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":93747,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXLuCwfed8CiVjBEHFVji","type":"assistant","uuid":"6ca038c0-b675-4f6b-85c5-d276bce80067","timestamp":"2026-01-21T17:15:42.494Z"}
{"parentUuid":"6ca038c0-b675-4f6b-85c5-d276bce80067","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01TiPEgSPS56V8xNKzMm2i9H","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_019zAxyXNjR9qGH7WcACNmXN","name":"Read","input":{"file_path":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\globales.js","offset":1420,"limit":35}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":93747,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":93747,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXLuCwfed8CiVjBEHFVji","type":"assistant","uuid":"2977bf41-c200-4801-abb2-4f4bbcde75fd","timestamp":"2026-01-21T17:15:43.275Z"}
{"parentUuid":"2977bf41-c200-4801-abb2-4f4bbcde75fd","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_019zAxyXNjR9qGH7WcACNmXN","type":"tool_result","content":"  1420→        method: 'GET',\n  1421→        dataType: 'json',\n  1422→        success: function(respuesta) {\n  1423→            let creditos_disponibles = respuesta?.data?.creditos_disponibles ?? 0;\n  1424→            let creditos_plan = respuesta?.data?.creditos_plan ?? 0;\n  1425→            let porcentaje_disponible = creditos_plan > 0 ? (creditos_disponibles / creditos_plan) * 100 : 0;\n  1426→\n  1427→            let texto_tag = '';\n  1428→            let clase_tag = '';\n  1429→            let icono_final = '';\n  1430→\n  1431→            if (creditos_disponibles <= 0) {\n  1432→                texto_tag = 'Sin créditos';\n  1433→                clase_tag = 'tag-tonal-gray';\n  1434→                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.' })}></i>`;\n  1435→            } else if (porcentaje_disponible < 20) {\n  1436→                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n  1437→                clase_tag = 'tag-filled-yellow';\n  1438→                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'Estás cerca de agotar tus créditos. Te queda menos del 20% del total disponible. Considera recargar o revisar tu consumo para evitar interrupciones.' })}></i>`;\n  1439→            } else {\n  1440→                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n  1441→                clase_tag = 'tag-tonal-blue';\n  1442→            }\n  1443→\n  1444→            $(`#${contenedor_id}`).html(crearTag({\n  1445→                texto: texto_tag,\n  1446→                class: clase_tag,\n  1447→                icono_final: icono_final,\n  1448→            }));\n  1449→        },\n  1450→        error: function() {\n  1451→            $(`#${contenedor_id}`).html(crearTag({\n  1452→                texto: 'Error al cargar créditos',\n  1453→                class: 'tag-tonal-gray',\n  1454→            }));\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"6a0d040b-a45a-4133-8fc3-69b3e847c4d2","timestamp":"2026-01-21T17:15:44.608Z","toolUseResult":{"type":"text","file":{"filePath":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\globales.js","content":"        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            let creditos_disponibles = respuesta?.data?.creditos_disponibles ?? 0;\n            let creditos_plan = respuesta?.data?.creditos_plan ?? 0;\n            let porcentaje_disponible = creditos_plan > 0 ? (creditos_disponibles / creditos_plan) * 100 : 0;\n\n            let texto_tag = '';\n            let clase_tag = '';\n            let icono_final = '';\n\n            if (creditos_disponibles <= 0) {\n                texto_tag = 'Sin créditos';\n                clase_tag = 'tag-tonal-gray';\n                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.' })}></i>`;\n            } else if (porcentaje_disponible < 20) {\n                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                clase_tag = 'tag-filled-yellow';\n                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'Estás cerca de agotar tus créditos. Te queda menos del 20% del total disponible. Considera recargar o revisar tu consumo para evitar interrupciones.' })}></i>`;\n            } else {\n                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                clase_tag = 'tag-tonal-blue';\n            }\n\n            $(`#${contenedor_id}`).html(crearTag({\n                texto: texto_tag,\n                class: clase_tag,\n                icono_final: icono_final,\n            }));\n        },\n        error: function() {\n            $(`#${contenedor_id}`).html(crearTag({\n                texto: 'Error al cargar créditos',\n                class: 'tag-tonal-gray',\n            }));","numLines":35,"startLine":1420,"totalLines":1458}},"sourceToolAssistantUUID":"2977bf41-c200-4801-abb2-4f4bbcde75fd"}
{"parentUuid":"6a0d040b-a45a-4133-8fc3-69b3e847c4d2","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01Co1435Es8rkPr2wZSJk5z1","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01GMhgjjLdCPV6VxdTvaqXma","name":"Edit","input":{"replace_all":false,"file_path":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\globales.js","old_string":"            if (creditos_disponibles <= 0) {\n                texto_tag = 'Sin créditos';\n                clase_tag = 'tag-tonal-gray';\n                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.' })}></i>`;\n            } else if (porcentaje_disponible < 20) {","new_string":"            if (creditos_disponibles <= 0 || creditos_plan <= 0) {\n                texto_tag = 'Sin créditos';\n                clase_tag = 'tag-tonal-gray';\n                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.' })}></i>`;\n            } else if (porcentaje_disponible < 20) {"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":979,"cache_read_input_tokens":93747,"cache_creation":{"ephemeral_5m_input_tokens":979,"ephemeral_1h_input_tokens":0},"output_tokens":25,"service_tier":"standard"}},"requestId":"req_011CXLuDUW3jawCgSMtwZooA","type":"assistant","uuid":"b146b505-61d5-438b-9924-dc2d0ae8223c","timestamp":"2026-01-21T17:15:50.678Z"}
{"parentUuid":"b146b505-61d5-438b-9924-dc2d0ae8223c","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01GMhgjjLdCPV6VxdTvaqXma","type":"tool_result","content":"The file c:\\laragon\\www\\psicoalianza-2\\public\\js\\globales.js has been updated. Here's the result of running `cat -n` on a snippet of the edited file:\n  1427→            let texto_tag = '';\n  1428→            let clase_tag = '';\n  1429→            let icono_final = '';\n  1430→\n  1431→            if (creditos_disponibles <= 0 || creditos_plan <= 0) {\n  1432→                texto_tag = 'Sin créditos';\n  1433→                clase_tag = 'tag-tonal-gray';\n  1434→                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.' })}></i>`;\n  1435→            } else if (porcentaje_disponible < 20) {\n  1436→                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n  1437→                clase_tag = 'tag-filled-yellow';\n  1438→                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'Estás cerca de agotar tus créditos. Te queda menos del 20% del total disponible. Considera recargar o revisar tu consumo para evitar interrupciones.' })}></i>`;\n  1439→            } else {"}]},"uuid":"bf3fda0f-d14a-4221-b479-ce6178499d5e","timestamp":"2026-01-21T17:16:01.320Z","toolUseResult":{"filePath":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\globales.js","oldString":"            if (creditos_disponibles <= 0) {\n                texto_tag = 'Sin créditos';\n                clase_tag = 'tag-tonal-gray';\n                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.' })}></i>`;\n            } else if (porcentaje_disponible < 20) {","newString":"            if (creditos_disponibles <= 0 || creditos_plan <= 0) {\n                texto_tag = 'Sin créditos';\n                clase_tag = 'tag-tonal-gray';\n                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.' })}></i>`;\n            } else if (porcentaje_disponible < 20) {","originalFile":"// Mensajes en español para el plugin Select2\nconst mensajes_select2 = {\n    'noResults'              : () => { return 'No hay resultados para la búsqueda.'; },\n    'searching'              : () => { return 'Buscando...'; },\n    'Loading'                : () => { return 'Cargando...'; },\n    'loadingMore'            : () => { return 'Cargando más resultados...'; },\n    'dropdownFooter'         : (texto) => { return `Mostrando ${texto} resultados`; },\n    'emptyOptions'           : () => { return 'No hay opciones disponibles.'; },\n    'appendItems'            : (items) => { return `Agregando ${items.length} elementos.`; },\n    'maximumSelectionReached': () => { return 'Se ha alcanzado el número máximo de selecciones.'; },\n    'selectOnClose'          : () => { return 'Seleccione una opción al cerrar el menú.'; },\n    'escapeKeyUp'            : () => { return 'Presione \\'Escape\\' para cerrar el menú.'; },\n    'errorLoading'           : () => { return 'Error al cargar datos. Inténtalo de nuevo más tarde.'; },\n    'inputTooShort'          : (elemento) => { return `Ingresa al menos ${elemento.minimum} caracteres para iniciar una búsqueda.`; },\n    'noMatches'              : () => { return 'No se encontraron coincidencias para tu búsqueda.'; },\n    'allowClear'             : () => { return 'Borrar selección'; },\n    'SelectionTooLong'       : (conteo, maximo) => { return `Solo puedes seleccionar ${maximo} opciones.`; },\n    'loadMore'               : () => { return 'Cargando más resultados...'; },\n    'removing'               : (seleccion) => { return 'Eliminando...'; },\n    'matches'                : (coincidencias, total) => {\n        if (coincidencias === 0) {\n            return 'No hay coincidencias.';\n        } else if (coincidencias === 1) {\n            return 'Se encontró 1 coincidencia.';\n        } else {\n            return `Se encontraron ${coincidencias} coincidencias entre ${total}.`;\n        }\n    }\n};\n\n// audios\nvar audio_notificacion = new Audio('/audios/notificacion.mp3');\n\nlet mostro_modal_creditos_ia = false;\nlet funcion_ejecucion_ia = null;\nlet modals_abiertos_ia = null;\n\n/**\n * Mostrar modal de créditos IA\n * \n * @return void\n * @author José Manuel Jiménez\n */\nfunction mostrarModalCreditosIA(servicio_ia_id) {\n    $.ajax({\n        url: `/api/empresas/${$('#empresa_sesion_id').val()}/creditos`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta_empresa) {\n            if (respuesta_empresa?.data?.creditos_disponibles > 0) {\n                $.ajax({\n                    url: `/api/servicios-ia/${servicio_ia_id}/creditos`,\n                    method: 'GET',\n                    dataType: 'json',\n                    success: function(respuesta) {\n                        if (respuesta?.data?.consume_creditos && respuesta?.data?.consume_creditos <= respuesta_empresa.data.creditos_disponibles) {\n                            $('#cantidad-creditos-descontar-modal').text(respuesta.data.consume_creditos);\n                            $('#modal-consumo-creditos-ia').modal('show');\n                            mostro_modal_creditos_ia = true;\n                            modals_abiertos_ia = $('.modal.show').not('#modal-consumo-creditos-ia').not('#modal-generando-ia');\n                            $(modals_abiertos_ia).addClass('d-none');\n                        } else {\n                            mostrarToastSolicitarCreditosIA();\n                        }\n                    }\n                });\n            } else {\n                mostrarToastSolicitarCreditosIA();\n            }\n        }\n    });\n}\n\n/**\n * Mostrar toast para solicitar créditos IA\n * \n * @return void\n * @author José Manuel Jiménez\n */\nfunction mostrarToastSolicitarCreditosIA() {\n    $.ajax({\n        url: `/empresas/${$('#empresa_sesion_id').val()}`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            let adicional_toast = '';\n            if (respuesta?.data?.ejecutivo?.telefono) {\n                adicional_toast = `<a href=\"https://wa.me/${respuesta.data.ejecutivo.telefono.replace(/\\D/g, '')}?text=Hola,%20me%20gustar%C3%ADa%20solicitar%20cr%C3%A9ditos%20adicionales%20para%20mi%20empresa.\" target=\"_blank\">\n                    <p class=\"text-label-1 text-white no-visited text-decoration-none mb-0\">Solicitar</p>\n                </a>`;\n            }\n            setTimeout(() => {\n                $('#modal-generando-ia').modal('hide');\n                $('#modal-cargue-ia').modal('hide');\n                mostrarToast('danger', 'No cuentas con créditos. Solicita créditos adicionales.', '', adicional_toast);\n            }, 300);\n        }\n    });\n}\n\n/**\n * Continuar ejecución IA luego del modal de créditos\n * \n * @return void\n * @author José Manuel Jiménez\n */\nfunction continuarEjecucionIA() {\n    if (funcion_ejecucion_ia) {\n        funcion_ejecucion_ia();\n        funcion_ejecucion_ia = null;\n    }\n    mostro_modal_creditos_ia = false;\n    $('#modal-consumo-creditos-ia').modal('hide');\n}\n\n/**\n * Solicitar más créditos IA\n * \n * @return void\n * @author José Manuel Jiménez\n */\nfunction solicitarMasCreditosIA() {\n    $.ajax({\n        url: `/empresas/${$('#empresa_sesion_id').val()}`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            if (respuesta?.data?.ejecutivo?.telefono) {\n                window.open(`https://wa.me/${respuesta.data.ejecutivo.telefono.replace(/\\D/g, '')}?text=Hola,%20me%20gustar%C3%ADa%20solicitar%20cr%C3%A9ditos%20adicionales%20para%20mi%20empresa.`, '_blank');\n            } else {\n                mostrarToast('danger', 'No se encontró un ejecutivo asignado a la empresa. Por favor, comunícate con soporte para recargar créditos.');\n            }\n            $('#modal-solicitar-mas-creditos-ia').modal('hide');\n        }\n    });\n}\n\n/**\n * Validar respuesta de créditos IA\n * \n * @return void\n * @author José Manuel Jiménez\n */\nfunction validarRespuestaCreditosIA(error_ia) {\n    if (error_ia == 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.') {\n        mostrarToastSolicitarCreditosIA();\n        return true;\n    }\n    return false;\n}\n\n/**\n * Ajustar el ancho de los elementos select2 asincrono multiple.\n *\n * @returns {void}\n * @author Andres Morales\n */\n$(document).ready(function () {\n    cargarNotificiacionesHeader();\n    if (window.configuracion_reverbg && window.configuracion_reverbg.activar_websocket) {\n        configurarWebSocketNotificaciones();\n    }\n    setTimeout(() => {\n        $(\".input-container\").each(function () {\n            let $container = $(this);\n            let $select = $container.find(\"select[multiple]\");\n            let $icon = $container.find(\".input-icono1\");\n            if ($select.length && $icon.length) {\n                $(this).find('.select2-selection--multiple').addClass('ps-5')\n            }\n        });\n    }, 1000);\n    $('#modal-consumo-creditos-ia').on('hidden.bs.modal', function () {\n        if (mostro_modal_creditos_ia) {\n            $(modals_abiertos_ia).removeClass('d-none');\n        }\n        mostro_modal_creditos_ia = false;\n    });\n\n    // Cargar créditos disponibles si existe el contenedor y el ID de empresa\n    if ($('#contenedor-tag-creditos').length && $('#empresa_sesion_id').length) {\n        obtenerCreditosDisponiblesEmpresa($('#empresa_sesion_id').val());\n    }\n});\n\n/**\n * Formatear fecha a formato dd/mm/yyyy - hh:mm AM/PM.  Ejemplo: 01/Feb/2022 - 12:00 PM\n *\n * @param {string} fecha_entrada fecha en formato ISO\n * @returns {string} fecha y hora formateada\n * @author Andres Morales\n */\nfunction formatearFecha(fecha_entrada) {\n    var fecha = new Date(fecha_entrada);\n    var dia = fecha.getDate();\n    var mes = fecha.toLocaleString('es-ES', { month: 'short' });\n    var anio = fecha.getFullYear();\n    let hora = fecha.getHours();\n    let minuto = fecha.getMinutes();\n    let ampm = hora >= 12 ? 'PM' : 'AM';\n    hora = hora % 12 || 12;\n    minuto = minuto.toString().padStart(2, '0');\n    return `${dia}/${mes}/${anio} - ${hora}:${minuto} ${ampm}`;\n}\n\nfunction formatearFecha2(fecha_entrada) {\n    let partes = fecha_entrada.split(' ');\n    let fecha = partes[0].split('-');\n    let hora = partes[1];\n    let fechaISO = `${fecha[2]}-${fecha[1]}-${fecha[0]}T${hora}`;\n\n    let date = new Date(fechaISO);\n\n    if (isNaN(date.getTime())) {\n        return 'Fecha inválida';\n    }\n\n    let dia = date.getDate();\n    let mes = date.toLocaleString('eu-EU', { month: 'short' });\n    let anio = date.getFullYear();\n    return `${dia}/${mes}/${anio}`;\n}\n\n/**\n * Opción para contraer o agrandar el menú principal\n *\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Andres Morales\n */\nfunction contraerMenu() {\n    if ($('.sidebar-menu').hasClass('close')) {\n        $('.sidebar-menu').removeClass('d-none');\n        localStorage.setItem('opcion_menu_storage', 'abierto');\n        $('#btn-collapse').attr('data-bs-original-title', 'Contraer');\n        $('#btn-collapse').attr('data-bs-title', 'Contraer');\n        $(\".menu-bar\").each(function() {\n            $(this).removeClass(\"px-2\").addClass(\"px-5\");\n        });\n        $('[data-bs-toggle=\"tooltip\"]').each(function () { new bootstrap.Tooltip(this); });\n        $('.lista-primary[data-bs-toggle=\"tooltip\"]').each(function () {\n            var tooltip_instancia = bootstrap.Tooltip.getInstance(this);\n            if (tooltip_instancia) {\n                tooltip_instancia.dispose();\n            }\n        });\n    } else {\n        $('.sidebar-menu').addClass('d-none');\n        localStorage.setItem('opcion_menu_storage', 'cerrado');\n        $('#btn-collapse').attr('data-bs-original-title', 'Expandir');\n        $('#btn-collapse').attr('data-bs-title', 'Expandir');\n        $(\".menu-bar\").each(function() {\n            $(this).removeClass(\"px-5\").addClass(\"px-2\");\n        });\n        $('[data-bs-toggle=\"tooltip\"]').each(function () { new bootstrap.Tooltip(this); });\n    }\n    $('.tooltip.bs-tooltip-auto').remove();\n    $('.sidebar-menu').toggleClass('close');\n    $('.contenedor-vista').toggleClass('close');\n    $('#btn-collapse').toggleClass('close');\n    $('.nombre-usuario-empresa').toggle();\n    $('.menu-bar .text-menu').toggle();\n}\n\n/**\n * Opción para abrir o cerrar el menu segun la elección guardada\n *\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Andres Morales\n */\nfunction mostrarMenuStorage() {\n    $(document).ready(function() {\n        $('.lista-primary[data-bs-toggle=\"tooltip\"]').each(function () {\n            var tooltip_instancia = bootstrap.Tooltip.getInstance(this);\n            if (tooltip_instancia) {\n                tooltip_instancia.dispose();\n            }\n        });\n\n        if (window.innerWidth < 768) {\n            localStorage.setItem('opcion_menu_storage', 'cerrado');\n        }\n\n        if (localStorage.getItem('opcion_menu_storage') === 'cerrado') {\n            contraerMenu();\n        }\n        let $active = $('.menu-bar .active');\n\n        if ($active.length) {\n            $('.menu-bar').scrollTop($active.position().top);\n        }\n    });\n}\nmostrarMenuStorage();\n\n/**\n * Funcion para hacer el slug de un texto desde jquery.\n *\n * @returns {void}\n * @author Andres Morales\n */\nfunction slugify(text) {\n    return $.trim(text)\n        .toLowerCase()\n        .normalize(\"NFD\")\n        .replace(/[\\u0300-\\u036f]/g, \"\")\n        .replace(/[^a-z0-9 -]/g, \"\")\n        .replace(/\\s+/g, \"-\")\n        .replace(/-+/g, \"-\");\n}\n\n/**\n * Función generica para mostrar mensajes de respuesta\n *\n * @param {string} tipo_alerta define el color de la alerta segun alerts de botstrap.\n * @param {string} texto_1 Texto que mostrara la alerta.\n * @param {string} texto_2 Texto secundario en la alerta.\n * @param {string} accion Acción adicional(por definir).\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Andres Gonzalez\n */\nfunction mostrarToast(tipo_alerta, texto_1, texto_2 = '', accion = '', icono2 = '') {\n    let icono = '';\n    let texto_color = 'text-white';\n    if (accion != '') {\n        accion = `<div class=\"col-auto p-0 text-label-1\">${accion}</div>`;\n    }\n\n    if (tipo_alerta == 'success') {\n        icono = 'bi bi-check-circle';\n    }\n\n    if (tipo_alerta == 'neutral') {\n        icono = 'bi bi-info-circle';\n    }\n\n    if (tipo_alerta == 'warning') {\n        icono = 'bi bi-info-circle';\n        texto_color = \"text-red-letras\";\n    }\n\n    if (tipo_alerta == 'danger') {\n        icono = 'bi bi-x-circle';\n    }\n\n    if (icono2 != '') {\n        icono = icono2;\n    }\n\n    if (texto_2 != '') {\n        texto_2 = `<div class=\"col-12 p-0 text-label-1 ${texto_color}\">${texto_2}</div>`;\n    }\n\n    let alert_toast = $(`\n        <div class=\"alert toast-${tipo_alerta} alert-dismissible fade show d-flex align-items-center pe-3 py-3 me-3\" role=\"alert\" style=\"display:none\">\n            <div class=\"col-auto\">\n                <span class=\"${icono} ${texto_color}\"></span>\n            </div>\n            <div class=\"col px-3\">\n                <div class=\"row m-0 ${texto_color}\">\n                    <div class=\"col-12 p-0 text-label-1 ${texto_color}\">\n                        ${texto_1}\n                    </div>\n                    ${texto_2}\n                </div>\n            </div>\n            ${accion}\n            <div class=\"col-auto ms-3 pointer\" data-bs-dismiss=\"alert\">\n                <span class=\"bi bi-x ${texto_color}\"></span>\n            </div>\n        </div>\n    `);\n    $('#contenedor-alert-toast').append(alert_toast);\n    alert_toast.fadeIn();\n    setTimeout(function() {\n        alert_toast.fadeOut();\n        alert_toast.alert('close');\n    }, 5000);\n}\n\n/**\n * Formatear número.\n *\n * @param {number} numero número a formatear\n * @author Andres Morales\n */\nfunction formatearNumero(numero) {\n    return parseInt(numero).toLocaleString('es-ES');\n}\n\n/**\n * Formatear fecha.\n *\n * @param {*} fecha Fecha a formatear.\n * @param {boolean} incluir_segundos Indica si se debe incluir los segundos en la hora.\n * @param {string} formato Formato en el que se retornará la fecha.\n * @param {string} separador Símbolo que se usará para separar días, meses y años.\n * @returns {Object} Objeto con la fecha y hora formateada.\n * @author Daniel Beltrán\n */\nfunction formatearFechaConceptual(fecha, incluir_segundos = false, formato = 'Ymd', separador = '-') {\n    const NUEVA_FECHA = new Date(fecha);\n    const ANO         = NUEVA_FECHA.getFullYear();\n    const MES         = String(NUEVA_FECHA.getMonth() + 1).padStart(2, '0');\n    const DIA         = String(NUEVA_FECHA.getDate()).padStart(2, '0');\n    const HORAS       = String(NUEVA_FECHA.getHours()).padStart(2, '0');\n    const MINUTOS     = String(NUEVA_FECHA.getMinutes()).padStart(2, '0');\n    const SEGUNDOS    = String(NUEVA_FECHA.getSeconds()).padStart(2, '0');\n\n    let fecha_formateada = `${ANO}${separador}${MES}${separador}${DIA}`;\n\n    if (formato === 'dmY') {\n        fecha_formateada = `${DIA}${separador}${MES}${separador}${ANO}`;\n    }\n\n    return {\n        fecha: fecha_formateada,\n        hora : incluir_segundos ? `${HORAS}:${MINUTOS}:${SEGUNDOS}` : `${HORAS}:${MINUTOS}`\n    };\n}\n\n/**\n * Formatear fecha a May. 2023.\n *\n * @param {string} fechaISO Fecha a formatear.\n * @returns {string} Objeto con la fecha y hora formateada.\n * @author Andres Morales\n */\nfunction formatearFechaAnioMes(fechaISO) {\n    const fecha = new Date(fechaISO);\n    const opciones = { month: 'short', year: 'numeric' };\n    let fecha_formateada = fecha.toLocaleDateString('es-ES', opciones);\n\n    fecha_formateada = fecha_formateada.replace(\n        /^([a-zñ]+)(\\s\\d{4})$/,\n        (_, mes, anio) => `${mes.charAt(0).toUpperCase() + mes.slice(1)}. ${anio.trim()}`\n    );\n\n    return fecha_formateada;\n}\n\n/**\n * Formatear un numero a moneda.\n *\n * @param {string} valor Numero.\n * @returns {string} Numero formateado.\n * @author Andres Morales\n */\nfunction formatearMonedaCOP(valor) {\n    return new Intl.NumberFormat('es-CO', {\n        style: 'currency',\n        currency: 'COP',\n        minimumFractionDigits: 0,\n        maximumFractionDigits: 0\n    }).format(valor);\n}\n\n/**\n * Formatear fecha a un formato d/m/Y hh:mm:ss entendible para el usuario.\n *\n * @param {*} fecha_inicial Fecha a formatear.\n * @returns {String} String con la fecha y hora formateada.\n * @author José Manuel Jiménez\n */\nfunction fechaMostrar(fecha_inicial) {\n    if (!fecha_inicial) {\n        return \"\";\n    }\n    const fecha = new Date(fecha_inicial);\n    if (isNaN(fecha.getTime())) {\n        return \"\";\n    }\n    const dia = String(fecha.getUTCDate()).padStart(2, '0');\n    const mes = String(fecha.getUTCMonth() + 1).padStart(2, '0');\n    const anio = fecha.getUTCFullYear();\n    if (!fecha_inicial.includes(\" \")) {\n        return `${dia}/${mes}/${anio}`;\n    }\n    const horas = String(fecha.getUTCHours()).padStart(2, '0');\n    const minutos = String(fecha.getUTCMinutes()).padStart(2, '0');\n    const segundos = String(fecha.getUTCSeconds()).padStart(2, '0');\n    return `${dia}/${mes}/${anio} ${horas}:${minutos}:${segundos}`;\n}\n\n/**\n * Descargar Excel.\n *\n * @param {string} ruta Ruta desde donde se descarga el archivo.\n * @param {string} nombre_archivo Nombre del archivo descargado.\n * @param {boolean} marca_tiempo Indica si el nombre del archivo debe llevar marca de tiempo.\n * @param {Object} parametros Parámetros a enviar en la petición.\n * @returns {void}\n * @author Daniel Beltrán\n */\nasync function descargarExcel(ruta, nombre_archivo, marca_tiempo = true, parametros = {}) {\n    parametros._token = $('meta[name=\"csrf-token\"]').attr('content');\n\n    await $.ajax({\n        type     : 'POST',\n        url      : `/${ruta}`,\n        data     : parametros,\n        xhrFields: {\n            responseType: 'blob'\n        },\n        success: function (respuesta) {\n            // Crear una URL para el Blob\n            let url = window.URL.createObjectURL(respuesta); // 'respuesta' es el Blob\n            let a   = document.createElement('a'); // Crea un nuevo elemento <a> para iniciar la descarga\n            a.href  = url;\n            const fecha_actual     = new Date();\n            const dia              = fecha_actual.getDate();\n            const mes              = fecha_actual.getMonth() + 1;\n            const ano              = fecha_actual.getFullYear();\n            const hora             = fecha_actual.getHours();\n            const minutos          = fecha_actual.getMinutes();\n            const segundos         = fecha_actual.getSeconds();\n            const fecha_formateada = `${dia}${mes}${ano}${hora}${minutos}${segundos}`;\n\n            a.download = marca_tiempo ? `${nombre_archivo}-${fecha_formateada}.xlsx` : `${nombre_archivo}.xlsx`;\n            document.body.appendChild(a);\n            a.click();\n            window.URL.revokeObjectURL(url);\n            document.body.removeChild(a);\n        }\n    }).then(() => {\n        mostrarToast('success', 'Archivo descargado correctamente.');\n    }).catch((error) => {\n        mostrarToast('danger', 'Ocurrió un error al descargar el archivo.');\n    });\n}\n\n/**\n * Convierte un string a slug.\n *\n * @param {string} str\n * @returns {string}\n * @author Fahibram Cárcamo\n */\nfunction slug(str) {\n\n    // Quita espacios en blanco\n    str = str.replace(/^\\s+|\\s+$/g, \"\")\n\n    // Convierte el string a minusculas\n    str = str.toLowerCase()\n\n    // Quita los caracteres no alfanuméricos\n    str = str.replace(/[^a-z0-9 -]/g, \"\")\n\n    // Reemplaza los espacio con guiones\n    str = str.replace(/\\s+/g, \"-\")\n\n    // Remueve los guiones consecutivos\n    str = str.replace(/-+/g, \"-\")\n\n    return str\n}\n\n/**\n * Compara los elementos de dos arreglos y retorna `true` si son iguales y `false` en caso contrario\n * (Este función está pensada para comparar arreglos unidimensionales).\n *\n * @param {array} primer_arreglo\n * @param {array} segundo_arreglo\n * @param {boolean} comparar_orden\n * @return {boolean}\n * @author Fahibram Cárcamo\n */\nfunction sonArreglosIguales(primer_arreglo, segundo_arreglo, comparar_orden = false) {\n\n    if (!comparar_orden) {\n        primer_arreglo.sort()\n        segundo_arreglo.sort()\n    }\n\n    if (primer_arreglo.length !== segundo_arreglo.length) return false\n\n    for (let i = 0; i < primer_arreglo.length; i++) {\n        if (primer_arreglo[i] !== segundo_arreglo[i]) return false\n    }\n\n    return true\n}\n\n/**\n * Función para cambiar de empresa.\n *\n * @param {number} empresa_id ID de la empresa a la que se va a cambiar.\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Daniel Beltrán\n */\nfunction cambiarEmpresa(empresa_id) {\n    $.ajax({\n        type: 'POST',\n        url: '/suplantar-rol-admin-general',\n        data: {\n            _token    : $('meta[name=\"csrf-token\"]').attr('content'),\n            empresa_id: empresa_id\n        },\n        success: function (respuesta) {\n            localStorage.setItem('notificacionToast', JSON.stringify({\n                tipo_alerta: 'success',\n                texto_1    : 'Cambio de empresa exitoso'\n            }));\n\n            window.location.reload();\n        },\n        error: function (error) {\n            mostrarToast('danger', 'Ocurrió un error al cambiar de empresa');\n        }\n    });\n}\n\n/**\n * Enviar la solucitud de suplantación de rol y empresa al Back-end.\n *\n * @param {function|null} callback_exito Callback ejecutado en caso de éxito.\n * @param {string} url URL de suplantación.\n * @param {string} _token Token CSRF del formulario.\n * @param {number} empresa_id Id de la empresa a suplantar.\n * @param {number|null} rol_id Id del rol a suplantar.\n * @param {function|null} callback_error Callback ejecutado en caso de error.\n * @returns {void}\n * @author Fahibram Cárcamo\n */\nasync function enviarOrdenSuplantacionRolEmpresa (callback_exito, url, _token, empresa_id = null, rol_id = null, callback_error = null) {\n\n    let condicion_suplantacion = rol_id === null\n        ? empresa_id === null\n            ? true\n            : parseInt($('#empresa_sesion_id').val()) !== parseInt(empresa_id)\n        : parseInt($('#rol_sesion_id').val()) !== parseInt(rol_id) && parseInt($('#empresa_sesion_id').val()) !== parseInt(empresa_id);\n\n    if (condicion_suplantacion) {\n        let data = { _token };\n        if (empresa_id !== null) data.empresa_id = empresa_id;\n        if (rol_id !== null) data.rol_id = rol_id;\n\n        await $.ajax({ type: 'POST', url, data })\n            .then((respuesta, status, xhr) => {\n                if (xhr.status >= 200 && xhr.status < 300 && callback_exito !== null) callback_exito();\n            })\n            .catch(error => {\n                let swal_titulo, swal_texto;\n\n                if (error.status === 404) {\n                    if (error.responseJSON.mensaje) {\n                        swal_titulo = 'Algo salió mal';\n                        if (error.responseJSON.mensaje === 'no existe rol_suplantar') {\n                            swal_texto = 'El rol no existe.';\n                        } else if (error.responseJSON.mensaje === 'no existe empresa_suplantar') {\n                            swal_texto = 'La empresa no existe.';\n                        } else if (error.responseJSON.mensaje === 'no existe usuario_suplantar') {\n                            swal_texto = 'El usuario no existe.';\n                        } else {\n                            swal_texto = '';\n                        }\n                    } else if (error.responseJSON.empresa && error.responseJSON.rol) {\n                        swal_titulo = 'No fué posible cambiar de empresa';\n                        swal_texto = error.responseJSON.rol === 'Administrador general' || error.responseJSON.rol === 'Propietario'\n                            ? `La empresa ${error.responseJSON.empresa} no tiene ningún usuario con el rol Administrador general o Propietario.`\n                            : `La empresa ${error.responseJSON.empresa} no tiene ningún usuario con el rol ${error.responseJSON.rol}.`;\n                    } else {\n                        swal_titulo = 'Algo salió mal';\n                        swal_texto = error.responseJSON.errors;\n                    }\n                } else {\n                    swal_titulo = 'Algo salió mal';\n                    swal_texto = '';\n                }\n\n                if (callback_error !== null) callback_error();\n\n                Swal.fire({\n                    title: swal_titulo,\n                    text: swal_texto,\n                    icon: \"error\",\n                    confirmButtonText: \"Aceptar\"\n                });\n            });\n    }\n}\n\n/**\n * Mostrar tooltip según el div que lo contenga.\n *\n * @param {div} div Elemento en donde se va a mostrar el tooltip.\n * @returns {void}\n * @author Sol Espitia\n */\nfunction mostrarTooltip(div) {\n    const TOOLTIP         = div.querySelector('.tooltip-x');\n    TOOLTIP.style.display = 'block';\n}\n\n/**\n * Ocultar tooltip según el div que lo contenga.\n *\n * @param {div} div Elemento en donde se va a mostrar el tooltip.\n * @returns {void}\n * @author Sol Espitia\n */\nfunction ocultarTooltip(div) {\n    const TOOLTIP         = div.querySelector('.tooltip-x');\n    TOOLTIP.style.display = 'none';\n}\n\n/**\n * Retornar la diferencia en días de dos fechas dadas.\n *\n * @param {string} fecha_inicial Fecha inicial\n * @param {string} fecha_final Fecha final\n * @param {bool} valor_absoluto Retorna la diferencia en valor absoluto\n * @returns {number}\n * @author Fahibram Cárcamo\n * @author Andres Morales\n */\nfunction diferenciaFechasDias(fecha_inicial, fecha_final, valor_absoluto = false, sumar_dia = true) {\n    let fecha1 = new Date(fecha_inicial);\n    let fecha2 = new Date(fecha_final);\n\n    fecha1.setHours(0, 0, 0, 0);\n    fecha2.setHours(0, 0, 0, 0);\n\n    let diferencia_milisegundos = fecha2.getTime() - fecha1.getTime();\n\n    let diferencia_dias = diferencia_milisegundos / (1000 * 60 * 60 * 24);\n    let resultado = diferencia_dias;\n    if (sumar_dia) {\n        resultado = diferencia_dias + 1;\n    }\n\n    return valor_absoluto ? Math.abs(resultado) : resultado;\n}\n\n/**\n * Retornar `true` si una fecha dada está dentro de un rango de fechas dadas, `false` en otro caso.\n *\n * @param {string} fecha Fecha dada\n * @param {string} fecha_desde Fecha inicial del rango\n * @param {string} fecha_hasta Fecha final del rango\n * @returns {boolean}\n * @author Fahibram Cárcamo\n */\nfunction fechaDentroDelRango(fecha, fecha_desde, fecha_hasta) {\n    fecha = new Date(fecha);\n    fecha_desde = new Date(fecha_desde);\n    fecha_hasta = new Date(fecha_hasta);\n\n    if (isNaN(fecha) || isNaN(fecha_desde) || isNaN(fecha_hasta)) {\n        throw new Error('Una o más fechas no son válidas.');\n    }\n\n    return fecha >= fecha_desde && fecha <= fecha_hasta;\n}\n\n/**\n * Descuenta el tiempo para las respuestas.\n *\n * @param id - ID del elemento HTML donde mostrar el tiempo\n * @param tiempo - Tiempo inicial en segundos\n * @author Jair Carvajal\n */\nvar tiempos_usados = {};\n\nfunction descuentoTiempo(id, tiempo, callback, onTick) {\n    var $elemento = $('#' + id);\n    if ($elemento.length === 0) {\n        console.error('Elemento con id \"' + id + '\" no encontrado.');\n        return;\n    }\n    if (tiempos_usados[id]) {\n        clearInterval(tiempos_usados[id]);\n    }\n    let tiempoTotal = tiempo;\n    tiempos_usados[id] = setInterval(function() {\n        if (tiempo <= 0) {\n            clearInterval(tiempos_usados[id]);\n            delete tiempos_usados[id];\n            $elemento.text('Tiempo finalizado');\n            if (window.tiempoFinalizado()) {\n                tiempoFinalizado();\n            }\n            if (typeof callback === 'function') {\n                callback();\n            }\n            return;\n        }\n\n        var minutos = Math.floor(tiempo / 60);\n        var segundos = tiempo % 60;\n\n        var textoTiempo = minutos + ':' + (segundos < 10 ? '0' : '') + segundos + '<i class=\"bi bi-alarm ms-2\"></i>';\n\n        if (tiempo <= 15) {\n            $elemento.addClass('text-state-red');\n            $elemento.removeClass('text-state-green');\n        } else {\n            $elemento.addClass('text-state-green');\n            $elemento.removeClass('text-state-red');\n        }\n\n        $elemento.html(textoTiempo);\n\n        var tiempoUsado = tiempoTotal - tiempo;\n\n        if (typeof onTick === 'function') {\n            onTick((tiempoUsado % 5));\n        }\n        tiempo--;\n    }, 1000);\n}\n\n/**\n * Detengo el tiempo para las respuestas.\n *\n * @param id - ID del elemento HTML donde mostrar el tiempo\n * @param tiempo - Tiempo inicial en segundos\n * @author Jair Carvajal\n */\nfunction detenerDescuentoTiempo(id) {\n    if (tiempos_usados[id]) {\n        clearInterval(tiempos_usados[id]);\n        delete tiempos_usados[id];\n    }\n}\n\n/**\n * Genera un SVG de la imagen de usuario.\n *\n * @param id ID del usuario.\n * @param nombres Nombres del usuario.\n * @param apellidos Apellidos del usuario.\n * @return image\n * @author Andres Morales\n */\nfunction crearImagenUsuarioLetras(id, nombres, apellidos) {\n    var tamano = 200;\n    var iniciales = (nombres[0] + apellidos[0]).toUpperCase();\n    var hash = md5(id);\n\n    var r = parseInt(hash.substring(0, 2), 16);\n    var g = parseInt(hash.substring(2, 4), 16);\n    var b = parseInt(hash.substring(4, 6), 16);\n    var colorFondo = `rgb(${r},${g},${b})`;\n\n    var luminancia = 0.299 * r + 0.587 * g + 0.114 * b;\n    var colorTexto = luminancia > 150 ? \"#000000\" : \"#FFFFFF\";\n\n    // SVG como texto\n    var svg = `\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${tamano}\" height=\"${tamano}\">\n        <rect width=\"100%\" height=\"100%\" fill=\"${colorFondo}\" />\n        <text x=\"50%\" y=\"50%\" dy=\".35em\"\n            text-anchor=\"middle\"\n            font-family=\"Lato, sans-serif\"\n            font-size=\"${tamano * 0.4}\"\n            fill=\"${colorTexto}\">\n            ${iniciales}\n        </text>\n    </svg>`;\n    var svgEncoded = encodeURIComponent(svg)\n        .replace(/'/g, \"%27\")\n        .replace(/\"/g, \"%22\");\n\n    var dataUri = `data:image/svg+xml,${svgEncoded}`;\n    return dataUri;\n}\n\n/**\n * Carga las notificaciones\n *\n * @return void\n * @author Andres Morales\n * @author Andres Gonzalez\n * @author Esperanza Olivo\n */\nfunction cargarNotificiacionesHeader() {\n    $.ajax({\n        url: '/usuario-notificaciones',\n        type: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            let datos = respuesta.data;\n            let notificaciones_noleidas = datos?.unread_notifications?.length ?? 0;\n\n            // Siempre remover el badge existente\n            $('#dropdownNotificaciones #badge-notificaciones').remove();\n\n            // Solo agregar el badge si hay notificaciones no leídas\n            if (notificaciones_noleidas > 0) {\n                $('#dropdownNotificaciones').append(`<span id=\"badge-notificaciones\" class=\"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger border border-white\">${notificaciones_noleidas}</span>`);\n                $('#contador-notificaciones-abierto').append(`<span id=\"badge-notificaciones\" class=\"badge rounded-pill bg-danger border border-white\">${notificaciones_noleidas}</span>`);\n\n                $('#contenedor-boton-marcar-todas').html(`\n                    <button class=\"btn btn-link text-primary w-100 d-flex justify-content-center\" onclick=\"marcarNotificacionesLeidas('all')\">\n                        Marcar todo como leído\n                    </button>\n                `);\n            }\n\n            let no_leidos_ids = Array.isArray(datos?.unread_notifications) ? datos.unread_notifications.map(notificacion => notificacion.id): [];\n\n            if (Array.isArray(datos?.notifications) && datos.notifications.length > 0) {\n                $('#notificacion-sinnotificaciones').hide();\n                $('.notificaciones-listado').remove();\n                datos.notifications.forEach(notificacion => {\n                    const { id, data, updated_at } = notificacion;\n\n                    const NO_LEIDO = no_leidos_ids.includes(id);\n                    const MENSAJE = (data?.mensaje || '').slice(0, 120) + '...';\n                    const HORA = new Date(updated_at).toLocaleTimeString('es-CO', {\n                        hour: '2-digit',\n                        minute: '2-digit',\n                        hour12: false\n                    });\n\n                    const notificaciones = `\n                        <li class=\"${NO_LEIDO ? '' : 'bg-gray-90'} notificaciones-listado py-0\" id=\"notificacion-${id}\">\n                            <a class=\"dropdown-item text-gray-10 text-decoration-none border-top pt-0 pb-1\" href=\"javascript:void(0)\" onclick=\"marcarNotificacionesLeidas('${id}','${data?.ruta}')\">\n                                <div class=\"d-flex justify-content-between\">\n                                    <div class=\"w-auto flex-grow-1 pe-3\">\n                                        <p class=\"mt-1 mb-0 text-headline-6 text-gray-10\">${data?.titulo}</p>\n                                        <p class=\"mb-0 text-body-3 text-gray-30 notificacion-mensaje\">${MENSAJE}</p>\n                                    </div>\n                                    <div class=\"w-auto my-auto ${NO_LEIDO ? 'text-cta-azul' : 'text-gray-10'} text-label-2 flex-shrink-0\">\n                                        ${HORA}${NO_LEIDO ? `<i class=\"bi bi-circle-fill text-cta-azul my-auto texto-notificacion-icono ms-3\"></i>` : ''}\n                                    </div>\n                                </div>\n                            </a>\n                        </li>\n                    `;\n\n                    $(notificaciones).insertBefore('#contenedor-boton-marcar-todas');\n                });\n\n            } else {\n                $('#notificacion-sinnotificaciones').hide();\n                $('.notificaciones-listado').remove();\n            }\n\n        },\n        error: function(xhr, status, error) {\n            console.error('Error al cargar notificaciones:', error);\n        }\n    });\n}\n\n/**\n * Marcar las notificaciones leídas.\n *\n * @param {array} notificaciones_ids ids de las notificaciones\n * @param {string} ruta_destino ruta donde se va ha actualizar la pagina\n * @returns {void}\n * @author Andres Gonzalez\n * @author Esperanza Olivo\n */\nfunction marcarNotificacionesLeidas(notificaciones_ids = null, ruta_destino = null, soporte_id = null) {\n\n    let data = {\n        _token: $('meta[name=\"csrf-token\"]').attr('content')\n    };\n\n    if (notificaciones_ids === 'all') {\n        data.marcar_todo = true;\n    } else if (soporte_id) {\n        data.soporte_id = soporte_id;\n    } else if (notificaciones_ids) {\n        data.notificaciones_ids = Array.isArray(notificaciones_ids)\n            ? notificaciones_ids\n            : [notificaciones_ids];\n    }\n\n    $.ajax({\n        url: '/usuario-marcar-notificaciones-leidas',\n        type: 'POST',\n        data: data,\n        success: function(respuesta) {\n            cargarNotificiacionesHeader();\n\n            if (notificaciones_ids && notificaciones_ids !== 'all' && ruta_destino) {\n                window.location.href = \"/\" + ruta_destino;\n            }\n\n            if (notificaciones_ids === 'all') {\n                $('#badge-notificaciones').remove();\n                $('#contenedor-boton-marcar-todas').empty();\n                $('.notificaciones-listado').addClass('bg-gray-90');\n                $('.bi-circle-fill').remove();\n            }\n        },\n        error: function(xhr, estatus, error) {\n            console.error('Error al cargar notificaciones:', error);\n        }\n    });\n}\n\n/**\n * Configurar WebSocket para notificaciones en tiempo real\n *\n * @return void\n * @author Andres Gonzalez\n */\nfunction configurarWebSocketNotificaciones() {\n    try {\n        if (!window.configuracion_reverbg) {\n            return;\n        }\n\n        const PUSHER = new Pusher(window.configuracion_reverbg.appKey, {\n            wsHost: window.configuracion_reverbg.host,\n            wsPort: window.configuracion_reverbg.port,\n            wssPort: window.configuracion_reverbg.port,\n            cluster: 'mt1',\n            forceTLS: false,\n            enabledTransports: ['ws', 'wss'],\n            authEndpoint: '/broadcasting-auth',\n            auth: {\n                headers: {\n                    'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\n                }\n            }\n        });\n\n        PUSHER.connection.bind('failed', function() {\n            console.error('❌ Conexión WebSocket falló');\n        });\n\n        PUSHER.connection.bind('error', function(error) {\n            console.error('❌ Error de WebSocket:', error);\n        });\n\n        let usuario_id = window.configuracion_reverbg.usuario_id;\n\n        if (!usuario_id) {\n            return;\n        }\n\n        const NOMBRE_CANAL = `private-App.Models.Usuarios.User.${usuario_id}`;\n        const CANAL = PUSHER.subscribe(NOMBRE_CANAL);\n\n        CANAL.bind('pusher:subscription_error', function(error) {\n            console.error('❌ Error al suscribirse al canal:', error);\n        });\n\n        // Escuchar eventos específicos de notificaciones\n        CANAL.bind('Illuminate\\\\Notifications\\\\Events\\\\BroadcastNotificationCreated', function(data) {\n            if (data.tipo === 'nueva_notificacion') {\n                audio_notificacion.play();\n                cargarNotificiacionesHeader();\n            }\n\n            if (data.tipo === 'nuevo_mensaje') {\n                if (($('#soporte-guardado-id').val() == data.soporte_id) || ($('#soporte_empresa_id').val() == data.soporte_id)) {\n                    audio_notificacion.play();\n                    consultarChat(data.soporte_id);\n                }\n            }\n        });\n    } catch (error) {\n        console.error('💥 Error en configurarWebSocketNotificaciones:', error);\n        console.error('Stack trace:', error.stack);\n    }\n}\n\n/**\n * Retornar el string entrante en formato title case.\n *\n * @param {string} texto\n * @returns {string}\n * @author Fahibram Cárcamo\n */\nfunction titleCase(texto) {\n    return texto.toLowerCase().replace(/\\b\\w/g, caracter => caracter.toUpperCase());\n}\n\n/**\n * Número de horas que durará el almacenamiento de la variable `ulitmas_empresas` en el\n * almacenamiento local **LocalStorage**.\n *\n * @var {number}\n * @author Fahibram Cárcamo\n */\nconst CANTIDAD_HORAS_VENCIMIENTO_ULTIMAS_EMPRESAS_LOCALSTORAGE = 6;\n\n/**\n * Validar si ya debe removerse la variable `ultimas_empresas` del alamacenamiento local\n * **LocalStorage**, si no es tiempo de eliminarla entonces se reinicia el tiempo de vigencia de la\n * variable.\n *\n * @returns {void}\n * @author Fahibram Cárcamo\n */\nfunction validarYActualizarUltimasEmpresasLocalStorage() {\n    let fecha_hora_actuales = moment();\n    let fecha_hora_vencimiento_ultimas_empresas = fecha_hora_actuales.clone().add(CANTIDAD_HORAS_VENCIMIENTO_ULTIMAS_EMPRESAS_LOCALSTORAGE, 'hours');\n    let fecha_hora_vencimiento_ultimas_empresas_localstorage = localStorage.getItem('vencimiento_ultimas_empresas');\n    let ultimas_empresas = localStorage.getItem('ultimas_empresas');\n\n    if (\n        ultimas_empresas != null &&\n        fecha_hora_vencimiento_ultimas_empresas_localstorage != null &&\n        fecha_hora_actuales.clone().isBefore(moment(fecha_hora_vencimiento_ultimas_empresas_localstorage).clone())\n    ) {\n        localStorage.setItem('vencimiento_ultimas_empresas', fecha_hora_vencimiento_ultimas_empresas.format('YYYY-MM-DD HH:mm:ss'));\n        return;\n    }\n\n    localStorage.removeItem('vencimiento_ultimas_empresas');\n    localStorage.removeItem('ultimas_empresas');\n}\n\n/**\n * Obtener la edad actual de un usuario según su fecha de nacimiento.\n *\n * @param {string} fecha_nacimiento\n * @returns {string}\n * @author José Manuel Jiménez\n * @author Fahibram Cárcamo\n * @author Andres Morales\n */\nfunction obtenerEdad(fecha_nacimiento) {\n    if (!fecha_nacimiento) return \"N/A\";\n    let hoy = new Date();\n    let nacimiento = new Date(fecha_nacimiento);\n    let edad = hoy.getFullYear() - nacimiento.getFullYear();\n    let mes = hoy.getMonth() - nacimiento.getMonth();\n    if (mes < 0 || (mes === 0 && hoy.getDate() < nacimiento.getDate())) edad--;\n    return edad + \" años\";\n}\n\n/**\n * Restablecer un input de tipo file.\n *\n * @param {html} elemento_input_html Elemento input html.\n * @param {html} label_elemento_input_html Label del elemento input html.\n * @param {html} boton_eliminar_elemento_input_html Botón para eliminar archivo del elemento input html.\n * @author Fahibram Cárcamo\n */\nfunction reiniciarCampoArchivo(elemento_input_html, label_elemento_input_html, boton_eliminar_elemento_input_html) {\n    elemento_input_html.val('');\n    elemento_input_html.removeAttr('data-base64');\n    label_elemento_input_html.text('Ningún archivo seleccionado');\n    boton_eliminar_elemento_input_html.hide();\n\n    if (elemento_input_html.data('imagen')) {\n        $('#' + elemento_input_html.data('imagen')).val('');\n        $('#' + elemento_input_html.data('imagen') + '_previsualizacion').attr('src', '');\n        $('#' + elemento_input_html.data('imagen') + '_fondo_previsualizacion').removeClass('d-none');\n    }\n}\n\n/**\n * Definir un campo destinado a recibir un número de teléfono celular.\n *\n * Esta función debe llamarse en el evento ready del objeto global document:\n * `$(document).ready(...)`. Ademas debe incluirse un pequeño fragmento de código en la función\n * `validacionAdicional` para que se agregué el código del número de celular al valor de campo\n * cuando se envíe el formulario donde se encutra el campo.\n *\n * ```\n * if (\n *   $('#input_celular_id').length &&\n *   $('#input_celular_id').val() !== '' &&\n *   input_celular.getNumber() !== ''\n * ) {\n *   $('#input_celular_id').val(input_celular.getNumber().slice(1));\n * }\n * ```\n *\n * Donde `input_celular` es el objeto retornado por esta función.\n *\n * @param {string} input_celular_id Id del campo.\n * @param {string} nombre_input_celular Nombre del campo.\n * @param {string} placeholder_input_celular Placeholder del campo.\n * @param {boolean} obligatorio El campo es obligatorio en el formulario.\n * @returns {object}\n * @author Fahibram Cárcamo\n */\nfunction definirInputTipoCelular(input_celular_id, nombre_input_celular, placeholder_input_celular, obligatorio = true) {\n    /**\n     * 🌎 Campo para ingresar un número de telefono con selectór de código de país con banderas.\n     * Este componente se creó con la librería International Telephone Input\n     * (https://intl-tel-input.com).\n     *\n     * La linea hiddenInput: () => ({ phone: 'celular_contacto' }) tiene como función establecer el\n     * nombre del campo, es decir, la llave del par llave-valor que se adjuntará en los datos del\n     * formulario cuando se envíe, en este caso 'celular_contacto'.\n     *\n     * Las lienas autoPlaceholder: 'aggressive' y\n     * customPlaceholder: (placeholder, country) => 'Celular*' se usan para definir el placeholder\n     * del campo.\n     *\n     * Con $('#celular_contacto').attr('required', true); se establece el campo como requerido\n     * dentro del formulario, se hace de esta forma porque la librería no admite el atributo\n     * required directamente en el componente html.\n     *\n     * @author Fahibram Cárcamo\n     */\n    if (document.querySelector(`#${input_celular_id}`)) {\n        const dropdown_dinamico = document.createElement('div');\n        document.body.appendChild(dropdown_dinamico);\n\n        let campo_celular = window.intlTelInput(document.querySelector(`#${input_celular_id}`), {\n            nationalMode: true,\n            initialCountry: 'co',\n            separateDialCode: true,\n            autoInsertDialCode: false,\n            autoPlaceholder: 'aggressive',\n            dropdownContainer: dropdown_dinamico,\n            customPlaceholder: (placeholder, country) => placeholder_input_celular,\n            loadUtils: () => import('https://cdn.jsdelivr.net/npm/intl-tel-input@25.4.2/build/js/utils.js'),\n            onlyCountries: [\n                'CO', // Colombia\n                'EC', // Ecuador\n                'AR', // Argentina\n                'CL', // Chile\n                'VE', // Venezuela\n                'PE', // Perú\n                'BO', // Bolivia\n                'UY', // Uruguay\n                'PY', // Paraguay\n                'PA', // Panamá\n                'MX', // México\n                'CR', // Costa Rica\n                // 'PR', // Puerto Rico\n                'CU', // Cuba\n                // 'DO', // República Dominicana\n                'SV', // El Salvador\n                'GT', // Guatemala\n                'HN', // Honduras\n                'NI', // Nicaragua\n                'ES', // España\n                'US', // Estados Unidos\n                'GQ'  // Guinea Ecuatorial\n            ]\n        });\n\n        if (obligatorio) $(`#${input_celular_id}`).attr('required', true);\n\n        return campo_celular;\n    }\n\n    return null;\n}\n\n/**\n * Establece la validación adicional que se aplica a un campo de tipo celular antes de enviar sus\n * datos en un formulario.\n *\n * @param {HTMLInputElement} input Elemento HTML del campo de tipo celular.\n * @param {string} input_id Id del elemento HTML del campo de tipo celular.\n * @author Fahibram Cárcamo\n * @author Jair Carvajal\n */\nfunction validacionAdicionalInputTipoCelular(input, input_id) {\n    let numero_completo = input.getNumber();\n    let indicativo = '+' + input.getSelectedCountryData().dialCode;\n    let codigo_iso2_pais = input.getSelectedCountryData().iso2;\n    let numero_sin_indicativo = numero_completo.replace(indicativo, '');\n    $(`#indicativo_${input_id}`).val(indicativo);\n    $(`#codigo_iso2_pais_${input_id}`).val(codigo_iso2_pais);\n    $(`#${input_id}`).val(numero_sin_indicativo);\n}\n\n/**\n * Rellenar un input de tipo celular.\n *\n * @param {string} indicativo_celular Código del país del número de celular.\n * @param {string} codigo_pais_iso2 Código ISO2 del país del número de celular.\n * @param {string} numero_celular Número de celular sin código de país.\n * @param {string} input_celular_id ID del input de tipo celular.\n * @param {HTMLInputElement} input_celular Input de tipo celular.\n * @returns {void}\n * @author Daniel Beltrán\n * @author Fahibram Cárcamo\n */\nfunction rellenarInputCelular(indicativo_celular, codigo_pais_iso2, numero_celular, input_celular_id, input_celular) {\n    $(`#${input_celular_id}`).val(numero_celular);\n    if (![null, undefined].includes(codigo_pais_iso2)) input_celular.setCountry(codigo_pais_iso2);\n}\n\n/**\n * Convierte imágenes de base64 a Blob.\n *\n * @param {string} cadena_base_64 Base 64 de la imagen.\n * @returns {Promise<Array>}\n * @author Andres Gonzalez\n */\nfunction imagenBase64Blob(cadena_base_64) {\n    if (!cadena_base_64 || !cadena_base_64.startsWith('data:image')) return null;\n    let datos_base_64 = cadena_base_64.split(',')[1];\n    let tipo_mime = cadena_base_64.match(/data:(.*?);base64/)[1];\n    let caracteres_binarios = atob(datos_base_64);\n    let arreglo_bytes = new Array(caracteres_binarios.length).fill(0).map((_, i) => caracteres_binarios.charCodeAt(i));\n    let bytes_uint8 = new Uint8Array(arreglo_bytes);\n    return new Blob([bytes_uint8], { type: tipo_mime });\n}\n\n\n/**\n * Limpiar estructuras html innecesarias en el check editor.\n *\n * @param {string} html - Cadena HTML generada por CKEditor a limpiar\n * @returns {string} HTML limpio sin elementos específicos de CKEditor\n * @author Andres Gonzalez\n * @author Jair Carvajal\n */\nfunction limpiarHTMLCKEditor(html) {\n    // Remover todos los elementos con clases de CKEditor\n    html = html.replace(/<div class=\"ck[^\"]*\"[^>]*>.*?<\\/div>/gs, '');\n    html = html.replace(/<span class=\"[^\"]*ck[^\"]*\"[^>]*>/gi, '<span>');\n\n    // Limpiar spans de imagen inline\n    html = html.replace(/<span class=\"image-inline[^\"]*\"[^>]*>/gi, '');\n    html = html.replace(/<\\/span>/g, '');\n\n    // Remover elementos de upload y widgets\n    html = html.replace(/<div class=\"ck-image-upload[^\"]*\"[^>]*>.*?<\\/div>/gs, '');\n    html = html.replace(/<div class=\"ck-fake-selection[^\"]*\"[^>]*>.*?<\\/div>/gs, '');\n\n    // Remover atributos innecesarios\n    html = html.replace(/contenteditable=\"[^\"]*\"/gi, '');\n    html = html.replace(/data-cke-filler=\"[^\"]*\"/gi, '');\n\n    // Limpiar párrafos vacíos con br\n    html = html.replace(/<p><br[^>]*><\\/p>/gi, '');\n    html = html.replace(/<br data-cke[^>]*>/gi, '');\n\n    // Limpiar espacios múltiples y saltos de línea\n    html = html.replace(/\\s+/g, ' ');\n    html = html.replace(/>\\s+</g, '><');\n\n    return html.trim();\n}\n\n/**\n * Ordena estudios por fecha_inicio más reciente (de más nueva a más antigua).\n * Preserva los índices originales para permitir edición y eliminación correcta.\n *\n * @param {Array} estudios - Array de objetos con estudios\n * @returns {Array} Array de estudios ordenados con propiedad indice_original\n * @author Jair Carvajal\n */\nfunction ordenarEstudiosPorFecha(estudios) {\n    // Mapear con índice original\n    let estudios_con_indice = estudios.map((estudio, indice_original) => ({\n        ...estudio,\n        indice_original: indice_original\n    }));\n\n    // Ordenar estudios por fecha_inicio (más reciente primero)\n    let estudios_ordenados = estudios_con_indice.sort((a, b) => {\n        // Si ambos tienen fecha_inicio, ordenar por más reciente\n        if (a.fecha_inicio && b.fecha_inicio) {\n            return moment(b.fecha_inicio).diff(moment(a.fecha_inicio));\n        }\n        // Si solo uno tiene fecha_inicio, ese va primero\n        if (a.fecha_inicio && !b.fecha_inicio) return -1;\n        if (!a.fecha_inicio && b.fecha_inicio) return 1;\n        // Si ninguno tiene fecha_inicio, mantener orden original\n        return 0;\n    });\n\n    return estudios_ordenados;\n}\n\n/**\n * Ordena experiencias laborales por fecha: primero las que está trabajando actualmente (sin fecha_fin),\n * luego por fecha_fin más reciente.\n * Preserva los índices originales para permitir edición y eliminación correcta.\n *\n * @param {Array} experiencias - Array de objetos con experiencias laborales\n * @returns {Array} Array de experiencias ordenadas con propiedad indice_original\n * @author Jair Carvajal\n */\nfunction ordenarExperienciasPorFecha(experiencias) {\n    // Mapear con índice original\n    let experiencias_con_indice = experiencias.map((experiencia, indice_original) => ({\n        ...experiencia,\n        indice_original: indice_original\n    }));\n\n    // Ordenar experiencias\n    let experiencias_ordenadas = experiencias_con_indice.sort((a, b) => {\n        // Si 'a' no tiene fecha_fin (trabaja actualmente), va primero\n        if (!a.fecha_fin && b.fecha_fin) return -1;\n        // Si 'b' no tiene fecha_fin (trabaja actualmente), va primero\n        if (a.fecha_fin && !b.fecha_fin) return 1;\n        // Si ambos están trabajando actualmente (sin fecha_fin), mantener el orden actual\n        if (!a.fecha_fin && !b.fecha_fin) return 0;\n        // Si ambos tienen fecha_fin, ordenar por fecha más reciente primero (descendente)\n        return moment(b.fecha_fin).diff(moment(a.fecha_fin));\n    });\n\n    return experiencias_ordenadas;\n}\n\n/**\n * Obtener créditos disponibles de la empresa y actualizar el tag.\n * - Si tiene créditos >= 20% del plan: tag azul\n * - Si tiene créditos < 20% del plan: tag amarillo\n * - Si no tiene créditos: tag gris \"Sin créditos\"\n *\n * @param {number} empresa_id ID de la empresa\n * @param {string} contenedor_id ID del contenedor donde se mostrará el tag\n * @returns {void}\n * @author Andres Gonzalez\n */\nfunction obtenerCreditosDisponiblesEmpresa(empresa_id, contenedor_id = 'contenedor-tag-creditos') {\n    if (!empresa_id || !$(`#${contenedor_id}`).length) {\n        return;\n    }\n\n    $.ajax({\n        url: `/api/empresas/${empresa_id}/creditos`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            let creditos_disponibles = respuesta?.data?.creditos_disponibles ?? 0;\n            let creditos_plan = respuesta?.data?.creditos_plan ?? 0;\n            let porcentaje_disponible = creditos_plan > 0 ? (creditos_disponibles / creditos_plan) * 100 : 0;\n\n            let texto_tag = '';\n            let clase_tag = '';\n            let icono_final = '';\n\n            if (creditos_disponibles <= 0) {\n                texto_tag = 'Sin créditos';\n                clase_tag = 'tag-tonal-gray';\n                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.' })}></i>`;\n            } else if (porcentaje_disponible < 20) {\n                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                clase_tag = 'tag-filled-yellow';\n                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'Estás cerca de agotar tus créditos. Te queda menos del 20% del total disponible. Considera recargar o revisar tu consumo para evitar interrupciones.' })}></i>`;\n            } else {\n                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                clase_tag = 'tag-tonal-blue';\n            }\n\n            $(`#${contenedor_id}`).html(crearTag({\n                texto: texto_tag,\n                class: clase_tag,\n                icono_final: icono_final,\n            }));\n        },\n        error: function() {\n            $(`#${contenedor_id}`).html(crearTag({\n                texto: 'Error al cargar créditos',\n                class: 'tag-tonal-gray',\n            }));\n        }\n    });\n}\n","structuredPatch":[{"oldStart":1428,"oldLines":7,"newStart":1428,"newLines":7,"lines":["             let clase_tag = '';","             let icono_final = '';"," ","-            if (creditos_disponibles <= 0) {","+            if (creditos_disponibles <= 0 || creditos_plan <= 0) {","                 texto_tag = 'Sin créditos';","                 clase_tag = 'tag-tonal-gray';","                 icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.' })}></i>`;"]}],"userModified":false,"replaceAll":false},"sourceToolAssistantUUID":"b146b505-61d5-438b-9924-dc2d0ae8223c"}
{"parentUuid":"bf3fda0f-d14a-4221-b479-ce6178499d5e","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01PxJGj492uFyJ8DxFo75tNi","type":"message","role":"assistant","content":[{"type":"text","text":"Listo. Ahora la validación muestra \"Sin créditos\" (tag gris) cuando:\n- `creditos_disponibles <= 0` (no tiene créditos disponibles)\n- `creditos_plan <= 0` (no tiene un plan de créditos asociado)"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":858,"cache_read_input_tokens":94726,"cache_creation":{"ephemeral_5m_input_tokens":858,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXLuEnnQnZLVEm1zFMBtS","type":"assistant","uuid":"cb1fe709-5b6a-4b3c-bfce-35dedf3405ed","timestamp":"2026-01-21T17:16:06.387Z"}
{"type":"queue-operation","operation":"dequeue","timestamp":"2026-01-21T17:28:07.840Z","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961"}
{"type":"file-history-snapshot","messageId":"c2bee892-89c8-46fa-b64b-8ae31780a88f","snapshot":{"messageId":"c2bee892-89c8-46fa-b64b-8ae31780a88f","trackedFileBackups":{"resources\\views\\vacantes\\paginas\\index.blade.php":{"backupFileName":"1ae59264a32091d1@v9","version":9,"backupTime":"2026-01-21T16:50:05.680Z"},"public\\js\\globales.js":{"backupFileName":"704f632e999527e6@v6","version":6,"backupTime":"2026-01-21T17:28:10.019Z"},"public\\js\\vacantes\\vacantes.js":{"backupFileName":"ca631dbb99127e3f@v3","version":3,"backupTime":"2026-01-21T16:33:41.257Z"},"public\\componentes\\componentes\\tags.js":{"backupFileName":"247759b31878023a@v2","version":2,"backupTime":"2026-01-21T16:39:57.931Z"}},"timestamp":"2026-01-21T17:28:09.990Z"},"isSnapshotUpdate":false}
{"parentUuid":"2977bf41-c200-4801-abb2-4f4bbcde75fd","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Read","command":"callback"},"toolUseID":"toolu_019zAxyXNjR9qGH7WcACNmXN","parentToolUseID":"toolu_019zAxyXNjR9qGH7WcACNmXN","uuid":"652104a5-116d-483e-a830-516cf8ab0981","timestamp":"2026-01-21T17:15:43.510Z"}
{"parentUuid":"b146b505-61d5-438b-9924-dc2d0ae8223c","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Edit","command":"callback"},"toolUseID":"toolu_01GMhgjjLdCPV6VxdTvaqXma","parentToolUseID":"toolu_01GMhgjjLdCPV6VxdTvaqXma","uuid":"12a43d79-8708-436b-ad78-3fc4ce8bff47","timestamp":"2026-01-21T17:15:50.908Z"}
{"parentUuid":"12a43d79-8708-436b-ad78-3fc4ce8bff47","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Edit","command":"callback"},"toolUseID":"toolu_01GMhgjjLdCPV6VxdTvaqXma","parentToolUseID":"toolu_01GMhgjjLdCPV6VxdTvaqXma","uuid":"5a390cc5-88a4-486d-8a6d-10cec6e15746","timestamp":"2026-01-21T17:15:50.908Z"}
{"parentUuid":"bf3fda0f-d14a-4221-b479-ce6178499d5e","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"callback"},"parentToolUseID":"toolu_01GMhgjjLdCPV6VxdTvaqXma","toolUseID":"toolu_01GMhgjjLdCPV6VxdTvaqXma","timestamp":"2026-01-21T17:16:01.322Z","uuid":"eeb489c2-821c-4f29-bd45-2d07fc1eb4ff"}
{"parentUuid":"cb1fe709-5b6a-4b3c-bfce-35dedf3405ed","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"type":"text","text":"quiero ajuatr la validacion y es si no tiene creditos diponibles muetres ese toas pero si no tiene  \"plan_credito\": null que se null tambien que mujestre ese toast"}]},"uuid":"c2bee892-89c8-46fa-b64b-8ae31780a88f","timestamp":"2026-01-21T17:28:09.987Z"}
{"parentUuid":"c2bee892-89c8-46fa-b64b-8ae31780a88f","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01SnN1HccrV1YpjmdTRduUrX","type":"message","role":"assistant","content":[{"type":"text","text":"Entendido. Voy a ajustar la validación para que verifique si `plan_credito` es `null` también."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":98510,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":98510,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXLvAPMmKa9mbDq7osnvK","type":"assistant","uuid":"bf497f4f-7f93-4ce9-9953-cde7309a7804","timestamp":"2026-01-21T17:28:13.520Z"}
{"parentUuid":"bf497f4f-7f93-4ce9-9953-cde7309a7804","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01SnN1HccrV1YpjmdTRduUrX","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_011HnGTWEirwPtRwaC3oH9oc","name":"Read","input":{"file_path":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\globales.js","offset":1415,"limit":40}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":98510,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":98510,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXLvAPMmKa9mbDq7osnvK","type":"assistant","uuid":"0bed43ce-d1ed-4662-acd3-86a2ab5280f6","timestamp":"2026-01-21T17:28:14.243Z"}
{"parentUuid":"0bed43ce-d1ed-4662-acd3-86a2ab5280f6","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_011HnGTWEirwPtRwaC3oH9oc","type":"tool_result","content":"  1415→        return;\n  1416→    }\n  1417→\n  1418→    $.ajax({\n  1419→        url: `/api/empresas/${empresa_id}/creditos`,\n  1420→        method: 'GET',\n  1421→        dataType: 'json',\n  1422→        success: function(respuesta) {\n  1423→            let creditos_disponibles = respuesta?.data?.creditos_disponibles ?? 0;\n  1424→            let creditos_plan = respuesta?.data?.creditos_plan ?? 0;\n  1425→            let porcentaje_disponible = creditos_plan > 0 ? (creditos_disponibles / creditos_plan) * 100 : 0;\n  1426→\n  1427→            let texto_tag = '';\n  1428→            let clase_tag = '';\n  1429→            let icono_final = '';\n  1430→\n  1431→            if (creditos_disponibles <= 0 || creditos_plan <= 0) {\n  1432→                texto_tag = 'Sin créditos';\n  1433→                clase_tag = 'tag-tonal-gray';\n  1434→                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.' })}></i>`;\n  1435→            } else if (porcentaje_disponible < 20) {\n  1436→                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n  1437→                clase_tag = 'tag-filled-yellow';\n  1438→                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'Estás cerca de agotar tus créditos. Te queda menos del 20% del total disponible. Considera recargar o revisar tu consumo para evitar interrupciones.' })}></i>`;\n  1439→            } else {\n  1440→                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n  1441→                clase_tag = 'tag-tonal-blue';\n  1442→            }\n  1443→\n  1444→            $(`#${contenedor_id}`).html(crearTag({\n  1445→                texto: texto_tag,\n  1446→                class: clase_tag,\n  1447→                icono_final: icono_final,\n  1448→            }));\n  1449→        },\n  1450→        error: function() {\n  1451→            $(`#${contenedor_id}`).html(crearTag({\n  1452→                texto: 'Error al cargar créditos',\n  1453→                class: 'tag-tonal-gray',\n  1454→            }));\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"b3772d04-197a-473a-ad14-3c7005245eb6","timestamp":"2026-01-21T17:28:15.579Z","toolUseResult":{"type":"text","file":{"filePath":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\globales.js","content":"        return;\n    }\n\n    $.ajax({\n        url: `/api/empresas/${empresa_id}/creditos`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            let creditos_disponibles = respuesta?.data?.creditos_disponibles ?? 0;\n            let creditos_plan = respuesta?.data?.creditos_plan ?? 0;\n            let porcentaje_disponible = creditos_plan > 0 ? (creditos_disponibles / creditos_plan) * 100 : 0;\n\n            let texto_tag = '';\n            let clase_tag = '';\n            let icono_final = '';\n\n            if (creditos_disponibles <= 0 || creditos_plan <= 0) {\n                texto_tag = 'Sin créditos';\n                clase_tag = 'tag-tonal-gray';\n                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.' })}></i>`;\n            } else if (porcentaje_disponible < 20) {\n                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                clase_tag = 'tag-filled-yellow';\n                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'Estás cerca de agotar tus créditos. Te queda menos del 20% del total disponible. Considera recargar o revisar tu consumo para evitar interrupciones.' })}></i>`;\n            } else {\n                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                clase_tag = 'tag-tonal-blue';\n            }\n\n            $(`#${contenedor_id}`).html(crearTag({\n                texto: texto_tag,\n                class: clase_tag,\n                icono_final: icono_final,\n            }));\n        },\n        error: function() {\n            $(`#${contenedor_id}`).html(crearTag({\n                texto: 'Error al cargar créditos',\n                class: 'tag-tonal-gray',\n            }));","numLines":40,"startLine":1415,"totalLines":1458}},"sourceToolAssistantUUID":"0bed43ce-d1ed-4662-acd3-86a2ab5280f6"}
{"parentUuid":"b3772d04-197a-473a-ad14-3c7005245eb6","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01495CNqU4VzjCNzow38JnQF","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01Hs7dsMi32AjgmajgCQLcae","name":"Edit","input":{"replace_all":false,"file_path":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\globales.js","old_string":"        success: function(respuesta) {\n            let creditos_disponibles = respuesta?.data?.creditos_disponibles ?? 0;\n            let creditos_plan = respuesta?.data?.creditos_plan ?? 0;\n            let porcentaje_disponible = creditos_plan > 0 ? (creditos_disponibles / creditos_plan) * 100 : 0;\n\n            let texto_tag = '';\n            let clase_tag = '';\n            let icono_final = '';\n\n            if (creditos_disponibles <= 0 || creditos_plan <= 0) {","new_string":"        success: function(respuesta) {\n            let creditos_disponibles = respuesta?.data?.creditos_disponibles ?? 0;\n            let creditos_plan = respuesta?.data?.creditos_plan ?? 0;\n            let plan_credito = respuesta?.data?.plan_credito;\n            let porcentaje_disponible = creditos_plan > 0 ? (creditos_disponibles / creditos_plan) * 100 : 0;\n\n            let texto_tag = '';\n            let clase_tag = '';\n            let icono_final = '';\n\n            if (creditos_disponibles <= 0 || plan_credito === null) {"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":1117,"cache_read_input_tokens":98510,"cache_creation":{"ephemeral_5m_input_tokens":1117,"ephemeral_1h_input_tokens":0},"output_tokens":25,"service_tier":"standard"}},"requestId":"req_011CXLvAoKRHZuCSmWctLAvS","type":"assistant","uuid":"35a29b79-4797-4ae8-9087-f633f1f8b919","timestamp":"2026-01-21T17:28:21.293Z"}
{"parentUuid":"35a29b79-4797-4ae8-9087-f633f1f8b919","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01Hs7dsMi32AjgmajgCQLcae","type":"tool_result","content":"The file c:\\laragon\\www\\psicoalianza-2\\public\\js\\globales.js has been updated. Here's the result of running `cat -n` on a snippet of the edited file:\n  1418→    $.ajax({\n  1419→        url: `/api/empresas/${empresa_id}/creditos`,\n  1420→        method: 'GET',\n  1421→        dataType: 'json',\n  1422→        success: function(respuesta) {\n  1423→            let creditos_disponibles = respuesta?.data?.creditos_disponibles ?? 0;\n  1424→            let creditos_plan = respuesta?.data?.creditos_plan ?? 0;\n  1425→            let plan_credito = respuesta?.data?.plan_credito;\n  1426→            let porcentaje_disponible = creditos_plan > 0 ? (creditos_disponibles / creditos_plan) * 100 : 0;\n  1427→\n  1428→            let texto_tag = '';\n  1429→            let clase_tag = '';\n  1430→            let icono_final = '';\n  1431→\n  1432→            if (creditos_disponibles <= 0 || plan_credito === null) {\n  1433→                texto_tag = 'Sin créditos';\n  1434→                clase_tag = 'tag-tonal-gray';\n  1435→                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.' })}></i>`;\n  1436→            } else if (porcentaje_disponible < 20) {"}]},"uuid":"ffbeba7b-95c5-41f1-83f9-76c9ecb3c79f","timestamp":"2026-01-21T17:29:05.701Z","toolUseResult":{"filePath":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\globales.js","oldString":"        success: function(respuesta) {\n            let creditos_disponibles = respuesta?.data?.creditos_disponibles ?? 0;\n            let creditos_plan = respuesta?.data?.creditos_plan ?? 0;\n            let porcentaje_disponible = creditos_plan > 0 ? (creditos_disponibles / creditos_plan) * 100 : 0;\n\n            let texto_tag = '';\n            let clase_tag = '';\n            let icono_final = '';\n\n            if (creditos_disponibles <= 0 || creditos_plan <= 0) {","newString":"        success: function(respuesta) {\n            let creditos_disponibles = respuesta?.data?.creditos_disponibles ?? 0;\n            let creditos_plan = respuesta?.data?.creditos_plan ?? 0;\n            let plan_credito = respuesta?.data?.plan_credito;\n            let porcentaje_disponible = creditos_plan > 0 ? (creditos_disponibles / creditos_plan) * 100 : 0;\n\n            let texto_tag = '';\n            let clase_tag = '';\n            let icono_final = '';\n\n            if (creditos_disponibles <= 0 || plan_credito === null) {","originalFile":"// Mensajes en español para el plugin Select2\nconst mensajes_select2 = {\n    'noResults'              : () => { return 'No hay resultados para la búsqueda.'; },\n    'searching'              : () => { return 'Buscando...'; },\n    'Loading'                : () => { return 'Cargando...'; },\n    'loadingMore'            : () => { return 'Cargando más resultados...'; },\n    'dropdownFooter'         : (texto) => { return `Mostrando ${texto} resultados`; },\n    'emptyOptions'           : () => { return 'No hay opciones disponibles.'; },\n    'appendItems'            : (items) => { return `Agregando ${items.length} elementos.`; },\n    'maximumSelectionReached': () => { return 'Se ha alcanzado el número máximo de selecciones.'; },\n    'selectOnClose'          : () => { return 'Seleccione una opción al cerrar el menú.'; },\n    'escapeKeyUp'            : () => { return 'Presione \\'Escape\\' para cerrar el menú.'; },\n    'errorLoading'           : () => { return 'Error al cargar datos. Inténtalo de nuevo más tarde.'; },\n    'inputTooShort'          : (elemento) => { return `Ingresa al menos ${elemento.minimum} caracteres para iniciar una búsqueda.`; },\n    'noMatches'              : () => { return 'No se encontraron coincidencias para tu búsqueda.'; },\n    'allowClear'             : () => { return 'Borrar selección'; },\n    'SelectionTooLong'       : (conteo, maximo) => { return `Solo puedes seleccionar ${maximo} opciones.`; },\n    'loadMore'               : () => { return 'Cargando más resultados...'; },\n    'removing'               : (seleccion) => { return 'Eliminando...'; },\n    'matches'                : (coincidencias, total) => {\n        if (coincidencias === 0) {\n            return 'No hay coincidencias.';\n        } else if (coincidencias === 1) {\n            return 'Se encontró 1 coincidencia.';\n        } else {\n            return `Se encontraron ${coincidencias} coincidencias entre ${total}.`;\n        }\n    }\n};\n\n// audios\nvar audio_notificacion = new Audio('/audios/notificacion.mp3');\n\nlet mostro_modal_creditos_ia = false;\nlet funcion_ejecucion_ia = null;\nlet modals_abiertos_ia = null;\n\n/**\n * Mostrar modal de créditos IA\n * \n * @return void\n * @author José Manuel Jiménez\n */\nfunction mostrarModalCreditosIA(servicio_ia_id) {\n    $.ajax({\n        url: `/api/empresas/${$('#empresa_sesion_id').val()}/creditos`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta_empresa) {\n            if (respuesta_empresa?.data?.creditos_disponibles > 0) {\n                $.ajax({\n                    url: `/api/servicios-ia/${servicio_ia_id}/creditos`,\n                    method: 'GET',\n                    dataType: 'json',\n                    success: function(respuesta) {\n                        if (respuesta?.data?.consume_creditos && respuesta?.data?.consume_creditos <= respuesta_empresa.data.creditos_disponibles) {\n                            $('#cantidad-creditos-descontar-modal').text(respuesta.data.consume_creditos);\n                            $('#modal-consumo-creditos-ia').modal('show');\n                            mostro_modal_creditos_ia = true;\n                            modals_abiertos_ia = $('.modal.show').not('#modal-consumo-creditos-ia').not('#modal-generando-ia');\n                            $(modals_abiertos_ia).addClass('d-none');\n                        } else {\n                            mostrarToastSolicitarCreditosIA();\n                        }\n                    }\n                });\n            } else {\n                mostrarToastSolicitarCreditosIA();\n            }\n        }\n    });\n}\n\n/**\n * Mostrar toast para solicitar créditos IA\n * \n * @return void\n * @author José Manuel Jiménez\n */\nfunction mostrarToastSolicitarCreditosIA() {\n    $.ajax({\n        url: `/empresas/${$('#empresa_sesion_id').val()}`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            let adicional_toast = '';\n            if (respuesta?.data?.ejecutivo?.telefono) {\n                adicional_toast = `<a href=\"https://wa.me/${respuesta.data.ejecutivo.telefono.replace(/\\D/g, '')}?text=Hola,%20me%20gustar%C3%ADa%20solicitar%20cr%C3%A9ditos%20adicionales%20para%20mi%20empresa.\" target=\"_blank\">\n                    <p class=\"text-label-1 text-white no-visited text-decoration-none mb-0\">Solicitar</p>\n                </a>`;\n            }\n            setTimeout(() => {\n                $('#modal-generando-ia').modal('hide');\n                $('#modal-cargue-ia').modal('hide');\n                mostrarToast('danger', 'No cuentas con créditos. Solicita créditos adicionales.', '', adicional_toast);\n            }, 300);\n        }\n    });\n}\n\n/**\n * Continuar ejecución IA luego del modal de créditos\n * \n * @return void\n * @author José Manuel Jiménez\n */\nfunction continuarEjecucionIA() {\n    if (funcion_ejecucion_ia) {\n        funcion_ejecucion_ia();\n        funcion_ejecucion_ia = null;\n    }\n    mostro_modal_creditos_ia = false;\n    $('#modal-consumo-creditos-ia').modal('hide');\n}\n\n/**\n * Solicitar más créditos IA\n * \n * @return void\n * @author José Manuel Jiménez\n */\nfunction solicitarMasCreditosIA() {\n    $.ajax({\n        url: `/empresas/${$('#empresa_sesion_id').val()}`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            if (respuesta?.data?.ejecutivo?.telefono) {\n                window.open(`https://wa.me/${respuesta.data.ejecutivo.telefono.replace(/\\D/g, '')}?text=Hola,%20me%20gustar%C3%ADa%20solicitar%20cr%C3%A9ditos%20adicionales%20para%20mi%20empresa.`, '_blank');\n            } else {\n                mostrarToast('danger', 'No se encontró un ejecutivo asignado a la empresa. Por favor, comunícate con soporte para recargar créditos.');\n            }\n            $('#modal-solicitar-mas-creditos-ia').modal('hide');\n        }\n    });\n}\n\n/**\n * Validar respuesta de créditos IA\n * \n * @return void\n * @author José Manuel Jiménez\n */\nfunction validarRespuestaCreditosIA(error_ia) {\n    if (error_ia == 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.') {\n        mostrarToastSolicitarCreditosIA();\n        return true;\n    }\n    return false;\n}\n\n/**\n * Ajustar el ancho de los elementos select2 asincrono multiple.\n *\n * @returns {void}\n * @author Andres Morales\n */\n$(document).ready(function () {\n    cargarNotificiacionesHeader();\n    if (window.configuracion_reverbg && window.configuracion_reverbg.activar_websocket) {\n        configurarWebSocketNotificaciones();\n    }\n    setTimeout(() => {\n        $(\".input-container\").each(function () {\n            let $container = $(this);\n            let $select = $container.find(\"select[multiple]\");\n            let $icon = $container.find(\".input-icono1\");\n            if ($select.length && $icon.length) {\n                $(this).find('.select2-selection--multiple').addClass('ps-5')\n            }\n        });\n    }, 1000);\n    $('#modal-consumo-creditos-ia').on('hidden.bs.modal', function () {\n        if (mostro_modal_creditos_ia) {\n            $(modals_abiertos_ia).removeClass('d-none');\n        }\n        mostro_modal_creditos_ia = false;\n    });\n\n    // Cargar créditos disponibles si existe el contenedor y el ID de empresa\n    if ($('#contenedor-tag-creditos').length && $('#empresa_sesion_id').length) {\n        obtenerCreditosDisponiblesEmpresa($('#empresa_sesion_id').val());\n    }\n});\n\n/**\n * Formatear fecha a formato dd/mm/yyyy - hh:mm AM/PM.  Ejemplo: 01/Feb/2022 - 12:00 PM\n *\n * @param {string} fecha_entrada fecha en formato ISO\n * @returns {string} fecha y hora formateada\n * @author Andres Morales\n */\nfunction formatearFecha(fecha_entrada) {\n    var fecha = new Date(fecha_entrada);\n    var dia = fecha.getDate();\n    var mes = fecha.toLocaleString('es-ES', { month: 'short' });\n    var anio = fecha.getFullYear();\n    let hora = fecha.getHours();\n    let minuto = fecha.getMinutes();\n    let ampm = hora >= 12 ? 'PM' : 'AM';\n    hora = hora % 12 || 12;\n    minuto = minuto.toString().padStart(2, '0');\n    return `${dia}/${mes}/${anio} - ${hora}:${minuto} ${ampm}`;\n}\n\nfunction formatearFecha2(fecha_entrada) {\n    let partes = fecha_entrada.split(' ');\n    let fecha = partes[0].split('-');\n    let hora = partes[1];\n    let fechaISO = `${fecha[2]}-${fecha[1]}-${fecha[0]}T${hora}`;\n\n    let date = new Date(fechaISO);\n\n    if (isNaN(date.getTime())) {\n        return 'Fecha inválida';\n    }\n\n    let dia = date.getDate();\n    let mes = date.toLocaleString('eu-EU', { month: 'short' });\n    let anio = date.getFullYear();\n    return `${dia}/${mes}/${anio}`;\n}\n\n/**\n * Opción para contraer o agrandar el menú principal\n *\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Andres Morales\n */\nfunction contraerMenu() {\n    if ($('.sidebar-menu').hasClass('close')) {\n        $('.sidebar-menu').removeClass('d-none');\n        localStorage.setItem('opcion_menu_storage', 'abierto');\n        $('#btn-collapse').attr('data-bs-original-title', 'Contraer');\n        $('#btn-collapse').attr('data-bs-title', 'Contraer');\n        $(\".menu-bar\").each(function() {\n            $(this).removeClass(\"px-2\").addClass(\"px-5\");\n        });\n        $('[data-bs-toggle=\"tooltip\"]').each(function () { new bootstrap.Tooltip(this); });\n        $('.lista-primary[data-bs-toggle=\"tooltip\"]').each(function () {\n            var tooltip_instancia = bootstrap.Tooltip.getInstance(this);\n            if (tooltip_instancia) {\n                tooltip_instancia.dispose();\n            }\n        });\n    } else {\n        $('.sidebar-menu').addClass('d-none');\n        localStorage.setItem('opcion_menu_storage', 'cerrado');\n        $('#btn-collapse').attr('data-bs-original-title', 'Expandir');\n        $('#btn-collapse').attr('data-bs-title', 'Expandir');\n        $(\".menu-bar\").each(function() {\n            $(this).removeClass(\"px-5\").addClass(\"px-2\");\n        });\n        $('[data-bs-toggle=\"tooltip\"]').each(function () { new bootstrap.Tooltip(this); });\n    }\n    $('.tooltip.bs-tooltip-auto').remove();\n    $('.sidebar-menu').toggleClass('close');\n    $('.contenedor-vista').toggleClass('close');\n    $('#btn-collapse').toggleClass('close');\n    $('.nombre-usuario-empresa').toggle();\n    $('.menu-bar .text-menu').toggle();\n}\n\n/**\n * Opción para abrir o cerrar el menu segun la elección guardada\n *\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Andres Morales\n */\nfunction mostrarMenuStorage() {\n    $(document).ready(function() {\n        $('.lista-primary[data-bs-toggle=\"tooltip\"]').each(function () {\n            var tooltip_instancia = bootstrap.Tooltip.getInstance(this);\n            if (tooltip_instancia) {\n                tooltip_instancia.dispose();\n            }\n        });\n\n        if (window.innerWidth < 768) {\n            localStorage.setItem('opcion_menu_storage', 'cerrado');\n        }\n\n        if (localStorage.getItem('opcion_menu_storage') === 'cerrado') {\n            contraerMenu();\n        }\n        let $active = $('.menu-bar .active');\n\n        if ($active.length) {\n            $('.menu-bar').scrollTop($active.position().top);\n        }\n    });\n}\nmostrarMenuStorage();\n\n/**\n * Funcion para hacer el slug de un texto desde jquery.\n *\n * @returns {void}\n * @author Andres Morales\n */\nfunction slugify(text) {\n    return $.trim(text)\n        .toLowerCase()\n        .normalize(\"NFD\")\n        .replace(/[\\u0300-\\u036f]/g, \"\")\n        .replace(/[^a-z0-9 -]/g, \"\")\n        .replace(/\\s+/g, \"-\")\n        .replace(/-+/g, \"-\");\n}\n\n/**\n * Función generica para mostrar mensajes de respuesta\n *\n * @param {string} tipo_alerta define el color de la alerta segun alerts de botstrap.\n * @param {string} texto_1 Texto que mostrara la alerta.\n * @param {string} texto_2 Texto secundario en la alerta.\n * @param {string} accion Acción adicional(por definir).\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Andres Gonzalez\n */\nfunction mostrarToast(tipo_alerta, texto_1, texto_2 = '', accion = '', icono2 = '') {\n    let icono = '';\n    let texto_color = 'text-white';\n    if (accion != '') {\n        accion = `<div class=\"col-auto p-0 text-label-1\">${accion}</div>`;\n    }\n\n    if (tipo_alerta == 'success') {\n        icono = 'bi bi-check-circle';\n    }\n\n    if (tipo_alerta == 'neutral') {\n        icono = 'bi bi-info-circle';\n    }\n\n    if (tipo_alerta == 'warning') {\n        icono = 'bi bi-info-circle';\n        texto_color = \"text-red-letras\";\n    }\n\n    if (tipo_alerta == 'danger') {\n        icono = 'bi bi-x-circle';\n    }\n\n    if (icono2 != '') {\n        icono = icono2;\n    }\n\n    if (texto_2 != '') {\n        texto_2 = `<div class=\"col-12 p-0 text-label-1 ${texto_color}\">${texto_2}</div>`;\n    }\n\n    let alert_toast = $(`\n        <div class=\"alert toast-${tipo_alerta} alert-dismissible fade show d-flex align-items-center pe-3 py-3 me-3\" role=\"alert\" style=\"display:none\">\n            <div class=\"col-auto\">\n                <span class=\"${icono} ${texto_color}\"></span>\n            </div>\n            <div class=\"col px-3\">\n                <div class=\"row m-0 ${texto_color}\">\n                    <div class=\"col-12 p-0 text-label-1 ${texto_color}\">\n                        ${texto_1}\n                    </div>\n                    ${texto_2}\n                </div>\n            </div>\n            ${accion}\n            <div class=\"col-auto ms-3 pointer\" data-bs-dismiss=\"alert\">\n                <span class=\"bi bi-x ${texto_color}\"></span>\n            </div>\n        </div>\n    `);\n    $('#contenedor-alert-toast').append(alert_toast);\n    alert_toast.fadeIn();\n    setTimeout(function() {\n        alert_toast.fadeOut();\n        alert_toast.alert('close');\n    }, 5000);\n}\n\n/**\n * Formatear número.\n *\n * @param {number} numero número a formatear\n * @author Andres Morales\n */\nfunction formatearNumero(numero) {\n    return parseInt(numero).toLocaleString('es-ES');\n}\n\n/**\n * Formatear fecha.\n *\n * @param {*} fecha Fecha a formatear.\n * @param {boolean} incluir_segundos Indica si se debe incluir los segundos en la hora.\n * @param {string} formato Formato en el que se retornará la fecha.\n * @param {string} separador Símbolo que se usará para separar días, meses y años.\n * @returns {Object} Objeto con la fecha y hora formateada.\n * @author Daniel Beltrán\n */\nfunction formatearFechaConceptual(fecha, incluir_segundos = false, formato = 'Ymd', separador = '-') {\n    const NUEVA_FECHA = new Date(fecha);\n    const ANO         = NUEVA_FECHA.getFullYear();\n    const MES         = String(NUEVA_FECHA.getMonth() + 1).padStart(2, '0');\n    const DIA         = String(NUEVA_FECHA.getDate()).padStart(2, '0');\n    const HORAS       = String(NUEVA_FECHA.getHours()).padStart(2, '0');\n    const MINUTOS     = String(NUEVA_FECHA.getMinutes()).padStart(2, '0');\n    const SEGUNDOS    = String(NUEVA_FECHA.getSeconds()).padStart(2, '0');\n\n    let fecha_formateada = `${ANO}${separador}${MES}${separador}${DIA}`;\n\n    if (formato === 'dmY') {\n        fecha_formateada = `${DIA}${separador}${MES}${separador}${ANO}`;\n    }\n\n    return {\n        fecha: fecha_formateada,\n        hora : incluir_segundos ? `${HORAS}:${MINUTOS}:${SEGUNDOS}` : `${HORAS}:${MINUTOS}`\n    };\n}\n\n/**\n * Formatear fecha a May. 2023.\n *\n * @param {string} fechaISO Fecha a formatear.\n * @returns {string} Objeto con la fecha y hora formateada.\n * @author Andres Morales\n */\nfunction formatearFechaAnioMes(fechaISO) {\n    const fecha = new Date(fechaISO);\n    const opciones = { month: 'short', year: 'numeric' };\n    let fecha_formateada = fecha.toLocaleDateString('es-ES', opciones);\n\n    fecha_formateada = fecha_formateada.replace(\n        /^([a-zñ]+)(\\s\\d{4})$/,\n        (_, mes, anio) => `${mes.charAt(0).toUpperCase() + mes.slice(1)}. ${anio.trim()}`\n    );\n\n    return fecha_formateada;\n}\n\n/**\n * Formatear un numero a moneda.\n *\n * @param {string} valor Numero.\n * @returns {string} Numero formateado.\n * @author Andres Morales\n */\nfunction formatearMonedaCOP(valor) {\n    return new Intl.NumberFormat('es-CO', {\n        style: 'currency',\n        currency: 'COP',\n        minimumFractionDigits: 0,\n        maximumFractionDigits: 0\n    }).format(valor);\n}\n\n/**\n * Formatear fecha a un formato d/m/Y hh:mm:ss entendible para el usuario.\n *\n * @param {*} fecha_inicial Fecha a formatear.\n * @returns {String} String con la fecha y hora formateada.\n * @author José Manuel Jiménez\n */\nfunction fechaMostrar(fecha_inicial) {\n    if (!fecha_inicial) {\n        return \"\";\n    }\n    const fecha = new Date(fecha_inicial);\n    if (isNaN(fecha.getTime())) {\n        return \"\";\n    }\n    const dia = String(fecha.getUTCDate()).padStart(2, '0');\n    const mes = String(fecha.getUTCMonth() + 1).padStart(2, '0');\n    const anio = fecha.getUTCFullYear();\n    if (!fecha_inicial.includes(\" \")) {\n        return `${dia}/${mes}/${anio}`;\n    }\n    const horas = String(fecha.getUTCHours()).padStart(2, '0');\n    const minutos = String(fecha.getUTCMinutes()).padStart(2, '0');\n    const segundos = String(fecha.getUTCSeconds()).padStart(2, '0');\n    return `${dia}/${mes}/${anio} ${horas}:${minutos}:${segundos}`;\n}\n\n/**\n * Descargar Excel.\n *\n * @param {string} ruta Ruta desde donde se descarga el archivo.\n * @param {string} nombre_archivo Nombre del archivo descargado.\n * @param {boolean} marca_tiempo Indica si el nombre del archivo debe llevar marca de tiempo.\n * @param {Object} parametros Parámetros a enviar en la petición.\n * @returns {void}\n * @author Daniel Beltrán\n */\nasync function descargarExcel(ruta, nombre_archivo, marca_tiempo = true, parametros = {}) {\n    parametros._token = $('meta[name=\"csrf-token\"]').attr('content');\n\n    await $.ajax({\n        type     : 'POST',\n        url      : `/${ruta}`,\n        data     : parametros,\n        xhrFields: {\n            responseType: 'blob'\n        },\n        success: function (respuesta) {\n            // Crear una URL para el Blob\n            let url = window.URL.createObjectURL(respuesta); // 'respuesta' es el Blob\n            let a   = document.createElement('a'); // Crea un nuevo elemento <a> para iniciar la descarga\n            a.href  = url;\n            const fecha_actual     = new Date();\n            const dia              = fecha_actual.getDate();\n            const mes              = fecha_actual.getMonth() + 1;\n            const ano              = fecha_actual.getFullYear();\n            const hora             = fecha_actual.getHours();\n            const minutos          = fecha_actual.getMinutes();\n            const segundos         = fecha_actual.getSeconds();\n            const fecha_formateada = `${dia}${mes}${ano}${hora}${minutos}${segundos}`;\n\n            a.download = marca_tiempo ? `${nombre_archivo}-${fecha_formateada}.xlsx` : `${nombre_archivo}.xlsx`;\n            document.body.appendChild(a);\n            a.click();\n            window.URL.revokeObjectURL(url);\n            document.body.removeChild(a);\n        }\n    }).then(() => {\n        mostrarToast('success', 'Archivo descargado correctamente.');\n    }).catch((error) => {\n        mostrarToast('danger', 'Ocurrió un error al descargar el archivo.');\n    });\n}\n\n/**\n * Convierte un string a slug.\n *\n * @param {string} str\n * @returns {string}\n * @author Fahibram Cárcamo\n */\nfunction slug(str) {\n\n    // Quita espacios en blanco\n    str = str.replace(/^\\s+|\\s+$/g, \"\")\n\n    // Convierte el string a minusculas\n    str = str.toLowerCase()\n\n    // Quita los caracteres no alfanuméricos\n    str = str.replace(/[^a-z0-9 -]/g, \"\")\n\n    // Reemplaza los espacio con guiones\n    str = str.replace(/\\s+/g, \"-\")\n\n    // Remueve los guiones consecutivos\n    str = str.replace(/-+/g, \"-\")\n\n    return str\n}\n\n/**\n * Compara los elementos de dos arreglos y retorna `true` si son iguales y `false` en caso contrario\n * (Este función está pensada para comparar arreglos unidimensionales).\n *\n * @param {array} primer_arreglo\n * @param {array} segundo_arreglo\n * @param {boolean} comparar_orden\n * @return {boolean}\n * @author Fahibram Cárcamo\n */\nfunction sonArreglosIguales(primer_arreglo, segundo_arreglo, comparar_orden = false) {\n\n    if (!comparar_orden) {\n        primer_arreglo.sort()\n        segundo_arreglo.sort()\n    }\n\n    if (primer_arreglo.length !== segundo_arreglo.length) return false\n\n    for (let i = 0; i < primer_arreglo.length; i++) {\n        if (primer_arreglo[i] !== segundo_arreglo[i]) return false\n    }\n\n    return true\n}\n\n/**\n * Función para cambiar de empresa.\n *\n * @param {number} empresa_id ID de la empresa a la que se va a cambiar.\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Daniel Beltrán\n */\nfunction cambiarEmpresa(empresa_id) {\n    $.ajax({\n        type: 'POST',\n        url: '/suplantar-rol-admin-general',\n        data: {\n            _token    : $('meta[name=\"csrf-token\"]').attr('content'),\n            empresa_id: empresa_id\n        },\n        success: function (respuesta) {\n            localStorage.setItem('notificacionToast', JSON.stringify({\n                tipo_alerta: 'success',\n                texto_1    : 'Cambio de empresa exitoso'\n            }));\n\n            window.location.reload();\n        },\n        error: function (error) {\n            mostrarToast('danger', 'Ocurrió un error al cambiar de empresa');\n        }\n    });\n}\n\n/**\n * Enviar la solucitud de suplantación de rol y empresa al Back-end.\n *\n * @param {function|null} callback_exito Callback ejecutado en caso de éxito.\n * @param {string} url URL de suplantación.\n * @param {string} _token Token CSRF del formulario.\n * @param {number} empresa_id Id de la empresa a suplantar.\n * @param {number|null} rol_id Id del rol a suplantar.\n * @param {function|null} callback_error Callback ejecutado en caso de error.\n * @returns {void}\n * @author Fahibram Cárcamo\n */\nasync function enviarOrdenSuplantacionRolEmpresa (callback_exito, url, _token, empresa_id = null, rol_id = null, callback_error = null) {\n\n    let condicion_suplantacion = rol_id === null\n        ? empresa_id === null\n            ? true\n            : parseInt($('#empresa_sesion_id').val()) !== parseInt(empresa_id)\n        : parseInt($('#rol_sesion_id').val()) !== parseInt(rol_id) && parseInt($('#empresa_sesion_id').val()) !== parseInt(empresa_id);\n\n    if (condicion_suplantacion) {\n        let data = { _token };\n        if (empresa_id !== null) data.empresa_id = empresa_id;\n        if (rol_id !== null) data.rol_id = rol_id;\n\n        await $.ajax({ type: 'POST', url, data })\n            .then((respuesta, status, xhr) => {\n                if (xhr.status >= 200 && xhr.status < 300 && callback_exito !== null) callback_exito();\n            })\n            .catch(error => {\n                let swal_titulo, swal_texto;\n\n                if (error.status === 404) {\n                    if (error.responseJSON.mensaje) {\n                        swal_titulo = 'Algo salió mal';\n                        if (error.responseJSON.mensaje === 'no existe rol_suplantar') {\n                            swal_texto = 'El rol no existe.';\n                        } else if (error.responseJSON.mensaje === 'no existe empresa_suplantar') {\n                            swal_texto = 'La empresa no existe.';\n                        } else if (error.responseJSON.mensaje === 'no existe usuario_suplantar') {\n                            swal_texto = 'El usuario no existe.';\n                        } else {\n                            swal_texto = '';\n                        }\n                    } else if (error.responseJSON.empresa && error.responseJSON.rol) {\n                        swal_titulo = 'No fué posible cambiar de empresa';\n                        swal_texto = error.responseJSON.rol === 'Administrador general' || error.responseJSON.rol === 'Propietario'\n                            ? `La empresa ${error.responseJSON.empresa} no tiene ningún usuario con el rol Administrador general o Propietario.`\n                            : `La empresa ${error.responseJSON.empresa} no tiene ningún usuario con el rol ${error.responseJSON.rol}.`;\n                    } else {\n                        swal_titulo = 'Algo salió mal';\n                        swal_texto = error.responseJSON.errors;\n                    }\n                } else {\n                    swal_titulo = 'Algo salió mal';\n                    swal_texto = '';\n                }\n\n                if (callback_error !== null) callback_error();\n\n                Swal.fire({\n                    title: swal_titulo,\n                    text: swal_texto,\n                    icon: \"error\",\n                    confirmButtonText: \"Aceptar\"\n                });\n            });\n    }\n}\n\n/**\n * Mostrar tooltip según el div que lo contenga.\n *\n * @param {div} div Elemento en donde se va a mostrar el tooltip.\n * @returns {void}\n * @author Sol Espitia\n */\nfunction mostrarTooltip(div) {\n    const TOOLTIP         = div.querySelector('.tooltip-x');\n    TOOLTIP.style.display = 'block';\n}\n\n/**\n * Ocultar tooltip según el div que lo contenga.\n *\n * @param {div} div Elemento en donde se va a mostrar el tooltip.\n * @returns {void}\n * @author Sol Espitia\n */\nfunction ocultarTooltip(div) {\n    const TOOLTIP         = div.querySelector('.tooltip-x');\n    TOOLTIP.style.display = 'none';\n}\n\n/**\n * Retornar la diferencia en días de dos fechas dadas.\n *\n * @param {string} fecha_inicial Fecha inicial\n * @param {string} fecha_final Fecha final\n * @param {bool} valor_absoluto Retorna la diferencia en valor absoluto\n * @returns {number}\n * @author Fahibram Cárcamo\n * @author Andres Morales\n */\nfunction diferenciaFechasDias(fecha_inicial, fecha_final, valor_absoluto = false, sumar_dia = true) {\n    let fecha1 = new Date(fecha_inicial);\n    let fecha2 = new Date(fecha_final);\n\n    fecha1.setHours(0, 0, 0, 0);\n    fecha2.setHours(0, 0, 0, 0);\n\n    let diferencia_milisegundos = fecha2.getTime() - fecha1.getTime();\n\n    let diferencia_dias = diferencia_milisegundos / (1000 * 60 * 60 * 24);\n    let resultado = diferencia_dias;\n    if (sumar_dia) {\n        resultado = diferencia_dias + 1;\n    }\n\n    return valor_absoluto ? Math.abs(resultado) : resultado;\n}\n\n/**\n * Retornar `true` si una fecha dada está dentro de un rango de fechas dadas, `false` en otro caso.\n *\n * @param {string} fecha Fecha dada\n * @param {string} fecha_desde Fecha inicial del rango\n * @param {string} fecha_hasta Fecha final del rango\n * @returns {boolean}\n * @author Fahibram Cárcamo\n */\nfunction fechaDentroDelRango(fecha, fecha_desde, fecha_hasta) {\n    fecha = new Date(fecha);\n    fecha_desde = new Date(fecha_desde);\n    fecha_hasta = new Date(fecha_hasta);\n\n    if (isNaN(fecha) || isNaN(fecha_desde) || isNaN(fecha_hasta)) {\n        throw new Error('Una o más fechas no son válidas.');\n    }\n\n    return fecha >= fecha_desde && fecha <= fecha_hasta;\n}\n\n/**\n * Descuenta el tiempo para las respuestas.\n *\n * @param id - ID del elemento HTML donde mostrar el tiempo\n * @param tiempo - Tiempo inicial en segundos\n * @author Jair Carvajal\n */\nvar tiempos_usados = {};\n\nfunction descuentoTiempo(id, tiempo, callback, onTick) {\n    var $elemento = $('#' + id);\n    if ($elemento.length === 0) {\n        console.error('Elemento con id \"' + id + '\" no encontrado.');\n        return;\n    }\n    if (tiempos_usados[id]) {\n        clearInterval(tiempos_usados[id]);\n    }\n    let tiempoTotal = tiempo;\n    tiempos_usados[id] = setInterval(function() {\n        if (tiempo <= 0) {\n            clearInterval(tiempos_usados[id]);\n            delete tiempos_usados[id];\n            $elemento.text('Tiempo finalizado');\n            if (window.tiempoFinalizado()) {\n                tiempoFinalizado();\n            }\n            if (typeof callback === 'function') {\n                callback();\n            }\n            return;\n        }\n\n        var minutos = Math.floor(tiempo / 60);\n        var segundos = tiempo % 60;\n\n        var textoTiempo = minutos + ':' + (segundos < 10 ? '0' : '') + segundos + '<i class=\"bi bi-alarm ms-2\"></i>';\n\n        if (tiempo <= 15) {\n            $elemento.addClass('text-state-red');\n            $elemento.removeClass('text-state-green');\n        } else {\n            $elemento.addClass('text-state-green');\n            $elemento.removeClass('text-state-red');\n        }\n\n        $elemento.html(textoTiempo);\n\n        var tiempoUsado = tiempoTotal - tiempo;\n\n        if (typeof onTick === 'function') {\n            onTick((tiempoUsado % 5));\n        }\n        tiempo--;\n    }, 1000);\n}\n\n/**\n * Detengo el tiempo para las respuestas.\n *\n * @param id - ID del elemento HTML donde mostrar el tiempo\n * @param tiempo - Tiempo inicial en segundos\n * @author Jair Carvajal\n */\nfunction detenerDescuentoTiempo(id) {\n    if (tiempos_usados[id]) {\n        clearInterval(tiempos_usados[id]);\n        delete tiempos_usados[id];\n    }\n}\n\n/**\n * Genera un SVG de la imagen de usuario.\n *\n * @param id ID del usuario.\n * @param nombres Nombres del usuario.\n * @param apellidos Apellidos del usuario.\n * @return image\n * @author Andres Morales\n */\nfunction crearImagenUsuarioLetras(id, nombres, apellidos) {\n    var tamano = 200;\n    var iniciales = (nombres[0] + apellidos[0]).toUpperCase();\n    var hash = md5(id);\n\n    var r = parseInt(hash.substring(0, 2), 16);\n    var g = parseInt(hash.substring(2, 4), 16);\n    var b = parseInt(hash.substring(4, 6), 16);\n    var colorFondo = `rgb(${r},${g},${b})`;\n\n    var luminancia = 0.299 * r + 0.587 * g + 0.114 * b;\n    var colorTexto = luminancia > 150 ? \"#000000\" : \"#FFFFFF\";\n\n    // SVG como texto\n    var svg = `\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${tamano}\" height=\"${tamano}\">\n        <rect width=\"100%\" height=\"100%\" fill=\"${colorFondo}\" />\n        <text x=\"50%\" y=\"50%\" dy=\".35em\"\n            text-anchor=\"middle\"\n            font-family=\"Lato, sans-serif\"\n            font-size=\"${tamano * 0.4}\"\n            fill=\"${colorTexto}\">\n            ${iniciales}\n        </text>\n    </svg>`;\n    var svgEncoded = encodeURIComponent(svg)\n        .replace(/'/g, \"%27\")\n        .replace(/\"/g, \"%22\");\n\n    var dataUri = `data:image/svg+xml,${svgEncoded}`;\n    return dataUri;\n}\n\n/**\n * Carga las notificaciones\n *\n * @return void\n * @author Andres Morales\n * @author Andres Gonzalez\n * @author Esperanza Olivo\n */\nfunction cargarNotificiacionesHeader() {\n    $.ajax({\n        url: '/usuario-notificaciones',\n        type: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            let datos = respuesta.data;\n            let notificaciones_noleidas = datos?.unread_notifications?.length ?? 0;\n\n            // Siempre remover el badge existente\n            $('#dropdownNotificaciones #badge-notificaciones').remove();\n\n            // Solo agregar el badge si hay notificaciones no leídas\n            if (notificaciones_noleidas > 0) {\n                $('#dropdownNotificaciones').append(`<span id=\"badge-notificaciones\" class=\"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger border border-white\">${notificaciones_noleidas}</span>`);\n                $('#contador-notificaciones-abierto').append(`<span id=\"badge-notificaciones\" class=\"badge rounded-pill bg-danger border border-white\">${notificaciones_noleidas}</span>`);\n\n                $('#contenedor-boton-marcar-todas').html(`\n                    <button class=\"btn btn-link text-primary w-100 d-flex justify-content-center\" onclick=\"marcarNotificacionesLeidas('all')\">\n                        Marcar todo como leído\n                    </button>\n                `);\n            }\n\n            let no_leidos_ids = Array.isArray(datos?.unread_notifications) ? datos.unread_notifications.map(notificacion => notificacion.id): [];\n\n            if (Array.isArray(datos?.notifications) && datos.notifications.length > 0) {\n                $('#notificacion-sinnotificaciones').hide();\n                $('.notificaciones-listado').remove();\n                datos.notifications.forEach(notificacion => {\n                    const { id, data, updated_at } = notificacion;\n\n                    const NO_LEIDO = no_leidos_ids.includes(id);\n                    const MENSAJE = (data?.mensaje || '').slice(0, 120) + '...';\n                    const HORA = new Date(updated_at).toLocaleTimeString('es-CO', {\n                        hour: '2-digit',\n                        minute: '2-digit',\n                        hour12: false\n                    });\n\n                    const notificaciones = `\n                        <li class=\"${NO_LEIDO ? '' : 'bg-gray-90'} notificaciones-listado py-0\" id=\"notificacion-${id}\">\n                            <a class=\"dropdown-item text-gray-10 text-decoration-none border-top pt-0 pb-1\" href=\"javascript:void(0)\" onclick=\"marcarNotificacionesLeidas('${id}','${data?.ruta}')\">\n                                <div class=\"d-flex justify-content-between\">\n                                    <div class=\"w-auto flex-grow-1 pe-3\">\n                                        <p class=\"mt-1 mb-0 text-headline-6 text-gray-10\">${data?.titulo}</p>\n                                        <p class=\"mb-0 text-body-3 text-gray-30 notificacion-mensaje\">${MENSAJE}</p>\n                                    </div>\n                                    <div class=\"w-auto my-auto ${NO_LEIDO ? 'text-cta-azul' : 'text-gray-10'} text-label-2 flex-shrink-0\">\n                                        ${HORA}${NO_LEIDO ? `<i class=\"bi bi-circle-fill text-cta-azul my-auto texto-notificacion-icono ms-3\"></i>` : ''}\n                                    </div>\n                                </div>\n                            </a>\n                        </li>\n                    `;\n\n                    $(notificaciones).insertBefore('#contenedor-boton-marcar-todas');\n                });\n\n            } else {\n                $('#notificacion-sinnotificaciones').hide();\n                $('.notificaciones-listado').remove();\n            }\n\n        },\n        error: function(xhr, status, error) {\n            console.error('Error al cargar notificaciones:', error);\n        }\n    });\n}\n\n/**\n * Marcar las notificaciones leídas.\n *\n * @param {array} notificaciones_ids ids de las notificaciones\n * @param {string} ruta_destino ruta donde se va ha actualizar la pagina\n * @returns {void}\n * @author Andres Gonzalez\n * @author Esperanza Olivo\n */\nfunction marcarNotificacionesLeidas(notificaciones_ids = null, ruta_destino = null, soporte_id = null) {\n\n    let data = {\n        _token: $('meta[name=\"csrf-token\"]').attr('content')\n    };\n\n    if (notificaciones_ids === 'all') {\n        data.marcar_todo = true;\n    } else if (soporte_id) {\n        data.soporte_id = soporte_id;\n    } else if (notificaciones_ids) {\n        data.notificaciones_ids = Array.isArray(notificaciones_ids)\n            ? notificaciones_ids\n            : [notificaciones_ids];\n    }\n\n    $.ajax({\n        url: '/usuario-marcar-notificaciones-leidas',\n        type: 'POST',\n        data: data,\n        success: function(respuesta) {\n            cargarNotificiacionesHeader();\n\n            if (notificaciones_ids && notificaciones_ids !== 'all' && ruta_destino) {\n                window.location.href = \"/\" + ruta_destino;\n            }\n\n            if (notificaciones_ids === 'all') {\n                $('#badge-notificaciones').remove();\n                $('#contenedor-boton-marcar-todas').empty();\n                $('.notificaciones-listado').addClass('bg-gray-90');\n                $('.bi-circle-fill').remove();\n            }\n        },\n        error: function(xhr, estatus, error) {\n            console.error('Error al cargar notificaciones:', error);\n        }\n    });\n}\n\n/**\n * Configurar WebSocket para notificaciones en tiempo real\n *\n * @return void\n * @author Andres Gonzalez\n */\nfunction configurarWebSocketNotificaciones() {\n    try {\n        if (!window.configuracion_reverbg) {\n            return;\n        }\n\n        const PUSHER = new Pusher(window.configuracion_reverbg.appKey, {\n            wsHost: window.configuracion_reverbg.host,\n            wsPort: window.configuracion_reverbg.port,\n            wssPort: window.configuracion_reverbg.port,\n            cluster: 'mt1',\n            forceTLS: false,\n            enabledTransports: ['ws', 'wss'],\n            authEndpoint: '/broadcasting-auth',\n            auth: {\n                headers: {\n                    'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\n                }\n            }\n        });\n\n        PUSHER.connection.bind('failed', function() {\n            console.error('❌ Conexión WebSocket falló');\n        });\n\n        PUSHER.connection.bind('error', function(error) {\n            console.error('❌ Error de WebSocket:', error);\n        });\n\n        let usuario_id = window.configuracion_reverbg.usuario_id;\n\n        if (!usuario_id) {\n            return;\n        }\n\n        const NOMBRE_CANAL = `private-App.Models.Usuarios.User.${usuario_id}`;\n        const CANAL = PUSHER.subscribe(NOMBRE_CANAL);\n\n        CANAL.bind('pusher:subscription_error', function(error) {\n            console.error('❌ Error al suscribirse al canal:', error);\n        });\n\n        // Escuchar eventos específicos de notificaciones\n        CANAL.bind('Illuminate\\\\Notifications\\\\Events\\\\BroadcastNotificationCreated', function(data) {\n            if (data.tipo === 'nueva_notificacion') {\n                audio_notificacion.play();\n                cargarNotificiacionesHeader();\n            }\n\n            if (data.tipo === 'nuevo_mensaje') {\n                if (($('#soporte-guardado-id').val() == data.soporte_id) || ($('#soporte_empresa_id').val() == data.soporte_id)) {\n                    audio_notificacion.play();\n                    consultarChat(data.soporte_id);\n                }\n            }\n        });\n    } catch (error) {\n        console.error('💥 Error en configurarWebSocketNotificaciones:', error);\n        console.error('Stack trace:', error.stack);\n    }\n}\n\n/**\n * Retornar el string entrante en formato title case.\n *\n * @param {string} texto\n * @returns {string}\n * @author Fahibram Cárcamo\n */\nfunction titleCase(texto) {\n    return texto.toLowerCase().replace(/\\b\\w/g, caracter => caracter.toUpperCase());\n}\n\n/**\n * Número de horas que durará el almacenamiento de la variable `ulitmas_empresas` en el\n * almacenamiento local **LocalStorage**.\n *\n * @var {number}\n * @author Fahibram Cárcamo\n */\nconst CANTIDAD_HORAS_VENCIMIENTO_ULTIMAS_EMPRESAS_LOCALSTORAGE = 6;\n\n/**\n * Validar si ya debe removerse la variable `ultimas_empresas` del alamacenamiento local\n * **LocalStorage**, si no es tiempo de eliminarla entonces se reinicia el tiempo de vigencia de la\n * variable.\n *\n * @returns {void}\n * @author Fahibram Cárcamo\n */\nfunction validarYActualizarUltimasEmpresasLocalStorage() {\n    let fecha_hora_actuales = moment();\n    let fecha_hora_vencimiento_ultimas_empresas = fecha_hora_actuales.clone().add(CANTIDAD_HORAS_VENCIMIENTO_ULTIMAS_EMPRESAS_LOCALSTORAGE, 'hours');\n    let fecha_hora_vencimiento_ultimas_empresas_localstorage = localStorage.getItem('vencimiento_ultimas_empresas');\n    let ultimas_empresas = localStorage.getItem('ultimas_empresas');\n\n    if (\n        ultimas_empresas != null &&\n        fecha_hora_vencimiento_ultimas_empresas_localstorage != null &&\n        fecha_hora_actuales.clone().isBefore(moment(fecha_hora_vencimiento_ultimas_empresas_localstorage).clone())\n    ) {\n        localStorage.setItem('vencimiento_ultimas_empresas', fecha_hora_vencimiento_ultimas_empresas.format('YYYY-MM-DD HH:mm:ss'));\n        return;\n    }\n\n    localStorage.removeItem('vencimiento_ultimas_empresas');\n    localStorage.removeItem('ultimas_empresas');\n}\n\n/**\n * Obtener la edad actual de un usuario según su fecha de nacimiento.\n *\n * @param {string} fecha_nacimiento\n * @returns {string}\n * @author José Manuel Jiménez\n * @author Fahibram Cárcamo\n * @author Andres Morales\n */\nfunction obtenerEdad(fecha_nacimiento) {\n    if (!fecha_nacimiento) return \"N/A\";\n    let hoy = new Date();\n    let nacimiento = new Date(fecha_nacimiento);\n    let edad = hoy.getFullYear() - nacimiento.getFullYear();\n    let mes = hoy.getMonth() - nacimiento.getMonth();\n    if (mes < 0 || (mes === 0 && hoy.getDate() < nacimiento.getDate())) edad--;\n    return edad + \" años\";\n}\n\n/**\n * Restablecer un input de tipo file.\n *\n * @param {html} elemento_input_html Elemento input html.\n * @param {html} label_elemento_input_html Label del elemento input html.\n * @param {html} boton_eliminar_elemento_input_html Botón para eliminar archivo del elemento input html.\n * @author Fahibram Cárcamo\n */\nfunction reiniciarCampoArchivo(elemento_input_html, label_elemento_input_html, boton_eliminar_elemento_input_html) {\n    elemento_input_html.val('');\n    elemento_input_html.removeAttr('data-base64');\n    label_elemento_input_html.text('Ningún archivo seleccionado');\n    boton_eliminar_elemento_input_html.hide();\n\n    if (elemento_input_html.data('imagen')) {\n        $('#' + elemento_input_html.data('imagen')).val('');\n        $('#' + elemento_input_html.data('imagen') + '_previsualizacion').attr('src', '');\n        $('#' + elemento_input_html.data('imagen') + '_fondo_previsualizacion').removeClass('d-none');\n    }\n}\n\n/**\n * Definir un campo destinado a recibir un número de teléfono celular.\n *\n * Esta función debe llamarse en el evento ready del objeto global document:\n * `$(document).ready(...)`. Ademas debe incluirse un pequeño fragmento de código en la función\n * `validacionAdicional` para que se agregué el código del número de celular al valor de campo\n * cuando se envíe el formulario donde se encutra el campo.\n *\n * ```\n * if (\n *   $('#input_celular_id').length &&\n *   $('#input_celular_id').val() !== '' &&\n *   input_celular.getNumber() !== ''\n * ) {\n *   $('#input_celular_id').val(input_celular.getNumber().slice(1));\n * }\n * ```\n *\n * Donde `input_celular` es el objeto retornado por esta función.\n *\n * @param {string} input_celular_id Id del campo.\n * @param {string} nombre_input_celular Nombre del campo.\n * @param {string} placeholder_input_celular Placeholder del campo.\n * @param {boolean} obligatorio El campo es obligatorio en el formulario.\n * @returns {object}\n * @author Fahibram Cárcamo\n */\nfunction definirInputTipoCelular(input_celular_id, nombre_input_celular, placeholder_input_celular, obligatorio = true) {\n    /**\n     * 🌎 Campo para ingresar un número de telefono con selectór de código de país con banderas.\n     * Este componente se creó con la librería International Telephone Input\n     * (https://intl-tel-input.com).\n     *\n     * La linea hiddenInput: () => ({ phone: 'celular_contacto' }) tiene como función establecer el\n     * nombre del campo, es decir, la llave del par llave-valor que se adjuntará en los datos del\n     * formulario cuando se envíe, en este caso 'celular_contacto'.\n     *\n     * Las lienas autoPlaceholder: 'aggressive' y\n     * customPlaceholder: (placeholder, country) => 'Celular*' se usan para definir el placeholder\n     * del campo.\n     *\n     * Con $('#celular_contacto').attr('required', true); se establece el campo como requerido\n     * dentro del formulario, se hace de esta forma porque la librería no admite el atributo\n     * required directamente en el componente html.\n     *\n     * @author Fahibram Cárcamo\n     */\n    if (document.querySelector(`#${input_celular_id}`)) {\n        const dropdown_dinamico = document.createElement('div');\n        document.body.appendChild(dropdown_dinamico);\n\n        let campo_celular = window.intlTelInput(document.querySelector(`#${input_celular_id}`), {\n            nationalMode: true,\n            initialCountry: 'co',\n            separateDialCode: true,\n            autoInsertDialCode: false,\n            autoPlaceholder: 'aggressive',\n            dropdownContainer: dropdown_dinamico,\n            customPlaceholder: (placeholder, country) => placeholder_input_celular,\n            loadUtils: () => import('https://cdn.jsdelivr.net/npm/intl-tel-input@25.4.2/build/js/utils.js'),\n            onlyCountries: [\n                'CO', // Colombia\n                'EC', // Ecuador\n                'AR', // Argentina\n                'CL', // Chile\n                'VE', // Venezuela\n                'PE', // Perú\n                'BO', // Bolivia\n                'UY', // Uruguay\n                'PY', // Paraguay\n                'PA', // Panamá\n                'MX', // México\n                'CR', // Costa Rica\n                // 'PR', // Puerto Rico\n                'CU', // Cuba\n                // 'DO', // República Dominicana\n                'SV', // El Salvador\n                'GT', // Guatemala\n                'HN', // Honduras\n                'NI', // Nicaragua\n                'ES', // España\n                'US', // Estados Unidos\n                'GQ'  // Guinea Ecuatorial\n            ]\n        });\n\n        if (obligatorio) $(`#${input_celular_id}`).attr('required', true);\n\n        return campo_celular;\n    }\n\n    return null;\n}\n\n/**\n * Establece la validación adicional que se aplica a un campo de tipo celular antes de enviar sus\n * datos en un formulario.\n *\n * @param {HTMLInputElement} input Elemento HTML del campo de tipo celular.\n * @param {string} input_id Id del elemento HTML del campo de tipo celular.\n * @author Fahibram Cárcamo\n * @author Jair Carvajal\n */\nfunction validacionAdicionalInputTipoCelular(input, input_id) {\n    let numero_completo = input.getNumber();\n    let indicativo = '+' + input.getSelectedCountryData().dialCode;\n    let codigo_iso2_pais = input.getSelectedCountryData().iso2;\n    let numero_sin_indicativo = numero_completo.replace(indicativo, '');\n    $(`#indicativo_${input_id}`).val(indicativo);\n    $(`#codigo_iso2_pais_${input_id}`).val(codigo_iso2_pais);\n    $(`#${input_id}`).val(numero_sin_indicativo);\n}\n\n/**\n * Rellenar un input de tipo celular.\n *\n * @param {string} indicativo_celular Código del país del número de celular.\n * @param {string} codigo_pais_iso2 Código ISO2 del país del número de celular.\n * @param {string} numero_celular Número de celular sin código de país.\n * @param {string} input_celular_id ID del input de tipo celular.\n * @param {HTMLInputElement} input_celular Input de tipo celular.\n * @returns {void}\n * @author Daniel Beltrán\n * @author Fahibram Cárcamo\n */\nfunction rellenarInputCelular(indicativo_celular, codigo_pais_iso2, numero_celular, input_celular_id, input_celular) {\n    $(`#${input_celular_id}`).val(numero_celular);\n    if (![null, undefined].includes(codigo_pais_iso2)) input_celular.setCountry(codigo_pais_iso2);\n}\n\n/**\n * Convierte imágenes de base64 a Blob.\n *\n * @param {string} cadena_base_64 Base 64 de la imagen.\n * @returns {Promise<Array>}\n * @author Andres Gonzalez\n */\nfunction imagenBase64Blob(cadena_base_64) {\n    if (!cadena_base_64 || !cadena_base_64.startsWith('data:image')) return null;\n    let datos_base_64 = cadena_base_64.split(',')[1];\n    let tipo_mime = cadena_base_64.match(/data:(.*?);base64/)[1];\n    let caracteres_binarios = atob(datos_base_64);\n    let arreglo_bytes = new Array(caracteres_binarios.length).fill(0).map((_, i) => caracteres_binarios.charCodeAt(i));\n    let bytes_uint8 = new Uint8Array(arreglo_bytes);\n    return new Blob([bytes_uint8], { type: tipo_mime });\n}\n\n\n/**\n * Limpiar estructuras html innecesarias en el check editor.\n *\n * @param {string} html - Cadena HTML generada por CKEditor a limpiar\n * @returns {string} HTML limpio sin elementos específicos de CKEditor\n * @author Andres Gonzalez\n * @author Jair Carvajal\n */\nfunction limpiarHTMLCKEditor(html) {\n    // Remover todos los elementos con clases de CKEditor\n    html = html.replace(/<div class=\"ck[^\"]*\"[^>]*>.*?<\\/div>/gs, '');\n    html = html.replace(/<span class=\"[^\"]*ck[^\"]*\"[^>]*>/gi, '<span>');\n\n    // Limpiar spans de imagen inline\n    html = html.replace(/<span class=\"image-inline[^\"]*\"[^>]*>/gi, '');\n    html = html.replace(/<\\/span>/g, '');\n\n    // Remover elementos de upload y widgets\n    html = html.replace(/<div class=\"ck-image-upload[^\"]*\"[^>]*>.*?<\\/div>/gs, '');\n    html = html.replace(/<div class=\"ck-fake-selection[^\"]*\"[^>]*>.*?<\\/div>/gs, '');\n\n    // Remover atributos innecesarios\n    html = html.replace(/contenteditable=\"[^\"]*\"/gi, '');\n    html = html.replace(/data-cke-filler=\"[^\"]*\"/gi, '');\n\n    // Limpiar párrafos vacíos con br\n    html = html.replace(/<p><br[^>]*><\\/p>/gi, '');\n    html = html.replace(/<br data-cke[^>]*>/gi, '');\n\n    // Limpiar espacios múltiples y saltos de línea\n    html = html.replace(/\\s+/g, ' ');\n    html = html.replace(/>\\s+</g, '><');\n\n    return html.trim();\n}\n\n/**\n * Ordena estudios por fecha_inicio más reciente (de más nueva a más antigua).\n * Preserva los índices originales para permitir edición y eliminación correcta.\n *\n * @param {Array} estudios - Array de objetos con estudios\n * @returns {Array} Array de estudios ordenados con propiedad indice_original\n * @author Jair Carvajal\n */\nfunction ordenarEstudiosPorFecha(estudios) {\n    // Mapear con índice original\n    let estudios_con_indice = estudios.map((estudio, indice_original) => ({\n        ...estudio,\n        indice_original: indice_original\n    }));\n\n    // Ordenar estudios por fecha_inicio (más reciente primero)\n    let estudios_ordenados = estudios_con_indice.sort((a, b) => {\n        // Si ambos tienen fecha_inicio, ordenar por más reciente\n        if (a.fecha_inicio && b.fecha_inicio) {\n            return moment(b.fecha_inicio).diff(moment(a.fecha_inicio));\n        }\n        // Si solo uno tiene fecha_inicio, ese va primero\n        if (a.fecha_inicio && !b.fecha_inicio) return -1;\n        if (!a.fecha_inicio && b.fecha_inicio) return 1;\n        // Si ninguno tiene fecha_inicio, mantener orden original\n        return 0;\n    });\n\n    return estudios_ordenados;\n}\n\n/**\n * Ordena experiencias laborales por fecha: primero las que está trabajando actualmente (sin fecha_fin),\n * luego por fecha_fin más reciente.\n * Preserva los índices originales para permitir edición y eliminación correcta.\n *\n * @param {Array} experiencias - Array de objetos con experiencias laborales\n * @returns {Array} Array de experiencias ordenadas con propiedad indice_original\n * @author Jair Carvajal\n */\nfunction ordenarExperienciasPorFecha(experiencias) {\n    // Mapear con índice original\n    let experiencias_con_indice = experiencias.map((experiencia, indice_original) => ({\n        ...experiencia,\n        indice_original: indice_original\n    }));\n\n    // Ordenar experiencias\n    let experiencias_ordenadas = experiencias_con_indice.sort((a, b) => {\n        // Si 'a' no tiene fecha_fin (trabaja actualmente), va primero\n        if (!a.fecha_fin && b.fecha_fin) return -1;\n        // Si 'b' no tiene fecha_fin (trabaja actualmente), va primero\n        if (a.fecha_fin && !b.fecha_fin) return 1;\n        // Si ambos están trabajando actualmente (sin fecha_fin), mantener el orden actual\n        if (!a.fecha_fin && !b.fecha_fin) return 0;\n        // Si ambos tienen fecha_fin, ordenar por fecha más reciente primero (descendente)\n        return moment(b.fecha_fin).diff(moment(a.fecha_fin));\n    });\n\n    return experiencias_ordenadas;\n}\n\n/**\n * Obtener créditos disponibles de la empresa y actualizar el tag.\n * - Si tiene créditos >= 20% del plan: tag azul\n * - Si tiene créditos < 20% del plan: tag amarillo\n * - Si no tiene créditos: tag gris \"Sin créditos\"\n *\n * @param {number} empresa_id ID de la empresa\n * @param {string} contenedor_id ID del contenedor donde se mostrará el tag\n * @returns {void}\n * @author Andres Gonzalez\n */\nfunction obtenerCreditosDisponiblesEmpresa(empresa_id, contenedor_id = 'contenedor-tag-creditos') {\n    if (!empresa_id || !$(`#${contenedor_id}`).length) {\n        return;\n    }\n\n    $.ajax({\n        url: `/api/empresas/${empresa_id}/creditos`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            let creditos_disponibles = respuesta?.data?.creditos_disponibles ?? 0;\n            let creditos_plan = respuesta?.data?.creditos_plan ?? 0;\n            let porcentaje_disponible = creditos_plan > 0 ? (creditos_disponibles / creditos_plan) * 100 : 0;\n\n            let texto_tag = '';\n            let clase_tag = '';\n            let icono_final = '';\n\n            if (creditos_disponibles <= 0 || creditos_plan <= 0) {\n                texto_tag = 'Sin créditos';\n                clase_tag = 'tag-tonal-gray';\n                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.' })}></i>`;\n            } else if (porcentaje_disponible < 20) {\n                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                clase_tag = 'tag-filled-yellow';\n                icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'Estás cerca de agotar tus créditos. Te queda menos del 20% del total disponible. Considera recargar o revisar tu consumo para evitar interrupciones.' })}></i>`;\n            } else {\n                texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                clase_tag = 'tag-tonal-blue';\n            }\n\n            $(`#${contenedor_id}`).html(crearTag({\n                texto: texto_tag,\n                class: clase_tag,\n                icono_final: icono_final,\n            }));\n        },\n        error: function() {\n            $(`#${contenedor_id}`).html(crearTag({\n                texto: 'Error al cargar créditos',\n                class: 'tag-tonal-gray',\n            }));\n        }\n    });\n}\n","structuredPatch":[{"oldStart":1422,"oldLines":13,"newStart":1422,"newLines":14,"lines":["         success: function(respuesta) {","             let creditos_disponibles = respuesta?.data?.creditos_disponibles ?? 0;","             let creditos_plan = respuesta?.data?.creditos_plan ?? 0;","+            let plan_credito = respuesta?.data?.plan_credito;","             let porcentaje_disponible = creditos_plan > 0 ? (creditos_disponibles / creditos_plan) * 100 : 0;"," ","             let texto_tag = '';","             let clase_tag = '';","             let icono_final = '';"," ","-            if (creditos_disponibles <= 0 || creditos_plan <= 0) {","+            if (creditos_disponibles <= 0 || plan_credito === null) {","                 texto_tag = 'Sin créditos';","                 clase_tag = 'tag-tonal-gray';","                 icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.' })}></i>`;"]}],"userModified":false,"replaceAll":false},"sourceToolAssistantUUID":"35a29b79-4797-4ae8-9087-f633f1f8b919"}
{"parentUuid":"ffbeba7b-95c5-41f1-83f9-76c9ecb3c79f","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01AiMHJSBCQXpuTytUqwX29V","type":"message","role":"assistant","content":[{"type":"text","text":"Listo. Ahora la validación muestra \"Sin créditos\" (tag gris con tooltip) cuando:\n- `creditos_disponibles <= 0` (no tiene créditos disponibles)\n- `plan_credito === null` (no tiene un plan de créditos asociado)"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":891,"cache_read_input_tokens":99627,"cache_creation":{"ephemeral_5m_input_tokens":891,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXLvEdnJ9ND8DrkHhWE3H","type":"assistant","uuid":"8eca430c-e28f-427f-ad5e-e71234b0f0dd","timestamp":"2026-01-21T17:29:12.988Z"}
{"type":"queue-operation","operation":"dequeue","timestamp":"2026-01-21T17:51:01.938Z","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961"}
{"type":"file-history-snapshot","messageId":"658d1842-b9c2-4799-9a2b-2a2e86ea07c6","snapshot":{"messageId":"658d1842-b9c2-4799-9a2b-2a2e86ea07c6","trackedFileBackups":{"resources\\views\\vacantes\\paginas\\index.blade.php":{"backupFileName":"1ae59264a32091d1@v9","version":9,"backupTime":"2026-01-21T16:50:05.680Z"},"public\\js\\globales.js":{"backupFileName":"704f632e999527e6@v7","version":7,"backupTime":"2026-01-21T17:51:04.325Z"},"public\\js\\vacantes\\vacantes.js":{"backupFileName":"ca631dbb99127e3f@v3","version":3,"backupTime":"2026-01-21T16:33:41.257Z"},"public\\componentes\\componentes\\tags.js":{"backupFileName":"247759b31878023a@v2","version":2,"backupTime":"2026-01-21T16:39:57.931Z"}},"timestamp":"2026-01-21T17:51:04.297Z"},"isSnapshotUpdate":false}
{"parentUuid":"0bed43ce-d1ed-4662-acd3-86a2ab5280f6","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Read","command":"callback"},"toolUseID":"toolu_011HnGTWEirwPtRwaC3oH9oc","parentToolUseID":"toolu_011HnGTWEirwPtRwaC3oH9oc","uuid":"541f533f-add3-4e03-8fc0-27f1a6a6551c","timestamp":"2026-01-21T17:28:14.492Z"}
{"parentUuid":"35a29b79-4797-4ae8-9087-f633f1f8b919","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Edit","command":"callback"},"toolUseID":"toolu_01Hs7dsMi32AjgmajgCQLcae","parentToolUseID":"toolu_01Hs7dsMi32AjgmajgCQLcae","uuid":"39e1bfcd-a426-433d-891d-2f4c2bd329ad","timestamp":"2026-01-21T17:28:21.537Z"}
{"parentUuid":"39e1bfcd-a426-433d-891d-2f4c2bd329ad","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Edit","command":"callback"},"toolUseID":"toolu_01Hs7dsMi32AjgmajgCQLcae","parentToolUseID":"toolu_01Hs7dsMi32AjgmajgCQLcae","uuid":"296c324c-5e84-47b6-8bf0-e0e7acd713f4","timestamp":"2026-01-21T17:28:21.538Z"}
{"parentUuid":"ffbeba7b-95c5-41f1-83f9-76c9ecb3c79f","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"callback"},"parentToolUseID":"toolu_01Hs7dsMi32AjgmajgCQLcae","toolUseID":"toolu_01Hs7dsMi32AjgmajgCQLcae","timestamp":"2026-01-21T17:29:05.702Z","uuid":"db3cf167-ce39-406f-857b-218bc641957b"}
{"parentUuid":"8eca430c-e28f-427f-ad5e-e71234b0f0dd","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"type":"text","text":"<ide_selection>The user selected the lines 26 to 26 from c:\\laragon\\www\\psicoalianza-2\\public\\js\\agendas\\historial-agendamientos.js:\n$(document).ready(() => renderizarTablaHistorialAgendamientos());\n\nThis may or may not be related to the current task.</ide_selection>"},{"type":"text","text":"aqui tambien quiero agregar esto inicializarTooltips();"}]},"uuid":"658d1842-b9c2-4799-9a2b-2a2e86ea07c6","timestamp":"2026-01-21T17:51:04.293Z"}
{"parentUuid":"658d1842-b9c2-4799-9a2b-2a2e86ea07c6","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_013YED2mFEBMkC2rGBzdTkPJ","type":"message","role":"assistant","content":[{"type":"text","text":"Voy a leer el archivo para agregar `inicializarTooltips();` en el `$(document).ready()`."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":103520,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":103520,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXLwugw1MNVBnkJu6aUke","type":"assistant","uuid":"23a4b008-ca78-4ae9-94ac-fa0c5c86921f","timestamp":"2026-01-21T17:51:09.292Z"}
{"parentUuid":"23a4b008-ca78-4ae9-94ac-fa0c5c86921f","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_013YED2mFEBMkC2rGBzdTkPJ","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01LputYWweWvazG7gfVtsxMK","name":"Read","input":{"file_path":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\agendas\\historial-agendamientos.js","limit":40}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":103520,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":103520,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXLwugw1MNVBnkJu6aUke","type":"assistant","uuid":"6ad259f4-aa6c-45c0-96a3-92f1ced133b4","timestamp":"2026-01-21T17:51:10.131Z"}
{"parentUuid":"6ad259f4-aa6c-45c0-96a3-92f1ced133b4","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01LputYWweWvazG7gfVtsxMK","type":"tool_result","content":"     1→const TABLA_HISTORIAL_AGENDAMIENTOS_ID = 'tabla-historial-agendamientos';\n     2→const CONFIGURACIONES_TABLA_HISTORIAL_AGENDAMIENTOS = {\n     3→    autoWidth: false,\n     4→    responsive: true,\n     5→    processing: false,\n     6→    serverSide: true,\n     7→    searching: true,\n     8→    deferRender: true,\n     9→    paging: true,\n    10→    aaSorting: [],\n    11→    language: lenguaje_componente_datatables,\n    12→    lengthMenu: [\n    13→        [5, 10, 25, 50, 100, 200],\n    14→        [5, 10, 25, 50, 100, 200]\n    15→    ],\n    16→    scrollX: true,\n    17→    scrollY: 'calc(100vh)',\n    18→    scrollCollapse: true,\n    19→};\n    20→\n    21→let todas_agendas_seleccionadas = false;\n    22→let agendas_seleccionadas_ids = [];\n    23→let json_filtros = {};\n    24→let agendas = [];\n    25→\n    26→$(document).ready(() => renderizarTablaHistorialAgendamientos());\n    27→\n    28→/**\n    29→ * Mostrar los datos de la tabla del historial de agendamientos.\n    30→ *\n    31→ * @returns {void}\n    32→ * @author Fahibram Cárcamo\n    33→ */\n    34→function renderizarTablaHistorialAgendamientos() {\n    35→    // Destruir la tabla del historial de agendamientos si existe.\n    36→    if ($.fn.DataTable.isDataTable( `#${TABLA_HISTORIAL_AGENDAMIENTOS_ID}`)) {\n    37→        $(`#${TABLA_HISTORIAL_AGENDAMIENTOS_ID}`).DataTable().clear().destroy();\n    38→    }\n    39→\n    40→    $(`#${TABLA_HISTORIAL_AGENDAMIENTOS_ID}`).DataTable({\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"ae456bd5-d5db-4b3f-81ca-8adbeb13f2ac","timestamp":"2026-01-21T17:51:11.479Z","toolUseResult":{"type":"text","file":{"filePath":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\agendas\\historial-agendamientos.js","content":"const TABLA_HISTORIAL_AGENDAMIENTOS_ID = 'tabla-historial-agendamientos';\nconst CONFIGURACIONES_TABLA_HISTORIAL_AGENDAMIENTOS = {\n    autoWidth: false,\n    responsive: true,\n    processing: false,\n    serverSide: true,\n    searching: true,\n    deferRender: true,\n    paging: true,\n    aaSorting: [],\n    language: lenguaje_componente_datatables,\n    lengthMenu: [\n        [5, 10, 25, 50, 100, 200],\n        [5, 10, 25, 50, 100, 200]\n    ],\n    scrollX: true,\n    scrollY: 'calc(100vh)',\n    scrollCollapse: true,\n};\n\nlet todas_agendas_seleccionadas = false;\nlet agendas_seleccionadas_ids = [];\nlet json_filtros = {};\nlet agendas = [];\n\n$(document).ready(() => renderizarTablaHistorialAgendamientos());\n\n/**\n * Mostrar los datos de la tabla del historial de agendamientos.\n *\n * @returns {void}\n * @author Fahibram Cárcamo\n */\nfunction renderizarTablaHistorialAgendamientos() {\n    // Destruir la tabla del historial de agendamientos si existe.\n    if ($.fn.DataTable.isDataTable( `#${TABLA_HISTORIAL_AGENDAMIENTOS_ID}`)) {\n        $(`#${TABLA_HISTORIAL_AGENDAMIENTOS_ID}`).DataTable().clear().destroy();\n    }\n\n    $(`#${TABLA_HISTORIAL_AGENDAMIENTOS_ID}`).DataTable({","numLines":40,"startLine":1,"totalLines":270}},"sourceToolAssistantUUID":"6ad259f4-aa6c-45c0-96a3-92f1ced133b4"}
{"parentUuid":"ae456bd5-d5db-4b3f-81ca-8adbeb13f2ac","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_013mKkwKkETxouC8LnSqVvVY","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_016PaSNg9bLQ1Bhv9kRNh6CQ","name":"Edit","input":{"replace_all":false,"file_path":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\agendas\\historial-agendamientos.js","old_string":"$(document).ready(() => renderizarTablaHistorialAgendamientos());","new_string":"$(document).ready(() => {\n    renderizarTablaHistorialAgendamientos();\n    inicializarTooltips();\n});"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":785,"cache_read_input_tokens":103520,"cache_creation":{"ephemeral_5m_input_tokens":785,"ephemeral_1h_input_tokens":0},"output_tokens":25,"service_tier":"standard"}},"requestId":"req_011CXLwvE4G9AT9GkwoMGqTM","type":"assistant","uuid":"9882d969-18fb-455e-b49b-48a973470759","timestamp":"2026-01-21T17:51:15.638Z"}
{"type":"file-history-snapshot","messageId":"9882d969-18fb-455e-b49b-48a973470759","snapshot":{"messageId":"658d1842-b9c2-4799-9a2b-2a2e86ea07c6","trackedFileBackups":{"resources\\views\\vacantes\\paginas\\index.blade.php":{"backupFileName":"1ae59264a32091d1@v9","version":9,"backupTime":"2026-01-21T16:50:05.680Z"},"public\\js\\globales.js":{"backupFileName":"704f632e999527e6@v7","version":7,"backupTime":"2026-01-21T17:51:04.325Z"},"public\\js\\vacantes\\vacantes.js":{"backupFileName":"ca631dbb99127e3f@v3","version":3,"backupTime":"2026-01-21T16:33:41.257Z"},"public\\componentes\\componentes\\tags.js":{"backupFileName":"247759b31878023a@v2","version":2,"backupTime":"2026-01-21T16:39:57.931Z"},"public\\js\\agendas\\historial-agendamientos.js":{"backupFileName":"2dc428456137fadd@v1","version":1,"backupTime":"2026-01-21T17:51:18.649Z"}},"timestamp":"2026-01-21T17:51:04.297Z"},"isSnapshotUpdate":true}
{"parentUuid":"9882d969-18fb-455e-b49b-48a973470759","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_016PaSNg9bLQ1Bhv9kRNh6CQ","type":"tool_result","content":"The file c:\\laragon\\www\\psicoalianza-2\\public\\js\\agendas\\historial-agendamientos.js has been updated. Here's the result of running `cat -n` on a snippet of the edited file:\n    22→let agendas_seleccionadas_ids = [];\n    23→let json_filtros = {};\n    24→let agendas = [];\n    25→\n    26→$(document).ready(() => {\n    27→    renderizarTablaHistorialAgendamientos();\n    28→    inicializarTooltips();\n    29→});\n    30→\n    31→/**\n    32→ * Mostrar los datos de la tabla del historial de agendamientos.\n    33→ *"}]},"uuid":"ef829223-ca51-4b0e-b144-1d27f0a0bf4f","timestamp":"2026-01-21T17:51:18.734Z","toolUseResult":{"filePath":"c:\\laragon\\www\\psicoalianza-2\\public\\js\\agendas\\historial-agendamientos.js","oldString":"$(document).ready(() => renderizarTablaHistorialAgendamientos());","newString":"$(document).ready(() => {\n    renderizarTablaHistorialAgendamientos();\n    inicializarTooltips();\n});","originalFile":"const TABLA_HISTORIAL_AGENDAMIENTOS_ID = 'tabla-historial-agendamientos';\nconst CONFIGURACIONES_TABLA_HISTORIAL_AGENDAMIENTOS = {\n    autoWidth: false,\n    responsive: true,\n    processing: false,\n    serverSide: true,\n    searching: true,\n    deferRender: true,\n    paging: true,\n    aaSorting: [],\n    language: lenguaje_componente_datatables,\n    lengthMenu: [\n        [5, 10, 25, 50, 100, 200],\n        [5, 10, 25, 50, 100, 200]\n    ],\n    scrollX: true,\n    scrollY: 'calc(100vh)',\n    scrollCollapse: true,\n};\n\nlet todas_agendas_seleccionadas = false;\nlet agendas_seleccionadas_ids = [];\nlet json_filtros = {};\nlet agendas = [];\n\n$(document).ready(() => renderizarTablaHistorialAgendamientos());\n\n/**\n * Mostrar los datos de la tabla del historial de agendamientos.\n *\n * @returns {void}\n * @author Fahibram Cárcamo\n */\nfunction renderizarTablaHistorialAgendamientos() {\n    // Destruir la tabla del historial de agendamientos si existe.\n    if ($.fn.DataTable.isDataTable( `#${TABLA_HISTORIAL_AGENDAMIENTOS_ID}`)) {\n        $(`#${TABLA_HISTORIAL_AGENDAMIENTOS_ID}`).DataTable().clear().destroy();\n    }\n\n    $(`#${TABLA_HISTORIAL_AGENDAMIENTOS_ID}`).DataTable({\n        ...CONFIGURACIONES_TABLA_HISTORIAL_AGENDAMIENTOS,\n        ajax: {\n            url : '/listado-historial-agendamientos',\n            data: function (datos) {\n                if ($('#prueba_id').val() !== '') datos.prueba_id = $('#prueba_id').val();\n                if ($('#estado_id').val() !== '') datos.estado_id = $('#estado_id').val();\n\n                if (typeof json_filtros.fecha_inicio === 'string') {\n                    let arreglo_fecha_inicio = json_filtros.fecha_inicio.split(' a ');\n                    (arreglo_fecha_inicio[0]) ? datos.fecha_inicio_desde = arreglo_fecha_inicio[0] : '';\n                    (arreglo_fecha_inicio[1]) ? datos.fecha_inicio_hasta = arreglo_fecha_inicio[1] : '';\n                }\n\n                if (typeof json_filtros.fecha_cierre === 'string') {\n                    let arreglo_fecha_cierre = json_filtros.fecha_cierre.split(' a ');\n                    (arreglo_fecha_cierre[0]) ? datos.fecha_cierre_desde = arreglo_fecha_cierre[0] : '';\n                    (arreglo_fecha_cierre[1]) ? datos.fecha_cierre_hasta = arreglo_fecha_cierre[1] : '';\n                }\n            },\n            dataSrc: function (json) {\n                return Object.values(json.data);\n            }\n        },\n        columns: [\n            {\n                data: null,\n                orderable: false,\n                searchable: false,\n                title: `${\n                    crearCheckbox({\n                        id: 'checkbox-seleccionar-todos-tabla-historial-agendamientos',\n                        name: 'checkbox-seleccionar-todos-tabla-historial-agendamientos',\n                        onclick: 'seleccionarTodosAgendamientos(this.checked)'\n                    })\n                }`,\n                render: (dato) => {\n                    let checked = agendas_seleccionadas_ids.includes(dato.id);\n                    return  crearCheckbox({\n                        id: `checkbox-tabla-historial-agendamientos-${dato.id}`,\n                        class: 'checkbox-tabla-historial-agendamientos',\n                        onclick: `seleccionarAgenda(this.checked, ${dato.id})`,\n                        checked\n                    })\n                },\n            },\n            {\n                data: 'id',\n                title: '<span class=\"text-body-3\">ID</span>',\n                className: 'text-body-3 text-center',\n                orderable: true,\n                searchable: true\n            },\n            {\n                data: 'evaluado.nombre_completo',\n                title: '<span class=\"text-body-3\">Aplicante</span>',\n                className: 'text-body-3',\n                orderable: true,\n                searchable: true\n            },\n            {\n                data: 'evaluado.documento',\n                title: '<span class=\"text-body-3\">Documento</span>',\n                className: 'text-body-3',\n                orderable: true,\n                searchable: true\n            },\n            {\n                data: 'evaluado.email',\n                title: `<span class=\"text-body-3\">Correo electrónico</span>`,\n                className: 'text-body-3',\n                orderable: true,\n                searchable: true\n            },\n            {\n                data: 'proceso.nombre',\n                title: `<span class=\"text-body-3\">Proceso</span>`,\n                className: 'text-body-3',\n                orderable: true,\n                searchable: true\n            },\n            {\n                data: 'prueba.nombre',\n                title: `<span class=\"text-body-3\">Prueba</span>`,\n                className: 'text-body-3',\n                orderable: true,\n                searchable: true\n            },\n            {\n                data: 'fecha_inicio',\n                title: '<span class=\"text-body-3\">Fecha de inicio</span>',\n                className: 'text-body-3 text-center',\n                orderable: true,\n                searchable: true,\n                render: (dato, tipo) =>  (tipo === 'display') ? (dato ? formatearFechaConceptual(dato)['fecha'] : '---') : dato\n            },\n            {\n                data: 'fecha_cierre',\n                title: '<span class=\"text-body-3\">Fecha de cierre</span>',\n                className: 'text-body-3 text-center',\n                orderable: true,\n                searchable: true,\n                render: (dato, tipo) =>  (tipo === 'display') ? (dato ? formatearFechaConceptual(dato)['fecha'] : '---') : dato\n            },\n            {\n                data: 'estado.nombre',\n                title: '<span class=\"text-body-3\">Estado</span>',\n                className: 'text-body-3 text-center',\n                orderable: true,\n                searchable: true\n            }\n        ],\n        initComplete: function(settings) {\n            cargarDataTablas();\n        },\n        drawCallback: function(settings) {\n            agendas = $(`#${TABLA_HISTORIAL_AGENDAMIENTOS_ID}`).DataTable().data().toArray();\n        },\n    });\n}\n\n/**\n * Seleccionar o deseleccionar todos los agendamientos.\n *\n * @param {boolean} seleccion Selección.\n * @returns {void}\n * @author Fahibram Cárcamo\n */\nfunction seleccionarTodosAgendamientos(seleccion) {\n    agendas_seleccionadas_ids = [];\n\n    if (seleccion) {\n        todas_agendas_seleccionadas = true;\n\n        for (let i = 0; i < agendas.length; i++) {\n            agendas_seleccionadas_ids.push(agendas[i].id);\n            let checkbox_id = `#checkbox-tabla-historial-agendamientos-${agendas[i].id}`;\n            if (!$(checkbox_id).is(':checked')) $(checkbox_id).click();\n        }\n\n        return;\n    }\n\n    todas_agendas_seleccionadas = false;\n\n    for (let i = 0; i < agendas.length; i++) {\n        let checkbox_id = `#checkbox-tabla-historial-agendamientos-${agendas[i].id}`;\n        if ($(checkbox_id).is(':checked')) $(checkbox_id).click();\n    }\n}\n\n/**\n * Selecciona o deselecciona un agendamiento.\n *\n * @param {boolean} seleccion Selección.\n * @param {string} agenda_id Id de la agenda.\n * @returns {void}\n * @author Fahibram Cárcamo\n */\nfunction seleccionarAgenda(seleccion, agenda_id) {\n    agenda_id = parseInt(agenda_id);\n    let checkbox_todos_id = '#checkbox-seleccionar-todos-tabla-historial-agendamientos';\n\n    if (seleccion) {\n        if (!agendas_seleccionadas_ids.includes(agenda_id)) agendas_seleccionadas_ids.push(agenda_id);\n\n        if (agendas.length === agendas_seleccionadas_ids.length && !$(checkbox_todos_id).is(':checked')) {\n            todas_agendas_seleccionadas = true;\n            $(checkbox_todos_id).prop('checked', true);\n            $(checkbox_todos_id).change();\n        }\n\n        return;\n    }\n\n    agendas_seleccionadas_ids = agendas_seleccionadas_ids.filter(agenda_seleccionada_id => agenda_seleccionada_id !== agenda_id);\n\n    if ($(checkbox_todos_id).is(':checked')) {\n        todas_agendas_seleccionadas = false;\n        $(checkbox_todos_id).prop('checked', false);\n        $(checkbox_todos_id).change();\n    }\n}\n\n/**\n * Función para aplicar los filtros avanzados.\n *\n * @param {string} filtro Id del elemento html del filtro\n * @param {object} filtros Filtros aplicados\n * @returns {void}\n * @author Fahibram Cárcamo\n */\nfunction aplicarFiltrosDropdown(filtro, filtros) {\n    filtro_html = filtro;\n    json_filtros = filtros;\n    actualizarDatatables(TABLA_HISTORIAL_AGENDAMIENTOS_ID);\n}\n\n/**\n * Descargar el archivo Excel con los datos del historial de agendamiento.\n *\n * @returns {Promise<void>}\n * @author Fahibram Cárcamo\n */\nasync function descargarExcelHistorialAgendamientos() {\n    let datos_peticion = {};\n\n    (json_filtros.estado_id) ? datos_peticion.estado_id = json_filtros.estado_id : '';\n    (json_filtros.prueba_id) ? datos_peticion.prueba_id = json_filtros.prueba_id : '';\n\n    if (typeof json_filtros.fecha_inicio === 'string') {\n        let arreglo_fecha_inicio = json_filtros.fecha_inicio.split(' a ');\n        (arreglo_fecha_inicio[0]) ? datos_peticion.fecha_inicio_desde = arreglo_fecha_inicio[0] : '';\n        (arreglo_fecha_inicio[1]) ? datos_peticion.fecha_inicio_hasta = arreglo_fecha_inicio[1] : '';\n    }\n\n    if (typeof json_filtros.fecha_cierre === 'string') {\n        let arreglo_fecha_cierre = json_filtros.fecha_cierre.split(' a ');\n        (arreglo_fecha_cierre[0]) ? datos_peticion.fecha_cierre_desde = arreglo_fecha_cierre[0] : '';\n        (arreglo_fecha_cierre[1]) ? datos_peticion.fecha_cierre_hasta = arreglo_fecha_cierre[1] : '';\n    }\n\n    if (!todas_agendas_seleccionadas && agendas_seleccionadas_ids.length > 0) datos_peticion.agendas_ids = agendas_seleccionadas_ids;\n\n    descargarExcel(\n        'exportar-excel-historial-agendamientos',\n        'historial-agendamientos',\n        true,\n        datos_peticion\n    );\n}","structuredPatch":[{"oldStart":23,"oldLines":7,"newStart":23,"newLines":10,"lines":[" let json_filtros = {};"," let agendas = [];"," ","-$(document).ready(() => renderizarTablaHistorialAgendamientos());","+$(document).ready(() => {","+    renderizarTablaHistorialAgendamientos();","+    inicializarTooltips();","+});"," "," /**","  * Mostrar los datos de la tabla del historial de agendamientos."]}],"userModified":false,"replaceAll":false},"sourceToolAssistantUUID":"9882d969-18fb-455e-b49b-48a973470759"}
{"parentUuid":"ef829223-ca51-4b0e-b144-1d27f0a0bf4f","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01V71kvwAUnR7gTxwxJqg8XG","type":"message","role":"assistant","content":[{"type":"text","text":"Listo. Agregué `inicializarTooltips();` en el `$(document).ready()` del archivo `historial-agendamientos.js`."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":383,"cache_read_input_tokens":104305,"cache_creation":{"ephemeral_5m_input_tokens":383,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXLwvs7xPxjfzcnh972sd","type":"assistant","uuid":"3a1db3d9-0fae-43d2-8fbf-480bf75a0e03","timestamp":"2026-01-21T17:51:25.885Z"}
{"type":"queue-operation","operation":"dequeue","timestamp":"2026-01-21T18:53:17.185Z","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961"}
{"type":"file-history-snapshot","messageId":"cca14399-806d-4bb6-a108-748bb4dc76fb","snapshot":{"messageId":"cca14399-806d-4bb6-a108-748bb4dc76fb","trackedFileBackups":{"resources\\views\\vacantes\\paginas\\index.blade.php":{"backupFileName":"1ae59264a32091d1@v9","version":9,"backupTime":"2026-01-21T16:50:05.680Z"},"public\\js\\globales.js":{"backupFileName":"704f632e999527e6@v8","version":8,"backupTime":"2026-01-21T18:53:19.409Z"},"public\\js\\vacantes\\vacantes.js":{"backupFileName":"ca631dbb99127e3f@v3","version":3,"backupTime":"2026-01-21T16:33:41.257Z"},"public\\componentes\\componentes\\tags.js":{"backupFileName":"247759b31878023a@v2","version":2,"backupTime":"2026-01-21T16:39:57.931Z"},"public\\js\\agendas\\historial-agendamientos.js":{"backupFileName":"2dc428456137fadd@v1","version":1,"backupTime":"2026-01-21T17:51:18.649Z"}},"timestamp":"2026-01-21T18:53:19.356Z"},"isSnapshotUpdate":false}
{"parentUuid":"6ad259f4-aa6c-45c0-96a3-92f1ced133b4","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Read","command":"callback"},"toolUseID":"toolu_01LputYWweWvazG7gfVtsxMK","parentToolUseID":"toolu_01LputYWweWvazG7gfVtsxMK","uuid":"89d0d155-6835-4b59-8d41-670db9389f11","timestamp":"2026-01-21T17:51:10.381Z"}
{"parentUuid":"9882d969-18fb-455e-b49b-48a973470759","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Edit","command":"callback"},"toolUseID":"toolu_016PaSNg9bLQ1Bhv9kRNh6CQ","parentToolUseID":"toolu_016PaSNg9bLQ1Bhv9kRNh6CQ","uuid":"f2e850c9-b406-452a-86d9-adb22f0844f7","timestamp":"2026-01-21T17:51:15.896Z"}
{"parentUuid":"f2e850c9-b406-452a-86d9-adb22f0844f7","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Edit","command":"callback"},"toolUseID":"toolu_016PaSNg9bLQ1Bhv9kRNh6CQ","parentToolUseID":"toolu_016PaSNg9bLQ1Bhv9kRNh6CQ","uuid":"1bbb1d8c-5ff5-43fb-a6b7-8aa6800ea1f4","timestamp":"2026-01-21T17:51:15.896Z"}
{"parentUuid":"ef829223-ca51-4b0e-b144-1d27f0a0bf4f","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"callback"},"parentToolUseID":"toolu_016PaSNg9bLQ1Bhv9kRNh6CQ","toolUseID":"toolu_016PaSNg9bLQ1Bhv9kRNh6CQ","timestamp":"2026-01-21T17:51:18.735Z","uuid":"dc7dea58-741c-464d-b1a9-d13ec6fa145c"}
{"parentUuid":"3a1db3d9-0fae-43d2-8fbf-480bf75a0e03","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"type":"text","text":"<ide_selection>The user selected the lines 10 to 17 from c:\\laragon\\www\\psicoalianza-2\\resources\\views\\perfiles\\perfiles-pruebas.blade.php:\ncabecera: `\n            <div class=\"col-auto text-headline-2 text-gray-30 fw-bold\">Producto selección</div>\n            <div class=\"col-auto ps-2 pe-0 my-auto\" id=\"contenedor-tag-creditos\">\n                ${crearTag({\n                    texto: 'Cargando créditos...',\n                    class: 'tag-tonal-blue'\n                })}\n            </div>\n\nThis may or may not be related to the current task.</ide_selection>"},{"type":"text","text":"listo ira aqui cabecera: `\n            <div class=\"col-auto text-headline-2 text-gray-30 fw-bold\">Producto selección</div>\n            <div class=\"col-auto ps-2 pe-0 my-auto\" id=\"contenedor-tag-creditos\">\n                ${crearTag({\n                    texto: 'Cargando créditos...',\n                    class: 'tag-tonal-blue'\n                })}\n            </div> el toas se ve diferente por lo que loa fectan las calases de esa vista"}]},"uuid":"cca14399-806d-4bb6-a108-748bb4dc76fb","timestamp":"2026-01-21T18:53:19.352Z"}
{"parentUuid":"cca14399-806d-4bb6-a108-748bb4dc76fb","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01VVpxBRgmUUwZLdYcxohNeD","type":"message","role":"assistant","content":[{"type":"text","text":"Entiendo. El tooltip se ve diferente porque las clases CSS de esa vista lo están afectando. Déjame revisar el archivo para entender mejor el contexto y buscar una solución."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":107898,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":107898,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXM2f2DHhNmULij62KH7V","type":"assistant","uuid":"94e7f4a7-e07f-40ec-932c-c19019d4f706","timestamp":"2026-01-21T18:53:24.802Z"}
{"parentUuid":"94e7f4a7-e07f-40ec-932c-c19019d4f706","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01VVpxBRgmUUwZLdYcxohNeD","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01Hp4U7dwPe2md9RgviRneEK","name":"Read","input":{"file_path":"c:\\laragon\\www\\psicoalianza-2\\resources\\views\\perfiles\\perfiles-pruebas.blade.php","limit":50}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":107898,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":107898,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXM2f2DHhNmULij62KH7V","type":"assistant","uuid":"87b244fb-dcee-4c91-860b-be46dace2b3a","timestamp":"2026-01-21T18:53:25.682Z"}
{"parentUuid":"87b244fb-dcee-4c91-860b-be46dace2b3a","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01Hp4U7dwPe2md9RgviRneEK","type":"tool_result","content":"     1→@extends('layouts.app')\n     2→@section('titulo', 'Pefiles pruebas')\n     3→\n     4→@section('estilos')\n     5→    <link href=\"{{ asset('css/perfiles/perfiles.css') }}\" rel=\"stylesheet\">\n     6→@endsection\n     7→\n     8→@section('contenido')\n     9→    ${contenedorPrincipal({\n    10→        cabecera: `\n    11→            <div class=\"col-auto text-headline-2 text-gray-30 fw-bold\">Producto selección</div>\n    12→            <div class=\"col-auto ps-2 pe-0 my-auto\" id=\"contenedor-tag-creditos\">\n    13→                ${crearTag({\n    14→                    texto: 'Cargando créditos...',\n    15→                    class: 'tag-tonal-blue'\n    16→                })}\n    17→            </div>\n    18→        `,\n    19→        contenido: `\n    20→            <div class=\"card shadow-none\">\n    21→                @include('componentes.menu-superior', ['rutas' => $rutas_menu->where('slug', 'productos-servicios')->first()?->rutas, 'activo' => 'perfiles-pruebas'])\n    22→                <div class=\"card-body\">\n    23→                    <div class=\"row\">\n    24→                        <div class=\"col-12 col-lg-2 border-end\">\n    25→                            <ul class=\"nav\" id=\"listado_pruebas_perfiles\" role=\"tablist\">\n    26→                                @foreach ($pruebas_plan_activo_seleccion as $loopIndex => $item)\n    27→                                    <div class=\"col-12\" role=\"presentation\">\n    28→                                        <button\n    29→                                            value=\"{{ $item->id }}\"\n    30→                                            type=\"button\"\n    31→                                            class=\"botones-grupo tab-vertical{{ $loop->first ? ' active' : '' }}\"\n    32→                                            id=\"{{ $item->id }}_{{ \\Illuminate\\Support\\Str::slug($item->nombre) }}\"\n    33→                                        >\n    34→                                            <span class=\"text-body-3\"><img src=\"/imagenes/logos/pruebas/{{ $item->slug }}.png\" class=\"rounded-circle me-3\" width=\"24px\" heigth=\"24px\"> {{ $item->nombre }}</span>\n    35→                                        </button>\n    36→                                    </div>\n    37→                                @endforeach\n    38→                            </ul>\n    39→                        </div>\n    40→                        <div class=\"col-12 col-lg-10\" id=\"tabla_con_datos\">\n    41→                            ${crearTabla({\n    42→                                id: 'tabla-pefiles-pruebas',\n    43→                                url: '{{ \"/ofertas-laborales/aplicantes\" }}',\n    44→                                class: 'p-0 table-borderless',\n    45→                                registros_paginas: false,\n    46→                                input_container_class: 'mb-0',\n    47→                                filtro: crearFiltroDropdown({\n    48→                                    id: 'filtro_dropdown',\n    49→                                    name: 'filtro_dropdown',\n    50→                                    type: 'text',\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"bce21e6f-58ac-4d04-a41e-614193eaf258","timestamp":"2026-01-21T18:53:27.028Z","toolUseResult":{"type":"text","file":{"filePath":"c:\\laragon\\www\\psicoalianza-2\\resources\\views\\perfiles\\perfiles-pruebas.blade.php","content":"@extends('layouts.app')\n@section('titulo', 'Pefiles pruebas')\n\n@section('estilos')\n    <link href=\"{{ asset('css/perfiles/perfiles.css') }}\" rel=\"stylesheet\">\n@endsection\n\n@section('contenido')\n    ${contenedorPrincipal({\n        cabecera: `\n            <div class=\"col-auto text-headline-2 text-gray-30 fw-bold\">Producto selección</div>\n            <div class=\"col-auto ps-2 pe-0 my-auto\" id=\"contenedor-tag-creditos\">\n                ${crearTag({\n                    texto: 'Cargando créditos...',\n                    class: 'tag-tonal-blue'\n                })}\n            </div>\n        `,\n        contenido: `\n            <div class=\"card shadow-none\">\n                @include('componentes.menu-superior', ['rutas' => $rutas_menu->where('slug', 'productos-servicios')->first()?->rutas, 'activo' => 'perfiles-pruebas'])\n                <div class=\"card-body\">\n                    <div class=\"row\">\n                        <div class=\"col-12 col-lg-2 border-end\">\n                            <ul class=\"nav\" id=\"listado_pruebas_perfiles\" role=\"tablist\">\n                                @foreach ($pruebas_plan_activo_seleccion as $loopIndex => $item)\n                                    <div class=\"col-12\" role=\"presentation\">\n                                        <button\n                                            value=\"{{ $item->id }}\"\n                                            type=\"button\"\n                                            class=\"botones-grupo tab-vertical{{ $loop->first ? ' active' : '' }}\"\n                                            id=\"{{ $item->id }}_{{ \\Illuminate\\Support\\Str::slug($item->nombre) }}\"\n                                        >\n                                            <span class=\"text-body-3\"><img src=\"/imagenes/logos/pruebas/{{ $item->slug }}.png\" class=\"rounded-circle me-3\" width=\"24px\" heigth=\"24px\"> {{ $item->nombre }}</span>\n                                        </button>\n                                    </div>\n                                @endforeach\n                            </ul>\n                        </div>\n                        <div class=\"col-12 col-lg-10\" id=\"tabla_con_datos\">\n                            ${crearTabla({\n                                id: 'tabla-pefiles-pruebas',\n                                url: '{{ \"/ofertas-laborales/aplicantes\" }}',\n                                class: 'p-0 table-borderless',\n                                registros_paginas: false,\n                                input_container_class: 'mb-0',\n                                filtro: crearFiltroDropdown({\n                                    id: 'filtro_dropdown',\n                                    name: 'filtro_dropdown',\n                                    type: 'text',","numLines":50,"startLine":1,"totalLines":421}},"sourceToolAssistantUUID":"87b244fb-dcee-4c91-860b-be46dace2b3a"}
{"parentUuid":"bce21e6f-58ac-4d04-a41e-614193eaf258","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01S5kafsxchc54mAK2B1yQcs","type":"message","role":"assistant","content":[{"type":"text","text":"Veo que la vista carga el CSS `perfiles/perfiles.css`. El problema podría ser que hay estilos específicos que afectan al tooltip. \n\n¿Podrías indicarme cómo se ve diferente el tooltip? Por ejemplo:\n1. ¿Se ve con colores diferentes?\n2. ¿El tamaño es diferente?\n3. ¿La posición no es correcta?\n4. ¿El texto se corta o no se muestra completo?\n\nEsto me ayudará a identificar qué estilos están causando el conflicto y proponer una solución adecuada."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":1119,"cache_read_input_tokens":107898,"cache_creation":{"ephemeral_5m_input_tokens":1119,"ephemeral_1h_input_tokens":0},"output_tokens":3,"service_tier":"standard"}},"requestId":"req_011CXM2fcy5RWAw2pJJnFJWA","type":"assistant","uuid":"e3f276a2-ad5d-43b4-8138-f74fc68740e4","timestamp":"2026-01-21T18:53:32.856Z"}
{"type":"queue-operation","operation":"dequeue","timestamp":"2026-01-21T18:54:07.110Z","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961"}
{"type":"file-history-snapshot","messageId":"44b027a6-dd98-4185-a7d9-780400432e2f","snapshot":{"messageId":"44b027a6-dd98-4185-a7d9-780400432e2f","trackedFileBackups":{"resources\\views\\vacantes\\paginas\\index.blade.php":{"backupFileName":"1ae59264a32091d1@v9","version":9,"backupTime":"2026-01-21T16:50:05.680Z"},"public\\js\\globales.js":{"backupFileName":"704f632e999527e6@v8","version":8,"backupTime":"2026-01-21T18:53:19.409Z"},"public\\js\\vacantes\\vacantes.js":{"backupFileName":"ca631dbb99127e3f@v3","version":3,"backupTime":"2026-01-21T16:33:41.257Z"},"public\\componentes\\componentes\\tags.js":{"backupFileName":"247759b31878023a@v2","version":2,"backupTime":"2026-01-21T16:39:57.931Z"},"public\\js\\agendas\\historial-agendamientos.js":{"backupFileName":"2dc428456137fadd@v1","version":1,"backupTime":"2026-01-21T17:51:18.649Z"}},"timestamp":"2026-01-21T18:54:08.597Z"},"isSnapshotUpdate":false}
{"parentUuid":"87b244fb-dcee-4c91-860b-be46dace2b3a","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Read","command":"callback"},"toolUseID":"toolu_01Hp4U7dwPe2md9RgviRneEK","parentToolUseID":"toolu_01Hp4U7dwPe2md9RgviRneEK","uuid":"def64166-ceac-4541-a4dc-3164085f7bab","timestamp":"2026-01-21T18:53:25.941Z"}
{"parentUuid":"e3f276a2-ad5d-43b4-8138-f74fc68740e4","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"type":"text","text":"los colores y la forma del toas seve redonda y los coloes simpre son girses"}]},"uuid":"44b027a6-dd98-4185-a7d9-780400432e2f","timestamp":"2026-01-21T18:54:08.592Z"}
{"parentUuid":"44b027a6-dd98-4185-a7d9-780400432e2f","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01TZd8KmHWr2gXoMoawQz84h","type":"message","role":"assistant","content":[{"type":"text","text":"Entiendo, el tooltip se ve con forma redondeada y colores grises en lugar del estilo normal del sistema. Esto probablemente es porque el CSS de perfiles está sobrescribiendo los estilos del tooltip o está usando un popover de Bootstrap con estilos diferentes.\n\nDéjame revisar el archivo CSS de perfiles para identificar el problema:"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":3025,"cache_read_input_tokens":109017,"cache_creation":{"ephemeral_5m_input_tokens":3025,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXM2idn2VwocGqKj9pnrF","type":"assistant","uuid":"d5b4caf8-5ff7-460c-bde3-c11641625d58","timestamp":"2026-01-21T18:54:13.425Z"}
{"parentUuid":"d5b4caf8-5ff7-460c-bde3-c11641625d58","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01TZd8KmHWr2gXoMoawQz84h","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_011Q9aG8eWqaW7ggxgxn1FdG","name":"Read","input":{"file_path":"c:\\laragon\\www\\psicoalianza-2\\public\\css\\perfiles\\perfiles.css"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":3025,"cache_read_input_tokens":109017,"cache_creation":{"ephemeral_5m_input_tokens":3025,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXM2idn2VwocGqKj9pnrF","type":"assistant","uuid":"322754a7-f359-4255-8d73-b1e72270a53f","timestamp":"2026-01-21T18:54:13.901Z"}
{"parentUuid":"322754a7-f359-4255-8d73-b1e72270a53f","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_011Q9aG8eWqaW7ggxgxn1FdG","type":"tool_result","content":"     1→.input-dinamico + .error {\n     2→    display: none!important;\n     3→}\n     4→\n     5→.nivel {\n     6→    border: 2px #e0e0e0;\n     7→    border-radius: 12px;\n     8→    overflow: hidden;\n     9→    display: flex;\n    10→    flex-direction: column;\n    11→    height: 150px;\n    12→    box-shadow: 0 2px 6px rgba(29, 29, 29, 0.425);\n    13→}\n    14→\n    15→/* Zona blanca para los tags */\n    16→.zona-tags {\n    17→    flex: 1;\n    18→    background-color: white;\n    19→    padding: 10px;\n    20→    min-height: 80px;\n    21→    overflow-y: auto;\n    22→}\n    23→\n    24→/* Zona de color para el rango */\n    25→.zona-rango {\n    26→    text-align: center;\n    27→    padding: 8px;\n    28→    color: white;\n    29→    font-weight: bold;\n    30→}\n    31→\n    32→.medio-rango {\n    33→    color: black !important;\n    34→}\n    35→\n    36→/* Colores por nivel */\n    37→/* .bajo {\n    38→    border-color: #F73B3B;\n    39→} */\n    40→.bajo-color {\n    41→    color: #F73B3B;\n    42→}\n    43→.bajo {\n    44→    border-color: #F73B3B;\n    45→}\n    46→.bajo .zona-rango {\n    47→    background-color: #F73B3B;\n    48→}\n    49→\n    50→.medio {\n    51→    border-color: #FFD12E;\n    52→}\n    53→.medio-color {\n    54→    color: #FFD12E;\n    55→}\n    56→.medio .zona-rango.medio-rango {\n    57→    background-color: #FFD12E;\n    58→}\n    59→\n    60→.alto {\n    61→    border-color: #81BF45;\n    62→}\n    63→.alto-color {\n    64→    color: #81BF45;\n    65→}\n    66→.alto .zona-rango {\n    67→    background-color: #81BF45;\n    68→}\n    69→\n    70→.avanzado {\n    71→    border-color: #1BB8F3;\n    72→}\n    73→.avanzado-color {\n    74→    color: #1BB8F3;\n    75→}\n    76→.avanzado .zona-rango {\n    77→    background-color: #1BB8F3;\n    78→}\n    79→\n    80→/* Tags */\n    81→.tag {\n    82→    background: #e0e0e0;\n    83→    padding: 5px 10px;\n    84→    border-radius: 15px;\n    85→    margin: 3px;\n    86→    display: inline-block;\n    87→    cursor: grab;\n    88→}\n    89→\n    90→.perfil_selected {\n    91→    min-width: 224px !important;\n    92→}\n    93→\n    94→.input-container-perfil {\n    95→    position: relative;\n    96→    height: auto;\n    97→    display: flex;\n    98→    flex-direction: column;\n    99→    align-items: flex-start;\n   100→    margin-bottom: 0px;\n   101→}\n   102→\n   103→.borde-tendisc {\n   104→    border-left: 15px solid #4da6ff;\n   105→    padding-left: 12px;\n   106→    border-radius: 10px; \n   107→}\n   108→\n   109→.borde-ethikos {\n   110→    border-left: 15px solid #75242a;\n   111→    padding-left: 12px;\n   112→    border-radius: 10px; \n   113→}\n   114→\n   115→.borde-iq {\n   116→    border-left: 15px solid #2ab296;\n   117→    padding-left: 12px;\n   118→    border-radius: 10px; \n   119→}\n   120→\n   121→.borde-potencial {\n   122→    border-left: 15px solid #543289;\n   123→    padding-left: 12px;\n   124→    border-radius: 10px; \n   125→}\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"9c9bd987-806b-4dc3-b87f-f7fb2ca70362","timestamp":"2026-01-21T18:54:15.315Z","toolUseResult":{"type":"text","file":{"filePath":"c:\\laragon\\www\\psicoalianza-2\\public\\css\\perfiles\\perfiles.css","content":".input-dinamico + .error {\n    display: none!important;\n}\n\n.nivel {\n    border: 2px #e0e0e0;\n    border-radius: 12px;\n    overflow: hidden;\n    display: flex;\n    flex-direction: column;\n    height: 150px;\n    box-shadow: 0 2px 6px rgba(29, 29, 29, 0.425);\n}\n\n/* Zona blanca para los tags */\n.zona-tags {\n    flex: 1;\n    background-color: white;\n    padding: 10px;\n    min-height: 80px;\n    overflow-y: auto;\n}\n\n/* Zona de color para el rango */\n.zona-rango {\n    text-align: center;\n    padding: 8px;\n    color: white;\n    font-weight: bold;\n}\n\n.medio-rango {\n    color: black !important;\n}\n\n/* Colores por nivel */\n/* .bajo {\n    border-color: #F73B3B;\n} */\n.bajo-color {\n    color: #F73B3B;\n}\n.bajo {\n    border-color: #F73B3B;\n}\n.bajo .zona-rango {\n    background-color: #F73B3B;\n}\n\n.medio {\n    border-color: #FFD12E;\n}\n.medio-color {\n    color: #FFD12E;\n}\n.medio .zona-rango.medio-rango {\n    background-color: #FFD12E;\n}\n\n.alto {\n    border-color: #81BF45;\n}\n.alto-color {\n    color: #81BF45;\n}\n.alto .zona-rango {\n    background-color: #81BF45;\n}\n\n.avanzado {\n    border-color: #1BB8F3;\n}\n.avanzado-color {\n    color: #1BB8F3;\n}\n.avanzado .zona-rango {\n    background-color: #1BB8F3;\n}\n\n/* Tags */\n.tag {\n    background: #e0e0e0;\n    padding: 5px 10px;\n    border-radius: 15px;\n    margin: 3px;\n    display: inline-block;\n    cursor: grab;\n}\n\n.perfil_selected {\n    min-width: 224px !important;\n}\n\n.input-container-perfil {\n    position: relative;\n    height: auto;\n    display: flex;\n    flex-direction: column;\n    align-items: flex-start;\n    margin-bottom: 0px;\n}\n\n.borde-tendisc {\n    border-left: 15px solid #4da6ff;\n    padding-left: 12px;\n    border-radius: 10px; \n}\n\n.borde-ethikos {\n    border-left: 15px solid #75242a;\n    padding-left: 12px;\n    border-radius: 10px; \n}\n\n.borde-iq {\n    border-left: 15px solid #2ab296;\n    padding-left: 12px;\n    border-radius: 10px; \n}\n\n.borde-potencial {\n    border-left: 15px solid #543289;\n    padding-left: 12px;\n    border-radius: 10px; \n}","numLines":125,"startLine":1,"totalLines":125}},"sourceToolAssistantUUID":"322754a7-f359-4255-8d73-b1e72270a53f"}
{"parentUuid":"9c9bd987-806b-4dc3-b87f-f7fb2ca70362","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01C29Mwbi6JnoQq7ztaPSdHB","type":"message","role":"assistant","content":[{"type":"text","text":"Encontré el problema. En las líneas 81-88 del archivo `perfiles.css` hay una clase `.tag` que está sobrescribiendo los estilos del componente tag del sistema:\n\n```css\n.tag {\n    background: #e0e0e0;\n    padding: 5px 10px;\n    border-radius: 15px;\n    margin: 3px;\n    display: inline-block;\n    cursor: grab;\n}\n```\n\nEsta clase está diseñada para los tags arrastrables de los perfiles de pruebas, pero afecta a todos los elementos con clase `.tag`, incluyendo el tag de créditos.\n\nTienes dos opciones:\n\n1. **Renombrar la clase en perfiles.css** a algo más específico como `.tag-perfil` o `.tag-draggable`\n2. **Hacer el selector más específico** para que solo aplique dentro del contexto de perfiles\n\n¿Cuál prefieres? La opción 1 es más limpia pero requiere actualizar el HTML/JS donde se usen esos tags de perfiles."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":1591,"cache_read_input_tokens":112042,"cache_creation":{"ephemeral_5m_input_tokens":1591,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXM2jAzVUyC1SdaJbUZvo","type":"assistant","uuid":"ec06bf2f-12d3-4ab8-b16f-70d2fca2b0e5","timestamp":"2026-01-21T18:54:23.192Z"}
{"type":"queue-operation","operation":"dequeue","timestamp":"2026-01-21T18:56:07.412Z","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961"}
{"type":"file-history-snapshot","messageId":"66dcf375-efd7-4a00-b1d3-b849d17c3293","snapshot":{"messageId":"66dcf375-efd7-4a00-b1d3-b849d17c3293","trackedFileBackups":{"resources\\views\\vacantes\\paginas\\index.blade.php":{"backupFileName":"1ae59264a32091d1@v9","version":9,"backupTime":"2026-01-21T16:50:05.680Z"},"public\\js\\globales.js":{"backupFileName":"704f632e999527e6@v8","version":8,"backupTime":"2026-01-21T18:53:19.409Z"},"public\\js\\vacantes\\vacantes.js":{"backupFileName":"ca631dbb99127e3f@v3","version":3,"backupTime":"2026-01-21T16:33:41.257Z"},"public\\componentes\\componentes\\tags.js":{"backupFileName":"247759b31878023a@v2","version":2,"backupTime":"2026-01-21T16:39:57.931Z"},"public\\js\\agendas\\historial-agendamientos.js":{"backupFileName":"2dc428456137fadd@v1","version":1,"backupTime":"2026-01-21T17:51:18.649Z"}},"timestamp":"2026-01-21T18:56:08.994Z"},"isSnapshotUpdate":false}
{"parentUuid":"322754a7-f359-4255-8d73-b1e72270a53f","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Read","command":"callback"},"toolUseID":"toolu_011Q9aG8eWqaW7ggxgxn1FdG","parentToolUseID":"toolu_011Q9aG8eWqaW7ggxgxn1FdG","uuid":"fc90e715-64fc-4068-8985-08f6abf8e3b8","timestamp":"2026-01-21T18:54:14.151Z"}
{"parentUuid":"ec06bf2f-12d3-4ab8-b16f-70d2fca2b0e5","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"type":"text","text":"y no se puede crear otra clase para eltag para que lo deje como el original y s ele colaca aqui en lo de creditos"}]},"uuid":"66dcf375-efd7-4a00-b1d3-b849d17c3293","timestamp":"2026-01-21T18:56:08.991Z"}
{"parentUuid":"66dcf375-efd7-4a00-b1d3-b849d17c3293","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_0163QHDnxVy4rNKxg49V4mFs","type":"message","role":"assistant","content":[{"type":"text","text":"Buena idea. Voy a crear una clase más específica para el tag de créditos que mantenga los estilos originales y no sea afectada por los estilos de perfiles.\n\nPrimero necesito ver los estilos originales del tag en el CSS del sistema:"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":3144,"cache_read_input_tokens":113633,"cache_creation":{"ephemeral_5m_input_tokens":3144,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXM2sWtY6jUFxk2RkMV83","type":"assistant","uuid":"cb8e5a80-9f4b-418c-a72b-f94825618522","timestamp":"2026-01-21T18:56:13.531Z"}
{"parentUuid":"cb8e5a80-9f4b-418c-a72b-f94825618522","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_0163QHDnxVy4rNKxg49V4mFs","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01MFoFVFM474FZuuynaNDocv","name":"Grep","input":{"pattern":"\\.tag-tonal|\\.tag-filled","path":"c:\\laragon\\www\\psicoalianza-2\\public\\css","output_mode":"files_with_matches"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":3144,"cache_read_input_tokens":113633,"cache_creation":{"ephemeral_5m_input_tokens":3144,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXM2sWtY6jUFxk2RkMV83","type":"assistant","uuid":"936ceb95-0a66-44f7-b0d6-880587cfe764","timestamp":"2026-01-21T18:56:14.663Z"}
{"parentUuid":"936ceb95-0a66-44f7-b0d6-880587cfe764","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01MFoFVFM474FZuuynaNDocv","type":"tool_result","content":"No files found"}]},"uuid":"1dd52494-9b7d-41fd-8e3f-365cbd8b1c35","timestamp":"2026-01-21T18:56:18.474Z","toolUseResult":{"mode":"files_with_matches","filenames":[],"numFiles":0},"sourceToolAssistantUUID":"936ceb95-0a66-44f7-b0d6-880587cfe764"}
{"parentUuid":"1dd52494-9b7d-41fd-8e3f-365cbd8b1c35","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01SHQXsdZxYyK3pqaKjn16fV","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_015qhKnSXwcFzjwrVy2bevDv","name":"Grep","input":{"pattern":"tag-tonal-blue|tag-filled-yellow","output_mode":"files_with_matches"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":204,"cache_read_input_tokens":116777,"cache_creation":{"ephemeral_5m_input_tokens":204,"ephemeral_1h_input_tokens":0},"output_tokens":25,"service_tier":"standard"}},"requestId":"req_011CXM2tGRvGr7hFbs9SUnUE","type":"assistant","uuid":"fcb1c40f-d14d-4984-a28f-54ff47cdea6b","timestamp":"2026-01-21T18:56:22.192Z"}
{"parentUuid":"fcb1c40f-d14d-4984-a28f-54ff47cdea6b","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_015qhKnSXwcFzjwrVy2bevDv","type":"tool_result","content":"Found 23 files\npublic\\js\\globales.js\nresources\\views\\agendas\\historial-agendamientos.blade.php\nresources\\views\\perfiles\\perfiles-pruebas.blade.php\nresources\\views\\procesos\\index.blade.php\nresources\\views\\vacantes\\paginas\\index.blade.php\npublic\\js\\vacantes\\vacantes.js\npublic\\js\\vacantes\\detalles\\detalle-resultados.js\npublic\\js\\vacantes\\detalles\\detalle-etapas.js\npublic\\js\\mis-pruebas\\aplicante\\tareas-pendientes.js\npublic\\js\\empresa\\planes\\planes.js\npublic\\js\\vacantes\\aplicante\\postulaciones.js\nresources\\sass\\globales.scss\npublic\\js\\pruebas\\listado_pruebas.js\npublic\\js\\procesos\\listado.js\npublic\\js\\procesos\\procesos.js\nresources\\views\\ofertas-laborales\\paginas\\detalles\\index.blade.php\nresources\\views\\inicio\\index-empresas.blade.php\npublic\\js\\ofertas-laborales\\index.js\npublic\\js\\ofertas-laborales\\funciones\\funciones-seleccion.js\npublic\\js\\manuales\\manuales.js\npublic\\js\\inicio\\inicio.js\npublic\\js\\empresas\\empresas-planes\\index.js\nresources\\views\\componentes\\componentes\\tags.blade.php"}]},"uuid":"8b8fe964-aca2-4d4d-89ce-e21df91871f3","timestamp":"2026-01-21T18:56:24.769Z","toolUseResult":{"mode":"files_with_matches","filenames":["public\\js\\globales.js","resources\\views\\agendas\\historial-agendamientos.blade.php","resources\\views\\perfiles\\perfiles-pruebas.blade.php","resources\\views\\procesos\\index.blade.php","resources\\views\\vacantes\\paginas\\index.blade.php","public\\js\\vacantes\\vacantes.js","public\\js\\vacantes\\detalles\\detalle-resultados.js","public\\js\\vacantes\\detalles\\detalle-etapas.js","public\\js\\mis-pruebas\\aplicante\\tareas-pendientes.js","public\\js\\empresa\\planes\\planes.js","public\\js\\vacantes\\aplicante\\postulaciones.js","resources\\sass\\globales.scss","public\\js\\pruebas\\listado_pruebas.js","public\\js\\procesos\\listado.js","public\\js\\procesos\\procesos.js","resources\\views\\ofertas-laborales\\paginas\\detalles\\index.blade.php","resources\\views\\inicio\\index-empresas.blade.php","public\\js\\ofertas-laborales\\index.js","public\\js\\ofertas-laborales\\funciones\\funciones-seleccion.js","public\\js\\manuales\\manuales.js","public\\js\\inicio\\inicio.js","public\\js\\empresas\\empresas-planes\\index.js","resources\\views\\componentes\\componentes\\tags.blade.php"],"numFiles":23},"sourceToolAssistantUUID":"fcb1c40f-d14d-4984-a28f-54ff47cdea6b"}
{"parentUuid":"8b8fe964-aca2-4d4d-89ce-e21df91871f3","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01EHnJCyUUFqpBVtBAyqhDRc","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01W65ajWMMo68Vyak8kf2ejw","name":"Read","input":{"file_path":"c:\\laragon\\www\\psicoalianza-2\\resources\\sass\\globales.scss","offset":1,"limit":100}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":459,"cache_read_input_tokens":116981,"cache_creation":{"ephemeral_5m_input_tokens":459,"ephemeral_1h_input_tokens":0},"output_tokens":25,"service_tier":"standard"}},"requestId":"req_011CXM2tgPp8QWaZEMuUofYC","type":"assistant","uuid":"7fdefb63-856b-4387-ac17-7c0df90a747f","timestamp":"2026-01-21T18:56:28.124Z"}
{"parentUuid":"7fdefb63-856b-4387-ac17-7c0df90a747f","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01W65ajWMMo68Vyak8kf2ejw","type":"tool_result","content":"     1→@import \"variables\";\n     2→\n     3→* {\n     4→    margin: 0;\n     5→    padding: 0;\n     6→    color: $ps-gray-30;\n     7→    scrollbar-width: thin !important;\n     8→    scrollbar-color: lightgrey transparent !important;\n     9→    font-family: 'Lato';\n    10→}\n    11→\n    12→html {\n    13→    height: 100vh;\n    14→    overflow: hidden;\n    15→}\n    16→\n    17→body {\n    18→    overflow-x: hidden;\n    19→    overflow-y: hidden;\n    20→}\n    21→\n    22→::-webkit-scrollbar {\n    23→    width: 8px !important;\n    24→    height: 8px !important;\n    25→    background: transparent !important;\n    26→}\n    27→\n    28→::-webkit-scrollbar-thumb {\n    29→    background-color: lightgrey !important;\n    30→    border-radius: 4px !important;\n    31→}\n    32→\n    33→::-webkit-scrollbar-button {\n    34→    display: none !important;\n    35→}\n    36→\n    37→* {\n    38→    scrollbar-width: thin !important;\n    39→    scrollbar-color: lightgrey transparent !important;\n    40→}\n    41→\n    42→i {\n    43→    color: inherit;\n    44→}\n    45→\n    46→a.no-visited {\n    47→    text-decoration: none !important;\n    48→\n    49→    &:visited {\n    50→        color: inherit !important;\n    51→    }\n    52→}\n    53→\n    54→// Tooltips\n    55→.tooltip.show {\n    56→    opacity: 1 !important;\n    57→    background-color: $ps-gray-30;\n    58→    border-radius: 4px!important;\n    59→}\n    60→\n    61→.tooltip-inner {\n    62→    background-color: #4d4d4f !important;\n    63→    font-size: 12px;\n    64→    font-weight: 600;\n    65→    line-height: 16px;\n    66→    letter-spacing: 0.7;\n    67→}\n    68→\n    69→.tooltip-arrow {\n    70→    visibility: hidden;\n    71→}\n    72→\n    73→// tooltip plan card\n    74→.tooltip-bottom {\n    75→    position: absolute;// Asegúrate de que esté posicionado correctamente\n    76→    background-color: #4d4d4f !important;\n    77→    color: white;\n    78→    border-radius: 4px;\n    79→    text-align: center;\n    80→    padding: 4px 8px 4px 8px !important;\n    81→    z-index: 100;\n    82→    transform: translateX(-50%);\n    83→    size: 12px;\n    84→}\n    85→\n    86→.tooltip-icon-bottom {\n    87→    display: none;\n    88→    position: absolute !important;\n    89→    top: 100%;\n    90→    left: 50%;\n    91→}\n    92→\n    93→.tooltip-x {\n    94→    display: none;\n    95→    position: absolute;\n    96→    width: max-content;\n    97→    background: rgba($color: $black, $alpha: 0.7) !important;\n    98→    color: $white;\n    99→    font-size: 12px;\n   100→    border-radius: 4px;\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"b41df38d-1acc-4ac7-9976-fd182aa94945","timestamp":"2026-01-21T18:56:29.452Z","toolUseResult":{"type":"text","file":{"filePath":"c:\\laragon\\www\\psicoalianza-2\\resources\\sass\\globales.scss","content":"@import \"variables\";\n\n* {\n    margin: 0;\n    padding: 0;\n    color: $ps-gray-30;\n    scrollbar-width: thin !important;\n    scrollbar-color: lightgrey transparent !important;\n    font-family: 'Lato';\n}\n\nhtml {\n    height: 100vh;\n    overflow: hidden;\n}\n\nbody {\n    overflow-x: hidden;\n    overflow-y: hidden;\n}\n\n::-webkit-scrollbar {\n    width: 8px !important;\n    height: 8px !important;\n    background: transparent !important;\n}\n\n::-webkit-scrollbar-thumb {\n    background-color: lightgrey !important;\n    border-radius: 4px !important;\n}\n\n::-webkit-scrollbar-button {\n    display: none !important;\n}\n\n* {\n    scrollbar-width: thin !important;\n    scrollbar-color: lightgrey transparent !important;\n}\n\ni {\n    color: inherit;\n}\n\na.no-visited {\n    text-decoration: none !important;\n\n    &:visited {\n        color: inherit !important;\n    }\n}\n\n// Tooltips\n.tooltip.show {\n    opacity: 1 !important;\n    background-color: $ps-gray-30;\n    border-radius: 4px!important;\n}\n\n.tooltip-inner {\n    background-color: #4d4d4f !important;\n    font-size: 12px;\n    font-weight: 600;\n    line-height: 16px;\n    letter-spacing: 0.7;\n}\n\n.tooltip-arrow {\n    visibility: hidden;\n}\n\n// tooltip plan card\n.tooltip-bottom {\n    position: absolute;// Asegúrate de que esté posicionado correctamente\n    background-color: #4d4d4f !important;\n    color: white;\n    border-radius: 4px;\n    text-align: center;\n    padding: 4px 8px 4px 8px !important;\n    z-index: 100;\n    transform: translateX(-50%);\n    size: 12px;\n}\n\n.tooltip-icon-bottom {\n    display: none;\n    position: absolute !important;\n    top: 100%;\n    left: 50%;\n}\n\n.tooltip-x {\n    display: none;\n    position: absolute;\n    width: max-content;\n    background: rgba($color: $black, $alpha: 0.7) !important;\n    color: $white;\n    font-size: 12px;\n    border-radius: 4px;","numLines":100,"startLine":1,"totalLines":4425}},"sourceToolAssistantUUID":"7fdefb63-856b-4387-ac17-7c0df90a747f"}
{"parentUuid":"b41df38d-1acc-4ac7-9976-fd182aa94945","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01T1GRXBdfwEm26j6YJsivYL","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_013LFUnJniEwSPxqCcUoQSJY","name":"Grep","input":{"pattern":"^\\.tag","path":"c:\\laragon\\www\\psicoalianza-2\\resources\\sass\\globales.scss","output_mode":"content","-n":true}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":1159,"cache_read_input_tokens":117440,"cache_creation":{"ephemeral_5m_input_tokens":1159,"ephemeral_1h_input_tokens":0},"output_tokens":24,"service_tier":"standard"}},"requestId":"req_011CXM2u5558USxYiCJ3tfiU","type":"assistant","uuid":"94541618-8c13-4825-83a0-2a8c260c5938","timestamp":"2026-01-21T18:56:33.664Z"}
{"parentUuid":"94541618-8c13-4825-83a0-2a8c260c5938","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_013LFUnJniEwSPxqCcUoQSJY","type":"tool_result","content":"952:.tag-color-blue {\n991:.tag {\n996:.tag-sm {\n1000:.tag i {\n1004:.tag-filled-green {\n1009:.tag-filled-yellow {\n1014:.tag-filled-red {\n1019:.tag-filled-smooth-red {\n1024:.tag-filled-blue {\n1029:.tag-filled-gray {\n1034:.tag-filled-purple {\n1039:.tag.disabled {\n1044:.tag-tonal-green {\n1049:.tag-tonal-yellow {\n1054:.tag-tonal-red {\n1059:.tag-tonal-blue {\n1064:.tag-tonal-gray {\n1069:.tag-tonal-purple {\n1074:.tag-tonal-orange {\n1079:.tag-tonal-light-red {\n1084:.tag.disabled {\n1089:.tag.tag-tonal.disabled {"}]},"uuid":"8eb8d10f-aa0f-4641-aaeb-6ec7e930da36","timestamp":"2026-01-21T18:56:36.124Z","toolUseResult":{"mode":"content","numFiles":0,"filenames":[],"content":"952:.tag-color-blue {\n991:.tag {\n996:.tag-sm {\n1000:.tag i {\n1004:.tag-filled-green {\n1009:.tag-filled-yellow {\n1014:.tag-filled-red {\n1019:.tag-filled-smooth-red {\n1024:.tag-filled-blue {\n1029:.tag-filled-gray {\n1034:.tag-filled-purple {\n1039:.tag.disabled {\n1044:.tag-tonal-green {\n1049:.tag-tonal-yellow {\n1054:.tag-tonal-red {\n1059:.tag-tonal-blue {\n1064:.tag-tonal-gray {\n1069:.tag-tonal-purple {\n1074:.tag-tonal-orange {\n1079:.tag-tonal-light-red {\n1084:.tag.disabled {\n1089:.tag.tag-tonal.disabled {","numLines":22},"sourceToolAssistantUUID":"94541618-8c13-4825-83a0-2a8c260c5938"}
{"parentUuid":"8eb8d10f-aa0f-4641-aaeb-6ec7e930da36","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01RiJaZ5cKHLsarQELT99Xvf","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_015TYcsfi5n9bUmii9BiDwKA","name":"Read","input":{"file_path":"c:\\laragon\\www\\psicoalianza-2\\resources\\sass\\globales.scss","offset":990,"limit":110}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":360,"cache_read_input_tokens":118599,"cache_creation":{"ephemeral_5m_input_tokens":360,"ephemeral_1h_input_tokens":0},"output_tokens":25,"service_tier":"standard"}},"requestId":"req_011CXM2uXCCRxzgBbM1qLhhj","type":"assistant","uuid":"179c25cd-8f8d-42cd-8fab-46e7d2cfe460","timestamp":"2026-01-21T18:56:39.756Z"}
{"parentUuid":"179c25cd-8f8d-42cd-8fab-46e7d2cfe460","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_015TYcsfi5n9bUmii9BiDwKA","type":"tool_result","content":"   990→// Componentes de tags\n   991→.tag {\n   992→    border-radius: 4px;\n   993→    padding: 6px 12px;\n   994→}\n   995→\n   996→.tag-sm {\n   997→    padding: 6px 8px;\n   998→}\n   999→\n  1000→.tag i {\n  1001→    color: inherit;\n  1002→}\n  1003→\n  1004→.tag-filled-green {\n  1005→    background-color: $ps-state-green;\n  1006→    color: white;\n  1007→}\n  1008→\n  1009→.tag-filled-yellow {\n  1010→    background-color: $ps-state-yellow;\n  1011→    color: #00192A;\n  1012→}\n  1013→\n  1014→.tag-filled-red {\n  1015→    background-color: $ps-state-red;\n  1016→    color: white;\n  1017→}\n  1018→\n  1019→.tag-filled-smooth-red {\n  1020→    background-color: $ps-scale-red-90;\n  1021→    color: $ps-scale-red-10;\n  1022→}\n  1023→\n  1024→.tag-filled-blue {\n  1025→    background-color: $ps-state-blue;\n  1026→    color: white;\n  1027→}\n  1028→\n  1029→.tag-filled-gray {\n  1030→    background-color: $ps-gray-30;\n  1031→    color: white;\n  1032→}\n  1033→\n  1034→.tag-filled-purple {\n  1035→    background-color: $ps-cta-purple;\n  1036→    color: white;\n  1037→}\n  1038→\n  1039→.tag.disabled {\n  1040→    background-color: $ps-gray-50;\n  1041→    color: white;\n  1042→}\n  1043→\n  1044→.tag-tonal-green {\n  1045→    background-color: $ps-state-green-25;\n  1046→    color: $ps-green-10;\n  1047→}\n  1048→\n  1049→.tag-tonal-yellow {\n  1050→    background-color: $ps-state-yellow-25;\n  1051→    color: $ps-yellow-10;\n  1052→}\n  1053→\n  1054→.tag-tonal-red {\n  1055→    background-color: $ps-state-red-25;\n  1056→    color: $ps-red-10;\n  1057→}\n  1058→\n  1059→.tag-tonal-blue {\n  1060→    background-color: $ps-state-blue-25;\n  1061→    color: $ps-blue-20;\n  1062→}\n  1063→\n  1064→.tag-tonal-gray {\n  1065→    background-color: $ps-gray-80;\n  1066→    color: $ps-gray-30;\n  1067→}\n  1068→\n  1069→.tag-tonal-purple {\n  1070→    background-color: $ps-cta-purple-25;\n  1071→    color: $ps-purple-30;\n  1072→}\n  1073→\n  1074→.tag-tonal-orange {\n  1075→    background-color: $ps-state-orange-25;\n  1076→    color: $ps-orange-10;\n  1077→}\n  1078→\n  1079→.tag-tonal-light-red {\n  1080→    background-color: #fcdcdc;\n  1081→    color: #801c1c;\n  1082→}\n  1083→\n  1084→.tag.disabled {\n  1085→    background-color: $ps-gray-50;\n  1086→    color: white;\n  1087→}\n  1088→\n  1089→.tag.tag-tonal.disabled {\n  1090→    background-color: $ps-gray-90;\n  1091→    color: $ps-gray-50;\n  1092→}\n  1093→\n  1094→// Botones\n  1095→.btn {\n  1096→    height: 44px;\n  1097→    display: inline-flex;\n  1098→    align-items: center;\n  1099→    padding: 12px 16px;\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"df3e4d44-38d8-4c8c-8459-480b53cbe900","timestamp":"2026-01-21T18:56:41.062Z","toolUseResult":{"type":"text","file":{"filePath":"c:\\laragon\\www\\psicoalianza-2\\resources\\sass\\globales.scss","content":"// Componentes de tags\n.tag {\n    border-radius: 4px;\n    padding: 6px 12px;\n}\n\n.tag-sm {\n    padding: 6px 8px;\n}\n\n.tag i {\n    color: inherit;\n}\n\n.tag-filled-green {\n    background-color: $ps-state-green;\n    color: white;\n}\n\n.tag-filled-yellow {\n    background-color: $ps-state-yellow;\n    color: #00192A;\n}\n\n.tag-filled-red {\n    background-color: $ps-state-red;\n    color: white;\n}\n\n.tag-filled-smooth-red {\n    background-color: $ps-scale-red-90;\n    color: $ps-scale-red-10;\n}\n\n.tag-filled-blue {\n    background-color: $ps-state-blue;\n    color: white;\n}\n\n.tag-filled-gray {\n    background-color: $ps-gray-30;\n    color: white;\n}\n\n.tag-filled-purple {\n    background-color: $ps-cta-purple;\n    color: white;\n}\n\n.tag.disabled {\n    background-color: $ps-gray-50;\n    color: white;\n}\n\n.tag-tonal-green {\n    background-color: $ps-state-green-25;\n    color: $ps-green-10;\n}\n\n.tag-tonal-yellow {\n    background-color: $ps-state-yellow-25;\n    color: $ps-yellow-10;\n}\n\n.tag-tonal-red {\n    background-color: $ps-state-red-25;\n    color: $ps-red-10;\n}\n\n.tag-tonal-blue {\n    background-color: $ps-state-blue-25;\n    color: $ps-blue-20;\n}\n\n.tag-tonal-gray {\n    background-color: $ps-gray-80;\n    color: $ps-gray-30;\n}\n\n.tag-tonal-purple {\n    background-color: $ps-cta-purple-25;\n    color: $ps-purple-30;\n}\n\n.tag-tonal-orange {\n    background-color: $ps-state-orange-25;\n    color: $ps-orange-10;\n}\n\n.tag-tonal-light-red {\n    background-color: #fcdcdc;\n    color: #801c1c;\n}\n\n.tag.disabled {\n    background-color: $ps-gray-50;\n    color: white;\n}\n\n.tag.tag-tonal.disabled {\n    background-color: $ps-gray-90;\n    color: $ps-gray-50;\n}\n\n// Botones\n.btn {\n    height: 44px;\n    display: inline-flex;\n    align-items: center;\n    padding: 12px 16px;","numLines":110,"startLine":990,"totalLines":4425}},"sourceToolAssistantUUID":"179c25cd-8f8d-42cd-8fab-46e7d2cfe460"}
{"parentUuid":"df3e4d44-38d8-4c8c-8459-480b53cbe900","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01PRfUH12vadpH1uecyRekzz","type":"message","role":"assistant","content":[{"type":"text","text":"Ahora veo los estilos originales. Voy a agregar una clase específica `tag-creditos` en el archivo `globales.scss` que tenga mayor especificidad para que no sea sobrescrita por el CSS de perfiles:"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":1363,"cache_read_input_tokens":118959,"cache_creation":{"ephemeral_5m_input_tokens":1363,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXM2uvRwrKA4cfxPwtJux","type":"assistant","uuid":"8c689a00-96e4-4ff9-912c-7abb2fe08ad4","timestamp":"2026-01-21T18:56:46.268Z"}
{"parentUuid":"8c689a00-96e4-4ff9-912c-7abb2fe08ad4","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01PRfUH12vadpH1uecyRekzz","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01YEdBknQyNC1HgmyKb9TEwM","name":"Edit","input":{"replace_all":false,"file_path":"c:\\laragon\\www\\psicoalianza-2\\resources\\sass\\globales.scss","old_string":".tag.tag-tonal.disabled {\n    background-color: $ps-gray-90;\n    color: $ps-gray-50;\n}\n\n// Botones","new_string":".tag.tag-tonal.disabled {\n    background-color: $ps-gray-90;\n    color: $ps-gray-50;\n}\n\n// Tag de créditos (alta especificidad para evitar conflictos con otros CSS)\n.tag.tag-creditos {\n    border-radius: 4px !important;\n    padding: 6px 12px !important;\n    margin: 0 !important;\n    display: inline-flex !important;\n    align-items: center !important;\n    cursor: default !important;\n}\n\n// Botones"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":1363,"cache_read_input_tokens":118959,"cache_creation":{"ephemeral_5m_input_tokens":1363,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXM2uvRwrKA4cfxPwtJux","type":"assistant","uuid":"bdb2919b-1db3-47eb-9f7a-9fd0e2769b39","timestamp":"2026-01-21T18:56:49.238Z"}
{"parentUuid":"bdb2919b-1db3-47eb-9f7a-9fd0e2769b39","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"type":"tool_result","content":"The user doesn't want to proceed with this tool use. The tool use was rejected (eg. if it was a file edit, the new_string was NOT written to the file). The user provided the following reason for the rejection:  pienso aue la idea es colocarlo del css de perfiles","is_error":true,"tool_use_id":"toolu_01YEdBknQyNC1HgmyKb9TEwM"}]},"uuid":"d7ffa73f-345b-4c72-bb58-31a3764bd2e5","timestamp":"2026-01-21T18:57:11.082Z","toolUseResult":"Error: The user doesn't want to proceed with this tool use. The tool use was rejected (eg. if it was a file edit, the new_string was NOT written to the file). The user provided the following reason for the rejection:  pienso aue la idea es colocarlo del css de perfiles","sourceToolAssistantUUID":"bdb2919b-1db3-47eb-9f7a-9fd0e2769b39"}
{"parentUuid":"d7ffa73f-345b-4c72-bb58-31a3764bd2e5","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_013VbRXjikVnKmkEgSo4RbYR","type":"message","role":"assistant","content":[{"type":"text","text":"Entendido. Voy a hacer el selector más específico en el CSS de perfiles para que solo aplique dentro del contexto de los niveles de perfiles y no afecte al tag de créditos:"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":452,"cache_read_input_tokens":120322,"cache_creation":{"ephemeral_5m_input_tokens":452,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXM2xAnhS6ahATWVqEBrp","type":"assistant","uuid":"4e009f1f-54c6-4060-92fb-56f27c383381","timestamp":"2026-01-21T18:57:16.136Z"}
{"parentUuid":"4e009f1f-54c6-4060-92fb-56f27c383381","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_013VbRXjikVnKmkEgSo4RbYR","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01McbABMJvhEPLrkqTEhkZny","name":"Read","input":{"file_path":"c:\\laragon\\www\\psicoalianza-2\\public\\css\\perfiles\\perfiles.css"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":452,"cache_read_input_tokens":120322,"cache_creation":{"ephemeral_5m_input_tokens":452,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXM2xAnhS6ahATWVqEBrp","type":"assistant","uuid":"1f4e4445-45c6-4638-a43a-b040be79cf13","timestamp":"2026-01-21T18:57:16.668Z"}
{"parentUuid":"1f4e4445-45c6-4638-a43a-b040be79cf13","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01McbABMJvhEPLrkqTEhkZny","type":"tool_result","content":"     1→.input-dinamico + .error {\n     2→    display: none!important;\n     3→}\n     4→\n     5→.nivel {\n     6→    border: 2px #e0e0e0;\n     7→    border-radius: 12px;\n     8→    overflow: hidden;\n     9→    display: flex;\n    10→    flex-direction: column;\n    11→    height: 150px;\n    12→    box-shadow: 0 2px 6px rgba(29, 29, 29, 0.425);\n    13→}\n    14→\n    15→/* Zona blanca para los tags */\n    16→.zona-tags {\n    17→    flex: 1;\n    18→    background-color: white;\n    19→    padding: 10px;\n    20→    min-height: 80px;\n    21→    overflow-y: auto;\n    22→}\n    23→\n    24→/* Zona de color para el rango */\n    25→.zona-rango {\n    26→    text-align: center;\n    27→    padding: 8px;\n    28→    color: white;\n    29→    font-weight: bold;\n    30→}\n    31→\n    32→.medio-rango {\n    33→    color: black !important;\n    34→}\n    35→\n    36→/* Colores por nivel */\n    37→/* .bajo {\n    38→    border-color: #F73B3B;\n    39→} */\n    40→.bajo-color {\n    41→    color: #F73B3B;\n    42→}\n    43→.bajo {\n    44→    border-color: #F73B3B;\n    45→}\n    46→.bajo .zona-rango {\n    47→    background-color: #F73B3B;\n    48→}\n    49→\n    50→.medio {\n    51→    border-color: #FFD12E;\n    52→}\n    53→.medio-color {\n    54→    color: #FFD12E;\n    55→}\n    56→.medio .zona-rango.medio-rango {\n    57→    background-color: #FFD12E;\n    58→}\n    59→\n    60→.alto {\n    61→    border-color: #81BF45;\n    62→}\n    63→.alto-color {\n    64→    color: #81BF45;\n    65→}\n    66→.alto .zona-rango {\n    67→    background-color: #81BF45;\n    68→}\n    69→\n    70→.avanzado {\n    71→    border-color: #1BB8F3;\n    72→}\n    73→.avanzado-color {\n    74→    color: #1BB8F3;\n    75→}\n    76→.avanzado .zona-rango {\n    77→    background-color: #1BB8F3;\n    78→}\n    79→\n    80→/* Tags */\n    81→.tag {\n    82→    background: #e0e0e0;\n    83→    padding: 5px 10px;\n    84→    border-radius: 15px;\n    85→    margin: 3px;\n    86→    display: inline-block;\n    87→    cursor: grab;\n    88→}\n    89→\n    90→.perfil_selected {\n    91→    min-width: 224px !important;\n    92→}\n    93→\n    94→.input-container-perfil {\n    95→    position: relative;\n    96→    height: auto;\n    97→    display: flex;\n    98→    flex-direction: column;\n    99→    align-items: flex-start;\n   100→    margin-bottom: 0px;\n   101→}\n   102→\n   103→.borde-tendisc {\n   104→    border-left: 15px solid #4da6ff;\n   105→    padding-left: 12px;\n   106→    border-radius: 10px; \n   107→}\n   108→\n   109→.borde-ethikos {\n   110→    border-left: 15px solid #75242a;\n   111→    padding-left: 12px;\n   112→    border-radius: 10px; \n   113→}\n   114→\n   115→.borde-iq {\n   116→    border-left: 15px solid #2ab296;\n   117→    padding-left: 12px;\n   118→    border-radius: 10px; \n   119→}\n   120→\n   121→.borde-potencial {\n   122→    border-left: 15px solid #543289;\n   123→    padding-left: 12px;\n   124→    border-radius: 10px; \n   125→}\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"a27691d6-c026-46a9-8430-80c749142d2e","timestamp":"2026-01-21T18:57:17.999Z","toolUseResult":{"type":"text","file":{"filePath":"c:\\laragon\\www\\psicoalianza-2\\public\\css\\perfiles\\perfiles.css","content":".input-dinamico + .error {\n    display: none!important;\n}\n\n.nivel {\n    border: 2px #e0e0e0;\n    border-radius: 12px;\n    overflow: hidden;\n    display: flex;\n    flex-direction: column;\n    height: 150px;\n    box-shadow: 0 2px 6px rgba(29, 29, 29, 0.425);\n}\n\n/* Zona blanca para los tags */\n.zona-tags {\n    flex: 1;\n    background-color: white;\n    padding: 10px;\n    min-height: 80px;\n    overflow-y: auto;\n}\n\n/* Zona de color para el rango */\n.zona-rango {\n    text-align: center;\n    padding: 8px;\n    color: white;\n    font-weight: bold;\n}\n\n.medio-rango {\n    color: black !important;\n}\n\n/* Colores por nivel */\n/* .bajo {\n    border-color: #F73B3B;\n} */\n.bajo-color {\n    color: #F73B3B;\n}\n.bajo {\n    border-color: #F73B3B;\n}\n.bajo .zona-rango {\n    background-color: #F73B3B;\n}\n\n.medio {\n    border-color: #FFD12E;\n}\n.medio-color {\n    color: #FFD12E;\n}\n.medio .zona-rango.medio-rango {\n    background-color: #FFD12E;\n}\n\n.alto {\n    border-color: #81BF45;\n}\n.alto-color {\n    color: #81BF45;\n}\n.alto .zona-rango {\n    background-color: #81BF45;\n}\n\n.avanzado {\n    border-color: #1BB8F3;\n}\n.avanzado-color {\n    color: #1BB8F3;\n}\n.avanzado .zona-rango {\n    background-color: #1BB8F3;\n}\n\n/* Tags */\n.tag {\n    background: #e0e0e0;\n    padding: 5px 10px;\n    border-radius: 15px;\n    margin: 3px;\n    display: inline-block;\n    cursor: grab;\n}\n\n.perfil_selected {\n    min-width: 224px !important;\n}\n\n.input-container-perfil {\n    position: relative;\n    height: auto;\n    display: flex;\n    flex-direction: column;\n    align-items: flex-start;\n    margin-bottom: 0px;\n}\n\n.borde-tendisc {\n    border-left: 15px solid #4da6ff;\n    padding-left: 12px;\n    border-radius: 10px; \n}\n\n.borde-ethikos {\n    border-left: 15px solid #75242a;\n    padding-left: 12px;\n    border-radius: 10px; \n}\n\n.borde-iq {\n    border-left: 15px solid #2ab296;\n    padding-left: 12px;\n    border-radius: 10px; \n}\n\n.borde-potencial {\n    border-left: 15px solid #543289;\n    padding-left: 12px;\n    border-radius: 10px; \n}","numLines":125,"startLine":1,"totalLines":125}},"sourceToolAssistantUUID":"1f4e4445-45c6-4638-a43a-b040be79cf13"}
{"parentUuid":"a27691d6-c026-46a9-8430-80c749142d2e","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01SNafxVi9RnpwaWQPzFkgLL","type":"message","role":"assistant","content":[{"type":"text","text":"Voy a cambiar el selector `.tag` para que solo aplique dentro de `.zona-tags` (donde están los tags arrastrables de perfiles):"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":1554,"cache_read_input_tokens":120774,"cache_creation":{"ephemeral_5m_input_tokens":1554,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXM2xdigyj66GjJRzbABe","type":"assistant","uuid":"c48e072c-a0c1-4af0-937b-22afa2e32c0b","timestamp":"2026-01-21T18:57:21.973Z"}
{"parentUuid":"c48e072c-a0c1-4af0-937b-22afa2e32c0b","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_01SNafxVi9RnpwaWQPzFkgLL","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_018LfNYrHJsjk6ycH3f2bP6E","name":"Edit","input":{"replace_all":false,"file_path":"c:\\laragon\\www\\psicoalianza-2\\public\\css\\perfiles\\perfiles.css","old_string":"/* Tags */\n.tag {\n    background: #e0e0e0;\n    padding: 5px 10px;\n    border-radius: 15px;\n    margin: 3px;\n    display: inline-block;\n    cursor: grab;\n}","new_string":"/* Tags arrastrables dentro de zona-tags */\n.zona-tags .tag {\n    background: #e0e0e0;\n    padding: 5px 10px;\n    border-radius: 15px;\n    margin: 3px;\n    display: inline-block;\n    cursor: grab;\n}"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":1554,"cache_read_input_tokens":120774,"cache_creation":{"ephemeral_5m_input_tokens":1554,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXM2xdigyj66GjJRzbABe","type":"assistant","uuid":"a42381e2-b4cf-4513-8c3e-c9111ee7d231","timestamp":"2026-01-21T18:57:23.966Z"}
{"parentUuid":"a42381e2-b4cf-4513-8c3e-c9111ee7d231","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"type":"tool_result","content":"The user doesn't want to proceed with this tool use. The tool use was rejected (eg. if it was a file edit, the new_string was NOT written to the file). The user provided the following reason for the rejection:  no crar otro css para para colocarcelo a este tag para que quede como el original cabecera: `\n            <div class=\"col-auto text-headline-2 text-gray-30 fw-bold\">Producto selección</div>\n            <div class=\"col-auto ps-2 pe-0 my-auto\" id=\"contenedor-tag-creditos\">\n                ${crearTag({\n                    texto: 'Cargando créditos...',\n                    class: 'tag-tonal-blue'\n                })}\n            </div>","is_error":true,"tool_use_id":"toolu_018LfNYrHJsjk6ycH3f2bP6E"}]},"uuid":"21ba3650-9c0f-4d6f-88c2-7a61af2c8eb7","timestamp":"2026-01-21T18:58:22.090Z","toolUseResult":"Error: The user doesn't want to proceed with this tool use. The tool use was rejected (eg. if it was a file edit, the new_string was NOT written to the file). The user provided the following reason for the rejection:  no crar otro css para para colocarcelo a este tag para que quede como el original cabecera: `\n            <div class=\"col-auto text-headline-2 text-gray-30 fw-bold\">Producto selección</div>\n            <div class=\"col-auto ps-2 pe-0 my-auto\" id=\"contenedor-tag-creditos\">\n                ${crearTag({\n                    texto: 'Cargando créditos...',\n                    class: 'tag-tonal-blue'\n                })}\n            </div>","sourceToolAssistantUUID":"a42381e2-b4cf-4513-8c3e-c9111ee7d231"}
{"parentUuid":"21ba3650-9c0f-4d6f-88c2-7a61af2c8eb7","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_012wdUsfyo2cnqBkScm5JTgZ","type":"message","role":"assistant","content":[{"type":"text","text":"Entendido. Voy a agregar una nueva clase CSS en el archivo de perfiles que sobrescriba los estilos para el tag de créditos:"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":510,"cache_read_input_tokens":122328,"cache_creation":{"ephemeral_5m_input_tokens":510,"ephemeral_1h_input_tokens":0},"output_tokens":3,"service_tier":"standard"}},"requestId":"req_011CXM33LNoCBBFZAhkWXeHh","type":"assistant","uuid":"e6771eb3-1583-4f9a-b9d9-83deb6aaa0dc","timestamp":"2026-01-21T18:58:25.738Z"}
{"parentUuid":"e6771eb3-1583-4f9a-b9d9-83deb6aaa0dc","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_012wdUsfyo2cnqBkScm5JTgZ","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01U8USJzPE3iLZqo9qB5U3fc","name":"Edit","input":{"replace_all":false,"file_path":"c:\\laragon\\www\\psicoalianza-2\\public\\css\\perfiles\\perfiles.css","old_string":".borde-potencial {\n    border-left: 15px solid #543289;\n    padding-left: 12px;\n    border-radius: 10px; \n}","new_string":".borde-potencial {\n    border-left: 15px solid #543289;\n    padding-left: 12px;\n    border-radius: 10px;\n}\n\n/* Tag de créditos - restaura estilos originales */\n#contenedor-tag-creditos .tag {\n    background: transparent;\n    padding: 6px 12px;\n    border-radius: 4px;\n    margin: 0;\n    display: inline-flex;\n    align-items: center;\n    cursor: default;\n}\n\n#contenedor-tag-creditos .tag.tag-tonal-blue {\n    background-color: #ddeeff;\n    color: #0066cc;\n}\n\n#contenedor-tag-creditos .tag.tag-tonal-gray {\n    background-color: #e6e6e6;\n    color: #4d4d4f;\n}\n\n#contenedor-tag-creditos .tag.tag-filled-yellow {\n    background-color: #FFD12E;\n    color: #00192A;\n}"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":510,"cache_read_input_tokens":122328,"cache_creation":{"ephemeral_5m_input_tokens":510,"ephemeral_1h_input_tokens":0},"output_tokens":3,"service_tier":"standard"}},"requestId":"req_011CXM33LNoCBBFZAhkWXeHh","type":"assistant","uuid":"4df0e858-42b5-483f-a67c-e42be2322246","timestamp":"2026-01-21T18:58:29.476Z"}
{"type":"file-history-snapshot","messageId":"4df0e858-42b5-483f-a67c-e42be2322246","snapshot":{"messageId":"66dcf375-efd7-4a00-b1d3-b849d17c3293","trackedFileBackups":{"resources\\views\\vacantes\\paginas\\index.blade.php":{"backupFileName":"1ae59264a32091d1@v9","version":9,"backupTime":"2026-01-21T16:50:05.680Z"},"public\\js\\globales.js":{"backupFileName":"704f632e999527e6@v8","version":8,"backupTime":"2026-01-21T18:53:19.409Z"},"public\\js\\vacantes\\vacantes.js":{"backupFileName":"ca631dbb99127e3f@v3","version":3,"backupTime":"2026-01-21T16:33:41.257Z"},"public\\componentes\\componentes\\tags.js":{"backupFileName":"247759b31878023a@v2","version":2,"backupTime":"2026-01-21T16:39:57.931Z"},"public\\js\\agendas\\historial-agendamientos.js":{"backupFileName":"2dc428456137fadd@v1","version":1,"backupTime":"2026-01-21T17:51:18.649Z"},"public\\css\\perfiles\\perfiles.css":{"backupFileName":"6ec2f78530390885@v1","version":1,"backupTime":"2026-01-21T18:58:40.339Z"}},"timestamp":"2026-01-21T18:56:08.994Z"},"isSnapshotUpdate":true}
{"parentUuid":"4df0e858-42b5-483f-a67c-e42be2322246","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01U8USJzPE3iLZqo9qB5U3fc","type":"tool_result","content":"The file c:\\laragon\\www\\psicoalianza-2\\public\\css\\perfiles\\perfiles.css has been updated. Here's the result of running `cat -n` on a snippet of the edited file:\n   117→    padding-left: 12px;\n   118→    border-radius: 10px; \n   119→}\n   120→\n   121→.borde-potencial {\n   122→    border-left: 15px solid #543289;\n   123→    padding-left: 12px;\n   124→    border-radius: 10px;\n   125→}\n   126→\n   127→/* Tag de créditos - restaura estilos originales */\n   128→#contenedor-tag-creditos .tag {\n   129→    background: transparent;\n   130→    padding: 6px 12px;\n   131→    border-radius: 4px;\n   132→    margin: 0;\n   133→    display: inline-flex;\n   134→    align-items: center;\n   135→    cursor: default;\n   136→}\n   137→\n   138→#contenedor-tag-creditos .tag.tag-tonal-blue {\n   139→    background-color: #ddeeff;\n   140→    color: #0066cc;\n   141→}\n   142→\n   143→#contenedor-tag-creditos .tag.tag-tonal-gray {\n   144→    background-color: #e6e6e6;\n   145→    color: #4d4d4f;\n   146→}\n   147→\n   148→#contenedor-tag-creditos .tag.tag-filled-yellow {\n   149→    background-color: #FFD12E;\n   150→    color: #00192A;\n   151→}"}]},"uuid":"a40f0dfd-8722-4349-819e-6a4534042b39","timestamp":"2026-01-21T18:58:40.471Z","toolUseResult":{"filePath":"c:\\laragon\\www\\psicoalianza-2\\public\\css\\perfiles\\perfiles.css","oldString":".borde-potencial {\n    border-left: 15px solid #543289;\n    padding-left: 12px;\n    border-radius: 10px; \n}","newString":".borde-potencial {\n    border-left: 15px solid #543289;\n    padding-left: 12px;\n    border-radius: 10px;\n}\n\n/* Tag de créditos - restaura estilos originales */\n#contenedor-tag-creditos .tag {\n    background: transparent;\n    padding: 6px 12px;\n    border-radius: 4px;\n    margin: 0;\n    display: inline-flex;\n    align-items: center;\n    cursor: default;\n}\n\n#contenedor-tag-creditos .tag.tag-tonal-blue {\n    background-color: #ddeeff;\n    color: #0066cc;\n}\n\n#contenedor-tag-creditos .tag.tag-tonal-gray {\n    background-color: #e6e6e6;\n    color: #4d4d4f;\n}\n\n#contenedor-tag-creditos .tag.tag-filled-yellow {\n    background-color: #FFD12E;\n    color: #00192A;\n}","originalFile":".input-dinamico + .error {\n    display: none!important;\n}\n\n.nivel {\n    border: 2px #e0e0e0;\n    border-radius: 12px;\n    overflow: hidden;\n    display: flex;\n    flex-direction: column;\n    height: 150px;\n    box-shadow: 0 2px 6px rgba(29, 29, 29, 0.425);\n}\n\n/* Zona blanca para los tags */\n.zona-tags {\n    flex: 1;\n    background-color: white;\n    padding: 10px;\n    min-height: 80px;\n    overflow-y: auto;\n}\n\n/* Zona de color para el rango */\n.zona-rango {\n    text-align: center;\n    padding: 8px;\n    color: white;\n    font-weight: bold;\n}\n\n.medio-rango {\n    color: black !important;\n}\n\n/* Colores por nivel */\n/* .bajo {\n    border-color: #F73B3B;\n} */\n.bajo-color {\n    color: #F73B3B;\n}\n.bajo {\n    border-color: #F73B3B;\n}\n.bajo .zona-rango {\n    background-color: #F73B3B;\n}\n\n.medio {\n    border-color: #FFD12E;\n}\n.medio-color {\n    color: #FFD12E;\n}\n.medio .zona-rango.medio-rango {\n    background-color: #FFD12E;\n}\n\n.alto {\n    border-color: #81BF45;\n}\n.alto-color {\n    color: #81BF45;\n}\n.alto .zona-rango {\n    background-color: #81BF45;\n}\n\n.avanzado {\n    border-color: #1BB8F3;\n}\n.avanzado-color {\n    color: #1BB8F3;\n}\n.avanzado .zona-rango {\n    background-color: #1BB8F3;\n}\n\n/* Tags */\n.tag {\n    background: #e0e0e0;\n    padding: 5px 10px;\n    border-radius: 15px;\n    margin: 3px;\n    display: inline-block;\n    cursor: grab;\n}\n\n.perfil_selected {\n    min-width: 224px !important;\n}\n\n.input-container-perfil {\n    position: relative;\n    height: auto;\n    display: flex;\n    flex-direction: column;\n    align-items: flex-start;\n    margin-bottom: 0px;\n}\n\n.borde-tendisc {\n    border-left: 15px solid #4da6ff;\n    padding-left: 12px;\n    border-radius: 10px; \n}\n\n.borde-ethikos {\n    border-left: 15px solid #75242a;\n    padding-left: 12px;\n    border-radius: 10px; \n}\n\n.borde-iq {\n    border-left: 15px solid #2ab296;\n    padding-left: 12px;\n    border-radius: 10px; \n}\n\n.borde-potencial {\n    border-left: 15px solid #543289;\n    padding-left: 12px;\n    border-radius: 10px; \n}","structuredPatch":[{"oldStart":121,"oldLines":5,"newStart":121,"newLines":31,"lines":[" .borde-potencial {","     border-left: 15px solid #543289;","     padding-left: 12px;","-    border-radius: 10px; ","+    border-radius: 10px;","+}","+","+/* Tag de créditos - restaura estilos originales */","+#contenedor-tag-creditos .tag {","+    background: transparent;","+    padding: 6px 12px;","+    border-radius: 4px;","+    margin: 0;","+    display: inline-flex;","+    align-items: center;","+    cursor: default;","+}","+","+#contenedor-tag-creditos .tag.tag-tonal-blue {","+    background-color: #ddeeff;","+    color: #0066cc;","+}","+","+#contenedor-tag-creditos .tag.tag-tonal-gray {","+    background-color: #e6e6e6;","+    color: #4d4d4f;","+}","+","+#contenedor-tag-creditos .tag.tag-filled-yellow {","+    background-color: #FFD12E;","+    color: #00192A;"," }","\\ No newline at end of file"]}],"userModified":false,"replaceAll":false},"sourceToolAssistantUUID":"4df0e858-42b5-483f-a67c-e42be2322246"}
{"parentUuid":"a40f0dfd-8722-4349-819e-6a4534042b39","isSidechain":false,"userType":"external","cwd":"c:\\laragon\\www\\psicoalianza-2","sessionId":"f1673a8b-b94e-4e28-b6f2-be0c80dc1961","version":"2.1.11","gitBranch":"D26-260","slug":"federated-wobbling-pony","message":{"model":"claude-opus-4-5-20251101","id":"msg_0158rE4xXkpa19GRLiULVduR","type":"message","role":"assistant","content":[{"type":"text","text":"Listo. Agregué estilos específicos para el tag de créditos usando el selector `#contenedor-tag-creditos .tag` que tiene mayor especificidad que `.tag` y restaura los estilos originales:\n\n- **Estilos base**: `border-radius: 4px`, `padding: 6px 12px`, sin margen, display flex\n- **tag-tonal-blue**: Fondo azul claro con texto azul\n- **tag-tonal-gray**: Fondo gris claro con texto gris oscuro  \n- **tag-filled-yellow**: Fondo amarillo con texto oscuro"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":926,"cache_read_input_tokens":122838,"cache_creation":{"ephemeral_5m_input_tokens":926,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXM34osJVibSnmntB5hiQ","type":"assistant","uuid":"d957a5e8-f911-4f7d-b378-8e65cf99b13a","timestamp":"2026-01-21T18:58:46.773Z"}
